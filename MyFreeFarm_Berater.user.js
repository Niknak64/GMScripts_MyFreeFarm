// ==UserScript==
// @name           MyFreeFarm Berater
// @namespace      https://github.com/BastianKanaan/GMscripts_MyFreeFarm
// @author         BastianKanaan
// @description    Extends MyFreeFarm
// @icon           data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94BGgo6NO+u5q4AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAS0ElEQVRo3t2aeYxl11ngf+fub3+172t3V1cv7sVuJ3bs7jh2QtoMDoHEwRlCbMJEATRiSaKBQTNBCKGwBwSDNAyTQVGCYJIMEINjxrFix3E73mO7TW/V1VXVtS+v6i13v+ee+aNvQSXDaCTS7W7nSE/v3veuzrm/8y3nO9934Dq08cE+APv9E/1//tDN+16/9+hNJ/l+bXv3jAHw4zf1P/sLdx5TRqXyc++fHPvsGzW+/kbC5vMOyyvrfOSDJz99eM/gj+09fkK9Na/fW8sVzr86NfOl7ydgB+iK46TnVz75wJNtHZX3rcuUI8dvFS9cnuHQ7YcOWprTfvb8pUe/H4BzwH7g0H/59INfq3Z09++ZHBPHbn8LpVKF3WNdWPlOdeIdd962MDf/8vSl+XPX8mW0awxrAiPAgd/4xXf+wdaG74yP7BL9w/vp7x2h1WrRM3SYwf5+8cLz31Yf/w8f/fK1nn3tGkt2D3AE6J7o6xoc7Cjyq//pt3ntm88wMzvDhfMX+dmP/AJJnDKxe0j09HQZDzzwns+9GVW6CBwGjgIdhbz91vfdffjg6soWrhcwf+p5Cu7L3DwhWTkdYvVWCeOEQsFm//5dY1/4wld+880kYQeYBG4CqoD23uMTk0mcQJTQF9R4/48PM3mwDU2HDz5Y5dk/+VPc5YuErZpKooZ9LSVsXOX+BNAB7AUK2X1yx97C7oXpNQb7Nrn5pw5hOA6FthLFYh4hdD7+B8NceHGKi2eqYmTfmAGwb3I3Z85O3fAS1oHubckC6IZ9uGCWCruHN6lWHNIwQRc6BjqkGpqCNEkZPTTG0aFZtuqBPjQ08NPXAvZaAJtA2w7NUQ+9c/Lt5XQOWh5hrY5yfbQoRAYBKvRJ4xgZxcReQD5vMaK9yu9+5j//iWEY4s2g0nYGvO0MxX9/9PTnT1R6P1UqCVJDR/kJdiIQrsIqRghT4KEIpCSNJAuLa3zm7179qJaibnRgDejJgP9JOp3thZueOJvygwdTND0lcFuEWhEtdTALvTTXlmikCV4ScHFhixefXEHSuStKkxveadnAQOas/qm1vHhlq5Uwta6rsUosiCWuVsfJF2itzNMKY+a36sxsNXnhYkI5LLBSWz71ZvDSCkiz739eoyyjMI81VV7Vd6skYLSasrK4gWnnWKt7PL+4wbwbcv6yRKsrZDHXSGqbr74ZAg8t89D9O/stWNbuTS+8+Mzs2hfqstBNnPYOdRpcXNjg4VeXeOqSz/RcghuIb6zr5m+2omQ1NZ2/q7da4c7O+3u6abruDQWsA0PfDTzSVji26QZWJOWFxbr73OTuwcPfeL1ezhcNljydlmdDW+XJ8zPzd/lRsr6vo/xbtkjW26qVwzKJb7INo6OtWl1fWl2LbkQvnQJxJm0NEKZh6yptpNvx9fmt5MXjk72DD798meFyldHDY6xeuMi79nYpJWXqJJH2ajOaqW3UHtvudMsLGOjtYWF55YZahwUggRngEuAC6txa7XHNMF/Z9txRLJNATxnuG2Civ5ORgS56nPTtaPrpr03V9DDwGztht9vVgL0WwBpwGXgKeAVwoyiqNf1gbXtC2goWInLYZUG1UqH25JP4iTr32JnlQ4D92OJm5f83UG93xw2h0gKwsusGcDZbl8eziVADXe33juXlD0QrDRWWcqK2sIDSneSx80sngX6E8IZ7OvvCIPx5Kwnu6eru7J1fWPLLPQMvrtc2v+XknadMzXhdIlr79k2kZ86cv67AaQbqZtd+di8Bdctw9ZerVb3njjvGeOyvT4tG1zD27GX8vqH/wfmlxf6eronRnJqKIt/RCqCcrjNzm+7Nq6GaX52bzxb1K166v7e7HIeRByTXEzgCpjKnlX5HgG3ak+++d39PwcirNAzEsZN38sg/rvPAJ3+WwTb7o3rs3xPWVsYKhQKRq3GmqR2bvrjwIkBfZztL67XvGGhxebVxoyQAomzWLaAL2AVU/u29t9y/d3Skc31pXcTSQG6sENpF3nLLfkwh1ckfua991/4J8fpzL4jXaukTtWbTLBdL7e3t1bzQ9Uaj2Ypv1M3Ddoi5F9iH0Mf/6Jfu/3hff2/n8uqaGpk8KjQErcYmt/YNUe7sxVCJiBPFI5//K0bGB5UoNnNffGL5z8BNLNNMhRDb/uGqbCautoS1LPh4i2ZYRz54fOxT02cv5A/ceozugWFh6RrDh46RMxX9g33IyOeRv36EXYfeQhi02FhaIG9pg1uxuVDbrD8p0zSQUsrvNpEbCTiXpXZGH7xj6NerxTIqidk9Ocljjz6Bcuv09HfxyFe+Stxy6R4a5IlHHuXlp75O4jbxo0jEErW3r3Ty3LL/a2EYXFXYqwksssTdGLC3krf3j7XlbtPRcEyTrz/9Eh0lm5X1TVIl2FxZZGpmjqVLM7SVHSqlAghFEkuWN13hWCb5fOH3Li2sRlwDFbwasJ3AMeCtQLtjm/vcZsDK0ipx4DMx2EGpYGPmHGYvnKVUKVCpFMmZkKQphbxFqlL8WHLq9ByXV+tYmnr4Rk3xlLKU7AGgAmiDbcXROI7xIonne4g0xrYMOtqKKB0sXWekr51c3sa2DNAExZyDbgiUUrx8YYGiKd9+cM/I0I0GrGe7o7EsPQsIYywXTUgF9Uhi6ALimJxlolKJY1uEcYRKFbahUcw5yCQlUQpN03jv8UnZ3T/6e4+/PM14d+F1gIN7x24YYCMLH/PbP1QKdpvrxtQiVHfBVK6fgoypbTZJZYqUkqYb0Gq51BsegecjU4Vp6FimSVuloPte0xsYHHnu+bNzxfvu2P/S6XOXtR86cdMNAWzuyD8DcGig7cFFTzLl6YslS6AZEEcRtVod3wuo111818P3ApIgIooTfM9ndnkLw9AJooR7Dvf/yumZpeMyFY3ZxfUj9905ceGpqcR49+0Hrjuwk9mwBqj+jvKEX6/1zSVO0JeT3cLURck2SJXACTxi10PFCaam02h4+J5HqxnQagUIDUzLIJKSYs7S9/ZXz69uNqtz6631raY7/s4J89w/PPM6B/eOXzdgLfPO5Svxslm9Y9D52DyVxDKNhW4rNUxDo5wzKBo6XqpI/AAZxsRxQj5no3QTJRSWbdBRLWFbFn2dbSgUd9/UN9zd1XVpq+l1P/Pa5ZnaVn38/e84/Nrpc9OMDQ1cF2Anc1gOkPzAwYFfPr0hieL46YG86u0pWMLUBW4sidDo6KzS0dlGV3cbpUKOaql4ZWnK5wmimDSVOI6FF0TIVKGhiYqVjpRLxc/t37/vyEtT66cCzzv4Y3cfefzS5QV2jY2+oYHHdv7qIKAf29VzX1vJmVgMrItFgkP1ZsserFg4to6tGygFVr5AgiBVYDsWmiEIY4lMU8rlIqZloJRASYmuCYIwYrS3Kp77x7nDfhAuOI716GpLqo5c+p5Dk2NDT7905itvFPB2wewo0FMpFQffc3Tgoadn/MgPAtMKG/nx9jwVxyDvGPihBNNB6Dq6YWCaJkLXcf0QhcJ2TDTdQEMgUZiGRhgmxHFCznHQdNT5uZUfHBgc/JlarXYp1osHunPpe7p7B+szC8vfeiNUusCVIwx9QO1Hjw3/4jcvNVLXD6OBkjDiVKiSdaXbpp+gmRapEDTDmI2WS8P1EAIKeQfbsdhqeDRaTYI4wnV9kFBrtIhlSsv1OTTeJ0p5G5toutFonlrf2Lzv23PuZncu/AzkR/fsGrumwGYWZIwD0Vv39LxrvRU4F5fr2sbm5meDVqs43u4IKSFNFZoSRGGEIaCQc+hpr2KYOkopQGEaBuVino5yBamg1fLZaLYo5hyUglimmJbJiSPjTM0utR05eji/Xqutu2H03hdeX/jGB06MPn3h4qVrBiyyRPu+LNAwBkvmQ6emNnyU+l89He0fyosUSxOkKiWIU/woIQgTGq0Av9EijWMsXYNUIVNoNT1sU6fp+bgND5mmyFjh+REKsC2Tjc06HaUcmoCVxaUBgHIhf07Y+enZ5fp/vf/43qeulQ0XM7sdAtI793R96HI9Km648fkkkSqvJUuDRXO8aOvkTAOlFJoQCAFJClbOQaBQQoMkxTINdEPH9ULCMMaxbaRUpGlKkqRX4FVKGEs620rUtpq4CV9yXW/2ns0t99spX0U3/02QiNroYF+nqZuvbDVbV03COjDMlRM5EjTVXS3fvpFYsZTyrKZp+ZxObzVvYusGhi4wdZ04VSRSIYDID2h5Ic2mT8sLCMOYzS2XVKZoCKIoQUMjjCVC10gVFPN5ysU8XpCwf9cAtdpGEeB/AqWCE11aWP7EesM/ZSfNP7+0EHbs3TV+1YArwO4MfOnEnvaPnpqubTbr9dO6pr3X8/2/7ygX26p5k0SlCK5ItmKbWLqGKQSJTFFSoWRK04+4vLKB6wW03ABTNwjDmCCKiRKJkXltL4yRSiA0TSGgo1rdzn2ztLoOwOziyudn17x77z7onD13cfqqAJvAKFeOMWzkC6UeX5jdbpRsaZro8Tz/V1WaunHghVGicEyNSKboQqMZJRhCQ8oEmUjcIKTpBshEUrBtio6NLgQtPyBOJE3PRyaStVodqRQqVTRavmr4sTB041LLC+0slP3OF9T1+a3Zxc7b9u/5yPcKLID2TJ0DYPX43p6fu7AWrIF6rOV6f6ZQAhCJZtYNTRBn2z5Ng7a8RStO0DVBkkiUlGi6Rhgl+F5IFMbouo7rRfhhTN62UUJQLhexLRs3DIklIkpk0PCT11zPS7JMaG7nS55fXDu9VR34xNTy+tr3Cmxly1AB8Hs622/ZjNJ+HYoykT+j69r2wMKP5GyqaypOwLEM5SWSVigpWgZ+IgmTBJRCi2NKtoFhGtRaHp4fYZk6OcfCDyLiRBJEEW4Y4waKWKGaftR0/fCroF7Jgp7hnQ53fGyE6csLv79e23z4e/HSItvrTmSJtODmfYMfO3NhfmKr5eaKxcIXPM9f2t4a6kKj3TZuacmUMFGiu+SIWCriVF7J7pk6ptAIAZWCbuhoAhQCzdBBaTiOQy6XI4xT5YYRKCXcIDntOPYDj3/r9N9mWtYF9ALrWXWDza36VVmW8lw5OlgE6sBpLySuNVo/Cnw7CAK5Q0NEmKZJTpMHLMtWUYq26SW6VGAYembTOoapkyqNOE2xHQelG0gEXpiAptEKY7XphuFGoyXbndic7BPKFP7//vIT5/44G0ftSDq4wObViqVFthPalu4isOD5/rcy9R7LbHv7WdJUxUut+JRlaL2aprXphrB9qVQrlFiGLrw4JVUQK5AIEqHjBpFKFEITBoFENfx4c2WjuXDrUNJ727jBSIcSBwaMwx1tldwLF7a+lgG7mQC2MolflUjLzuykLftUdjwbA142+P91liqX16MH7yqWBroMqmUDLyFtxiKN0NKtKEn9SKogTNRGvaWabkCqNLXa9NKl9a2VMzOrXx+vhGNv321zebaBYRpcXvTV0b74lz58ct/bdpRzljLoq1ZqcTKYy0AtK3L72X9JVhVMMg1RgJbP5wuHxjoO//xxcef0vMvJm6ts+Zp4/KWafmbRXdts+m5k5J93DJkbK5vHUxkJITQ1t7gcN1Nz5vLa5peUgnfd1/e+szMe3zzbYs9EiaWkcvTcc3NfvevW4tc+98+5s3912eX/BexnBe04m1G5YxC5Q52sTPLDcRTd8sl71Nv+8kXdPTMTBz/dGXacXTPCMNbCT93f1fWhP579Q2j6dWClxhPZZBmZr6gCb2svO3t6qpZ6/Fm/dWoxfPIDLflDDz8z99vnloK/3dW38e/+4/tGf/fTX5755LVI8YSZymzXYHfOqMqkvpVd54CxA4P5vlAvqi89PfP3F5brS3aq+Jvn1pcfPb124fSFRnrylp77d5RNkmwyrcwploD8B2/r3qOEEb+0Lv8QWEsTpW6f7MkpmWivzYfrR4btT0B+ZHJ88A1P8TSA2UzKGmD+8B5zNPRD0dtWHsrplE3L5qETvWVQ0aKr+x97R+Ew6IVsIs8BLwELmafdyplGZbIUGlEYGWut8NfzjjNpxam4a1QdB9Z1jbwfSH7nJ4f+/dnp+TccOM7sei3TgvLMuplsLgUEUsnJ7lLBqwUM5pI2YLrDTpwwEtxztKcGPAGcAp4HngXmgKYhlIg2EzYWWkRReELCVlKLWF2MASzdE4G35qnVmfrw9aoP17OKfwGQX359/excq1TYajSfnUqdNNoKT/zDlHgYaOnNRHlrLqbSXgGmd5jI+Uyte5qRrD06Q9Nqb/sw1NbCIFj64gWTFaUfA37kken6oyA/HHUMfwqWuV6tANwJ/BrwF9le+W7gs6OVwnYq4k9vGuy8cP/+8jPQb/4L6/0w8BPAFxHi+I7//puZyx/YMc5f2MXKEa5z07Ii2k8AN2c7KwG8e8czd+Rs+wN2tTM33Nv9L/XRA9wP3PVdGpf7rue6rsYL/x8HbwtumjbAVwAAAABJRU5ErkJggg==
// @date           16.10.2023
// @version        2.10.102
// @license        GPL version 3 or any later version; http://www.gnu.org/copyleft/gpl.html
// @include       /^(http|https):\/\/(|www\.|s\d+\.)au\.myfreefarm\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)veselaferma\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.com\.br\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.de\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.cz\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.dk\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.gr\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)migranjalinda\.es\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)mabelleferme\.fr\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.com\.hr\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.ae\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.ir\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.it\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)enkicsitanyam\.hu\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.nl\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.co\.nz\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.no\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)wolnifarmerzy\.pl\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)pt\.myfreefarm\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)fermavesela\.ro\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)mojaderewnja\.ru\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.se\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)th\.myfreefarm\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)tr\.myfreefarm\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.com\/.*$/
// @include       /^(http|https):\/\/(|www\.|s\d+\.)myfreefarm\.com\.vn\/.*$/
// @exclude        https://*/dyn_bubbles.php*
// @exclude        https://*/nachrichten/bbhelp.php*
// @exclude        http://*/payment/*
// @grant          GM_addStyle
// @grant          GM_deleteValue
// @grant          GM_getValue
// @grant          GM_listValues
// @grant          GM_log
// @grant          GM_registerMenuCommand
// @grant          GM_setValue
// @grant          GM_xmlhttpRequest
// @grant          unsafeWindow
// @require        https://raw.githubusercontent.com/linus--tux/GMscripts_MyFreeFarm/master/MyFreeFarm_Common_functions.user.js
// ==/UserScript==

//***********************************************************************************************************
unsafeData.beraterDone=false;
// global variables
const VERSION=GM_info["script"]["version"];
const neededVersionFunctionFile="2.1.12";
const GM_Home  =GM_info["script"]["namespace"];
const GM_Source=GM_info["script"]["namespace"];
// [version,date,[[de,en],[de,en],...]]
const CHANGELOG=[["2.0","29.05.2014",[["Migration nach openuserjs.org","Migration to openuserjs.org"],["Script wird jetzt auf GitHub entwickelt","Script now developed on GitHub"]]]
                ,["2.1.1","14.06.2014",[["Neu: Changelog","New: Changelog"],["Bugfixes","Bugfixes"]]]
                ,["2.1.2","28.06.2014",[["Geändert: Berechnung des \"Rekursiv benötigt\"-Wertes","Change: Calculation of \"Recursive needed\" value"],["Neu: Optionen bzgl. Globaler Zeit und Bauernmarkt","New: Options according to global time and farmersmarket"],["Bugfix: Event nach Bedienung eines Farmis","Bugfix: Event after handling a farmi"]]]
                ,["2.2","11.07.2014",[["Refaktorierung der Zonen-Daten","Refactoring of zones data"]]]
                ,["2.2.1","12.07.2014",[["Bugfix","Bugfix"]]]
                ,["2.3","14.08.2014",[["Anpassung an Firefox 30","Adaptation to Firefox 30"]]]
                ,["2.3.1","15.08.2014",[["Bugfix: Zeit von anderen Accounts auf dem Server (Umloggen)","Bugfix: Time of other account on the server (login)"],["Bugfix: Ignorieren von verwelkten Gestecken","Bugfix: Ignoring of faded arrangements"],["Geändert: Spezieller Portal-Login nicht mehr benötigt","Change: Special Portal-Login not needed anymore"]]]
                ,["2.3.2","17.08.2014",[["Bugfix: Farmi MiniInfo verschwindet","Bugfix: Farmi MiniInfo vanishes"],["Neu: Goldesel Waltraud Log","New: Donkey Luke Log"]]]
                ,["2.3.3","19.08.2014",[["Neu: Baumereiprodukte und -quests durch Patch 18.08.2014","New: Forestry products and quests by patch 18.08.2014"]]]
                ,["2.3.4","22.08.2014",[["Bugfix: Sägewerk und Schreinerei durch Patch 18.08.2014","Bugfix: Sawmill and carpentry by patch 18.08.2014"]]]
                ,["2.3.5","23.11.2014",[["Bugfix: Im Markt wird manchmal die Menge nicht selektiert, wenn man ein Produkt kaufen will","Bugfix: Sometimes the amout of a product is not selected when buying a product"]]]
                ,["2.3.6","08.12.2014",[["Bugfix: DonkeyInfoPanel-Verhalten, wenn von zwei Computern auf einen Account zugegriffen wird","Bugfix: Multi user handling of donkey info panel (when accessing an account from several computers)"]]]
                ,["2.3.7","16.12.2014",[["Aktualisierung der Daten","Update of data"]]]
                ,["2.4.0","01.02.2015",[["Anpassung an Firefox 35","Fix for Firefox 35"],["Neu: Güterhof","New: Megafield"]]]
                ,["2.4.1","12.02.2015",[["Bugfix: Logging Waltraud","Bugfix: Logging Donkey Luke"]]]
                ,["2.4.2","01.04.2015",[["Aktualisierung der Daten","Update of data"]]]
                ,["2.5","27.06.2015",[["Neu: Güterhof","New: Megafield"],["Neu: Neues Laden der Seite, wenn Login oder Start des Skripts ausbleibt","New: Reload of page if login oder start of script misses"],["Umstellung der Speicher-Art auf JSON","Change of storing to JSON"],["Überarbeitung des Loggings","Refactoring of logging"],["Bugfix: Endzeiten-Fehler bei Ställen und Fabriken","Bugfix: Endtime error at stables and factories"]]]
                ,["2.5.1","03.07.2015",[["Aktualisierung der Daten für Tierarzt","Update of data for veterinary"],["Bugfix: Verlust der Quest Daten","Bugfix: Loss of quest data"]]]
                ,["2.5.2","05.07.2015",[["Neu: Anpassung für Tierarzt","New: Fix for veterinary"],["Neu: Aufruf der Saatguthändlers mit Produkt","New: Call of seed vendor with product"],["Text-Korrekturen","Text fixes"]]]
                ,["2.5.3","11.07.2015",[["Fix: Verkleinerung der Markt Quicklinks","Fix: Decrease of market quicklinks"],["Kleinere technische Korrekturen","Smaller technical fixes"]]]
                ,["2.5.4","21.07.2015",[["Fix: Probleme nach Neu-Installation","Fix: Problems after new installation"]]]
                ,["2.5.5","23.07.2015",[["Fix: Probleme mit Waltraud","Fix: Problems with Donkey Luke"]]]
                ,["2.5.6","28.07.2015",[["Bugfixes","Bugfixes"]]]
                ,["2.5.7","31.07.2015",[["Anpassung an Spiel-Update","Fix for game update"]]]
                ,["2.5.8","14.08.2015",[["Neu: Tierarzt-Questreihe","New: Veterinary quest series"]]]
                ,["2.5.9","31.08.2015",[["Anpassung an Spiel-Update","Fix for game update"],["Bugfix: Berechnung benötigter Güterhofprodukte","Bugfix: Calculation of needed megafield products"]]]
                ,["2.5.10","28.07.2015",[["Bugfixes","Bugfixes"]]]
                ,["2.5.11","15.10.2015",[["Anpassung an Spiel-Update 14.10.2015","Fix for game update 14.10.2015"]]]
                ,["2.5.11a","18.10.2015",[["Biospritanlage wird ignoriert","Fuelstation will be ignored"]]]
                ,["2.5.11b","20.10.2015",[["Neu: Dritte Questreihe","New: Third quest series"],["Weitere Anpassungen an Spiel-Update 14.10.2015","Further fixes for game update  14.10.2015"]]]
                ,["2.5.11c","21.10.2015",[["Neue Berater-Option: Farm-Questreihe 1 und 2 als abgeschlossen deklarieren","New adviser-option: declare main quest series 1 and 2 terminated"]]]
                ,["2.5.12","26.10.2015",[["Fix: Freischaltung exotische Produkte gemäss Quest-Fortschritt","Fix: Availability of exotic products according achievment of quests"],["Bereinigung Systemmeldungen","Fix of Systemmessages"],["Berater-Option: \"Questreihen beenden\" überarbeitet und erweitert","Adviser-option: \"declare main quest series terminated\" revised and updated"]]]
                ,["2.5.12a","29.10.2015",[["Addon: Gedächtnisstütze für Memory-Spiel","Addon: help for memory-game"]]]
                ,["2.5.12b","31.10.2015",[["Fix: Lagerbestandsverwaltung Farm 5","Fix: Managment of products in Stock for Farm 5"],["Fix: Systemmeldungen bereinigt","Fix: Cleanup of systemmessages"],["\"Lager- Fahrzeugübersicht\" neu positioniert","new position for stock-overview"]]]
                ,["2.5.13","02.11.2015",[["Addon: Hilfestellungen für Verträge","Addon: handling of contracts"]]]
                ,["2.5.13a","02.11.2015",[["Bugfix","Bugfix"]]]
                ,["2.5.13b","04.11.2015",[["Neue Berater-Option: Questnummer Questreihe 3 manuell setzen","New adviser option: Set questnumber for questserie main 3 manually"]]]
                ,["2.5.13c","10.11.2015",[["Berater-Option \"Questnummer Questreihe 3 übernehmen\" verbessert.","Adviser option \"Gather questnumber for main questseries 3\" improoved."],["Fix: Quicklinks und beobachte Marktpreise","Fix: Quicklinks and observe market prices"]]]
                ,["2.5.14","12.11.2015",[["Neue Berater-Option: Zone-Info löschen.","New adviser option: delete zone info."],["Fix: Marktstand-Liste führen","Fix: handle market-list"]]]
                ,["2.6","15.11.2015",[["Neue Berater-Option \"Güterhof\": Beim Starten einer Tour wird der Güterhof-Timer auf das Ende der Tour gesetzt.","New Adviser Option \"Megafield\": Megafield-Timer is set to end of the tour after a tour is started"]]]
                ,["2.6.1","17.11.2015",[["Kleiderspende: Ähnlich zur Waltraud und der Lotterie wird durch einen blinkenden Icon angezeigt, wenn bei der Kleiderspende gespendet oder gewürfelt werden sollte.","Clothing Donation: Blinking icon indicates, that you should donate or gamble."]]]
                ,["2.6.2","18.11.2015",[["Bugfix: Speicherung des Kleiderspende-Flags.","Bugfix: Clothing donation flag in options"]]]
                ,["2.6.3","19.11.2015",[["Bugfix: Berater-Option Quest-Linie 3 - Zeitberechnung","Bugfix: Adviser-Option main questseries 3 - calculation of time"]]]
                ,["2.6.4","22.11.2015",[["Bugfix: Berater-Funktionen auch für Level <8","Bugfix: Adviser-functionality for Level <8"]]]
                ,["2.6.5","23.11.2015",[["Kleiderspende: Anpassung für Bot","Clothing Donation: Adjustments for bot"]]]
                ,["2.7","24.11.2015",[["Anpassung an Spiel-Update 24.11.2015","Fix for game-update 24.11.2015"]]]
                ,["2.7.1","30.11.2015",[["Bugfix: Defaultwerte Deklarieren","Bugfix: declare default-values"]]]
                ,["2.7.2","04.12.2015",[["Addon: Hilfestellung für Weihnachts-Knabbermarathon","Addon: Assistance for X-Mas event"]]]
                ,["2.7.3","04.12.2015",[["Neue Berater-Option: Questnummer der 2. Baumerei-Questreihe manuell übernehmen","New adviser option: Set questnumber for 2nd series of quests (forestry)"]]]
                ,["2.7.4","10.12.2015",[["Berater-Option: \"Questnummer Übernehmen\" zu einer Funktion zusammengefasst.","Adviser-Option: \"set questnumber\" consolidated to one function."],["Bugfix: kleinere Optimierungen","Bugfix: small improvements"]]]
                ,["2.8.0","13.12.2015",[["Neu: Ponyhof","New: Ponyfarm"]]]
                ,["2.8.1","15.12.2015",[["Bugfix: Exotische Produkte","Bugfix: Exotic products"]]]
                ,["2.8.2","19.12.2015",[["Bugfix: Berechnung fehlende Produkte","Bugfix: Calculation of missing products"]]]
                ,["2.8.3","24.12.2015",[["Frohe Weihnachten","Merry Christmas"],["Bugfix: Berechnung fehlende Produkte","Bugfix: Calculation of missing products"]]]
                ,["2.9.0","27.12.2015",[["Neu: Tinkturen","new: tinctures"],["Spendenempfänger:wikipedia","Donation recipients: wikipedia"]]]
                ,["2.9.1","04.01.2016",[["Bugfix: Quest 47 Quest-Linie 3","Bugfix: Quest 47 of mainseries 3"]]]
                ,["2.9.2","05.01.2016",[["Bugfix: Berechnung der besseren Produkt-Alternative (bei Quests).","Bugfix: Calculation of best product-alternative (for Quests)."]]]
                ,["2.9.3","07.01.2016",[["Neu: Exotische Pflanzen nun auch in der Übersicht \"Profit pro Zone pro Tag\" und bei \"Fehlende Produkte\".","New: Exotic plants are added to overview \"Profit per Zone per Day\" and to \"Missing products\"."]]]
                ,["2.10.0","10.01.2016",[["Neu: Biospritanlage","New: Fuelstation"]]]
                ,["2.10.1","12.01.2016",[["Neu: Biosprit nun auch in der Übersicht \"Profit pro Zone pro Tag\".","New: Fuel shown to overview \"Profit per Zone per Day\"."]]]
                ,["2.10.2","13.01.2016",[["Bugfix: Picknick und Blumenwiese Nicht-Premium-Accounts","Bugfix: Picknick and fields of flower for non premium accounts "]]]
                ,["2.10.3","15.01.2016",[["Bugfix: Biosprit","Bugfix: Fuelstation"]]]
                ,["2.10.4","19.01.2016",[["Anpassung an Spiel-Update 19.01.2016","Adaptation for game update 19.01.2016"],["Bugfix: NPC-Preis für Biosprit","Bugfix: NPC-price for Fuel"]]]
                ,["2.10.5","24.01.2016",[["Bugfix: Preisvorschlag bei Verträgen","Bugfix: Pricesuggestion for contracts"]]]
                ,["2.10.6","25.01.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.7","01.02.2016",[["Bugfix: Default-Wert \"leere Felder\" für Blumenwiese neu 1 statt 0.","Bugfix: Default-Value \"empty fields\" for flower-meadow is set to 1 instead of 0."]]]
                ,["2.10.8","16.02.2016",[["Feature 1: Güterhof bevorzugen ","Feature 1: prefer megafield"]]]
                ,["2.10.9","25.02.2016",[["Optimierungen am Güterhof","improvements on megafield"],["Tooltip: Ertragsberechnung verbessert","Tooltip: yield-calculation improved"]]]
                ,["2.10.10","06.03.2016",[["Feature: Automatische Auswahl des Schwierigkeitsgrads beim Tierarzt","Feature: Automatic selection of the difficulty-level at the vet"]]]
                ,["2.10.11","08.03.2016",[["Anpassung an Spiel-Update 08.03.2016","Fix for game update 08.03.2016"]]]
                ,["2.10.12","09.03.2016",[["1. Questreihe Tierarzt aktualisiert","1. quest series veterinary updated"],["Questeingabe Bauernclub aktualisiert","Questinput farmerclub updated"]]]
                ,["2.10.13","10.03.2016",[["Megafield Premium Pflanzung","Megafield Premium Planting"],["Game-Update: Tierarzt Fix","Game-Update: Vet Fix"]]]
                ,["2.10.14","17.03.2016",[["Bugfix","Bugfix"],["Game-Update: Neue Produkte (Heillräuter, Tinkturen)","Game-Update: New products (herbs, tincture)"]]]
                ,["2.10.15","29.03.2016",[["Bugfix: Profit pro Zone","Bugfix:Profit per Zone per Day"],["Questreihe 2 Baumerei aktualisiert","forestry-quests-series II updated"]]]
                ,["2.10.16","18.04.2016",[["Bugfix: halbautomatische Ernten der Unkräuter, Steine, Baumstümpfe und Kakerlaken ","Bugfix: semi-automatic harvesting the weeds, stones, tree stumps and scrapers"]]]
                ,["2.10.17","27.04.2016",[["Allgemeine Verbesserungen beim Tierarzt, Kleiderspende Log, usw","improvements: veterinary, Clothing Donation Log, etc"]]]
                ,["2.10.18","28.04.2016",[["Tierarzt: Zeitberechnung in der Vorschau, Option für keine Coins Tinkturen","Vet Sick Animals: Queued animals popup, no-coin-drug flag"]]]
                ,["2.10.19","09.05.2016",[["Tierarzt: automatsche Behandlung","Vet: automatic treatment"]]]
                ,["2.10.20","24.05.2016",[["Verbesserungen bei den Verträgen und im Güterhof ","Megafield and Contract Improvements"]]]
                ,["2.10.21","25.05.2016",[["Bugfix: Güterhof und Pony-Farm ","Bugfix: Megafield and Ponyfarm"]]]
                ,["2.10.22","30.05.2016",[["Verbesserung Tierbehandlung und Fabriken ","Improvements: animal treatment and factory"]]]
                ,["2.10.23","30.05.2016",[["Bugfix ","Bugfix"]]]
                ,["2.10.24","30.05.2016",[["Neues common_function_file","New common_function_file"]]]
                ,["2.10.25","01.06.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.26","28.06.2016",[["Bugfix Güterhof und Verträge","Bugfix: megafield and contract"]]]
                ,["2.10.27","12.07.2016",[["Anpassung an Spiel-Update 12.07.2016","Fix for game update 12.07.2016"]]]
                ,["2.10.28","13.07.2016",[["Fix Produktionszeiten","Fix Productiongrowtime"]]]
                ,["2.10.29","25.07.2016",[["Update Picknick-Questreihe ","Update Foodworld-Quest-Series"]]]
                ,["2.10.30","27.07.2016",[["Verbesserung Fahrzeug für Transport von Farm5","Improvements vehicle for transporting exotic fruits from farm 5"]]]
                ,["2.10.31","09.08.2016",[["Anpassung an Spiel-Update 08.08.2016","Fix for game update 08.08.2016"]]]
                ,["2.10.32","10.08.2016",[["Verbesserung Fahrzeug für Transport von Farm5","Improvements vehicle for transporting exotic fruits from farm 5"]]]
                ,["2.10.33","11.08.2016",[["Update Quest Data","Update Quest Data"]]]
                ,["2.10.34","15.08.2016",[["Eisdiele","ice cream parlor"]]]
                ,["2.10.35","26.08.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.36","30.08.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.37","05.09.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.38","05.09.2016",[["Preise, Bonus Picknick Farmis","observing prices, bonus foodworld farmis"]]]
                ,["2.10.39","13.09.2016",[["Anpassung an Spiel-Update 12.09.2016","Fix for game update 12.09.2016"]]]
                ,["2.10.40","20.09.2016",[["Neu Baumereiprodukte (Spiel-Update 12.09.2016)","New forestry products (Game Update 12.09.2016)"]]]
                ,["2.10.41","22.09.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.42","22.09.2016",[["Verbesserung tooltip","Improvements tooltip"]]]
                ,["2.10.43","10.10.2016",[["Bugfix","Bugfix"]]]
                ,["2.10.44","17.10.2016",[["Verbesserung Megafield, Error Log, and Bugfixes","Improvements Megafield, Error Log, and Bugfixes"]]]
                ,["2.10.45","18.10.2016",[["Produktion Tieraufzuchtsprodukte","Production animal breed products"]]]
                ,["2.10.46","24.10.2016",[["Güterhof: 2x2 Erntemaschine (Optionen-Automat)","Megafield: 2x2 harvester (Check options automat)"],["Verbesserungen: Güterhof","Improvements: Megafield"],["Verbesserungen: Ställe und Fabriken","Improvements: stable and factories"]]]
                ,["2.10.47","26.10.2016",[["Tabelle: Questserie Tieraufzucht","Table: Quest-Series animal breed"],["Automatisches tägliches Abholen des 5000kT Puzzlepaket (siehe Optionen - Automat)","Automatic daily pick of 5000kT puzzle package (Check options automat)"]]]
                ,["2.10.49","16.11.2016",[["Tieraufzucht","Animal breeding"]]]
                ,["2.10.50","21.11.2016",[["Verbesserungen (Kleinvieh macht auch Mist :D)","Improvements"],["Option: NPC-Preis Berechnung","Option: NPC price calculation"]]]
                ,["2.10.51","01.12.2016",[["Verbesserungen Tieraufzucht","Improvements Animal breeding"],["Fehlende Produkte der Mumpfis (siehe Optionen > minimaler Lagerbestand)","Foodworld farmis missing products (CHECK BERATER-OPTIONS > MINIMAL RACKAMOUNT)"],["Fehlende Produkte der Farmesmarket-Farmis","Farmersmarket farmis in missing products"]]]
                ,["2.10.52","22.12.2016",[["Frohe Weihnachten und ein frohes neues Jahr 2017","Merry Christmas and happy new year 2017"],["Fenster Winterangebot ","Window christmas offer"]]]
                ,["2.10.53","29.12.2016",[["Winter Sport Spass (Bitte Option Olympia Run beachten!)","Winter Sport Fun (check the option olmpia run)"]]]
                ,["2.10.54","08.01.2017",[["Bugfix Olympia Offer","Bugfix Olympia Offer"]]]
                ,["2.10.55","27.01.2017",[["Die Option (Limitiere günstigste Angebote) hinzugefügt, um die Anzahl der einfließenden Preise zur Berechnung des beobachteten Preises zu ändern.","Added option (Limit cheapest offers) to change the amount of cheapest offers for calculate all observed prices "]]]
                ,["2.10.56","14.03.2017",[["Anpassung an Spiel-Update 14.03.2017","Fix for game update 14.03.2017"]]]
                ,["2.10.57","15.03.2017",[["Bugfix Strickerei, Ölfabrik","Bugfix Knitting, Oelfactory"]]]
                ,["2.10.58","16.03.2017",[["1. Feld Farm 6","First field farm6"]]]
                ,["2.10.59","20.03.2017",[["Hauptquestreihe 4","main questseries 4"]]]
                ,["2.10.60","28.03.2017",[["Bugfix Login, ","Bugfix Login"]]]
                ,["2.10.61","28.03.2017",[["Bugfix II Login, ","Bugfix II Login"]]]
                ,["2.10.62","30.03.2017",[["Teeverfeinerung, ","Tea factory"]]]
                ,["2.10.63","25.04.2017",[["Monsterfruchtaufzucht","megafruit farm"]]]
                ,["2.10.64","09.05.2017",[["Speedup Ponyfarm","Speedup Ponyfarm"]]]
                ,["2.10.65","11.05.2017",[["Newsfenster automatisch schließen","auto close newsbox"]]]
                ,["2.10.66","18.05.2017",[["Verbesserungen, Bugfix","Improvements, Bugfix"]]]
                ,["2.10.67","27.06.2017",[["Siebenschlaefer Event","seven sleepers day event"]]]
                ,["2.10.68","11.07.2017",[["Fenster Sommer Special schließen","close summer special window"]]]
                ,["2.10.69","11.07.2017",[["Einfache Lösung für Eisauslieferungs Event (beachte Option: Ice delivery event )","simple solution for ice delivery event (see option: Ice delivery event)"]]]
                ,["2.10.70","21.07.2017",[["Bugfix","Bugfix"]]]
                ,["2.10.71","06.08.2017",[["Bugfix Tieraufzuch","Bugfix Animal Breeding"]]]
                ,["2.10.72","28.08.2017",[["Wettessen","SpeedEating"],["Bugfix","Bugfix"]]]
                ,["2.10.73","21.09.2017",[["Neue Option: Upjers News ausschalten","New option: Turn off upjers news"],["Bugfix","Bugfix"]]]
                ,["2.10.74","28.09.2017",[["Bugfix","Bugfix"]]]
                ,["2.10.75","10.10.2017",[["Questreihe Tierarzt II und Schmetterlinge","Questserie: veterinary II and butterfly"]]]
                ,["2.10.76","17.10.2017",[["Schmetterlinge füttern","butterfly feeding"]]]
                ,["2.10.77","09.11.2017",[["Bugfix","Bugfix"]]]
                ,["2.10.78","15.05.2018",[["Questreihe 2 Baumerei aktualisiert","forestry-quests-series II updated"]]]
                ,["2.10.79","17.05.2018",[["Bugfix","Bugfix"]]]
                ,["2.10.80","29.05.2018",[["Anpassung an Spiel-Update: Weltbauertag","Fix for game update: world farmers day"]]]
                ,["2.10.82","11.07.2018",[["Bugfix","Bugfix"]]]
                ,["2.10.83","27.07.2018",[["Anpassung an Spiel-Update: Kuhrennen","Fix for game update: cow running"]]]
                ,["2.10.84","31.07.2018",[["Produktion Kuhrennen","Production cowracing"],["Bugfix Monsterfurcht","Bugfix megafruit"]]]
                ,["2.10.85","01.09.2018",[["Kuhfütterung","cow feeding"]]]
                ,["2.10.86","06.09.2018",[["Bugfix Kuhrennstall","Bugfix Cow running"]]]
                ,["2.10.87","12.09.2018",[["Bugfix Tierarzt","Bugfix animal treatment"]]]
                ,["2.10.88","09.10.2018",[["Täglicher Login Bonus","Daily login bonus"]]]
                ,["2.10.89","15.10.2018",[["Täglicher Login Bonus","Daily login bonus"]]]
                ,["2.10.90","25.10.2018",[["Bonus Alien Invasion","Alieninvasion bonus"]]]
                ,["2.10.91","05.12.2018",[["Adventskalender","xMas-Calendar"]]]
                ,["2.10.92","10.02.2019",[["Bugfix","Bugfix"]]]
                ,["2.10.93","12.03.2019",[["Schmetterling MouseOver Fenster: Blüten pro Stunde","Butterfly mouseover div: blossoms for hour"]]]
                ,["2.10.94","13.05.2019",[["Verbesserungen","Improvements"]]]
                ,["2.10.95","25.07.2019",[["Kuhrennen","Cow running"]]]
                ,["2.10.96","09.10.2019",[["Obststand","Fruitshop"],["Braver Ben","farmdog"],["Farm 7","farm 7"]]]
                ,["2.10.97","08.04.2020",[["Bugfix Fabriken","bugfix factory"]]]
                ,["2.10.98","19.05.2020",[["Update 19-05-2020","Update 19-05-2020"]]]
                ,["2.10.99","09.02.2021",[["Bugfix","Bugfix"]]]
                ,["2.10.100","11.03.2021",[["Obststand II","Fruitshop"],["Angelprodukte produzieren","produce fishing products"]]]
                ,["2.10.101","12.05.2022",[["Farm 8","Farm 8"],["Pfadfindeprodukte produzieren","produce scouts products"]]]
                ,["2.10.102","16.10.2023",[["Farm 9","Farm 9"]]]
            ];
if(!VERSIONfunctionFile){
    alert("Hi, I am the Berater-Script.\nThe function-file is missing.\nPlease install me again.");
    location.href=GM_Source;
}else if(compareVersions(neededVersionFunctionFile,VERSIONfunctionFile)>0){
    alert("Hi, I am the Berater-Script.\nThe function-file is too old.\nPlease install me again.");
    location.href=GM_Source;
}
var hotkeymap=explode(GM_getValue("hotkeymap"),"do_main/hotkeymap",{"prevPage":37,"nextPage":39,"farm1":49,"farm2":50,"farm3":51,"guild":52,"city1":53,"city2":54,"farmiLog":70,"help":72,"market":77,"marketstand":188,"messages":78,"options":79,"profit":80,"seedVendor":83,"overview":85,"contract":86,"systemMessage":88});
var FARMNAME=null;
var USERLEVEL=null;

// Constants
const INIT_CSS_STYLES = {
    "systemMsg_marketsale":[[],""],
    "systemMsg_contractsale":[[],"font-style:italic;"],
    "lowrack":[[],"background:orangered;color:#000;"],
    "farmicart_lowrack":[[],"color:yellow!important;"],
    "timeholder":[[],"background:url(\"http://mff.wavecdn.de/mff/guild/help_back.jpg\") -25px -25px;border:1px groove #4d240e;border-radius:10px;padding:5px;margin-bottom:5px;"],
    "timer":[[],"background-color:#de9008;color:white;font-weight:bold;text-align:center;"],
    "watertimer":[[],"background-color:blue;color:white;font-weight:bold;text-align:center;"],
    "timer_ready":[[],"background-color:red;color:white;font-weight:bold;text-align:center;"],
    "prod_border_lowamount":[[],"border:1px solid blue;"],
    "prod_border_missing":[[],"border:1px solid red;"],
    "cloud_back_noprice":[[],"background-color:white;"],
    "cloud_border_noprice":[["cloud_back_noprice"],"border:2px solid black;"],
    "cloud_back_below":[[],"background-color:#fdd;"],
    "cloud_border_below":[["cloud_back_below"],"border:2px solid red;"],
    "cloud_back_between":[[],"background-color:#ffe87c;"],
    "cloud_border_between":[["cloud_back_between"],"border:2px solid #ff8c00;"],
    "cloud_back_above":[[],"background-color:#dfd;"],
    "cloud_border_above":[["cloud_back_above"],"border:2px solid green;"],
    "farmi_price_unknown":[[],"background-color:none;"],
    "farmi_price_low":[[],"background-color:#FF3333;"],
    "farmi_price_between":[[],"background-color:yellow;"],
    "farmi_price_above":[[],"background-color:#22AA22;"],
    "farmi_amount_missing":[["farmi_price_above"],"border:1px solid red;"],
    "farmi_amount_low":[["farmi_price_above"],"border:1px solid blue;"],
    "farmi_amount_above":[["farmi_price_above"],"border:1px solid grey;"]};
const IMAGES={"leftarrow":"data:image/gif;base64,R0lGODlhIwAaAPcAAEQWBLyCVIROJKRqNFwyBOy2dGQ6JNyiZIRSPJxuVHxCDMySVIxeNLR2PFwyFPzSpEwmBNyefIxWJHRGJOy6lGw6FLSGZJxqRJRePFQmFMSSbKRyRKx6VOSqfIxiTHxONHRKNKRiPOSqdKx2TFwuBIRWNPzKlLyKXHw6DIQ+JJxmLHQyFIRGJHQ6FKxqROy6hGxCHLyOZMyabMR+ZIxOJHQ2BGxCJMyedJxeLJpmPLx6VOSyjEQeBPCyfIRCHMSCXMqSZGQyHF8mBHNGLLB+TJVaPMSGZKRqTJpiRFkuFJRWNPzOpHQ6HPC+jOSidJ1eNFwiBGIyDPzitOKmfIxWLPi+nMiWdKpyTMR6XLiCXIJOLLRyPHQ+JIxaPLRyVKh2RGwyFEwmDGk6HJxePOSqhIxONLx6TFouDPzOnK5uTHxCHNCadIxOLGpCLEceDNSSZFguHKVqPPS+fGs+JIxWPPzWtNyihHpKJO6+lLSGbKJuRNSWbKx6XPSufKdmRLB6TIpaNKx2VNCmdOy2jOyydIlKHMyObPyyhOy2fMySXPjGnHQ2HIRKLGwyDFwqDPzSrMyOXPy2hHxGLPy+jPzmvJRWLLR2ROCibIRCFJxmRFQiDLRyRJxmNMyOZNyedPyyfLx+TGQuFPzOrLRyTGQuDNyadHRCLFw2BIFWPJRiNGQ2FFQqBNiifLyKZJBiPMSWbLR+VOyufIRSNMSOXHxCJHY2FIdKJHk+FK5uRHRGHKBiLL9+VMeGXMiWZGg2HMmKZKFuTJZaNHU+HPTCjOmmdKBiNGQ2DIRaLMJ+XLSGXIRSLLh2VFQqDGg+HI1SLEsiDKxuPPS6fNSWXPzKnHA2DEQaBLyGVIRSJPzWpFQqFIxmTKRmPHw+DIRGHGw2FJxiPIxSNHxGHHxKLJRaLLR6RGQyBGw6JJReNGQyFFQmBJRWJHxGJPS6lLyGZKRqRMySbKxyRLR6VOyqfIRONHxKNOyqdLR2TGQuBIxWNMSKXHw6FHRCHMSOZNSabJROJHRCJCH5BAAAAAAALAAAAAAjABoABwj/AG20sWHAgYMgqlSdMUaABIRVBAw6SCJRFTpvYoQJk8QIH74SzjygkiVuQgVVFSoIuHKi1w1BN2RYsaLBAp8jSLSs+ydsHbhvR74JNTWnmRhSUcIV69Wrn6BXMXplgbULlA579kZdOZIpmCQmYrisk0UFUJAgYKKoKcbrUj1IoHr9GcHhzyhc24o9CRbsiR89aTKBW8flnxZl+Fj48qZk1yVil0CRM5MPlzs/uOJA2xynWLBxSoJlyoQEHyNa6xgpW1SLDS9WpXiB2sVr1xMfwTT66NaNxjW+wc6B0wKuCD5aoTAKa6TESIQIv7BgSeNHSS1bhoYrE3Dn3751WrRg/8BXBh8GDHSUMdn375YO6MtmIPNShMmKWl6qMCJ1R5w4Lf71p5pHbDDCBj7CNPPPE1ns8cMuyKTBRi0r0BJBFe2IU0EzJYjT3R3C/KMGeGyUyAY4kggjRj+e9JPPg3HY4oMz7LAjSgXhKdNCOFoI0cItQghDCwuM2FKkLVoIo8ov1uxiBjTqKFCDLk2YgM0x+5BwBxQojIMCClN44oMt/jjDhjPggDPPPHMEsccfxQwwgAoNLECICS+ggYcUdQwyTT3E1COPE/5gcqYSlYRWhBJ0/BNKKZsUA8ob0lwSTQHRICLFNA88skQsh3xCTB/EFFKID+oo4YwzSjDaxT9u4v9SCQ666LLFApP0MEwTDyhCCR7YRHJIB05MUQxvSmwTTKLBKNGFKUnchQsut+mDSTAdDIJHOasYkwsJE1xTgRpksCKMLSFcUZ2ispjjCC6bbGLGKE/Ycos+LUyhCAUE5AKDFilRUcGPLajxjbrOCMCGFvP4ogkOcdhjCTzb4CDAPrlQEwMFWaxyDAMMuALIMZVcI8A4ceDyDT5oyjLEMzxIkAM88MSxTSrBUCHALVTEsMM1yuQwwh9zfTECXnF8Eww4+MjygQ0ZPHOLM9vooccFOXwzxjn4RKEMK8pUcAERJ8zSCRCzBKCyM1qU0IUs0PKQQRTCUJHJFVe4840r37j/Y+83LbSQygYB8HJCbfZ8Q8U8sgCCyhC+uPFMEt54Iww4RwCjRyZj5JAJLs6MWQkNT+gBT2bfVKIMOG4j0AYcbmjiAD3/+BJKBYwUgQQS3xRhyzdKsBAMDbZQ8cQ5SlChkxaylOB6Nm5Uw4w4XkjiCymhBCHGOvMU4YyBJTqzjy3OVOKMLQIACGAbvmQgeTbiXPCOGL6AgY4jUJAixjzrICGLMhhggyxsoQxZ9OcwstDCHJIAAQBUAw5t4MAv1uAfcfDkflBwRCjEIA5ZOE19HyiJDegHAR7w4BlhSAIIgNGOWQABH134yDwmwAUxnOEMSQgFOnwhhjn40Ci+OEMYECAwxGxQZA7ayAM/3tCPgAAAOw=="
             ,"rightarrow":"data:image/gif;base64,R0lGODlhIwAaAPcAADwSBLqCU4BMDPC6eGpdRKKQfNSeXIluTF4wBHxiPNSGTGZLLLOnjF80JIFzXIdNLMK9pMuJZOKmfGg+EK9vRJVeRF4wFI9XLM6TZOisbNy2nJOFa8y7lOq0gmlYO1hAJfzYrrR6RPzHk8SSfN6UZ0gkBHxmRKSSdMqecXdBJLmplI9ZPNzLqbeFZOq7j9CUWrZ5XG4yFE0lFOugbIxWHKB7VJ9iLGRNPJSafJ9nRLy0lKNvRPCpfLFxVMiVdH5LHGwwC/TBpHlBDJxZMsqKXHtLLum0jFckBPG9nJ+MalxGNKxvPI1LI4peRIhRPGRGJJx5XMrCpXdoVGQ3FOymbJxqVHlAHIhSMMyaZLp7VPzCkp5kPLGhja5pRci2pKx2RHlePN6ZdHxGNKJwVMyOdJReNGpAJ3pGJvi8kGM3CcmOZeyydPm0gnhZOsqgfHE5FMe1m1kqBNmtjI9XNM6VbJSCdOWaZIdoR7mLZ8V+XPWufMmEXIh6XLJxTJ+EaNimdJ5dPPzmtMymf8CwjPnMpOaifLqEXO+gZK6cgUUcBHA4BFc/HPnHnPzuxPzftPq7hJRiOcZ9TIx+bLypjKaWfLyadLuumNSaXJ6MdLSOdPW1jMV9VMSafGdSPHpGHKRqPHFiSNSmZIx2VGpSM2U6JOKuhJliRNPCnEwqDFUqFaR2TIRSJJBSJIBiRpx+Y/zSps29pPC0lLyTb9ifcuKTXNeMW9TEpJ5eNHpSM7GihPzOlJJePLZ+XLZ2VNCadPTGpPnCnLR2PJRSL552VIZGJtWOZbyKXMWulrSSfHxOPIhqVK9mPGw+HHRcTOOfZIJxVF8wDMmDVGJONIx2ZIdONNSKbNqphFkwHPGrdMy7nLZ6TEkkDHZoTHVCLKyGbOihdIxXJKFjNJ9pTLm1nKJvTOyqhIBLJHw/FFclDIxeTGE4HMyihHE5HIt7ZOzKrNyihEYeDHM5DPzOnNyafHxSPIVGHKSahGdGLO6mdM6abLd2TFsqDOKabPKuhKiWhGQ6LCH5BAAAAAAALAAAAAAjABoABwj/AItQ63bGzBMzZtips7BvX5wj+9IkKhEHwRFoqa5ptPDmibkzHuc4oYeLZJEiCWOwm0MOjw88+XzJlGWoxRhxTXB1Y8ZsypkzRXCJKTJHJzN27B6Ii0DGFz86aqIG0KcvS59ePfqIg1SEGTR1zH4+EEMtxRSfffKEmccvQpYsmyjo67JlS5cLQwBtyZEDEi5zFqBNsTKH2oOzc7IUmkciwp5NeR736QPo0y0Kn7aUGTJn1xZTd6wEnmL4zZsrhiS03bQp2qYugIQ9IAbkyhtPF7YM4TxnBZhdZZ5M2UfM9JUsdNruCUF3CDEr3Yil6EYHUhpmnk7OmXPhSpEEc1JA/0sBhJg+1fq0adO3jIkVoE7EXHuAxFWaCdlxFb2C64K5OUWk8QYQOfCzRySs9cFEPD/E88B2J5lRAwh/IPCGOil8ZM4V5nRoDjNWmLNJISTsUUwegJyjiBAICLCKJ08EN4cGjrhgzgTnnGGFJ+YU8QCH5lgxhBoG1nIiEOfMMoAALdJAAy5WIJCDCISwsUQ88fBYRI9XcPjGFnREEMkeewDiRD1DXJLBABlk8IgWIMjDCAhoPEJFLSGw8gYzDxRxwQWrMNNHGI9FE4EwwrxBQyhrZLAGG1qgAYIjjMjzyCNt8jBLBDkwQxR3VpCDwWOb7CEMIFawMsujA2jyyquEiP8ggi5rUIFBCP4FecUcZZQxBSBZUEUVIPFYQQcbPxwRw7IpxABEMI6G8kk8CKTx3wMbcjcFS33MxR4x9dTjyTlzWMEOOs958ocuodAwwQQ/BGnFGxl2yA4xQ3TRBQWwDfEAE4gC2SUzvnQgCw2r/BDvdg90I8YV1Jh7Whd96Asbog/IxkQOQ5TxiSCG7HBBAjYkAEkOFazgBDXUELPsPm/MkQNdXSwDyG4XCJObOUOQg8IXOWgDydCQ7LLCCtQ4cQU7R4gXgxVX7NVFDjbfkpduZWxxizZb7CB0OFtA0oTRKzTRDTSJ5EDMWcxckIPUOdx8CyC3vP0AcDdfcQGvvbWusUIRFiSSiDjlQhPHG/oNUdcK23W5N6+AzNHhSRAXcY8Z2whugTgVLH3EERa89+AcXf74Y29XPJDCCl2WtEAD1wi+jTp99CCOMOwYDhE7RThB+hViPEANxKxTgws199zTzTUyACBDKg2ok0cv4nB8BkMWpGJBDGaIQQ/L1CTDshhnSPPBNdvAI4MMGjXQwD9YaWXKAxZkj07696NDyv78q9NAKttIn/rYl5FrNCAgADs="
             ,"leftarrow_dark":"data:image/gif;base64,R0lGODlhIwAaAPcAACQKBIxiPFw2FHxOJDwiDMSOXKx6RFw6LFQuDJRmTHRCHCwWBIxeNDwiFJRuRHxONEQWBGQ6JMSidKx+XJRiRGw+FEwuHMSedGxGLHxKHFQiBFQmFGw2FKRyTEQeBIRWLMSaZLSGTIRWNHxCHDweDCwSBJxiNIxOLFwuDCwWDJRaNHxGLMSObLR6VLyGXFQqDKxyTEwqFKxyPJRqRGQyHGw2HLyKbHxOLIxONEQaDFQqHEQeDHxCJFwuFHxKNLSGZDQOBFw2HEwqDMSWZHRCLDwWBEwiFHQ+JMSufFwuHFQiDGQqFIxWPJxiPJRaPJRSPIxmPEwiDLSOZLSCTKRuTGxCJIRaPKRuREQaBKRmRGQ+HHRKJFQqFKRyVDQSDDwWDHxKLMSCVKx2VGw6HHxSLIxSNFwyFFQmDCQOBLx6TGxCLEwuFDQaBEQmFGw+JJRmRFQyHMSafHRKLGw6FFQeBMSabLSKVJRWNHxGHDwSBIxSLLyWbLR+VLSKXGQqDLR2TKxyRMSyjMSihKRqTEwqHKRqRFQeDIRCLMSuhHQ+HIRKJJx2TGQyDHxGJLSKZGQ6HJxmPJRePLySZHRGJIxePLR+TFw+LJxmNDwaBEwmFFwyHEwmDKRyRKR2VDwaDMSefMSebJRiPGQ2FIROJEQiDDQWBEQiFJxuREwWBGw6JJxiRFQuHHRGLFwmFEweBIxWLIxWNDQSBDQWDJxaNIRGLFwqDLRyTJxqRGwyHHQ2HIROLJRONEwaDEweDGQuFIRKNDwOBGQ2HHw+JFwiDJRWPJRmPLyOZKxuTHRCJIxaPEwaBGw+HHxKJFwqFIRKLHQ6HIRSLJRSNGQyFFwmDCwOBFQuFHQ6FLyKVIRGHJRSLMSWbLx+VLyKXLRyRIRGJLyKZKRmPJxePAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAAAAAALAAAAAAjABoABwj/ABu0aeCpFCZPnjAZLFWiIRs2RUrJYvMFE6YimHbs6HWmWRJNZnocgGMhRhuLHnIgYMUACpVFM2YkSEDBygM1EbhsiLJjU5IIyFKNWWZKIxaMZx5BKnarQ7FQb0RAKwNNlzMwjVYgc6NpQ68cvTL16KEpYcIoY14BMmDiVTFdW26AUdQo0TMOHGoEO4JshZskm4xE4UJ2Qw4PvmBdgQFIz6hRKnhsbcRjBB4eCp7VkCYtWCo3qboa2USYF5Zmd2wNmpVNjwo9YzQE6xVFw5kztXp0DhasRzMzNGhEKYJFIwQaxLoMclIGxyFhuJS1UuW7ms4oUc4QDpakR5Jgj2g0/9tBKgodXcciOXsSjRYuQ1+U/bLBpcgGITHyZ9q0gTCNJM1s0AMN5EURDCxZOIFDNCsswQsEw3RhAxNcZAQHF5tskgltUZDWzFgfbrBDDoVcUYgKd5ShwDRn+PLND3F4YF0PHpCWhytR5NGLEme0EmCAXIwYCSxV4cGIBsrMwc0QEpixQymbAOOKNHQoI8YVStTSjC9jcclFEjt4cosuyyRSQQUZXDIFCHbUYQwigkygTTdpdFPJFX4Mg4IvNPBJQw00aEJKEYU08owel4AjQwhThGAHEntcICkfYYTxRxi2TFNLi75wKc1/QRjxRRbeSMPBM9bgYUIBfBTQhwR7BP/iyAUubJNGB38kwqM0R9TgZ6BGlOIND8NyoAQdSnDwhwvGYBILG0IUsQkKO4pBhRIbjLFCIjRIAyiYsTTSiDMnePNMLa64skMX2jgirQdreEBCNR544IoHSowBhhvN9GudJ9SIgocidB0hSjObaIAFJY6IUIoZQTzyiABmSNNDLbw2MgYNYyWRCTVo+LJMI5MosMwjovRQDSlmUDJBNdVoEdcNA4DBTF2JbExWElw0QA01rvSQyCTIILPMGLxJg0kPHXDhQRVkqBBAJKEwcMckY3QcxCqmlAIANUVEYYYbjbByxBhoI3NGL2O4gsUjk7yiwtx63FCDJj2sookmbXzOAXIpnhSXhBusbCWUGzz4gpvFHCAj7tkck6UJ16X87AkXUXhSRA5c0BCBUME0s/EZuDQzjTRjiMJZM9p9xHUJaAAQywZyZJJDEcTtIFZvXPTbrxIvjNVD71wUn4kpnpQAAAALZFIFBTscVEQeQBSxAxeZpKJyBGMRxrN2MK9BSuXLp2DKAypQscEG+0UfCxCxWJ/JKtXowEV+97dBCglsULM8Gg0hBAaSEYkmaCJQPMuERuIXP4TsgATkeWBBfkaNhpSiFA2IgBUiAYlCBAQAOw=="
             ,"rightarrow_dark":"data:image/gif;base64,R0lGODlhIwAaAPcAAB4GAIhVL1MqA7mITUA2JHJhT6BuNVtEKjgWAE87HqBZKj4pFIJ3XjgZD1RINVkqFJCMc5lbPKx1Tz8fBX1FJGY4JDgWB2AyFJtkPLJ7Q6eGbGRYQZqKZbODVUAyHTIhD8KkfYNOJMKVZJNjT6plPicPAE8+JHNjSZhuRkwiD4h4ZWAzHqeZeIZYPLOKYJxlNIZNNUQYByoPB7RwQ14xC3BPL287FDwqHmVqT28+JIuDZXNFJLl4T4BGL5ZmSVIpC0MWAryQc00iA2wzGJhcNU8pFbODXjIPALmMbG9eQDUlGXtFHl8pD1w4JFotHjwlD2xNNZiQdEw/LzwbB7Z1Q2xAL00hC1ouFppqPIhPL8KQY248HoBwX31AJZaGc3tLJE04HqpqSU8lGXJGL5pgSWU4GUAhEU4lEL+LYTsbApZgPbaCScCDVU0zHZhwT0YcB5WEazMTAKV8XmAyGZtmQ2VVSbBqPFk/JohcPpNSNbx9T5ZWNVpONYJGKm9WP6R1SW42HsKwg5p1U49/XsCac7ByT4hWNbhwPH1sVCULAEYbADIgC8CVbMK3k8Kqg8GKVmU7HJRQKl5SQ4t4XnVmT4tqSYp9aaBqNW5eSYNgSbyEXpNQL5NqTz4uHk4lC3NAHkY7J6B1PF5LL0AuGT0dD6x9Vmo7JKCQbCoTAzATB3NLKlYuD2EuD1M7JWxSO8KfdZqMc7mDZYtkRaRvR6xkNaNeNaCTc244GU4uGYByVsKbZWM4HoZSNYZLL5xqSbyUc8CQbINLHmUuFm5LL1klEKFgPYtcNZN9ZoNjT08rHlpAL30+HkMfC0k1Kq1vPFVGLzgWA5ZWLzsrGV5LPFkrGaBcQ6Z4VjMWC7l7SZqKbIZOKicPA0s/KkkiFHtZQ7JwSV4yD3A7GW9AKoiEbHJFKrZ5VlMpD08gBzIPA144KjobC5pyVkYcC1xPPLaYe6dyViUMA0gcA8KbbKdqT08uHlglC3NqVj4lFLd1SZtqQ4ZLKjUTA6xqQ7p9VndmVjwdFCH5BAAAAAAALAAAAAAjABoABwj/AItQ63bGzBMzZtips7BvX5wj+9IkKhEHwRFoqa5ptPDmibkzHuc4oYeLZJEiCWOwm0MOjw88+XzJlGWoxRhxTXB1Y8ZsypkzRXCJKTJHJzN27B6Ii0DGFz86aqIG0KcvS59ePfqIg1SEGTR1zH4+EEMtxRSfffKEmccvQpYsmyjo67JlS5cLQwBtyZEDEi5zFqBNsTKH2oOzc7IUmkciwp5NeR736QPo0y0Kn7aUGTJn1xZTd6wEnmL4zZsrhiS03bQp2qYugIQ9IAbkyhtPF7YM4TxnBZhdZZ5M2UfM9JUsdNruCUF3CDEr3Yil6EYHUhpmnk7OmXPhSpEEc1JA/0sBhJg+1fq0adO3jIkVoE7EXHuAxFWaCdlxFb2C64K5OUWk8QYQOfCzRySs9cFEPD/E88B2J5lRAwh/IPCGOil8ZM4V5nRoDjNWmLNJISTsUUwegJyjiBAICLCKJ08EN4cGjrhgzgTnnGGFJ+YU8QCH5lgxhBoG1nIiEOfMMoAALdJAAy5WIJCDCISwsUQ88fBYRI9XcPjGFnREEMkeewDiRD1DXJLBABlk8IgWIMjDCAhoPEJFLSGw8gYzDxRxwQWrMNNHGI9FE4EwwrxBQyhrZLAGG1qgAYIjjMjzyCNt8jBLBDkwQxR3VpCDwWOb7CEMIFawMsujA2jyyquEiP8ggi5rUIFBCP4FecUcZZQxBSBZUEUVIPFYQQcbPxwRw7IpxABEMI6G8kk8CKTx3wMbcjcFS33MxR4x9dTjyTlzWMEOOs958ocuodAwwQQ/BGnFGxl2yA4xQ3TRBQWwDfEAE4gC2SUzvnQgCw2r/BDvdg90I8YV1Jh7Whd96Asbog/IxkQOQ5TxiSCG7HBBAjYkAEkOFazgBDXUELPsPm/MkQNdXSwDyG4XCJObOUOQg8IXOWgDydCQ7LLCCtQ4cQU7R4gXgxVX7NVFDjbfkpduZWxxizZb7CB0OFtA0oTRKzTRDTSJ5EDMWcxckIPUOdx8CyC3vP0AcDdfcQGvvbWusUIRFiSSiDjlQhPHG/oNUdcK23W5N6+AzNHhSRAXcY8Z2whugTgVLH3EERa89+AcXf74Y29XPJDCCl2WtEAD1wi+jTp99CCOMOwYDhE7RThB+hViPEANxKxTgws199zTzTUyACBDKg2ok0cv4nB8BkMWpGJBDGaIQQ/L1CTDshhnSPPBNdvAI4MMGjXQwD9YaWXKAxZkj07696NDyv78q9NAKttIn/rYl5FrNCAgADs="
             ,"settings":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAHw0lEQVR4Xu2Wa1BU5xnHnz1nz17YXZab3C8CagSRgJpiMBIvQEXHW2oN/ZDYQlrbaRqVekFiHWplL+yy7IImwaCpjdGGGpEEBSIaZRprsBWLqGAw2orcFpHFXc6evZy379meyTh0sdikM/3Q38x/5p1zzrvv/33e532ehf95/k9pqWqhwVh6x2DU9xtM+s91OtUbxcXFEngK1IaD2QZDdQB4gYAnoNVqFSyglqjImKmrV64JWZSxJD0kLFyr8JPdKCkpCYFJoDW+tw0E0OQSCq/u1VfHwNOi12sycARsV9quuAcHB9HAwAA60/ypy1hhuAhPoKamhtRVHj5UXnXU2nzpBjr2yQWX1vTegxLju8nwtKh0qjRNaQm3uP3+/fseE+9WVz1S636zyHvkDiq0lb+98M7hWutnl2+hlrbbHr3/0RmkLj+IqqqqqAmPQKVSBcI4irYVfQEAFqfTeR8wDMNAXFy8TCQUrwNvSMm20NDQtOTUFBkpJIHDzbrBbB60CQSCVzZu3Oj0akCjKfkuIURDlZXG78NjqMvUqQCgFAqFNiwgCALkcrkAj2PBCwIEgdOnxYodDgc4HQy4nAx8ebPL7mCcjYWb845MmISUmDqU8mwquFjX0aqqt9b88xaUpAhc7Knp8TN2y2SyWLFYDBKJBOx2OwKAPhiHRlOlxLv1c7mc4GBocDsdMIRzZ/iBeURgd//oX8zCY1TsK29fujhrNkmScPLjE8ADSUmzKzNeWPRjAJBwu+KicLqh3tnbd//I1oIdecBTXFXlI7WLPp85M36Wn9KXGjQPA02PQW/vIAhYNm1HwWutTzSAs70kMSFpR2rKXJIL8+O43W6w2WzAsixQFAUMDm1jY73d4XLmbisorOMWl9DUueRZ0+f4KhVUe8etsdFR601AcBbrYmFBXh38O7i7baost3CZbjabUX9/P8JXzzPu6+vzjDs7O9Hx48dRS0sL6uzqREaTntbqtVlq06HzTWcvMq1X2tGBwx/ZtMZDepgEAhgHrnYbKCH1zrLsHEl4eAQghIBjbGwMLKMjOKHcgA1yx8AlIsgVMvi4scWdlJjAhoYEcTun+weGDxRuydv89AZ4dDrNaqFIWC2XyaWBQUEEDj07ODggxNdQvGL5SoSzmZvnMddx6x4EBQZAeNgUaL/RzfT3masLt+S/Dt8IvpJpNHtm42KTqdXunW8wGKQ6XUmywah7dP1GB9vW1oZ+d6wW1Z0+h66030BH/nAK6crfZvaW7Y2C/xbROarEuS+ryl4t0DLVH9Sh2vpmz+LHTjSg4ycbUWvrJbexomwQF7MpMEkImCRxK9R5EhHV+tKyjE20OI6sqO0GuTIAum/fA2DdkDgjGiIioohnk1MDpHLxXzQajfJbMxC7QrWKElH7fvDSItnCefFkRloCGRsbCQUV52DURkNq0jTP1bRarZAwM5FMeCYxTCoT/Qm3bZ9vbGDqclUaSZBHVy9Ll47YXHCg/ib8sb0HoiODQSrxcbe233IiYD31gStgo6OjkJoyRxgVFT09IFD5GTYh+o8NxOSol+DFz+RkpvmwAhLMw1bou90O925+AWM2GzyiGZvZ5tzS0HTaziKPCa5PeEwseH6hcEpwcEpgkF89l9BPbSB+uWojJSI/Wbv8BYVEKhX0DlrgYW8n0LYRiIiMgu67ZgfDOK7W7n9zP+t0rWlsOsW43S7gwB3PUzXxHxiRr6/yxQFz7zGEkGBSBmas1AfFrtDUS2U+ZS+vXuTDEqSno1kHboHl4TBwxenBI8Jxr3fgS6DRKsBs3VrYhCOwrqHplAOXaM4AV7o9bTtzabZIIpas2v+W6e0nGuDP+w0XOO+Ehwdn5a5dLGNBAJGBEuj56jqYh4YA93h4YCUdd3uwGzss+Kq50AI8v9y8vR5YyP30TAODOyVXKb82sWRxlpgUUj807SvbOXGmL9dkPLO2zPK9opPo1x/8FZlqO1DN+W6Uu70azc8tRqt/sQ/lbH7fGbdCcz0uc+IrZjDpcsuNeuZaxzXU1dWFLl++jBoaGtC1a9eQ3lBKq9Vqf68RQICWhAQHKjLTZ8KsaF+ID1PAiaZLcPdvPeArVwAhDYLO7t5HDoErm9+5Vwo2bfs9ISRfa25uctB2GiwWC+Am5klMf39/N0Gw8yY4AvauhCJohVQIf+8fheq6P8PdO90gpMQwJSIOOrru0YzVvL6nftcwAAi99RX+uXjT61uOM3am4Pz5sw7/AH9ITEwEmVwGIyMPCZp2dsE4RFgKZcx3YuNWakbyNU3o56YL6MV8I3pu/R60vqgGLcg/yERn7vqQuxxY0VihWAFYMiwplg+WEiuQfxeBFVVUtH1bqV5DV+432XRlmrE3f7WzAAD8+Hkij2l+YghWTPC8Da/Gr9TQr+ypR+u3VqP1O4+idbvqEK6ENnHA1GUAwIUvCWsaViRWGFYwb2YKv3As1gz+uzlBQUFzly5dmhUdHZ3IzeG/9+dNCDkHCiwJL3Hwc/nZsuB4na+vzE2QFPlw2EJYe67uHmr/8AIAOLAYXvbHxm5+RxR/DCQvARbCYvlvXI/9hoN/DgJ+spzfRbg8KjkpdP5PNoSm//Rnipj05/nQT8WK4qOlxBJjEV7ygORNUONMEZ73XiZM9Eww7j36Wt8i/wDjU5FzKBVeWwAAAABJRU5ErkJggg=="
             ,"starGrey":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAOCAIAAAB7HQGFAAAABnRSTlMA/wD/AP83WBt9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAVklEQVR4nJ2RUQrAMAhDp3fMKT1k9iGs0tgiy4/wGqNFI/kM5IoiYuQb5WWYRk7zjGS7UBUAz3I3rbkn68ddUUuWT7espPkvAM22vFu2bs8V2v/7tnoB7YUnCmjChpYAAAAASUVORK5CYII="
             ,"exclamationMark":"data:image/gif;base64,R0lGODlhGAAYAKEBAAAAAP///////////yH5BAEAAAIALAAAAAAYABgAAAJGlC+gy4B/QJi0BgeRtBZns3GU94Xi9UXnmKonmZpd64pwbNNaroN8n5gBfZUbTWY8Moa1SbL008mcwykKaH1mkEzQsjssAAA7"
             ,"graph":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAYdJREFUeNpi/P//P8NgBkwMgxyMOnDUgaMOHHUgrQGooMaFgWAmSAkQtwyUexjx1SSMjIwwyY9ALEAvB46mQSIBGzTp3IPiFqgYSWnwPxR/oIEDW5DMh+EuDDcMoANfYXHgc3Q3DGQU/x3MaRCU1r5gEV82WNLgHPSoBeIJIIdTKw0yA3Ev1GAQng/EPEQ6LhnJ3G9AbIYvwMh1YCmWBD6HCMcZA/FPJD1+hGKUVAc6QaPiMxYHfoOGLC4gCsQPkdRXEFPVEevAP9Co/E8AbwdiISz2ghy+C0ndNGLrYmIdiIxBpf5GPI58iJ6uoOkVJr8RX0hTEoKgjGCPlg6fQB0EavWkQaP5PzSd5UPFkdPcSSDmJKU1Q+1ixhgtnaFjgs02elR1oMywF4cDnwwGB8IyxQcsDrxNqgOZaFjPrsciPpfaTX5KqjoeaOH9Fhq1LQTKyeHd5AeFhspg7NW9IqL2oCYuJTUXd9HZgW9JdSAz1JG36eTAaSRlktGhj1EHjjpwCDgQIMAAkAsvxuJFQs4AAAAASUVORK5CYII="
             ,"questForestry1Active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94BHgsZEZSjuOgAAAvXSURBVFjDrZhrjF3Vdcd/e+/zvOe+5j22B+MHwTZVAJNAqlBU0yapQH2okEZRUwhpaaS2RFQl/dBWVFW/RKpSoT4S2rRqUSSikKRBDSkhRbRA4pIYYzBgGEwNNh7PePDcmTv33nPPaz/6YcYeD40/VOqWls6no/07a//Xf62zhXMOIQQAH7z+Bg4fOco1E4p9kzWisMaJgWDBNLj//j/j03d8nLvu+h0eeuhBr1ZLPnPv7//xX2zduv2dz91zxzVfvWWSbHQ30lmcc0hh6RWjjNXfZrKV0xtGmCJA1h1vnR6lFQ+ZasV849BbfOPlBZxzAHj8H5ZS6tYXjxz64oNfeWTf+668gptuvI7Ao/25e+6IgJz/h3Ux0Mz8mbn7I088lqX6yjxNr3NVOTbsS1kIOXnkhR9f++R/HiZpjhBHdR7/7r9grMfHbr6aH3zz4bN/fuSubGz6TCwFDgcIKEzfhiq1zaikKCtc5XvWd1VnZ2oiv5KhL6sf/vTSE9zN3echhHOOz97zB8y+9mrnwb//yuhzz73M/JlTpGmfxthWpqen2Do5hR9E5FnGG7NHmGhPYY0hjNv8+idvRpeav3xomvauvSgp0c7iK8VKBz6/81mYBor1uMznn146gBvmxLvGIYn51JavSbd+ZhLgH770AMoPRxfOdEh7Q6rCktRHqEcRVab57zdOsLi4SFEUVJXmjTdfI4xChtkSTz11GCM83tFN5k8vsNhJ6fULzp0b8tKpFdwicAI4DrwOZHCuZ1nqZlRnV8FagOb5DMnzz60z2ymrCpzFWMewn5MNM87OvUNZlSgUVmt27riKLVPT9Ps9GrVxjrzwEp4Hd+76a4reCoOi4uW3l/j6oeP827EzlEMgWt9JrIWKfFQQIMMAgpBA0Hqvhly/t4wUgqiWMDE5Sbe7ilQ+rdFRorhOqUuK1RRtNN1ul6QWocshx2dfRVeWK278ObJjjqA05JVFSYmxEl1C2AQG60B5hSCnyixVUaFKja9I3pshV1YVrUaMFRaEAhy6yOn3eywvnqW33KGfrpIPBgR+wKmTb9JujdJoNHjisadJwhhfX0457OIJgRSCxNN87Uk4+R0g2chSmvboLK3QW1rB9fsoQbgJ6LP3/RF5WdnWeIvYjwijiDiO6Pe6pN1zZEVKVRSEUhEGglpco7/aZTDoMzHR5PjrR8nznAPbP0/iS4JIEXiSy/sB97kt/NWjEsYACzhI6jVGp8aIahGikeApNb7pyL750EOURfrMKy+9crOnfKzJMaXGkxA2xhDC0huuMjoySpVVOOfYum079WZCr5jg8KvHeeQTv8s2fYJ9n/AohiXDrCSf0vj9iNHEbmhIg9WafndIADSVREkRbgJa6SwA/O1LR165ef/1H8AsG2pxRFXmlHkKUlJpTSpS6rWQ1sQYmRfx+NM/wswf4oaxBa6LzjL81RniWpsrE8PWiYQTiwOWBjlSSnB2bUcLKEmrXac14YPWONZt+j3G+O2Dzx80H/nIz6gqa9FdSdHWUhQZYZDQqCUkzYC35uaZ/Y/vkSw/xy/vWuXa60fYvncLP5qHx/uGQTZgfLqNxSMMS5QqceeVKtYf1jJMS0bHPQgCBGIz0Pi23QAcOvjs3c/814F/vmbf+6nVagS+pFdU1OKCo7Oz/ODIyxTzszTp8eXPbGdkei+58Dh9xjImphgdywgC0JWj1x8yGOZoa/E39gOgzEsWFpeZmvLXAAXBJlEvnTnB0pkTFMP+w99/7Fsce/s4M1vbtFtjjLbrvHb6LIdeeJGf/805/vBvppkcr/HmoEa/L+ksZYyN19hzZZ1emjFMc/K8xAqHxGEdhPIimgqSesju3ZcRNxsgFUJI+ZOODEB4B17jx4ePIYXPh6/axw/zPvOnnuZT93UYm5igrHwuH2nzysll9o7Vsdrg+QEi9EBqEBGCijzXqHMO4yyR5zjf33BQpCnpMKDIHGE6xDnr3utDF1aoBPtnnuThRx/nW0dOcPDoMW6+4U0ajYSzyxnLvR72djh2uoerNFY45uZWqEpNFEOZFRhrsTiqcXBuLUsbnwxFZcjzgnyYg9YIKYJLApUqQl7lccudx2nMfpcrbnqK8P2KgZEkUUgYhuyeHmF1aJlbyWi2YgSOyK/xyZUplB+xzY5Qi0OCwCdQPlF00QYGAk8Q+AHKUyBArDnxTwZyztF3HlEAyS+8zlRDkhFgtUNbh8HSTiJaKuLl08sMBhWeFRT9DBUY8qrkrD8A56gqS2ktnjhf7ms+JITAiwKiOIYg3rT/e4GcFGLtPRFgVYxTIXEQEHgSP/CJgxDlSdq/lXBssc/CQpdub8hwtWJ6ukncEOAkRVViCwMOAm+j5LHgKoOuNFqXYDU4iksCCcBTksCXCKAyBmsdyvcRCIw1aGPYs2WEpdQxqCzDSrLar8i7GbefblNVAik9gthDCEm7viZmFOCDFwoC30cICcqDi3rZ/6oyYwxZUeEbg/YkEqiwKCuwOEzlMJ5hLAnZOzPOknMcm+vTbIX005CRqRBHD6yjsgbJeoZaQAAMweYCISwWwOhLjrBrJoqhKktwEl2Bc5bQD7CmQluHr3y0Fhgqzv1syruPaW7aMUJnUDLZUkjfBzlgeb4gzQtqnuXrRyUfetHy7Pfh6AmYv9XRTvpkaUgz7eFw5pKi1hr8AZSFodIWxBqzFwTUa3XCWkg9qSF8n6tnJllYrmjGEoRDeYIqtdxZ7CIKY6Ioop1YnvipNld9e5S/G9/J8OPXM14P8ZTEQyKDGGddeakM2Voc0945gvIkcRwglcRoSzHM8QJJ4AfkwxznHNunR9k71ef500O2jtYZH3FU2jE96bPj7ZCTDCg0TLQsuyba7N0ywsR4gJUSXwqSeo3L63uQUopLATmhQEjAOtI0X6s4bZBOUFhL2s1YXFxidKLNyiBl/M6Igw/M86HtI4w3hojSkLZCah+23Nq7nKTpYbXGIsmLjG4vQ+GQUmCKklOXncI67CWB0kHG4mIX3xMo38MT4HsKgUI5qLcTZnZM4yysdFe5bKTBWBBzdKHLWNtHeortQvDRzggPZx3qVYjvCSSOwoKHRQUhFyYOXYJz1SWPzDqHw2GMQ1BRIXAWgkBghSQdZGTDkrIs0aXBOBj5jYAX/rHLVeM1hLZsm67YOT3FL74ueHTLAs16gBCK5qqgDB3apmSRxVYeexYrjLGbNfR7B/ZcIDoo3iWp1VDK4UuFcRarNdoYqPRaLypKwjBAeRIlYP+OKRa8gtl3M0aaCb2+ZmzEsv8Do3xveRnjAhp1SZUIfLXWJRLPI2kELF1WRynpbaqys/38QhjnUBKkUAgl8JTCD0OSOCKuhXh+gCc9UAKhFFJ5OGDi0yFP7u9QOY/FlZxOJ6cx3uYL+z5I2isY9DXWOLS2aGPIyooszaHQGGf15rJ3biOAylgsFmsc1jiEcGuOjSTwFUkjIYlrxHFAHIdYJ7h62yShCHhlrsPpxT4nl1KytCK4bg9fuut2+p2c4VBj1i1HCTg/BhljO5uArBMXwtk1e5RIpJRIJRFCIpWHRIKQeJ6Hw2ENGGPQTuNwXDna4ulrO2zf1mRmd4PUM3DyJLS28OXfvo3BckWkfILAR3gChQRPgaO7SUOdfnpBQ3ml3crqUIReiVuT+RqEBLc+YbnzrUkJnHEYJxiUJb1+jkAwPZOwZWuMCgVOWUR2Dto3cm/7Bf50dpaxsQAhoOYH1CbqaOv6m4D2X7Fto3dMnLOpVWqpX2IBqQQKgwEwDsP6Rxkwa7cVOAeVdaxqQ70pKMoC4wrq9QQbgGIFN3iSP0lnGS5KsmDNdqQs6D5/ioFmuAnomWNzF4DmPjb411+K33dbVNPUQ3/T74KSYCxsTMASWDteIR1X5JYT6buIOCA1Ct8KinMVbz13kgcWX8Wnzo79IZ1hjjGWyhj+/e3Ti2st9yKgONiwo/YXgtsP3DZDuxHwK1/8jlgfGs7/5qmLtSc2eqFwoNfvEuqvtju/ZhF2WJjXBpk9vDbac36QtY/ce4t+Y6GLcNA9mnJqg4f/Aas20VgjIO+jAAAAAElFTkSuQmCC"
             ,"questForestry2Active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94BHgscBfMOmNAAAAwYSURBVFjDrZh7jFz1dcc/v9/vvubeeezM7NO7uDY21AsG87IRBVqMoragNGlTkiZIBBOqJDQgoraq1Eo0VdqqUkQbtQqB0kecqqAGSEsDJU1p0lDkUMA2Nt4laxtcP3a9u/Y+Zmfmzp37+v36x6xtNsKVKvVKZ65mpJn7ued8z/meucIYgxACgBu272Dv/oNsG1CMD/p4rs97bcFsXuKRR/6Ae++5i127HmD37sct3w/ue/iLv/eVdevWn3zowXu2/d0dg0S1TUijMcYg0GRUEDTpKzTopgpjAuYaFZSMCLwuQ2WfZ944xjNvz2KMAcDi/3Aope58a/8bjz7+5LfGL7t8M7fefB2ORd9DD97jAV3+H473A42dnpl+xLPEC1GYXd4Nw+tMmtQ7LSljIQf373v9mpf/Yy9BuUrBK/LSi98m1xY/v/NqXn32qbkvH9gV1YamCwLMuR80sqmN0dozHTIjyfPEasZRKlUnL7ixtCyZvnrTwr9xP5859x1hjOGzD/4mU+9MLD7+l0/WXnvtbU7PnCAMW5Tq6xgeHmLd4BC249GNIg5P7Wegbwid57iFPu7+5E6yJOPRbw7Rd+k4CIlBY0mH2TPLPLx0gMpdQAtQgCnSPfBJzk64vPKpGfA97hn5B2lWayYB/uqxr6JstzY7s0jY7JDGmqBYpeh5pFHGu4ffY35+njiOSdOMw0ffwfVcOtEC3//+XnJhcTKrMHNimoWlkLATMzuvqRQn2T8JHFmNd4Ajbbzr/pri9TGtqRZoDVA+lyF57rxubD1JmoLR5NrQaXWJOhFz0ydJ0gSFQmcZGzdcwcjQMK1Wk5Lfz/59B7AsuHfjX5CGTZJMc/TUMt/cc4SxZ1N2/g5QA+pAsHq1g1Dd+jx2dQCUjSeo/KSGTKu5hBQCzw8YGByk0VhBKptKrYZXKJJkCfFKSJZnNBoNAt8jSzocmZogSzWX3Xw7zYMa0wg5uRyhZMxX9/RT+PMFqh5s2QjVq4ACcBaYW+DT1haeaR9GqfOoF4CSNKVSKqCFBqEAQxZ36UY5nWabvK9MksWIzODYDieOH2XH9lsplUr86ws/5Bd+aSdxZYhOY4FmRyJI0FGZLzy5nlAbpEy5ZdM8z33NQLGnKeO+jGkMowTumpJ99rd+l26S6kp/hYLt4XoehYJHq9kgbJwlikPSOMaVCtcR+AWf1kqDdrvFwECZIz8+SLfb5ZfLv89on89QpUglcPB9w8bRmBs2Zlw5LHnx0KWEh1ez5AHNJUSpjKVU/5oMPbt7N0kcvnLowKGdlrLReZc8ybAkuKU6QmianRVq1RpplGKMYd3oeorlgGY8wN6JIzz9ic8xlv4323cV2FpyuGbMR48LTiy0cZ81PPdWxnh9meBqIOoBzezzYKtESeGuAVpenAX42oH9h3Zeu/168qUcv+CRJl2SbghSkmYZoQgp+i6VgTqR5fHSD/+L9PQb3Fif5Xp7jvbdY+AGmCxDSwvLUQzVc+YZ5TPXvsNX/nYJ2oAP+Ul47upB1hFiMOaDBuM/7nlzT/6hD92i0qhCYzkk05o4jnCdgJIfEJQdjk2fZuoH3yVYeo2PXLrCNdurrN8ywrvHXHa3ujidLoNjdTyvgDA504sFdgxM8MCX58/PonwWHp4f5IrLJLgKgVgL1D+6CYA39vznr7/yo9u+sW38Knzfx7ElzTjFL8QcnJri1f1vE5+eokyTx+5bT21kC10sTs1ojNdHvd7FdnKSOEcnTU6dUYx/t8kDX5rvlUmBXoC7JxzKcgSdLgE1hMBZA7Qw8965909974XnvmF5LjdddS2tVh2ddJk8NcOb+97i9vtPMz40zN/sj3iv7WM3JXkSse3KKsV+h6dnl3BtcFxJnEoWnrD5jS8d7bVODqYDd+2z2brx56j3tfGLAUgLIaT8ycF43krU7ZO8vneS1ycm2HrZGLJU5vSJo3zqtxe47vJBrKBMPfB5+/hSTytZjmU7CMdCiAylFEmS8qN3O9y5+U3sa4B5oASfn1CM1Hbg2Ys0WxHdKIIwwhhtLgaEKyUjO17kqX96ief2v8eeg5Ns+ZVDlIoBc0sRS40m60sBk6eamDRDC8P09DJpkvHhYwO02wnTi23mnrD5xEdzaPauYkJYDLdR81dotlqk3ZQo6kKWIqRwPkjUAKTKZaTqc8e9UxxJvs6mn+0wGhQIjcL3LJJUs3mwylRngelmxGVjFYQxeG5A/3BImOREmaIVRxTWrba4AQYupep7SNvgKAuJxFY2CBC9SfzBGdIa2trGcSTbKyFDZUlLeOSpRpscg6Fa8Sgpm7ePL9EOUywjSJtdXFcztxKx0I5I8/S8dtCA9IlSi1bbJk4KWLYGqwC2d9F9qLfCKIEQkAubXFkIIfFdyNIcpSS2LRBA7XNlJp9e5urZBmWrSG05ZnRTjSA8zsxMRq6tHozoQYmlCf7++t4MIgWGYfnIA/xLZxEgvliGjAAcJXBshQAyk5NnBsuyEFKQ5ZoMzfhglYW2oZ1qOqmk2U1Jlrt8+vQAYWIQQvZKZQB71VBzeprqAAtg6RWwfAD3YhkSeZYTxgl2rnGsVV5bYjKBwZCmmjyRVHyHKzb0s6ANk9MtSn0uUWTYvLmKnHwXYQyiCFRXvUu8/7ZXY2UviJ/5X0smNDlZkiKMJk/BGI1j2WidkWuDpSxyCXmq8Luw5+gSt26ostSKGVIu9X6fWw6UeV43mDsEtoaFFpgMtIEwgTiDpRV49ZqYbfEKBpNftMuy1JBpg4kzlBIoywbAcRyktBAKbGWRZhmV+wrM/tEC5XHZ6xYno91KuO/DG3jxrSnu+MMKiy1JrsEYyE2OowybHvK56YZBLum3EbbBaJNcDEgHgc/IYB1lCwqei7QEeaqJoxjlSFzLoduN6MaG0ZE6W4ZC3jzVYV2tSH8ftNsJV26tM/L5hDOtLkFBkmU5vmPhuw4b+wO2bqhR63MIAheq/UgpxUW7DAFYvSS2wy6WgCzLEfQEHcYRc7ML1Oplmu2I2r0er/3ZaW5cX6W/1IE0J2wUeGrDjTw/1KBYcsjSDCUFcZKAkWipaSy3yboR9UtqaIO+KFDY7nBmbgXLEtiWQgqDbdsIFJZlKPX5XPJTW8kwtBotxspFam6Bg6cb1PtspKUQucEKUuaXV2hFLo4tVxcMDQhcxwE0RkvIUjAmvWjJNGDQmBxyDBqBMSmOI9BC0mlHRJ2UJEnI0hRLKIbuLbD3iUWuGPARmWZ0OGVwuMqdb6Z855JZgoKDtCDPNEpCt9tFGsB3qK20yHO9VkNfuO2nzxPt4QxBIUBZBktIDIYszcjz1e4Tgjhp4zgOliXJtODKsX5OWh2mzkRUywHNVka9qtm+vc73ls9ihIPvKVCgUCAMruMQBA5yYBClpLVmMM61uucjxyAVKCGRtkRaCrvg4nsefuChbBtL2khLgrSwLEmuNQO7XPbONEmNxfxyl8XFLsX+Cn+yZQedRkQYZuQpZFqT55ooSeiEEcQpudHZ2kltzIXAkGeaHNPzr0wjhSHXGQaJY1sE5YCC5+P5Lp7nYoRg2/oBAuVxaHqRU/Mtji+ERGGKe90WHtv1azSXQrpRSq57OpKAVD1P1bleXAOkjbgQWmBEjkIgpUIphUQipIVAgBBYUmHQ6NSgtUatNm3xboepuTbrR8uMbSoRWjkcPw59wzx+/8dpLad4to3jWEglkUaApcDQWKOhxVZ4XkNxmpnllUi4dorhXNYElgRD73/7uemvlETnBgN04pR22CVwJMOjASPrCihXYJRGRGeh72a+WN7HI1M/pr/Ws66CbREMFEm1aa0Bunbz6IU+6z+r20aqxXbS2xpkbwU3q6XNoZcRs2rmRqONIMkMbW1Y50viNCY3McVigHZAsYxpv8yz/z7HmXFDp6VXS5awsvc47YzOGqBXJqfP85z6xfY/f8Tb/LHEzwlce9UTe69KQq575wsV1wgkUhribo59LEEUHMJcYWtBfDbl2GvH+dP5CZwbHcYrAyxGEZk25GnOy8dn5lf9/wJQwbkwjqp/7PzqbR+7hL6Sw0cf/Y5YfYgiV6nU+7UnLqwvwkAmep8Vv/2DYx/XCN2J83fakd67ugGd25v1tx6+Izs820AYaBwMOXGBh/8BKS/fbJ55ZE4AAAAASUVORK5CYII="
             ,"questFoodworldActive":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94BHgsUNGoJEuIAAA1WSURBVFjDpZh5sFXFmcB/3X2Wu757376xg6yyi2KIGAVRZgxKlMrojClGE0ZNImiMOhmjlUomVsYZRqORqBNNDBr3uA5IiGIEEVFA1iAIDx68fb/33eUs3fPHewgM1PwzX1VXnVN1Tn+/b+n+vm7BoFw4Dm5YUMOtj7SwcEwNw+MpPnUbWDR1KPc+MYWa1KvDbltc+cCT69qXNzTTsevByYy5RPHCKpuOZkM8aRDaoGwbbcCYEAEEgCUEoRHIriZ2HevkJ+9/SkX1RNCodDpRVTthfnNQzAAg+T9EGl60HVHwDvSYXc9NOfLPD06+fufb5+37r7+bxtGuHP8fqa+rHhP4+aC7O9PUeezAJSrMocIc1lm+LW3rK/xQ+lZs8YLxS463tWNiDr9bD8n3j/BPP1tYcbTtrU+rhsq63vaQjTO6I329BsfWCAPIE1NqjCAMQUshMAhEd7fdOEHk31u3JjjW2DIUwCv2kYvPWmpVVL4HIE5QjKkSd86dFq+upuzm+htrE7FqqNuUw0obDjX6tLd0cMmcGi68dixHNh9Dohj6tXIaN8IbvRncpAYDSgqC0AAhUigEEhUWyDUdwx8xjtsWrAUcDIbt7z7HnqYVwXfuXvSMXZ286VSgRNueyzKJXB+ROhuRKOW1VTuYd0GC5Izx3HLTVqLpcuZPUly2sJKD27r5l18f4+c3JzFuKc+0esRjAb4X4jgK23FAGgjBDnIc6szzg2v+yIhh0wA40tPEYy8uYGZNgC6P89sjG3jn1ktEom408hffG0Z1EuYs2DAzl1WE3XHIweWXjeLXL2Qxgc20kQmShSbmXhRh26Z2Rk2J8er7Sxl/3WzS/T5hAIExYClCAflikWJRYytDe1+R8yY/jp0+B4AP1zzJI49NYWTaQo2vZ8vKWYyfmySSiM5TyVrke5s6mlq6f5i5YHzE3LvyQKG9tZ+1zx5kzdvtzJgUp+Gj41w5x8EpLSExejRTxiZZcfsuevfvABPFrohQLIKybWzbQioLy7JwHUWuN8OBxEiWzL2Y8qjFXTdfy9PL7kClKiAao++LHh76YBzfTsDy1999offjh5Gx8kRbx9a9LJ6T3PbwI9Mjh4/keWNTLyVWjosW1bJx4zFqZpUxpNxm1/MfEJ2cIFkT5emH9xHs/oREKk8+nyHX3UlPWwu93d3kch692QJH23vYsypHUybLO2+/yPrnX8NaWE5v3sfva+dP/5YCnWH1p3miVXY5OClreG102qOrGzpHDa8psyMlTJ9ls3pNE+99rjmvNUqyNEnjjoBvLKziV79pYPI3k/RmfGZPTlPwXSzTzZD6amQS4uWVNO3ZScPho3T0erT2h8y/4hKqXPjWn7/LjB/VU11TTswRRCM+/3jNVfTddysPr2xEx1zA67f+8/dHiEeY+Pgdo1oyez5n536LS6eW89S6ZtaubWDWhCh/eKuJu+6fSEEb8se7+PqccsoqI1hS0tPRzqdbvs2ty+Yxb/q5WJdKikWPZ5/7Iw/86m7SkzQi6CefydDR6tGdzVKWTFESsRDlK7m7rsDuY5+9fGTHH5YCgYpHoL9Af1tHf+kt//qN2fpoC8t/eYivz4ix9FtpKmfWsf71RmaOKaU6DfmMZtw5MUrTUdoP7SQ9cSlBfjJLv7OKnkKGkbUlVFRWMHPGudy2bAVzZ19MJFbG0vl3Up0bySsH3mFrQyvZjgxVNTXEx2X475+8el0m4BiAUhKCEM6f6K69+Bxxh6TonlsZMnVaFfsbo9QmbKbWF1n1UgdXLa5j85YeJs0agunYwt5DJZR+ZTU/XvlbvtjezM59zYSmkY3b9tPV1UdZupSSZBwAy3EYfe50li28m9sX3ctFwy/nlXcfY/yEYbz5m8NvjSlzD1QnbGRNGYyogXWf5Ji6eOOko+1Fxk8oJxXXCNvhzx/mqZxdR3NLBr9gMXF0jJ1vrscT5cy/vYFcTtHYsBOcSkaOiTNl7DC+MmkUqZhi319389Qrn3D5bXt59PVmerIBBrAsxYQZF/D7X3QhInEExva8AM8LkA0t0NACfTlo7ab54CGX1LRa/rK5B7+7lXwoKbYq7rmhhmee2kr77s+omL2cyvkHAEHL0b04kRSIgFHDUqhIBNuNUppOM6K+lm9eMYLK4SNZ8eNKquYa6i7t53h3nv3tefY8fgciEiCVknbExY64Z9Qydd/b+6muyTHvmhEc3dZOoiRk+7ZWZp5zmKyXYsaK/UQTFV/+kEhEyOcU0tFcMK0KZcWxlQUIvCDEtiQ/u16yfrsikIKbltjUl0JbdyevFFdTZRagtTae5w+E9n9XVlNieHPXTJoa3qAirXF6jtHqzGDE7Jf4/kPzcFwLc0rNSaVidLV6lNaliMdsLKWQlkAIg227hIFFZVqhEdAPKy4d+O/F9SvIJ6JUFgOEFI5lq7MDuSOLfP55kVm3v8zG7duoq59B/cipHDcxMi0dpOIRYokYyagDgBOJ4QWar06wECqCJW0cx0EpC9e1UJYiV5QUO+DqJVARB23g6JE/MWR4PRgQCKUGTTwDKBKP81Hly/z7xIf42/kL+HDHQdoad2N7CUxFGscSuBGX0IAScORoO5aCIdUOlophWRKhwFYSg41tK/YcEegueGDJgI7mljaSuSKxVAoRcQebFc7aoBll2yQtuPje4WR7e5g4YRjxeJz2rm6yvk8+H5Av5CkWA/wg5IOP9hNNCpLJOLbtEHFsLKGQShGLWiAk339MMGcJ1JUMKHn33fsJ01EC34dQAxRDYwiNORMIDKmSFHETMv/e4SSEYejo0SjHpaOtl55sH/39BfrzBQqFIlt3fcGIYSVEInHciIvt2CghUMohGbPoykja98EL3xtQEGjY1/4mscoqpJRgKQDXEgJLiDOAhAkNXuCTrkzT2dvH1Q9OYOyQUoaMnEBvNs/Bhib6sjky2QyZfIbW1iwVpRKEO5jQFkopHNdC2Rar1kmW3QKp6ICCluMtJFr6ETKC1iGE4QlPYM4SMqF1iNEhoRdQW5Fg197D3PrcXKaNTjNs3DiyuTxtnX10dWfZu/cA3X0Z0iUxShJJXDeCq2xCaShLWuQ9i3U7BHf9zUkFnz37UzrTkmx/lmJ/Hp3pw2DCE0hnLntAG4MxIToU1FZGWb9+MzcWzuOJpdvRYci2jzYzdngdBw/sw7FD4rEIbiyK5QiUJXGlQzQZ5Z5nDcsWCmLOyXCt8Z+nvLoKR0qkkggngtHG8/3wrKtMR1wXKRWWUtiWACFIxRNs3rSHG80lPPkPa1HOAvZu3cDx9j7irhzwTNQlYrlIIUinbApFwTubLX5+w8nJm441U57QVNRWY1mGVCKGqKhESikc2z77KtMYJBIdaHJFn2LBJwgChlaX8fGHm1j66BCGlBW57MoFiJJRKArYjk3UdrEsm6gjSKYEP3hKMmuyJHKKyb/7+CZCFSWbzdDTmaWvqxdyGbRB+6HGD/UZHjI6CCiPWeR8Q96DQhDga41EUlGe5tDBPhb9aATTLzwPc2ARsWSSRDxOIhkjFrWpSCve227x5hrFX54+aa8XGFr2bqaipp7B9httDAQBGOOLwZ3ojJDZwITqNBFbIAQIBF6oyfiQ93268wlae/rZ8v5m/A0B865dhG3bSGmRiguOtCrueCKCcRWjqk5O3Hj4KMX+Ip72KXZ7SAnac6jo6iEMtZfNmQGg737tnNOINot2ojH3y/dQG4qeRxCG5IsBxYKHH2hKEtBVOh2hPVKpFJa06cpIHn5L0dKguHKxGtxiBuSD1+6jekgZiZISpNDYrkNJMoqqrUEpacXjA76xWjL+6S4yAgEoRyBQBJ7Gth2SVogfGrpzHkpCiKCnv4T2Tp+KdJLKUsUzGwTrt1jIlEVl6Umafs/wce4tqipqCUKNFAZd8MgDpUUPbXQQBgMhk9poTh3GGHwdEnoGrQMMGscW+EYjpSQWcVFKEYs5JEdMYffxWkrKq8GK8voGjRu1iUYVOf/LQzHbthxiWFcAlovRIQKBkgMDNGGoO7MFj2zBw8KI07PaCIwGYYOSNkZqjNE40qEgiyglcG2bXE4y9Pw7KTo15PvupqtsBlkrTmV9BK0tNu0FX4Mt4YvXVuJNLCHiWCjsgVMtYKTEWDYYesLB6mp1ZvpPA8p7vunO5IVblCgNXqgJtSEXhPTkAnryRXrzHv3FEJntoFho4+Yv/h5X2UTq6kk23IMZci2tfjnNeah24TWzmpq+JDLbiTAaZSukhJhlkapMEGiTOQEkll8x9TSgned3+FVRxyp4PloDCowWBFrja4MfanSg0RgECi0MGE3gF7B0ATwfocFYLslUmlRZGdn2RtxUFdr3EIOZrhAICVMypdz/wPY4kAOw3t9z7DSg43OyL11dMva6SKApiTgDTbkc6BClFCDBFiCEGiw04uT1CxKMwAiDDgsU8h6BDqgeORKkQiAwGHqyuUHjDE/3728+AQNgRZ3Tt6LUL53rv7qk/vp01OGq/3hDDPgIOahZndpHiZM7vTADl2WnJqQ+5TkcpAfQLy5fGPy1uQdhoPOzPhpO8vA/0PHUrsuSeDkAAAAASUVORK5CYII="
             ,"questVeterinary":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAABmJLR0QA%2FwD%2FAP%2BgvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wgODTA67oFEugAADFtJREFUWMONmHmMXdV9xz%2Fn3OVtM%2FPmvVnt8TbD2ODxgm1sYxtMwEsw2HUEJE3TqjKp1FY0adKoaquoopHaROqSpUqqkiitlFBSKBS5QYTY4AUv8VKDN7ziYZjNs7x585Z5693O6R9vwB5jp%2FlJV0%2B6971zP%2B93fuf7%2B54juE2MpDLhvmuXH01dv7Yim56gual1uGvJ8ldT%2FX2FzTueCvg1cb3vstnRtdh%2FffeLX0%2BNDsv6RFN47xt7v7nr6V3Bxs2P%2B%2Fw%2FIW698c47JxPH396zbnx4%2BI3iB6eYnzQoyKgf7143uer%2Bh%2F9945btf%2F3rBjx5eP8%2FvLXn51vc3uOrEiHFZEWRD3Vc2LTtt140Eh0%2F2LljR%2BE3Bjp86GB3enz02oGffZcNDPKFncshEaUgJC%2B9nSZlLGR%2BYz3pM4cBtBZqXGiphdZCAc1L10TfS1XrG4aOiq%2F%2Ffg9GvQWGoPdEH%2F92Ncy6p77CpRd%2BNBAWeTdQGDFTVF8%2B9eEPDg1P%2FfATQEcP7GkYGBy6vP%2F578z%2BvYVVNt0%2FD13wQRiIugg0hXnr5BgnSt1sWzyL1vJQkK86Ih62tRWOyFykTfzP2RG6i2f43Lp2RADaNgGJaIkwnq3ww19O0rP9T9g4sU83JEwRXXYXxCOI7r%2BQgAaQHwENvn9x%2FS9%2F9v3kE4sCNq3swMk5tQfaRxdKkCrz0Io2lrdMcLAvz8lSkyxXtcgUXHlNtfPK%2BSwduTPsXFyP8DVojXA9EKAnyrQ1hPjjx5Ic%2Bc9%2F4qqcJ0ZSZZxrI%2BArgIaPOCTAsf0%2Ft08cP7Z1ZdwJb%2B5uJJ93sQ3jpiRqdLlCKFti2wKDucYVxlVIZBq7RaZ5iTh4eUQkx37F51YmCIdMUAq0Bg2i6iBcD513aa8LsWt1hAPnrxCpr8eIxiBWjy2IzwDKZLNt9Y2JP%2B9q9Cm7GssQtyk3ha5WCXmK7SvjhKdOcmooz8GLAzSm3mHXhhaisTBaGmjfR3suaHXTzxXkXZY%2BeDfF1BCTdfOpFkpQrmAaxGYACaV0RHqgtK4EAVHLuEP9a1S%2BSEM14LOrmmnMHCMxcogvPtJOQ30UAo0wTDBNQKA97%2BNsCcdFA%2BZUgbZklNxYisnBcXR6AkMQ%2BugtJkA82VoO1dWfP3u5uvy%2BWaAaNEqDIWZmKtAaP1CUh9PEYha77ksQis4m0hQFR6O1RjgeQkqwLLTnon0PYYdAaYQpOHgmRVC%2FkPamMHV%2BHaIpiWUYzXjBjQw9uGVHZs7dy76balzGnrMZ0lmvlg2tZ8C4viJb9shWPbIFh9MDipdOlugfKkNIICIm2rZAiNpl2bXPIABD8u4HaV48Ldi4%2Bl7yve8xOTYJdghDitCMKQNYumrT6Y2bd%2B45X3cXrxwfZSLjoEUNSmmN5wcUnYCSq4ibAap9MZGtX2Gw%2BwvsvaDI5aoQMSBqoS0LpEAICdIAU3Oqd5K9%2FQ1s3fIICT1By6wWWubNBsdFceOffwy0rGfhe%2Bs%2B9cgz7bPnM9S%2BgheO9TOVDUAoXD8gV%2FEpegGzG22aYybNs%2Bax%2FtHfZvtnHiMSMVFuALaFiBmIOhNtWWgBIh5h77kJ9qSa6Vq8gk5%2FCH%2FkCrnJPPgBxGwE4pNAAF2LlgyPXHyXhV0LGW9bzXOHP2Qg45IqeRS9AK8ScK43x%2FWywE5fQh39e5rf%2FWceneeQHcix%2B7XTjA%2FlwJaImIWoC%2FH6iUH2pttYvHoj3WKYkMgghKC%2FdxC3Uq1Jg8C%2BLRAgK4UixsAFlvTcS398Md%2FbP8iFkTJhAcXoXN6OPsx%2FfZhk4INh5PnXmJt%2BhzbDJ93QQ1%2FrE%2FzkhCCTddAEvH58kH3jLTzw8Ba6%2FEEMr0SkLowhJctXL6OhtRkMEymkvBMQSKFNXSWS7mX1g1s5OqQ4cHGMaGMz3Tue5tEv%2FR2q8wHez7gQGBhGiCBms%2Bizz%2FD5r%2F0jhdn3kRmdYjRd4vtvXmfFlifoLF3Fz4zhVDyEU0tGfmqKYm4Ksnm0VvqOQF4QCIEm2t7J6PAw8%2Bo0lhXizGCaeEIxt9FgRbJAV9KYFr4Aw5Ikiu8Tzp5ma8sY7aamKVnPQ%2Bvn0HflInrBakzTwLZDCA2RaAynUKaQL4LrIBAfT9mtCmisnJt89r4167lakuj39%2FHlB5NknYCDV1LUTfTSPXGIOW4%2FQrm8cDbP2xcKzI0I4qV%2BrL4jxEvDlByXhCm4d%2B18Bs6d4WwmSufdPYQKo1ghG6dSBi1oqI%2FQsKCF7%2Fz0yO6iqy7cFuh3P%2F%2Fks2lfEup%2Fmy%2BuipCss4naBqmCz1tnhjDdLIsSQNcawpu%2BxiW6SQ2%2FT3e4gOmVmSy5RCyDqBCElWLRkhay%2BQkuDkNH92LMqetorbEsk2RTnEjnbL7z4wOvFt3gwiem7PjhfX%2BTK1WJDR9i14oIiVgIUwrmJ8JsX9rEys5GXruU58RAjvjCNSx%2FYBuf2riGOa31gCZTCagPmTRG7FqXL5RoKFTZeU%2BEFR0jvHm2D2fhFgAqFRfHcSDwQePMaB3XhsfFxFD%2F04def%2BmvmieO8YcbW9EafKURQmCbglkNFlvvSVBxFf9xMkvL7OdZQpk5H14lHJ5kqhoQtQ0itsSQN1qOLhaJBIoHF8Tx3UFeeSvgd3Y8Qfj8bkzTBDMEt%2FayqF%2BwTuz%2F73X59%2FaYf%2FtIC6pmZ5BCoLQmZEiMkEAg2LG0md2%2B4psvn%2BPTFwdZNSdGXkjmNISIhQwsKW%2FxxQJdqWCnBRt7ElwausrhEzEeDkPgKwicmYsc4PK5U81uPvtHWzpcqt4NGykAQ0o0NbiobTA3YfOZFS1sWpzkldNjfOvNQbIln7qwgWUYCCFub5Ydl3C6yB9s6SD9wTWyoTlM5bKoyQm00sEMoLHUKJXyFI7S5KseXqAR0w1VKYUUAikFliEwBCxti9AStfBljIvjPif6iuQrAfqmZnxr6GkLYnkulpqi6jlYVggZrUOj3RlAiYZGPG0zPODia8iU%2FWlnWTO6SuuPXxaPWpzqm2LfRDNP7foyf%2FanX%2BV8qZ43T%2BXIFl2Cm03ZTCRA46Qd%2Bko2nd2dzOrqgFkLkPJG0UmA5tlzi7PnLjp5tCAYm%2FIwBFTcgEDpG9MnBCHL4PxAgQOFOaza8BALsufpLFxj26cf4xfZEPt6c%2BTKHoG6DZRSODrgX35xkUXL1uJc7yM1NAaFNEqjZgDdvWxDYdnaDc%2B33LOOnx7rxckLSn5ApuzjKY0QYBqC3lSZN8aT1Ld10pG9jJefpJJN0Tjwv2zb9jivD0Q58uEUueo0lBD4StUuKXj12CUGI8vZvP4%2B3NwEKA2uA1p7M1ZZY2NMa62fq1Ymt%2F94aPzxb588zdP3dxEPQxAoElGLdMnlhSsmtHayNlLCmSwihIFAYxswa%2FgU9697gJd%2FdQTbKrOyPYwpBRHbwAs0%2B69leWV4EV965knSbzyHBHQ1xKyxcYJAuXfcuf7o29%2FQZ8%2BcozjwLhuawixcEGIi73E618CcpWtZVVelcL0fBAg9rQ%2FU9CqabOEdt5kzJ4%2FSU59n7fwY6ZLPiVHJZLiDXU%2FsINl%2FBNBEQyGSySjNDy%2Bj7d6%2FfCxV8vbcFmj70g791aef5ErOYyQ9SQSfiGnT2RShzQoopkbxA4WUAik0QmvENJBhSCKtHUxmC5wvm3humVJg09HZw7pYBiYGMKQJQiNNg8Z6i7s2r6R5%2FbNbJ8vBvo%2Bn7Obw0ZR6L9AdkfREbRAKaVbQ5RxlX%2BF4AX7gYxoSU0pMKRDSQAoBQuNnR2kUkk0JC8u0UFrhV8%2BhyhqpIdAKQ9TkQwoDEASBmpxRQzMXg8BXAVEsantFAyGnt0CmwNcBpmkiRU1bgqAmCXbIplgso0IW8XgY2xJoAW5VYSCRpsa2bKQpa31OgWEaYFmgyd0RqFh19HhmSuQLJQwkgQoQQmJZkiDQXM87pApldq5dxPTYWGYtQ5FwiOGRcaYKJdpbW3n3yjh14QqWZRFosAxQnsYOGygN8bBNYk4SX%2BnCHYF65rcGGd8wi1MOgaj5EyEFCvB8H0%2BBi%2BAnR66BVEQseVsZjA1ZhEMFdNFECB%2BtNIHyMKWFzvuYQiBNj%2FHdZyj6lO8IdPzKyLfWPLbmGw1xj0RdeLrqRe2LRk24TMvElGAKA0Nqyo5JxZ3ZJLXw0boOrRXKB0yJOd2sR7MFXKVw3YB%2FPXSpF24Aid%2FgQMuYFlBxk6GT0w8%2FSo%2FQ4N8y3s1yHXx03DJ9%2F44naf8HbLDZdHrmYfEAAAAASUVORK5CYII%3D"
             ,"questVeterinaryActive":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAABmJLR0QA%2FwD%2FAP%2BgvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wgODiQa%2BQcNfgAAC31JREFUWMPNmHmMG9d9xz9v3syQQ%2B4uyV2u7tW5uizLXkm2rki2oiNyYsXOVSeNG9hukSBwmwJu%2FyiCAoWbukBbNElbow3QICnqOLBrJ03SxK5sRdZhRdJasu5bsrSntEvtLpfkckjOzHuvf3AlW9LayZ%2F9AQ8cDoczH%2F7O76NgAruaG4lfvnh2a67%2FYkd%2B6DrZlkl9c5fc89Nc1%2BXSpm2fV3yE9V8%2Ba0%2Bfuzj61c9e%2BmbuWp%2FVmGmJv%2FH6G8898eQTav2mT0X8FhO3nzh8uDNzYPf21YN9fa%2BPvXeIWc2SkpWIUu2rh5ev2vCD9Zsf%2FsuPumHn3p1%2Fv2P7LzYHlw4sz8Q0wxVNITb91MaHPv2SzEx%2F%2FpFt20q%2FM9DePbvahwavXXzrx99hLT38%2FiP3QCZBSVi8vHuInJzPpDUN9FR3YwwoY4zSGmPAAG2J%2B%2BjdHYmmrt%2FwF48vxmpwMJbg0juX%2BY8LcVZ%2F7hucVv9mIu2DACGE0cJEzz1%2BMnYH0L63tjd19%2FSe3fnCt6c9Pr%2FKxlUzMaUIhEQ0eNASZ0fnAHv8OaSXSQbVUQJlAINBmqxcSO2YI%2B4uneTzKydjIlCOxBgLkY2TK1b4wRt5Fm%2F7OufF81gWCGkhhOCvvnj0Jod146Dnwuk1%2F%2Fvjf2n%2B7ALFxmXTqY3W6h%2BYCFMqQ87ngY7J3J8dQZ3zaBUrsISFMTAzvloEJ9OiPX%2BSbYuT6FCjtEZVAyJjCHM%2BLQmXp7Zk2PvSt2l1VtW9qs0dIbMA9u%2F8hXvwwP4ty1K1%2BKb2NIVCgCvlB5xoMH6FWL7MQ7MlMzmP15NljreWRelN5DurtF49wOc60ji2g4o0UaSJIoPyq6hqQJgPyHoOf9AR49SubmzpTZjFFsBIPj%2B5MZ3587npCD8wOFJMkG4aU60SCzUPL0sRL3aSP2y4urtAy8C7fGVNK14ijhYWKgyJgqDuJW3qK1Ko0YBFqxYg%2B3L45XkYTT35bgcSWhvPCkEbU1GKhCM%2FJP8NujBGU1XxheVZ0iP7Sffv5qkNU2hq9DCRwVg2WtpoAyoI0EqjtcFUA5QxWIUSLSmPVk8QRArMrUQ2QKp5kh9raDxx7Gz1nhVTQTcZtAEpbvWUMoZIafy%2BIZJJhydWZHC9qcSbE%2BiqxigDlQBhWQjbgaCGjkKE4yIAIQV7TuTw07MR0Qi2tOC2Z1gA6zZvG5mxcOl3cumlbD82wlA%2BrHvjA%2FTKGIJIk%2FdD8tWQfKnGkW7Ny51lunp9iAmEJ8F1EEIgLFEHEQKhNUJaHO8a4b%2BPW8xf1U416sa67Rm3VNndyzceWb%2Fpke0nGubxyoFrXB%2BpYUT9C9oYwkgxVlOUA03KVugpi%2FG2%2FCm987%2FMG6c1hUINK2Ejkg44DpYUSEsibRvpwrGuPLt6G%2BnYtoZh9woIgR8qrIk8BLD0rvknN2x96Outa9rom9LBi%2Fu7KOYVCE0QKUYrEWOhYlraJZu0yU6dyZqtj%2FHwo58k4dmYQCFiDrJBYjc5WK6LtAVO2mPPmWF2D2fx7l9AIXOSgcIJXCkxmImr7IZNm9nefUW%2Bw6wH5zE4%2BT6%2Bt%2FcK3SMBuXLIWKgIK4rjl0bp9wXu0Bn0vr8j%2B%2B4%2FsXVmjXzPKD%2F%2F5VGu9xeQcQunycVpjLHj3X525Sczad19%2BJkz5P2r2NKipiISjn17Tt8KBFCLKowmj9H%2B8XvoSi3muzt7OHXVJy5gLNHG7sQG%2FutKM93v9WGd%2BB%2Fahg4zxVYMN93Flcmf5UedFqOjAZalefNwH3uGWlnyiXWU0yfxoxFcW2LbAms8zyZsjHdAhQXKqTMsf3AL%2B3o1b50eIJHO0r7tSbb%2B8d%2Bg53yMCyMBKImUMVTSZeHvPc2XnvkHxqavYHSwxOCwz7%2F%2B%2Biodmz%2FDcGo%2FhWo%2F0hJIW2ALgS1FfZ79LkACQdqazWB3HzMbDI4T42jPEKmMpi0t6WguMbdZUu9sCulYZMYu4I0eZUvrANMcQ2tLIw%2BsmUHX%2BTPMS20EYbAtC2kJLGlhCYF1p9jgjg547yczzy5IL6d4vAHO7%2BRP1jWTryl2ncvRcP0S7df3MCPoQuiAF48V2H2qRJsnSJW7cC6%2FTdrvoxyEZGxBx8pZdB8%2FRvdAhtnzFzFcu4RtSyxLIC2BoB62XT8Z%2BOsPBfrDp77wrH%2FCxXtvD08t92hucEm4klwpYsfRXuwgz4IMMPd%2B4huf4Qzt5Pou0B4vYYc%2Bw%2BUAz5EkLAtPGxYumcRoYYhrXXGmzllEMerCYjyHBCA%2BAujQb3Z9693X33mw9epBvnJvglTCxQBJVzK5yaWq4e3LRbJJwaItX6J15WNIoUlcO0hbrEyxpvEcScpzsSwBQUgci3lTPbQocvqUzbKOzeT8kwhhQAjEbUA2wMW%2BQXG9t%2BvJnb96%2BZstV%2Ffz1fWTMAYibRBC4NqCqU0OWxZlqASaH3XmaZ32AkvwmXHlPPH4MMWqIuFKPLeeJzfMjI3hKc262SmioI9dP9es%2BeLXONb%2F7xMqRhsgEZWcgzt%2Fsrpwcrv9rY%2B3ok195llCoI0hJi1krB7zbXdn%2BVmkee6V43zidA%2FLZyQpCIsZTTGSMYlj3Z6qAlOp4A4J1t%2BV4XTveY7uk4g54s5Rf6PKzh4%2FlA0K%2Ba9tnh5QDd8vRQFIy8JQh0u4kraMy6MdrWxc3MyrRwb42zd7yJcjGuISR0qEEBOL5VpAfGiMP9o8A3W%2Bh9Z4R%2F1XTzTLBnLXqPhFatpQqIaEyiDGB6rWul6ilsCRAing7skerQmHyEpyejDi4OUxChWFMeZDxbsxBlELcMIAW5coV8qMC%2Bs7gTJNaULj0tcdEBkY8SMiPX4jQBtz82GphMOhy0V%2BfT3Lp7%2F6NE%2F%2F2Tc4UW7kzUOj5McClNEfhgQYakM1LpVs0ql0vVNPBJSd1jY2rW1B576SYKAYIgVUAoXS5v3wCUHMkZzoKfJWaQZzH1rDtZY9DLcdYvVnNvNaPsaOS6OM%2BiFKTwClNTWjeP6108xctoKy6qtr6olCtnDp2tLSlWtfaF20mv%2Fcf4laQVCOFCN%2BRKgNQoAtBZdyPq8PtBAsnsZI4wEiPUzRz3G9ZS9rH9vKa90J9l4pMlodhxKCSOv6sgQ%2F3X%2BGXm8p9z%2BwlKFiHxNF2AZIp5PGGPO9amX44e%2F3Dn7qHzuP8OSquaTioJQmk3AYKge8eM5mbEEbU9oHGfFLYASOhDAKGWjcwaItq3h1%2B0Fijs%2ByKXFsS%2BC5klAZdl7M82rffJ545lH2df8zjrSQEyT1HSXxw1eeNZ2%2FPEq56wgfa44zf3aMXCHkcLGR5pUrSC7MkStepBJGxG2JH0Z4jkOgFK2NUwjOtXPu7QPcmyixclaSoXLEwWsW%2FYkpbHtsMwdGXiDuSuK2xLEtbClv2ZfdAfTl7842D8zaQN8FQ7G%2FSEyH4EnkzIB4NiCIBhn2a2TiLvlqSLPnUqyGpDyHQGkmN81idKBEcDmLrviUlcu0OXdhZpzlcv40TTGH62NV5mYbKQcRLY3eLUD2RPVwrXIEuw3sVkWD53K95JPyHMo1TaQNjTGHchiRjo%2B%2FJlwCpYlJi%2BGxXkgazJJRlNZYkaZfn8cUoSFW19szmxtQxpCKOxPn0IdZU1xijCLbECNSBltaSGGIjKEh5tyEM0DcloBBqfo%2BrBpGVMKIQGlqkcKxJSKElmQMpfVNuN8q0AxwIVdEG24upQ3FakCkNAOlCmGkGClXCZWiVA0IIoXWGm0gJuvSIunaJF2bBtch6doEocKVFr15H4Eg7wf13jbRvuyDVqgGxGyrLsDf37PSGHfww4hJDR6DYz7NXpxKEOE5NqHSgCAmITTgyPq4cR0Xo8Hg1nevxtCSjIOABrvuYXNbI70DaFlbSygRTr0Zjrtx%2FKBJ1uVIW7oBpQ2ea49fI7gx4MVt1SJk%2FZ2U75%2B74RQDqIn%2Bcfj%2FZP8Him2Tbjbyz4EAAAAASUVORK5CYII%3D"
             ,"questButterfly":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowOThCODU3NzdFMERFNzExOENEQjlEMTdBRkJFNUQwMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBMTU3QjZFMkFERDgxMUU3QjQzMkQxRjk3Q0I1MDI1NyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBMTU3QjZFMUFERDgxMUU3QjQzMkQxRjk3Q0I1MDI1NyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkVBQUQxMjY4RDhBREU3MTFBRTk2RkFDRkI4MjBEQTMwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA5OEI4NTc3N0UwREU3MTE4Q0RCOUQxN0FGQkU1RDAxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+qcffGwAAC1tJREFUeNrMWGtwXGUZfs59d8/es7vZzW4um7YpaUnapE1Ly7VQSoEBrILCMOOICoODozOOqIOKjvBDYJihIo4oFxEBK1PLvSDXcqmU2pK2kDbXJtlkL7nvfc/dd1PKaG1jf+Dlm/lydvacPd/zve/7PO/zhbEsCyzDwAJYAKbTJqGi6dANA83hEG649kI88dx7ODo2jrbmJmSyRSxriqKxMYBCYQp9Q7NojAQh8hJUesXw+ARM08RCQ9MNbDm/HSVFw7uHRjE0OoLJ6TnMY6k+wBAgmyiay+N1aF0UmwdTHbphgsF/d8wD4jgeDeEgrjq/DbO5UvUrMV7n42v9Luj/Zref9eCrfwyKRK6kIluowO+yd7S1NFy7eX0rl0nlthbLWqJU0aCoJioUYlXV/vOAfG77kk0dgStFzlKuXB//ZkWuW+rgNATEfCdk8/WNXfHM4LizpiVWK/ckK4crqvZUNc0GpbY6KeefLaB4Y+SqzhVn3OP01lo9SoDpThpoa6lHrX3PBq5m8YYwO4yMXcG0J4DVtZlJfXIkU1Iq5bqQ/7y5PJswVeUp2EXrMwMU9rtjHrcdDx8EM1WYxmbrY+xX1qA3YaAllkeskMZKdQjWLI+X5nzBsNf2mMdfqw7O6M2y3znLGKXPW2r5Po5jK4qqMTZJ3EdBO2nxVZlUqqjz11MCGkzODj34Vga96Qx+GjmCr8SS2F/6GFmfCFtZRWNUR4zJg2VNrB/14M6x1tj4dBLZqSlEG6K+biH6hVU16prZ8VFj4/r2nU88+2a3oqomc0IqDQLhtNtwblcbZLqWlPzJAfUPjz8fci3eev36AL7lOWiVEhZzgWcGsFc1gXYSpatMj9JXlxs5BOND6B+RsG7ROPJqArumnNh6MFgvNHXC58cl+UJBIC3TTqwsC1XNq9asDJ5nYZ2K9oamZVcvi6du+N5t+O7s2cyPewKAhwDUVCeDTEnCXJkD2mXgXA5ruoq4ZpWO5qiJFQ0F3LI0jd1th3CmrOD17kS8Y2njGpZWZk6Y8wtWyUBScoqMfaJDLIr1Qfv2Mc2OrW/N4KjkBeUIe8c49I/acPuLfrzVK8NcAqiLORg2EyUPMSxOPw8w4PwMaimKd+vbIAeamGuu2vgIy7Iyx3H0bprzVxaiwFPa2X9f1JZpKY8/9OgDu/b03xx3KfxNN9pQOZN+fMSCzWXiS0vzWLe2gud3NuDNvQq+067h7QEPUgaLWzqn4RCJ+lNAc4OB9t692P6OP7Zu5fJrVN34HcWGxNVCIT+HNcsa0ZeYJE3TF1Zqp2wDaVA6m0k+ddkqAeuaNPzowTjySQnRrIILzymjnGBw228EbH3ZjjvfC2Mwx+H7r9fjthfq8G5fDQZKHlg2Bj9vPoCIE/wlq+NbvJJpD7uoTyo56lUz81E6LdpX80lz7sx6+c4NbZ7Lnn57vObeP1XwkcdGBSxhGTQMZiT0jFcIuI5sUQAvuRC06XhqNIikQ8aamImrxR40uaZxc3iaeckMb/K47JsYhnvWsBgwpyme7HFADolDsx9DDz+TvvfW39tQVZEBhwjtYhGMQERTdMQlDWvdCjq9Mwi6FASdxLQmEZ0xHhG3hI+MVmScYazHACQlZ+YUY66gmDAggIF1+sJ4fEiioDO88Ygo8xvsHu7iLzYksGKTjo93iwgO63hs6Sx4JylAXMBO6m+LQiKiIRkGSYNIe7DbZXQXlsCxNIbmSb37/m0Du2RZQiDgR7lSgUltxpxnmLUwIIaYUNFM7P5oFNmynjEK1k1Ob/CZ1eeEVjDTR3Hr0z4U08BD7XksoQj1qSxFx0TYa8Im6HDJdjgEY775Wq46FGqW45XX/3Jvc0Ow84yW+JVKxQh4aqOyHK7tcU9lkw6bsJ9nrMOnBFRWFBTLFiZnslV4lEdr2OkpXn9EO/uFn70gNO08OIkr/HSnYmLMzaNYsrAoVsKh0RzKBRO+RgdSOR0zeR1lq4DhPW+/7/a4L/jGlrUbzzYHW4VcEuNWLfZO5s1D4Y7ygKYN2MviPomx+smsHSAp6KWFh+aDUw3fyQquWlyRSPSCrnXrH59KJmJ36B/iAknF32wiZlsl1C9yYddoGHuGHWRZWEzli3DbbLBIAIeS+fSF7U2huM9gV+mH0WgNANQlUrMMUqjH4ZSBX5RaIdU1krSN7H70z29cSkAKVcFkjlvYE/EQSCfHwOP2es+6bvOq+1olpS6SPICizUJwmYSa2ga802/Hb99IYGq2AJfLjlitFy21MppqbGjwC3BJDBRKo1GcwVp2FIsEygD5P6sCfO2DCLrjl6FeG5w+Oti/7lD/eP+nFvZk7ON5ziGIYmR6ZlZ77Lnd9w/DzFY66lCsdUE1XaQ9JrbtmYJC/pi6PNKZOUzNFMhbCxBsDozlOXRnOLzcb+DpAwKGisfaEGwcsZbDfa1p8OM9GJpW/Y31DT85KctOyBhLCi6S7HvyhVL5yZ0D2z0XS9dLAit9mBIJzATKho5wwIdJVphvEe0NbpRVA0fGZlExZWRmVIzNFJHKGvAKLnS0lBDwV6h3skiURdoYg9Vdbfnev76y43jZnAqQYRpmwWYTI2QZaoinUjKdSdy1w/n4OS3iZrcPsdScApmYZVRK2LDchxUxFxm6IsqahtQ0Q5kpIEb3a+08nPUW1oTILKiURuoKg5aEXxZqYFC/DlhzA2Lrsl2jydyCgCwColVU9R1iwFLqPO0Cx7mUcnn2UNo+7FH4WNjDIUpzdb2JtlAaTgJiT2pYZtNApYOBCo8HqcZeTcpY7BNw9cocWs5R6AY9ozP4YWgKn8ssRl/K1xn34jVaZ+VCgKrqVaETByOxXIpjmTDR002lbtMM3ZPPKTmvxE6eGRHioRqLnRxV0D5RosJm8LEmYKVNxeEh+pwVCGAZFzcV4YtwyIw7UFsiuskmYryJswIGSiGvnk33dTPzTgkWv6COW5ZqWEaehLNAGBWqKXYiM/ucxAvNo7o15HcGLw80RFuDkkPqVUbwblrEfWNO7P/qHG50VvBlQ4HZwCAQM7Brvx1HaZ+hRrIuJRY7UnU4KC9Hh1nM/vGDxF3F/Fy1bg12QTiWRWpvlqhLZyikc9UtCIIgU5QGyFQIb3Vn9j76wuSOfcKi8u1GOxKNNvzq6wXEN7J4P2BH3xSxL8VhYJCH19TREVLBzJh4tU/GHRMr4ArVQVdKzou6Fl1XJq+yUMo+TR2BqtBRJy3w7KimWxL1Ip7qyyCQNmKGOjg8spdhzZzNW9e1vi3SEZAncNs2DS/uJT9VknF3i4KL2jT0vUuLHQGWew3IWhGyyFVPy4h57dLETHE5LUR2FMVTCeM/SwDDSCLPBwlAXNP1Zkqdm773sxwbIoBpelmC2GPafXVdhYq0pVQxIlesULChi6Sg2YWPevrwxMtefNs/jXMDKrYVIngzuhl0OEa6d//21/b0/kDXywld05XTAXTs9M9AIK1xkzcms2qFqV9HCJiXAFl0M08RGzMZdprqjfN5fefefFXrJTyTO++DcYdk+VvhWdyJS5j9eOm1fTik+rEkKqMrUJm85w9vdlFTHlGqLoCyxp/m+a1aT5RlfZYxmSLV0wSp8wjLs0HL4jzVf2jQpmZ008hoijpWzBn7MyXXk2/vy0SSZTW2eZOwxZMfWvPAvhFvKmevu7TVLCcSw6PP90z82ut0jYg+rlob+LS5nkaE5g8x/zAoIIxE0XBwDOM6Zjirwq2X6H0KfVZDfg+i0ShSZQbnrV3hIhvt3PPebikYCvDFyQSv6laRY8wJt12uPj+/woGB4dOO0L8quWmVYOrV02D+E8NlzevXsYlsroD6GHNsKYbNUzTzIp3FqGFjOqeg+tnt4D+NzPHtMgu5t//FYPF/Nv4uwAAvmU2KTXZfKgAAAABJRU5ErkJggg=="
             ,"questButterflyActive":" data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowOThCODU3NzdFMERFNzExOENEQjlEMTdBRkJFNUQwMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NDU3MTRGMUFERDgxMUU3OUJCODg3NEU1QTQ3RkEwMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NDU3MTRGMEFERDgxMUU3OUJCODg3NEU1QTQ3RkEwMSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkVBQUQxMjY4RDhBREU3MTFBRTk2RkFDRkI4MjBEQTMwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA5OEI4NTc3N0UwREU3MTE4Q0RCOUQxN0FGQkU1RDAxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+PX+lEwAAC69JREFUeNrMWGlsXFcZPffNvPdm3zye8djj3U7qxI4dN0lTEqBNdwoIEKJQEJtoRRECCbFIZRMqQgUBahH9QQViacsWUGjpRlvUhDqQpXFWJ/E2sccez4zHnvHsy1su37gvjbOWH/3BtT6/mTcz9537fd8597zHOOcQGAMHBAC6wyKjoqhQNQ1dTQF85qO78NQz+3FuPoaBrg4ks0Vs6GhBe7sfhcISJiIZtIcaIZll1GiKmdgidF3HtYaiavjguzehVFUwcjKKSHQWqeUV1LGw1X/0t2bU3/BLJ+GXn3rbRsDvfROQec15E8UWin6UIDMJGjdDNwBWCPQsHXMUVoouCtvbBagRnsfPv14LyELhcI5aWq0H5OuvCwT5yeHYc5muYt4AUo86wAzFBEUThYdCNkC/LWMVUIPH0XvjvY2fSN2qhboTnrtcuY6wJ8Vw41GHb6XZevCEuFBNKLmQ129zLoiV+cSHUvuM39copCsAqgOvGEfRCJWialzTcrVFrALq7Ax9YEtL93eqOSvPFDrYeETGpp42BJWDO7y17h3e2XMYTReht8lo9c1lx/eeXqrIXGlM2wbnpVwxcUvmdS5c1GSqAchmgBEM4KJxvmqAujKgoNfV4rZb8YeDDpabK+NO/QhGyyrG5zSsCxcQLixiay0CLW7Cs5rT3TDW8UWb36ukKkq4xVUoBCez/YtbFl9RbDorVWpCabg8TQBFo8z1o924FjNKXLlmySLxzLknX7NhOprB99yT+HR4AaOlMWS9EizlGtpbVIRZHoKgY2fUje8f6QvGzWVk00sIdYQccVf79t7YSueiOMu6hoWxQ+vHR+DkdTAaRavBWt04mo2MXR3QZCT2jD/U/shHtwbwJdsYL81xdpM7/QafGM3RUl8jfZVO3a3l0NgZweSsjBvbYsjX5rEv4cAj4/4gbtiI1p40P1Q6a4ZzlYmCkZX6sWww2fyWTa0pSnaory1571ceCH71B1XGT4/gJ3dkQZPSdCqSJQkyTenZRAh7y9imFzHkN0FK06K1AvobCrgnm8AD+Q2IjFQCDQ2OwaW7ColLNK2eMfeapr/iWE2dSUDR18afP6tX8Oi+NM7JxOYww+F5EyajFnznOR/2jtuh9xKtekzQLDpKbg1aJ/3cz2DyMQQpiz8u74a/1Mc+Nn/r57G8ysDzQlsHULia6F4GSFX16p6Z3b96+KcPau3BEu6/z4LKVjMEE4PFq+Oe9XnccUMOf3+hEV//sR+xs048O+rGTw8HUHLSFA18tXW72jRsTh7FoaeXG7t+17zOkIXzAAJGyXAtUBeaa7OWWHHGXt16p4obOhV86xedyC/IaMlWsWtnGeU5hgcfF/Hoi1Z8f38TpnMmfOOfrXjw2WaMTDRgquQGtzA83HUcYZjMt9d6t4t5k2rMXm9up8G4ty5ZfZTvr60IH8n+sWkbCo8fL+Enuwt4+KAFZ07I4KMc08dknI5VIHFiV1FBUnei0aLiD9FG/Cy1AX/j/ZiVfKuXfSCYZkrOtaP9Vd/6NczSjJIx4zW/doZorAzkEk8XF156KEILCKmYsktQbpPAaF0tVRWdsoIbXFUMe9JodFbR6CCmdUgYDpsRcsk4pfUh6WjCjWwKZjWvlyxq2biwsCY7uIq6X7aXQZV1LbEju1+YDfRJKvruyGYweLuKsX9LaJxR8dv1GZgdpACdIl6oKOgOSGgJ2KGRNEiku1arHccKvRA2hmB1JKYWbs/EDCFc6yL0q6k0rqQJ5WA1Z3pf4glrOfiFQNAV1tJJfG23F0Ui8S835dFLGZqoCZQdHU0eHRZRhZNU3iZqqJC/4c5mpMIteNrxr5dsRy09LfP+IVYQ7NWsKIS9zomlaDJauk1NzQ2lioZzYFcDdF7EoPUoy+W7Er86c2bwge++7Ay8cGIZ76P2YBUd8y4ziiWO7nAJJ6M5lAs6vO02xHMq0nkVZV7AxKljh7v7w+F35Tt2bqoutYQSWdhjXpyKCe98UdlVZkcrke3D5YlYz2RlzJtYFgShLqKR1TSuMWghiq0GPVd7y/q8Nfyup3d9rnhiOfSQehQ3yTW8bpGQ6aNNttuJfdEmHJyxwUfUX8oX4bJYwAWGyEI+cfNge6A5UBMG9HH0VSMwk87GMwxx2knOxDU8Wr0OfMinmwdPTB28f/J6AlLQyGkKlxg002qddUK4DEuls5zez/b+aKjLsXB6YBv2OJw465CgOyUUWBClmgUHzs7idy+dxGun4jg+l0GlUsU7el1NQUtBsFEJTxda8eeVAUwzN0JBjmFnFPfSltOfOQ01Zhf0OampvzsU0jm/iGXsIsZpYKwISUgJDYVg0frbl/792Az0bGVzM4pBJ2pE+ZEJHX86uIQq+WMTSX0iuYKldIG8tQjRYsN83oRjSRNenNSw+7iISJG6o4EuYzERa014pC8BMTqOpSic7a1t371aU7/RRwodVSZwjaysn3nzraXk71+Y+qv7NvnjsijIR+MSgVlEWVPRVPfDgkjbjwmb2lwo1zScnadM6XYk0zXMk4+KZzV4RCc2ryvB76vQ3ilgriyhpjFsWNdTWj5ydA9j7DJA+pvZEqFzN6+YM4JbE+FmwzAtPJWM/XCP44md66Q7XV6E4ytV2IlZWqWEmzd6MRh2ImgtoqwoiC8zsuXko+jzoNUMRyvHNurMdE0kRlowzWX8vNAAja4u25djA30b9kUXchcBqhew7p2TFC7qJIHUQ1Ov1ybZpBDkUWK1ZJKrxXLmZMI6466aw01uE1ootrTqGAgk4CAg1gUFGywKpRWYqpjxi0krXl6wo8cr4sNDOazbSUZxir6jMnwzsIT3T3RjLudcF5YcrxDThi7NUH03Hl81VHW3Z4PKdbrbCPAs80FRBK0KzsyKprrzuWrOIwup/pDYGWjgQipaxabFEpxOhjFFxJClhjMRep0VCWAZt3UU4Q2ZkIzZECzRuu06wmYd2zIaJnxWLZtOHWN0d1hPzFpAmmGiLuwxVgLlQpUFmQ3tEPgYVxaTmWdks9gVVXnE52i829/W0tco2+Tx6ixGkhIemXNg9LMruM9RwSdpDXobgz+sYd+oFeeoKwLtZF1KAvbEmzEmbYSvulh8/tDcD4v5lXr/apdaSdObbKubdhPdu9k5eVjU2C1MZl2wilbRQVmaYlDFvceSh3/9bGrPEam7/G1zP6Y3ynjsvgI6bxVwwG/FxBKxj3z41LQZHl3F5kANjEzdyxN2PLQ4CJe/BaasZr1la/fHyjVVuxLLTBfRvw7KDoU385Kwg5HMM4t2ShO1RW41pQWJkbmcZrOn1KWaahr0bWkecl0nrhTw4J81PHeI/FTJjh+tq+KWAQUTI3Sxs8BGjwa7UoRdMkGWRDR6JDGt842kQ/UbgaL5/G2yodaX+10L3cE28SKJKGN25tW7yfWswKdnuZ20ysUszD7bFM+I/sWRJ3Ouhd/M2IeqZyXfe7s17LreBF9XEE+cnsBThz34sm8ZzgrHMbURTS1euKU8DlTn9o/vXf4GaZn61hk6n6V6g4d5HnauwMtqLMVcyNJ3s9T2s8gzhWmaR18p9a78B5uzB2xbbe021rU+PiNs+ufLbgneT6H3s8PkCkbx9VeO4CT3oZcm8PiX02PvmfuL+VvClGYotXntwwS2eotxBZ9yHpRI8uLmVaRIIrIszZaZXWCsAj+XeZBIEeB53q2nS9sLM/9IT7+unzI9qacacnfLA+925yNbHzsy64nnrM13btDKU5WJhb80RF/V+vVCV1MQ57eO1c31wmMP5qfDXYYtuMbzFIJYpsXkIREsgd5T8VbFVCXgOvWdZhiy+uQpX6QhETrQWlp4dYE5QnZLvnkxUNpeCyjrVYlbOQZ62h+vZ+H41MxlJVMN+l97kJJT1FZlwcsF4zcqnTNTIc2X2NNgumvZTVHAvahl3nCL9ouqwy887DFf4SGB/j8/qngDmH7JXPwK+6NtTdYva4mT07MXqrS2ZP8P478CDADh8iVZPPXV5gAAAABJRU5ErkJggg=="             ,"floppyDisk":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAEg0lEQVR4XqWVW2xUVRSGv7l12tIZytBSMRVjSIg2RhCEmJhA0MjtwagJPmDQ+NK0miZaiA+UCBgMCCUBYoU0qEgxKYlaRUVsFa1EUihMh4ItRTQSLO1M6fTCXM5t7+3JyeTEQBswfMnKydpn7fWv/Z+dHA/3jsAFH/cOs4HxXCwAtNYfjilAc3L3nVPnshpQdxs1NTWqtvZNJ1+xbKn65KMPnSegtm/booC+nIgnZxHqZG+K65kxzjY3sOH5pXh9PpSUyEwGO4FcPmvVi/x0opVkcpj44AA5GBsbJRjMt9eu03H6HMdbf04B01yBtp5Bui7+Sc93TWx+bAakR0GCZRgQLEBmsxgFU/j9Wj+vffoFDfv3ANDadoJgno9HKh4lmx4jY9ftqG8AWA6c9JNDKQ9SSPLtKQZTAp+ZB1KBJ4DHVKjAFBZt2oWzc9lSANrb20kkhujv76enp4/q6kqi0XPYdmGf4CCQ51p07MIA5y9d5kbHUerr65kIn8/Hjve3UVExx7HHnp6OjjPE4wnCU8N28yiN+3bTf30Q0zQ5eOjIsNfdDEhdcifqNr7D3j17AZg3by6lJRGKQkWsX7cOXdOc5teu9TvNAenHRaEUDl1dXSiluJXOzk56e3uprKykqrqKq3//xeYtm5j3+EJGksN8+00LALY9AK8Cv7gWfd89QGf0IldPNnPgwAEmIxwOc6T5EOlUilTqpiMCOB8XYGAwwVDiBrZIGihzLZKaRHglxcXF3Imt7+3ky5aveaNmvXMl7eZ0d/ew+4OPuTGcdE6QA9ci3QtSiskscmlqamLNmjXEYjEaGxupra3FME3OdMao3LCT/e++RY6VAK5FX53/hwuxbkZbP6P+8GHulrKyMqSUpNNpNuxrIfrj57Qcdix+EBh2T2AIhWZYBBcsoa6uDl3XuRXNUvgR+P3uNtauXUsmkyEvXIrP6yGe1gFut0iZCl0XhIrL8UZmUWQXW0IipHLs8vu85OkmocKga5/X68W0BDPz88jqplNj6dbEAl4TJJLkeMbZGDt+EA8+iqdFKC6ZgRDCDhMppB0WCoWp6cQ1gRwZYsnqKh6aOR2kMckJAiCFACXoaz/KSysXs2LVc44d+QWFAM7k6dRNRsdGMLQs3bEobZ2XSUfmcuVKH/PnViClObEAKCxhgZRkUimeeXa53TifzZs2MpSIA7Bt+y6SySH0bAbNjieefIrmY6cofKAM09Io8CuENomAVKAUBH0AOFMX2PFfUjfHMQ0DgMj0UkJFYbuuwL2KQS+34S5ZlkBKO0zhTCeFwDQtEvHBnP8Cw9Ac/6cUhSi7v5xQeCqWZYIynPV4VhH0TPINLvzWRoAAaUtiGjrZTMa5fsIS7q3RtSzTIiWUls10fi66rjlDGbpBQCqkHUqICQUWNWx9+8zTL7xMqDhC+ew5nDt7mvLycl6vrqJkxn0A9uRhQqGp+P0BRkeG+eNyH7qmUYQPYWgYXolyDUMBbuYHFgKnuAcenr+YS9FfAV4B2oAxRyAn5AMKcxFw1/8/CjCBNJD9F+Hva8TmTxPaAAAAAElFTkSuQmCC"
             ,"category_f1_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBQ8EG8PrytgAAAY7SURBVEjHnZZrbBxXFYC/mdlZz+5m316/svb6lTg2iUmdQmRXkRzZLQ1viAQqAqkqCIQo8IdH1aoi/KjgX4uaqg8hgeoWCYkkldISueC2aeokNGlaGmfjOOu1197N2k423vV2d8c7OzP8GHvsij+I++vMPfec75xz75l7BTbGlYnjqPmCCRBobuf/GxVKq3k0dZ2ho08Im7O2cP7EUybAP5tmkRQFEXFDY8D/KBsY6KrKaH6AUrFIOOIVBkYexbEJkJU6xiNJPJ7AhqEE6FRKKgeTOylmLtFYczKVXCa8Zx+NSo5lNcLVz1fwBbz2ehSFs0qcLyh9m5URhM0M3mpdwOXxbARm0H+tkUrqFH3RfYSCMr7IDkvnqkeKuTHlKIKWxpg+x7OPTxD94ndJjYogWtlVVZXRpU7yRQ0RyoxHrm8BdB1t7EOCuUWCvi6L6XSDq94CKM1WnbU0eqqMSYyfnzxGe+YsgaOvgGEA4FQUXvdexSMbiODGKSt2Bo7j73I4JDGbmiEcVAkFZQJG2d5aXc0CYMpRxO7dSHvaMKbPsf/b91O/q0b3Y38GXbdAHg+yUmftnClJAOR+8QZD+yNcTK7S2S4SEWTLc3DHf50jQUvbskkMYVeWd1I1HqwVyf3y77ZOUgIWRJAkksdu8I2vdWCs1WgKhAEo1LzWXrjqLYOYGynm3gLJYUw5ijTwFS6/kEVOa1xxifyqY4VKSd1YpVoQXVVRF28weeoyB0YGaA8Z+ETYUSfYACp30KcXrKoqi+ipsg069cwfOPH7SZ78YT+9TW6uL5XZ99u/2MGIAJd+cIqVQo6JSwXeeHmCAyMDBNoCRPxh8ksrCNlVK5M9beipMqLaitQ7iKnlePw732f1xXf5zZP93PygiOTbTW+Tla2aXwUUu5sguwbA5FicF54fIxxpQzh0kIBfRNDnP1UyU44y/uppHmt6iF8Hb/PQT+9DcLbgf+CzTM18xNlFgQa5RN+bXkC1mnETQLOPlqjA+Mk7jJ98msMP/IOd7RHuGemiE9BTZS6c+zcnnzvN3qrC7156GLOvg8rLJ6DrANW5BfoP7efjcx8Rj/tZci3QQz+OisfizOsio5KGN6XQHXUxHHMw+eY0bzPFKy+9zcjn/AB0OA2e+tEIzsODCOVGhG4/dYe/RS3xHgALmQi9TW7icXB4NQAcPl1iXt+q2pRTJdbsZK4K9462oU1nGY45uP/BQ2TLCg2BIK6RQcy7VtMZiRnEVqgrNlFKXQTg7KJAX1+Bt4pWCzg0dR2AdsmwQalsleGYg3VgcE8z60BqTiPa04w7aGJ8cJ1yPo+7049QgPXpaczqLZLzZeoqtwGIx/30/Hi3BQE4OHQvy/96n4RukbsljXVXhFuFHC3+MILQQUnMwOxtZmoRSqIVcc+s0w7sYsFNT0OS+RTMVUVSTpX6+8p0FhUL0nHsMywfed8GbA4j2ApGmUz+MrXwXnp8FdKlEteSi7T4w6yElvnkrpfW2jzXSl4WUiJTzhp7qwo4Acm51Yw4nXRHXXRLGgldtjPK3lmws1meneJMMm8HcGE6i5ZRuVXIsaJ58KZEXltZtfV1z34TU9/WjKauE/3rI/aCbknjViGHLNezLO4C4GoxxIfFEJp5g4m0CcA7qRqpbJXJyQqvSZZHOa1xIRYg0lCPIG2DaKoKOGj98iN2NhndxCREo3GT8bQJrSFWCjlm5qqQXSORrthOtajMfPoTenFwRjfofearlveqjpovbPy7NBVd1zG/B5GhL0F2jZ2SwNTCDBndZKWQY2XqJksb8M2+SqQraFGZRLpCu2Rwpn4HD5//iX1tqOoaJU1EiJ//o5lZuM17LdN4AmEkCSpjWXKvn7aibfbZhyGRrtAddZFIV5jXRfvYz+sih179Ol3tLSBJYBiU1tYYXeraekhcmThuqvkC45EZFG8ASZKQJBDGavzpuec/5Wy7TKOPIy8eobGh3r529aqOWi4yuLgLj2wwdPQJQdj2JDLVfIEzoSlkpwtp08gwkESRGiIODHTDwBQdG01m2PM1RASjhlatcOTuXgD7WSRsv+3+9vTPTD0bZ3g4xMdr9xDwymgooBaQlToANBRkVNtm+7emrlPSRMIRLwMjj9q+/wMharssRMjy2wAAAABJRU5ErkJggg=="
             ,"category_f2_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBQ8JC2vypPEAAAU1SURBVEjHpZZtbFNVGMd/96Xt3WvH1o1269Z1Y6DAdC5MgQUmCJgIMRgMStSQgAnBGKIfkPjJRYMvQCQKRjFICC/iCwaYYBREXsaYwtxYEGRA6Vq2dRu0u+tcd7vutn7o2JggTn2+nHOee8/5n+f8n+d/jsBtdvqbtTGANFv+bd4+IIHRWR+9XSpqT4S5z74u3PIOdbo0Lbb7s41QWotoUpAQB79EYZR9nSjRsMYjgZkjgASASy5PbHxBHgAdne0c7HwNSQKQAP0uLffoQ0QLU9Y1E031MX3RWkFY89bq2FNTF/LwnOkjAq+r3ctvqQf41yYKgEREC1HsfjC+hWzL+Ep3sAuLWSc5IxtFlgHIzp3IrvVHyCrp/3cgMUCIIckyXqMLW48dyaSEKr1XzzM2p4TzjRcwKiIJRgVFUZg3b8H/ABLQo1GsWinijZ4IiZY4H9eu1FJT00Bzq3fo/w3rP8biWcR/MwklIYRUPGVKZbbZTlgSUJIF2m+GsKQaUT0BcgpyARhfdB9O83wuBapGv74gENN1crQJSNb0nMqQEOLnmmMkC5kUOw2Ek3Jp8fkwjxmDnKigyDKKLOM0zyetPZkW6fyoQCIDOnYtB3FGxSTqTxxDCwapPXcCdzCZiBqEgTb6+rqhTxuaZzaZsE2cjXrQNrpoopCkmxCfnpbL+g+3AZCZYgCgydMMcjbbj9TSVHeBbrUbV6uLy9e89Hv8vLJmHQ2fF40inaFXCsdL1lB2iMPHDiBLY5mQY0TMtOI6dRKptYHNe3ex+6sDBHwevB1XaPT/Tnc4zLrVq2jaZ/sH2gEUZAA9CufYwoqteWx58Tvy8wuxFjmpr6vG43bR0+HGnLcRY7AaR/okmq9epqamgevua1x/H+a8qoAg3AES1wDtlvjEh6IksHKbk+ZmF/u+3k7plBlMK6mgrbWXqm3voZKJyZZC2NdDaaGJisefpzfQy6alZ7nfVP4XPmIMYiAtf+axyvb0TmRZHqrWsoVpaE0FfLt/J/qAn46gSuOZajoDN7DYx+EosNLgCfLko1MZa7Oyc9eX7Ntbx8pHX+Jm8uUheRno17HrjkEQcxuywRAHGbSiCp3ycS9RVbUf2WSi0DGJxjPVtLhaSM/MRvP9yvc/HubLqh9IlCMEbqr4wyGs0Scw5F27rU4ct45LumueJ5YfofbYHvxeL27vRRY8+QIA726opN79BxHjMPHl08o4fOg4ZaV2IhcW3UYCIzm5m1VHd/BR3XMoqanUnjuBT21BCwY5/tP3OKN+ss12rrf6uRka4NDBrzhb38LiebOwq0uHM9mgmEZRvVHe3FfOtJIKAHJzMgBIemgWFXNm4cybyKrli4mpCuOLc2iqu0Bx4SRmm9fHpx/54p1Yk6OWRLN5OCP+Vl1FGvYU0uVvZ0yGlQmO4Wt6SsE4GgOd2JIhy5iFyZZCQoI5TsbKJbMr3QYXxoREREkcQf6dEcWwTfbT35bBji2fIOhGwpKAJS2Ntq4AV88fRzRkIScNkGDS0XwhOvs7EOqPbo1pagdnx54m0Zw+eO3eS4/iu7B4FrFs2YssWb6K9ituAAoeyCQ3azIA+fIAUWv68EOi/ujmmP9GDxftp1BSUjAYDKPSP12P8ukyL1PnzqHL3w5Axn0lOMJXSXJOJ6IGeXnF0mEtqD+6Oaap3fxiOYHBqCCKIjoiEtF7tgAnN6RiLXIiX/fSoulYi5xMcOTz8oqlwognEcDF01tjqq8jPlDMGND+MZoICgY0PqhyDfnGZFjZ9PYbQ2v/CXD3FEIkaI2ZAAAAAElFTkSuQmCC"
             ,"category_f3_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBQ8HH++rXQIAAAYISURBVEjHnZZrUJTnFcd/7/vuLivXZZdll8vKKkrIEmS5GrQtOlgZFVNb09APNSaSzGQSO+2HtJ02zQydTGfSD/lmpxPrZKJtQi+Jl9ZLHa20TTU0CCIqARR2gSDgwl5Yln339r79sMhlmqat58uZOec8z/85l+ecI7BIPeeOIMsBFcCQZwHW8L9ReIVtGP/kNABb9r8mPLQQAJp3VvHcri+p+Wst/Nk6TIpej4gIKLCK8zmyZZ2CQkKWaZarmPUEMZkzhKrGw2he+eYe0gWP2pQa5eyli2R9pwaQgMTncL5At8h1Oi7q+2nCgewPqIAgeE58VQ1MKnS5Yqxdl0/tpmqO3HyAuifGI5GY9CoqyzS4C5Kik1fj3PnMizM1nVBA5a8fXedrwhjCGx00pG3+/0EUBQCdXs9l63ASJFNIkJqWTZ8mijE6gDE6wCeuSZ5qLGXT4GcI7ymPDCTp9Wj1KYhipg58yXj7ggZG3AvkqAKzPg9dfd0cbrDxzJCJLwe3PlL0JL0B0W5UmBFUlLkoqslKQW01AKPXxxlz3Wf4UgeWVD21lXU8M2R6BBgZ4d7bLerIKMx6J5n0Bii2iFgLsskRzEwhsOB7AEBqdi7125sQyjfzi3fOEPnK9H+/Phpll9+BdDfka3vtgJOUnGIWYhLdd8bIJ51IdgYpnk/Z4iwiw+Jghjl6hvsJ3f4jexvWE37vGvcduYii8B+rLB6Ps1E2I3b1R+i4MkSJaZT9+4s49I0qvFlaNtjWkm0u5cOTPQTHu9lavRNLXMehH3ZQWf86QbOBV2NOii4rX5h8AOnyiZ+0Pf2z08zcvUeeECCkE3CNxunuvY0h30xJQR49XQOMfXqebdUVNO7exqhrkqsnO3nz3bNsCA/y4oN5poR6gpbgKk9ikTgbo2ak1pbGNutLVk6/M8jOmlrqHtczHehDl7AS8AcpyM5ALMgnIRXhvuOmpngt5XlriKSK9N7zcN6rx3t/CofSje93PahNFYsNSyChJMMltbY0trmNC2y17eL40RNUPmmjxFyE2xul+1YvfjGDdBaoKHdgsRcy6A1SUlpGXeUmXt6RxY7cKJkNX6eze54q+zxbEyb6Ts+jeTJzKSdSa0tjmyvDj1ASJlVTR/uRkzif2EyaRiBmyqRYVlhQAnhHZpiem8JpMqLJMnLh/PuEPB6yzaU4HDr2NO/DXuSkt/cmB5rLMP6+H6vtKTTCAtJLB3e3DacF0Op0pD2WoP3tWwRVmVfePEqloQxBHELSKsiShdvD41hiKmlaBUuxgz6xkAVviFu9LqZGp8nK1FKWX0hCm0Pu3mZsmXNMBaKIMTmy3GFVlR9d+jaf3Bhm9+56FP8N7JteJMtWQ+N2OwXrSwgV2+l0DTHecxFnbghffJaAQYPXp+IXy3C7Xdy4eYGBj3/FvlfbkzUAIEjSUrKQJJ47dYCu/gi/PPU+BD9g3j/P3QcqewuipBvSsZXXMOJeYOhv59CHZ9nuPIimxIrffZxIUZQPR8Jcma2j7vX1yyBEo6vrW1VpPXyId6+HeOuDu1Q1N2PLLefqRJC+U6ew5Zbz9A9+vHTEw98pN39M54iPvsQWLN+tJbLNs/xPWlsa24b0HlJSU0FVlzxKeyxBzL2GX/+pk5ejN1FH/snMhm+RZYxjT4nh9XcREtcRzpzjSscAaulBAvty8JsDyakqCMQXItg8ejQAiZhMIpFAkqTlnyqpOL9XiM+VwrrjI7Q/X8EWuwFtYTXn+v4AQF6GgbDpBXKaB5hQJkABSRCSg0tRkOVQ8s39146pE2Me/pE/QJrBxMP0rKTfHDhLQU46bz0rMTghYK1wcPTYNR7/afOiRRyS710KeWhujh1TxcmcOLa8IJjMGTR5Sgj5Z4muzM8i/fyN7+Owp2AwruPMdfjIZlwBwCqARDRBaG6O+vGNS1uLsGIlUmU5wAXjbbS6NUiiSBwRDQoJFMQzYVqefZ72wG+RWNY95AAJRSEWDbPL+8SqtWhVn+75yzFV9ifnhFafsiSPoU/KkImhR4v8b97G0IMcIBQTMZkzqGo8vHT3vwBiE4b/X4TuNQAAAABJRU5ErkJggg=="
             ,"category_f4_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBQ8KNYG+6pkAAAVgSURBVEjHpZZrbBRVFMd/M7O7s92y7ZZtty5FWqpou0LVmgitSAAVSRBRMT4TGhMf0fgKGr+oH9RgqjESXzFGfBCMBuIrvh9gBaTlUbcKgjwU2nX73nZ3OnY7u9O544fZrhTxfZKbc+bOnPO/53/nnHslchL9+HkMQ7MBAuFyoID/IqneTgAaVz4oTczljdZ31tgA7eE2FK+KjAJYMEnzFzYILCwjw/yxpQwN6gTL/FL9RXfimgBwe1V2hdrw+YqOC6yeoPkLO+fj9rDL28JcFmGkNBuQpIkMojPa8fpyFAmb/yyyQ46ZyXD2sXpnCtLsLt/2rwAi3gup3F/H9I4KlpXeNfllzt+tqrSH2yZAfEjukwPsXL2HVfF6rm0t5tA9n1H4Qjer4vXMjcZYLGks0I5QNrSNtlv2gCz+AKR4Vdxe1dkTFxKqPQVt20x+2foe0wImt195A6tWO+kWNi2hubqYjs8/48X33gRgXnUJfd1JLgGuWziDLiGfNGvFG8DVE+vnjivuxfxiN0rpEKxczK/9U1FGhrDPCqBU+sCMYwORyirOralxvJMpMoV97PghxeWvf8NzN17zJ+QauGIZ1eFwvgpMA6AI8rb4dD/p9ihfjY3TmQH2xQjJfgaETp+mA7BmxWwq99cROvY2hXKAva5iBpd4ciBe5HmzAqy9/m7Ezu48tnUwhvikh7HXt/DR9t083pXkgz06/V2/AvDm1n1UqXBz/XmsPLWQOdVB+O5LOnsEe46ZLPVY3FrVSKz5F8BAan1njR2d0U7HXfu4v/EM4qOjpD0j/Nwv6E3EONgLs+uCLA5UcMHsAK7T55Np2UTomSgXF0CoZiblxRKlxT4GpVHGB4f4wS6gIjiFl65ZxPfBOQ5Ix8woqqpy4LUijqx7mVDNTEKVUFcyjeoqF3MK/U7phWqdNrHifMRPh3n20bdo2RcDoCYMlVUeukf9XHHuDCIlZ6BkezkYWf57JkYmS8UbOivOKqE37SXsM36nzxPGFwjAVBt5XgUAtns6khnP02wHLESiHGVkiMzAj+zo1ln9wnbWv7/W+YUlRea+hgewPUcxdr1P2GdgecKITDUFsyRUVwJ53jRs93TIBTb2bqD1sI/hYjdTZYEtlyGJKInUOANCJyIVcdPnl8IYDgiWiW0OIdXqeHwNyOlyhK8fpdKby8VZvfjpMGM7OokfihH3+ElI4zCS5YDQqVKT9GUDGLbOKYEg16/v4JHbFsKYF6eCFDe3LHwAsbMbpdKHVKs79TFBV1ca8UkP2ZY24odi7HVlOTCcpHdYY0DohGQ/nRno6oxjpQRvfPgtzZuX5IIbTia2JWh45TweWv01D192CmqoFqsomOfXzvbQN17N0aROIj2er5EyCtm8vZNZy64l0pSi9ONTeXztqzRvvhRkCSvXoPN7AgqnPVXN3Ma3WfegTtGAl7jHgKRFQioAeukd1khoaaziEsopZGs2zIpNESAFSBQti9O8bEmeAUk5DgTTBNWp/HtaV7JxfYAjn27ksgXnYNgjWEnBoDSKpDn1cCA5TNMTz1Lk3nDi2feHJpkHsazjOigSkSaNSNNS6vSrWPPkKxzdsgWAqulTkM+cy/KnS2hlw9+fK6bASGkOSDaTRhVTUGR50gr2+t9l+WMBeOxqwD75iv8MQNgYRtp5DITLObv/EsY0DUtIzgeThnyC/gdD2KR1nYbEAgck0nizFCzzc37/fMa0YUxznP8jwhSkdZ3a2AX5W4t03JXINgyNttIW3G4viiIzjowL8Y+1ZQlM06AhsWjStWgSydEt62wj1e+cL171X2Vg4gVDY9SUCZb5qb/oznzs3wCTHVSIZqCsjAAAAABJRU5ErkJggg=="
             ,"category_f5_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBQ8NHmJDhR4AAAajSURBVEjHfZZ/bFPXFcc/7/nZfk6cxHEcgp0fYJKYkMSQOKmA0BGapIIJEJqmLqOdKpVu3f5gq8akskI3daKgbZqKhtiPbhVd1Q2Nlf6AMrRBCGHi1wZJYIESfhoSSJrEsV9skvjXe29/vOAORnekq3vvOVfne86733PuE5iRnmO7iSsTOoDDPXdGOw3YeFgep/vcNhlRUGIpnv76q8IDbWZx+oPtOsBFTzcm2YYJ04xFBUwzM/+1ftQOKipqfJrGcBNKLEVBYY4QaN2IBHDur7/QAXqKesm25z/iTAZUNNVMMpmibnotwcEISjqFQzLjryzhjPQXzBYTZsxgk/m33Et9eClxZVgHBOFBBn1z+rDZsw3/mo6maySmU3hHVhBWFEJKmitdJ7kV6mVbQyEA+3oG6FAKeaqlhXneObgcEgBeX4ALwu/x3/EzmRIRTn+wVT/vukiuy8Uy4VmCwTsZp0ePnqBm+ibtK3KpzYsgVMxjsmOCd0MDLHHOpn5eDADR4QWguyfEvp4B+oehcnU7JZKFKcYQdrzUrsvzygDo7DzGgnSQ9oCxbwi40JQg8ekCrgwnMRcYkVZYRIbTuShjIbK1YibFewDcuj2F3RnDV15DeSmorkp+++ePEN782iJ9eRkscFu4MpwkEnNw+VYfXotGMCni81oy3JmVW8RodIRrwSQAa9rqUcZCDwGsXNGM4ISejn623XDTXOVDOPrtZj2lXwXgfjgHIBONW4oynM7FLUW5Mpzk5MVBPHkF2J0xir3F3AveI3UvTltLJfJyg/a3O0Vqf7yf7722iZK2myybakH6Z76Hc/02qq03+FFzNVZTH6Kjhu6eEAowGr3MoZnIpVIzdsm4h+OdQZ5cVEr9z2vRr7upW/8OZfmzGIiM8tKGr1C+ZgQTNpgC0xvfX/969ZpSKipXsXl/H32XROYWWPDmpSnMMXH0fAip1MyLTV6ikSgpqxuTep9nX1mBp1jEHjjEOG42vvwd7AUFrNXuIC9eTbZvglQ6jWe61KiTIXM/sjfI+mda+dMbO3hmXyHp6DiryjR++rM2xOthfvlOL99aVY7snoeIk1c2d6AG2jnwYTu3PV18Zj2D5XYl58Ih5jzSByQAXVVBFAgpaVYutZD0rWNJYwMHznRTtGYPW5pLePnwi0xt7aLu9Q+5kdSoXdjEelcOwaIubFYrAC6HxAurK/jEIZHU9BkI2QARTCaYUc6fVcPVHCc3PEeoX2fl4NJfcbbjNI2LD5COjlNWVcFaZ5pZ2mUunR+hmnV4/T6CRV1ElTTbjygsfB40/UHHiiNmMgGSsbBB1ZlelJQSXCr4BI+/lP7LN7n463qEfBu/uxDm2F2dkctjjPScwHl8N2P7NU53nwcgpKQRM70OA0QwGU4tOU4OH/oXEUc26BoA0WiMFzb8kNqFTQC0tLTy/t6dPPfaFsKlDew60M2q9+7in+yn7/2DuPKyGLh4kHhSe/hOAOKJBLeCdyitLielRLEJItNTCcQz8wk0TzGnJA8hpGDJcTLo7qLK9mWSkQTbf7KJWr+PS33XGM4aoMoxglv0EUklkMzSwyCV4ZXc7tvG8YEQTwXCWNJWRqKjnDw7zpNfqic1EYO1zbgOJkgCvZaPeX5XIRbzEJ9ljZPnSbCFDfiEHv5mb8MmX0VVU59/Ll1VGQ3F8RRH8Ze52LFzD0OH7YROLWDo3qTxVkyG0ORBQkoaAFuWlbw8B7Ysg1lmq5XstkH+4EsjPnEBsyRm2CVm+pJL5q1/pHHlZXF2Ux2Df/wNn+59G0u+lSMfHWAsodP76pFMO3+cWG0yFeVesrJtIM6wKx5HhCmsaQvX8v7O8volvHdjmh+cMTO3qZKPv5uPc7CbBXV+ZjsLaQi4Mpk8TkRBRJRERGEm9lSSeHwCCbKITIWoKAnA5iA1Wr0RQKefujf3sKXNz94TnUzYZ6O3LYQIBvMEkf+DBppOfHra2MqOIhZHlnFn9BJWm4w9126MlUPsemsn5+zVVLnhGw2F6AVGLaSSKcPRFw1NZ3JCoTG01AAJtH5TkB15zL+7mPuRccMBINtkBotPUPVcDDXQTseFITjXTa0kkW3N/8IktKRKdCLGoqEGAJq+ulWQAAKtG4WeY7v1wMgTnFdPYbbI6CYzEhoqKiUuD9cnxgnGAmhOkbGJIawmE2lEJLTMrKoqqWScxtCyDMBDdRJo3Sh8evptvXHYOGCWDWqmkOlUTgEwqSlkUcOScNn/ZJCKJ4wzKRG5MIdA68bM79Z/AEN2uGetoc70AAAAAElFTkSuQmCC"
             ,"category_r0_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBRAjDfqAKaEAABH0SURBVFjDTZhrjJzXed9/5znnvJeZ2Rv3wuVFK+7SkhyJkixZjhMbtlxbSaTElmPEbuSaiZMaCCD0S4ECBYo2Ltp8DBAgBVqlzofChdA0Tp0ENpIgsZxE8lUXkiZFilySS3LJXe5yd2dvs3N53/dc8uGd0H2BM/POOTPzPue5/P//86g//u1f4t5eFzuiee6zD/N0y3DuzVu8s7TBvWsXuPSDimVriA8eozF7lInDR5mcnGR0dBS/cHDapPo5sXJKGY4hcRwhAwKBkqB2o2M1VOGiK/xr+kbr1U6nw+7uLvsbq7jNFY71VnnyZIPR2TmykUOMtXISrVjZ7HH9zh6J1syM5Kjffe4JkkM5z3/2UZ4ZM7zxo1ucv7bM8tmrXLoO28cP0zg+x8zcPDMzU9if6b+YjtiXTUM/a1ObG23QRiOiECWggOgJUQje4f0A5z2u8rjK90NfXi+64RV/Jf/W1tY223dvoreW+cTEJmNH58nHpmi1GmRJyr12jyvLbZKoMOTwiy+c5Bkd+OvvXufspSvc+OEa50uDeXSemYUFHnhgisYT8cV8/OCryYh8MM+FPEuwVrA2QWuNaINSCnDEaAhe430P5w2uihSFpyzJi2bxvBkJz/tRf8bsm/86fvH937q7Os1316+xsHSHDywErD1KkqQ8eHQcZYTrK/uot//7F3lmJOHP3r7JpfeucOG7G1wbbTD20DxzD88zNzeBfSL+v/yQ/bWRVk6jmZKlTazN0TpDiUKUQikDSgMKoiLGHiH2iKGP9wWVqyiLisHA0e9X9PuBwaCk6vDNcCn5/Opqh+2Vmxyp7vLsyWkaE9OMjY5gjeHOVg9V/a8v8WdvLXPu0lWuvbHB0kSLyUfmOfH+40z/fPbxsdn066OHshMjIxl5nmITi5YEpTQggKe+FGCHcw4ogQLoD73s8EFTVUJZeLq9km63otet6B+EW/12+PLuO+GNzdsrzBQb/ML7D5OPTZLnGcZY9C8/McvlG6vcfvMOV5MGE48+yEOPH+fwzyenx47qP52eNdMThwzNlmAT0BJQqgK6w9EBdoE9oI1nnX61Rn/Q5qDrMHoW55r0uhmra8vgezQakUYDkkShtUZJGMeGl5JDaln3sgsbPdjf6TB/KENshjEas7i2T+fWNW50DdljR3jg5AxjT9vTzcP66xMTVvI0ktgCLREIQ4/FoQdLeq6kKDxVFShLT1V6ysLR63qMzPDpD/57ZmZGALh+5Qp/dObfMDNVMj3VotlISMcgwRIrn/tx9/XWEwpXjr96807B+Tttnj6Z0VcK/dyRiuvf77K6cITZh44w9eH8480Z+dNGUyVJAiKBGAI+OMqyoNfvsdfp0m7vc2/jgK2NLjvtPtvbffZ3B+ztDtjfK+gclGysr/PDy29y5e9vcPXKClKktMoFztz9HmXhUES0FkQURKhKr5zyL8QG36vaevl2u8tT0w20tugPhS4/smM0F45w/NgIjYfMP9o0TBNd7UEVCVWg26vY2x2w3e6zsz2gc1DR65YMikBVBdxw+CrgXaAsAmVRsb23zuB6SmITNnbXGRudIdmcYvHgPFXliT6iYkQB3kcqF6wn/gvZVH+42w0srW/z2GwDfb2jyRZmmZubJHkh+V6ueEIrj+iIMQIx0h84Dg4cna6j13P0+o6qrI1xrjY0hIj3kRAizkWCh6oKVJVnw96mvAHKaFSoODw6SrI7y7XeRbyrfxtjJPh6oy74cTcaHw/3+MbGXp+ys48+cnySB08eZezXG/9hdCC/rVVAqUiaGrQoyjLQ67u6QvueYuBxFXR7JUXhhvgYKApf3xeOsnQ4V+dsvVaxma4Sb1mMbdLtHzC/sEC6e4TFzk+Ioc55BYgSQlQ44qOxxbnBPRY3dw7Qj7zvGPMnpsnm9B8bH6ZQAUXEiCLEyGDg6PYdvb6n36voDzz9vqMoHGUZ/r/h7xtdFoFB31EWnqKove984GBsk5HuNK2RFpI0aY4cZnR/iqXeRZQCEY1SEaUUzgdC4OG4Hr+233Pop55+H8lvpP+juccL3lfE4FGKIe0FysLTL3z9YGcoK0VVKrwXnBO8r++90wSvCV4IQQhBE2M9UBprE1ojI8zbR9DJCFVVUPa6HJs5htmZ5G5YRFQk+joFnPMEiUdjk3P99bBopg41SfflGYVHxUiIEHwEwMfAoPAMBo7KGeY238/vfOU/s7S+TH+QcHg8ZcdsM7E3RQgFtjXGWLNJNfDsDHZBJ6RphS0iVaWoGpr25hbvvfsug7JLFTxrm1scn3+I7bfvsT13jiKt0KJIkgQtgsnl5Twz3zIzh1r40p3CKLyKxBhIjEa0IoSA0wqjwTk4Pvez/Mmff4Nep0tZRUQpRMAgVLGgkTQwScbOXpvQ6pOpGYIL5ICyGeiAeE8QiMbSUAofPf3OAUiOD0LwNQIQI0aDbalnm5nBuIV4WhFyV1U454BICAGI+BAoq1DnmIu8tv2/8W8dIwSIIdLebTM22sQPPG5in8Zglmx0nK2NNZrKkTSX8AeeNBPU+DStVpPJVovJ2Rl6B10qifhKc/nKbdonLjCeQJ6lpFajNGjRKFF59SSnjbfu+egc3jm8D0QiyoPRNQirGBFVU6dWA8onFxkUnsoFlAvs89PL6TY9Leg5KJRiQCT4SLsKwFW01nQOz9HqfQJNZFBULL13mXsLl5hwoGKKD57KR8xQMirRJLl+zvg0PGk8RFEoJfflhdZCiLEWH+LrtegJPhJDJBIJsVZKIqBFSBLBGoVoQQEhQFm5mnVcwBrDi0e+THu3zd5uj62762ydvEpuHYlJiDFQuQqiEKKgg0YMiJVTJgtmKkoE0cOQM2SJALEOsQrcZw+lhu4L8NHkBU49/nP0O/tcXb7K9ex1tDiMrqVf5QLBCyKBLMv5b7/5f3nv8lX2V+6yu7PP7elz2NCn1bTkuSFNNMYIWhQ+BGKsoVInHBOlGRfqIooh1OzgPQSIkeELQ43JfQb6SPZp/tWX/i3bW/u8e+kaNxbvEkMk0Qo75G9RNYhnWc7vv/QnXL+6xLsXznB3ZZ130++C36WRaVIrGA1qWMwhhvvvqIgYNW48PlHU3hKpKRMldXhDHBoHlQ8UpacoAj9nP83zv/IF3vrx97l2bYmr129in1liPDPkaYoWReUD0TsajRb/8Zf+iJ9cWuTKxXNcfO8sOydXyeKARm7IM0Niay+K4n7UEmNAFEY0QXRiUpti0DitayqL9TdjjDjnKUtHWTmqKjIYeJ6oPsnHf+HTvH3mDHfvrHPp4iX0h++QJRotgkLVfO8jojNeevg/8YN3zrK2tsLa+iadh9fITUEzT2hkhizRGKPRWtXGDq0VUSil0FrwKIxWUorSmZYACkKsBYLzgcp5BpWnN6jodEtOVZ/i1379X/POhfPcuH6DN8+cRT6wQh4VPiiqytUpFCOlh4Dh23/xf1jZLnC9PapTd0mUIzEaowUtgtaC0QqtFaJVzfhK3cfoevO6NILsovwsRHyMBO/rUFeOQeno9ks63ZKn+GU+87kXefPH/8Bme5+tzR30U6vE6HFeKMqKGANS1dVWuYjzBe2pd6jGh7CnQKHrglVq+FmhlQwNV/erVQSUEkQEFWTXSFSrKJlVImgCCl0ncqhlWn/g+ZD5FT76yS/wgze/R7u9iwuO3b3byFQgoPA+UlZ1IYhSRMD5WgK6IR3XbAMh1mVQS8J6RSlBi6mx+5+RRUWU1mgtxCirJnh1USfqg0YboopEgRAqYqwoXeAx9zH+5Ze+yN995wfs7uyTZgarUz72sV/kgbnjLDz0CIN0j2ZvBBcthydGoSgIIULeotpZQ2xO2pjAsQdJTn+/z+7aJv/z0lcpqy5WCyEEoqj750SlQAuINsTKXDS+DK+Rhi/HUOG9x7vAoKgYVBViG8yf+ADf/pu/pLtdEFH0O4FGo0WUPotXrnDp0kVGW6OU1YC97T0OjY1jkxRXlAycAzForSiLHkma4IOg6OH6geSBafrdDlIVRPF4huEPEas1QWuIgViG10xzJXn14KHya5GQ++Apq5LCuVos9Pc5e+MdJloTpCM5/aogSXP2Oh329vbY3tyrRYk1OO8JbsAtLK0sxdqMYtCj3y9ImxllcOQmIQEq5SmDo53cZLTh8EHwAcQLIhpRCqTO4+hVP79tXjWdXoVU8jpWP68FEqtQShNjSWJKboy9wezahziipsmzcZSLlEXF7anz7GftmrlUHS49TMRNqR8YQn3MEKnzlhgQEbRWJFbTSBSpURhTF48xCq2GOkNFEJCS1zu9EtPe7TPe16+g4/PEgKf2JgrEgLaR5ekfU7VPcbh1jBgjaTbKyLVZdg+vE0JANKRGsFZq7JOa+vhnuiXeFy6iIlqD1o4s0aSJJbM1lhrhp1Bl6v8KZXxle7ePnj82zowdX4yT4TNB/FFVC7yaKqMjRo8Pnm1zD7MzQsuO0cxbPLiwAHc0W9kdjFYkiZAmQmIVia3vrRUSW4uV1Op6PhXytJ7P0hrwM2tIkxpXE6tJbDJUceaMXtL/7s7tTfRjx0aQZot0Rq+ThC9CwMdApB5K1H1a207WYXOMkXwEiY7Z2eMkm5ad7C5JoslTTSM1NDKLtQwN1VhTG5qlQpZp0kRjrSKzmixJyBKDNUKSaNLEYLRBdIoqkpd3ltxiVnbRv/nhOa5t95mxE4tySD0ulke1ouZdEYwojNFYEbSCnXyN/q4hjykmS5g9Mgcrls7I3WF3T2ESITUam9QMZK2QWiExQ48ZjbVCPtxUZm09ZwxaGxCLqsw31VX9e8vL67z0+CTm1INHuXz+FmvrPR5pHPp892TvJqk+YURjpcJrQ2o8zkRS4zBS0tEX2W9PkvuIKgKzxx9B31W0T5zFiibVui4M+Sn7GF0LYS3UVa2oQ24TRElNn0qBMgRnbjWXs89fWNvhxETCp+YPoU9/4hQPT+a8fWMdyUZIJvU5SXhJa2ONqSvUKI3VUp+lpO4+bWe3ObhhUH1Py2bs7mwg+w3SY32aicUYuc/ptReFJDFYbbB2mJvGYm19QtWih5pY933XfH5jqVruHuzxBy9/hJXre+jPfnAO7yNZDFxZ32GMsWU9LsuSqV9VEpWKARlqTCOx9pJERCLlxCZb6QqrZpH+1C7p0Q51U602LrWaLNEkxpBYQ24MmdWkpp6z1mCsRevaSOclxJ79yuBi/PbtjT2++Nw8CzslP7y5h1GhIklz3jczQqfaY2lplZNy7FXzmIGG/5okJlfR100JJ2AEtKHVSCjLWmHFGDEmkie2NszKcHMKEamjoGq9KaLq5q/WaJMAmhDAVbGvevI71WVevbXe5tlPPM6njrX4znfOs7VyCxOKLk4JSZLw0YVp4tImt67d5aSeezX9mey2afmvi3EnRAXEeLJoGUkj3sGgcgTviSis0SRaMKbOS2sMSiuEuqGh5D7wEaJHhUjlIAYhOHOrPJAvF5fCG0s31/nw09P81lMzvPVXP2F9dYV7P7mC/tmjGQ0TCEojWpifyBj0ely83ablxpYP+8YfulZ4XFn1qDWCFSFNDMr4urOsA9pEjA0oHQjKUUrJwPfo+QP2XJeO79NzPQahoFKOwjv2XcV+6Tno+m/6Rf/R1cXe8t2tA5595jhfOTnBtQubXLh8leU3L3D7jkL7EDlkHQ0LQQxKDHNjCa3gOHdjjf0SmgPzjarhzjnlHy6ojhaUtdLSgaA9QVW1qNCOIjq8cpQEHOBFEVVNc0o0URl8NPjCnIk9/XK8qn9v+XYfQs7p0x/hcycm+MfXF7mzss7Opbe5eFlxXmvUTDPh1JEmnzw5xskHJslHJxkbHWUs12Ra8cr3r7AhmiPHDzE9qSkfdC+aLL5MGp6NKuT1kbruANZNC4hEjBYEVZ/PGY4g/Viq18u+eqW5kn5r/V6frf0B8w8c56v/5UX4u7N8/0fXeOuds/zwr+/gRLNkFBtaakMBHp9t8YUnp5kYb9GaPEzaaHJoJGdmJOXGxj7ffPcmbWB8qsnkoYSREcX+rDuNic9pyyljOIYwHiNZIAZRqjRR7RLUavTqoq/Ua2Nr5tW9TmCzXbDXKZkct3zmc8/y7KMz8MY1/urtq1y/8BZv/u0mt0ab7AXPlq+P8P8EiM2FDHOIeJoAAAAASUVORK5CYII="
             ,"category_r1_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBRApKTxsJfoAABF+SURBVFjDTZhZjB1Xet9/3zmnqu7aK3thk2xu0pCiRGmGniVWIMkzMhLFiCmPJRuwYXnJQ+J5yZuBAEYwmPjNgOEEfhhPAgQD6CHGZBRkiHicWJFnKM8MrSWUSJEaSVyaFJvd7GYvt+9+q845Xx7qklYB51ahbqHOd77vv3x15L/8wT9nY69H0rT88ouf40zD8d5bt3j3xiYb1y5z9acFnyYOObxEbXGJiYUDzM7OMjExQTjWfcVm9nmbymksSximxFABokZyIi0CayHXD8IovGFvNl7tdDq0Wi26m3cJm6vsH6zy5PE6E4vLVJozTDaqpFZYvd/n+p09UmuZb1aRf//LT5LOVHnhxVN8cdLx5oVbXLp2m9sXP+HqdWgtzVNfXmZ2+TDz8xMkj3E2aza/4ermuSRNqtZZrLUY08fIAJGAqieqIQZPiJHgI4UPhFwHYWjP5139dviodm5rq8fe2gpm8zbPzm4xuXSU6uQ+Go0alTRjY7vPR7e3SVVwVOGf/YvjfNFGfvjGdS5e/YibP1vncu7IHltm7vgRDh6aofZkPFud7n4zbUyfqVaneebv2tSM4Z1f34+1ltRmBLaBLVTbxAghgPcB75XRSMnzUM3z4oVRgxfCZLjo9uRbU1ceObc2OcuP1q9z9PoqTx2PJMkSaZpxeGkKcYbrq23c2Rce54s24b//dIWrH37E5Tc2uTZRY/r0YQ5+bpnl5SbJk/r96ox7qdGoU6stUakscLLokiTC5x77KtY+hjEGEQFAtc3/vPPnaPREHRFDTlHk5HnOcFgwGOQMKpyxtfCDtB5ea1ydfvlu4yS379QY3VnjmWwXax2JcywvTCE2xX2+ZvhvF27w3tVPuPbmJjen68yfOMLyySXmnk6fay6G7zan3ZFmM6VaTUiSOl8//K8x/o/gkcPwV29B8124dAsaVfijf4fIJNZYMDlgIUnJMkMIllrNMcotg/6AXi/QS/xLwzOjlfnD+vvpu0vnN24Lf7+yyfNZRj9JqFYrHNhXx717c5P1exvsXN5kdaLK3MlDHDu1yNyXk1emFvjO1LRWGzOQ1SLGBEQsxhj4V1+F//1zAG7duwOhx9wdSx2Ay8Aq0AYMUGbbOcFaQ5oGKhlUqoYsSehIOGIk/o39kvk3xsy/unlb+dnKHl89VcOnGc6BfeZzc2z+/DLv37UkJw5w/MQSS1+uvDK74L47N2nSiSpktsBkETE1YJKTt9bhz34Aa+uw1yLJR8yvDUh32jDfhaPH+Lj9FjAAAuUhgEXEYIxgbUqSOjIjWK8QYhIJL7oGK7STy2utEWbUY2GyRhCD666vsHYJimPzHNg/y+RJ91xq/Hcqu8HYtpJYBWegIXAigcoeFG3Y3oY8h8wh64H7/RGDUU76F/+Dxa8ehFYf1tsUOyMSMZDaciQpJAZRcAHsKGKHHukW5INghoTvVI/pp5Xt+vn37rf4/HKBtRn2S7HHW26S5rH9PHKwQeMx++OJCZ3LaoFKM5BMG9hnoCngIxjPydNfgGaTtfVtrt9vsW4jG6Ks7nVZa3fJ77U5Um3yQXGfXhgxNJHowCUGyQTqFhoOagapG2xqSCsWdUK0JgmOX8p2kv+0PYhcX9/h1GINe6NjqR1d4PjyNM0vVb5fqcennXocEWOFRAxGgTyifU/sRx4LNfYKy/UfXWVjdYtRlpAnln5vyCj33P9wleqxOTYrXbo+xwelCEoelBgU5yMmKCgQFfGBwgdyHyhCJI86NZyIp9nkext7A/JOB9fcP8XBpVkmz9TOugYvSYx4UTCOGIVRHsEHglcKBdKCWz+9zfX/eonOToeginQHRB8IowIFKvuaxKqyqwVFHtEYEBGsKXDWkjhDJbVkiSV1DhAKX+K44iyVFAaN+FL1yeRs9UL93JXtXdy+uSmWputkGd/UTsFIAzFGuk7JjeCAoJECJToh25ezxwh7bAbf6rL4S08giWXjZx9jsoSFZ04y98IxfnLnbQa9PsNWjnoFpKSTGKw1OBFSZ8icxVlDUEMelNwrGkGKgDP6zbrIuS1JcXOL02RPubNSC2eIkagBtUJhPTa1iBGCCjEoPkSK3pC/rdwmOVvHvfgoT06dYrPVwf/4CtFHZr9ynK07t1gv9ijyHFLFZIIxFutcabfW4MRgBLAGjICCFpFYBEyEtBCKVM7Uv1Q5277gz7nFmTpZTb5hRFGNxAjRKDGCLyJBwMcSY1EjECkKz7DXxyYJ/6u4wPP6OHayxnBtl+7aFiPTwxtPCBFEEGuRJEXSFIfFizIKBTH3GI1YAUXwQRn5SO4V4xISY0jq5hv1ijvnFmcnCPXiOYugRtAYcVZInOBsiRuNEUIkKqgCKCFGYlEQRjla8dSPLbJ3d4fBdp/KkSaZ1nDWY5KEM61ZJiYX0Bbk2z1i9MSk4MOFFn0ZjhOkBA2EONZcgdQKWV2ea1QcLj8eX7EhVot+jh/laNQSS6rlSiMElKiKojw4xBrECmIDIymwE1ViYhnsDalrA1WLzRxfGR2ksW+O3qUNmldXmTCO+Mg824s1TG+PAoWinBO1mGAQQIcRYyAVW01PJa84Ff+8jwVqPbFSpiyqYpxBzTiqCKIgKg9NRkQwRlCB/m6fYXeInaiRDwvqwfGF/hzV5gR2kLLzVxfYbyzFIGfdB2YPTBJdFWcchY1gI0YMQUFD6bqlgxkyLBUvzxs18TQoiCkBbx1JkiDGYoxDxGHseLjxsA5jLcZYxBg0QhECeQjs2CGV2hQLx05g9qrc+Mu/Y7oQVrZb5KqY1HD5xjp5L2e34YkKPkaK4MmLnMKXnVbwBcEXQIFNOG1MYpbKxlcQYxBjQAzeR/IQKULE+/EIJTZDjISg5X+FJyRK7cAMvd6Qzk4HkZRqNs1Hr11goZZxu9Mhzie8c3+HlVrC6HCNmBkKDShl9sQYrDMkqSNJHKpKjAFBsakuObFMxZHH9wqij2ikZIwKYUychz3FZw4lIiLEutCLPZoz8wRrGFzdYvvJTT78m/+HHxRs5zkGw81rHZKZBoUqRx8/wnvTdxi2+/juiPFED4kqgKoiCFIJ2NROuaAhtUaRqmDFPoxLP/OwPrxTRisiWFtqrLEO200wFUcyWWfn003uvHeTez//lCQoKXC318dUUxZPLVN/ep6tYpfeoIsPOWQlL1TGbx+fH7zfJRbEpC5NU1xisIUtVzL+ZRxo1PGLeEAgy6l7EyTVCpVqFWtSKvMN6pOzLDx5lHsr66xdu0sEOp0+nWrK4Wce59jTJ8hjj/v5Jp9Ut0sNdWXr92A+GZNUADFSzucEg+CMmFxEKtbKP4qPCjGGsRyVsqQKYiypS5jYt49KUmfQ8XQ2+/iJIfWGcPifnGDl4jX2NnZ54oVfwOcFlckq+08vMBjs8H59jUE+IBaeGANIHBtrGeS4jqVJCIgBY8Go5E6QViziYt7NiUVEtcSpRkVVIY6DN2AyxzGmmby6BRu3SEcFWV7QtvDJE5tk85NMHJplc/U+i08cojrj6Oxt8PdcIY8D/FZBDAohfgZJ+rDe8hn8RwxiIKSKSWk5ImuSymI6kRAJpeeqjoFdXj84G+eodxzt4zV2rq0zGZSJJKEWAu7qOp+8c5N8ps7IB9r3u9Tmmlys3cMPRiCKrRmsAmKIMY7LLGWZoRRrHeuoUawxmMSi3qw5gn5gUnMGsZhoQKTEZvBlwEiJUQVBuTrb4en5/dzfV2fr43V8jCzWqxTNCvWDM+xu7uJV6ezsUd/2hGxIjAVaOsY4YzpWDVApsVjWfoxVA8aAcYJYQQv5wIVC39As/J7EAg2+tMqoZRcVx7b5IMMC3o94s3aVr7y4TNF6hPabNxje3WV7a4/dfp9kuk5QRa0yGHQZ6ohiNALVz2SuTIaaEosRHRNVy3hjyQcRQUVQzxuucce82jkWvhOHRTUMc2IoA+QBTsdwYtzhiASKhuenkzd5ysyy/7dO0V4rGP3oI1qdPpWJGliDyxKQgjhUYhckyliCxmBUIUpZpTKjpUQxzrBaQVNDdGZQv+5edd1BxOLOu2b2gjYEDWHsCgUhRFQhxrEYqzzUgUGvx9suJ9nb4QtmkcP/8gnk8gZX37wCQFpLyPMBMYWYfYYzUmqzs7bkqJRSZAwYIxgBm5QNj3EOKez5ToyYrb0hfsS3g8ay/YoFPozKNk4Z2+a4Pw1KUSijUSAfBQaDEZ12h3+wq/QGuyw8Mk+SJswemCWpGD7c1ybEWAZoBTHjoCxEAmIj4gSbCDYxWCe4rLRS6ywYS8ztt7daOWZ7Y5vkpp7D68Uy9Ty0sxhLFmqQcVbloRrEqGiMxBDwec6g3SaGgsmFKaYfn8c4JfoAWpJGHhjGuOuyBqwxWCM4a0gSUxqPNbjElhsdhb1YuWXOdXfaOOl02dyeZLJlv0XF/YCgRA8xRHTMRBmXBy0nig+cY4y3JMuohAa9rR5ZL2f2wFxpfao460AelFUeOo6gOGvKTFrz8H+DgBd8MMQ9962N9YLZRHFPLTR4f2OXfdML5zglr0kmLz3AaUkeA1KuEDFlxz9WBqV8eZJVmGkeZHtrg8pmm+qJg8wcWKRe3CerVzDGYh72BhYzliPrBDduGREhNYZCC3zwmHZ4Laxwrt3d5rdO78M9fvgA1y6tcHdrxKnViZcXpxvvNDL9osFgXQWb1UiyBmlax7q03E5U0BBRTEmt4BCx7P7f17nd63Ps8ByNxhJfGzYZhA5+6NEQEWNxSVIGa4VK0sQah4YClzp8v4NWHJ1h/92VjY2XL67f5tB0wteOziA//OOvk4/6fO+DdZYePcijBxun56ayN5MoU/meR1qRdL2H9obY0Vhbo9IPnn5U+kT2Co8Jkd37e9gYkWYVtFyGTRIqIfJorY4FnBESZ6lWEgTo+Ejwnsw6hokhPzDbuvlPa7+2d3l0vtPa5D/+4S+w+g93cN1eD1T5/FyV92/cw/mlD3TB/WZT+aF2cxd6Bb4YETWQDwYU3SHDGKlExUYYxkARI1GVxBh8iJj2kEgssSwjfGK5NiqwYlhoVqkEi08tzWaNqcyh1sKR/ZjU+WtHev+2+ETOt9rb/MbXjsK1Xa7cG+AkFqRZlaP7mvR8h1sb21Snqq/XD83+yuzJ6vfqWXUqTTPSrAbiIEbEJgiWGHwpzmPbMtaVH4fmAQmlLLVzWJdibLmNLhasTREjRFW8D3R6w1Zrfe0348e3X7+3cYNffPZRnt1f4fXXL7G1egsXRz28GNI05cuHZ+H2Nreu30Usr6/Pul9LqnzXpnLEWYOx5qEvC6b0f3nwwTcmHvKP98a+LWPZEwXxWu5ESul8PkIY6a3Rrv/9wVV/fu3jVZ76/BS/fXqGt//6fe7dXWXj/Y+QP/3V4xyYm8DVJqlUMhJRLt7Z5cOO58hjBzi+3KCznH9fqvGlxIKVsR9rLM0m6mc+UMZGrSAP7CxGRLV0GjEP+90QoYgCA/ta86Z7+ZO1PhutEU9/YZHfPdLg2qcj3nr/CrcuvMfaXcGGqMwknloC0TjEOA5OptSi58Pr99ltKTP33fci/j26xYnY9ftNO8d0PLKXYzo50sox7RGyN0R2RuPrEQ+eM72A6QWkG4kD8H2Ie1z0O/KHXJI/ubLSZqgZL//OL/Li0Sl+fP5j7qzeY/fqO1z5uXDJWmS+nvLE/jpfOz7J8UOzVCdmmZyYYLJqqVjhP//kY9piWDw4w6HZlNHhcDap6jdI4nNGYlWIpV8TH36UERUrBqHs11QMUQwxmgEjOZ8P+HZtNTt3a3PAVrvL0vIh/vg//Cr87UV+cuEab797kZ/98A7eWG44YdOaMlCA04sNfuOpOaanGjRmF8hqdWaaVeabGSubbX5weYUOwvS+JvtnUmYbhp39/hXj9Hlxeto6WVLHFFBBiSKSi9KSIGsa5IOQyxuz68mrW53I2s6Q3e6A5lTCr3z9WZ49NQ9vXuOv3/mE65ff5q3/c59bE3X2YmCr3OPh/wNkVB9DQgBo6gAAAABJRU5ErkJggg=="
             ,"category_r2_active":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB94EBRAtJsi//W8AABHySURBVFjDVZhZrKXXWaafNf3DHs9Up+pUuapck+MqV2zHVYk7lWADpiEBxWEKYjKG5iLyTavVSKilFrkw0LetSA1RBBcgc0MgIIKgu4ksYgOOHcdluygPNZ9Tp07Vmac9/MOauPhPObClvX9t7b3W+tY3vO/7feKPfuMnWNkZYbqKH/viQzzR0bz9xjzfv7HKyrVLvPcvlgVjiA88QGvuIJNzB5ienqbX6+GPD59TqXpGGXFWaHEIGSeQZEAgUBPEdnRxydt42Vf+ZXWz89JgMGB7e5vd5Xu41bscqhZ47ESL3oEjZN0p+p2cRAnurI25vrhDohSz3RzxOz/2KMlUzue+eIbzfc2r353n3WsLLFy8ynvXYfPgQVqHDzN79Cizs7OY0+7ZtJu8oFvqaZPqXCuN0gopJUJIhIAYIcaA957gA847nHO42hW+iK/UI/c1/6H51vr6Opt3FlBrC/zwzAr9g8fI+zN0Oi2yJGVlY8yHCxskUaDJ4cc/f4LzKvD3L1/n4nsfcvO1e7xbGfTHjjN76hSHDx+m9ah4Np9MvpJ0WufyPCfLMhKToI1GKY2SEiEEADFGfAh47/DOY52jriqqusrrdv25qlt9zvfDW3qn/+LE5ce+dXdphpeXrnP8+gKPnwgYc5AkSTl6cAKhJdfv7CLe/INf4nw34S/evMV773/IpZdXudZt0z95iiMPP8yRIwcxZ8Nf5pP5z3W6HdrtNmmeYoxBKYUUEiEFQoj/YGiMkRgiYc+zzjqquqIsK4pRQVkWlEWBHdbfDO/nP7+0tMzm7evMuUWePjlNa3If/V4XozWL62PUH37pMf78jVu89a9XeP87q9zo95g5/RAnzpxk7nz+VO+Y+s7kZPfCdGeSifYknbTbGJruGSolIghELaAEPM13I5BSopRCa41JDKlJSVVKKlKMdShbQ7RnQm/w6+lkfFv7/sLaENbX1zk2oUElSCWZ6GSon3z0AB/cXOL2G4tcNS0mHz7BqZPHmX0if25iKvnzmVZ732TaopPkJEIhkYhKwMDBdg2bY7i3xfjObe7NX+VnWxO8fPEirGyTbxawU8KgRgwtcuzQNpLEvbcQKCLgJ9DuF5M+t9WofWm18Oxu73BsKkOaDK0V6oce2sfqB5d4Z0kjTh7lwePHmDmfP9edzv5kMm8nHZWSR4EC8BG8hXIMtoDRLsPBNsvb69xcW+QLB26Qny547W7B+miLwXBMXZX4aoSsSpSrIdQIQEuBUZJEKlQIeG+NlfaLoutvye300tJugaqH7O+38EKih/ducfddKI7NMXdoju6j5inTlV9PhZDSBywVY+fR1hIB6wO1s4xrS2lrKmvZGg25s7nMG3dv8rlzfeYGU/zL1h3aTNDLurRMRmoMeZLQShM6WUaSJCglyAXIJMGmGbWzsu7UX88fEQt5Mf3q99dWePyIRakU9ckw4rtqkvaDh3lgeobWCfMdo8Q+4SJEIARCiAzLgt3xmI3BgI3BLqOqYFSWjOuS7dGQ3WqLp2ZGPPzZWbLsOJd3rrO5GhBIiLGBKG8praV2Fu8dIXii8/jgiDFincMFZxz+R+Sy/Op25blxb4NH5nLU9YEiO3qQI3P76X0y/UuTiQvKg0SihQSgtpZxXTGyNWXdeNHFgA+O0lp2iwFB7HBaVjx0YZZO5xH02ltcXIpoMoxWAA0CxD1cDQ7nPT4Ggvc4a3HeYZ3DRj/h+u7jYYVvrO4W1MMd1NzcLEcfPMzsk91nk756UUUQIZImBi0UzjsKW1M4S+0cgYgQUFmHDY5xXbIzHjB7eYFD+zSnf2iGLDtPll3k9WsVo5HBqPte9TjnqJ2lrmtqa7HeE4Lfu0RERPAxYKU/Ezu8Xa7GK2vbI+TMzCQHJifJOvor+EDwAR8iznlKV1HUjRdra7HO7oXHE4mEELDe4mPJ7ISi15ZkWQAmmJ5W/PzEgGE1ZFxVVLZugN9ZKlszrioGRcGwGDW/e0cMAWLEKIWRiqQjv9LNM0qZImf2z5Cclc9GHc4566itJYRAUVWMi6oJ9Z43rXdYV1PVNd47am8ZlSXZ9xbpdySJFkgZkPIkWaZ55Imc7lTNuK4IMaIkSCFQUiJVQ7c+RCrvqGpLVdcUVYUtK6KzyIRz2Vn1rElz9L5+lzSXL8TgETESfcRFS2UbGqz2kj1EgIZ5hBCEEBjXNWUx4PScpNeRJEYQI2j9CaBF/1TJ0xe3+atVRYyBVGsETY0KIZCiMVxKSaJUs28MxBjRRqGkQOfyhTwx39L7+n1Cyz4dPbgITnhq5xlVFcOyCb2LAWJj5n2qdN4zritm3l/kwU+06HcleS5wTmIMwH6UCly4kPNn769T7VpSkzSGxvjRhaVonkYpEqVJlCLREqkytBIkLfl0O03R9pR7ThJy7zy2rqmcZ1QWHLmxwGfPRQ7tNxw/leBP55SlYWfHU5Y1jGrkfE395DQxRASCTltijEKIXbR+jF6vx9mzFf/39z/GeFwhZYEQFVJGlMooih5KTdPvexbmr9JuDVhbKvijV/sIL0lUgtAht4/H53SU/hlnLc5afAhY5whiTFWOuHFTMRwEhiPPJwPk5xOmptoIEYnRwqMV4kbFeM0RAkzNaiIV8L+AJwnhcWCTJBkwHi/g/Q51XTE1NUuankCpVUJ4BTW/wAd/vcuVhciynKCY7ZDrSAgeoSQm089oZDwraBIcLUgjFLbFlRNz3P6nebq5ZGZac3vJ8vjtmjO/PAV0gQzSHB63xKrGmEAsPDEWwNsN/tb/HeghpaTfDyRJQKk2cAn4n2z8w/u8d63ku5dK7m14bp86TCrbdBxY4aEGmWikEmfFb3/1Z+9F/IFQO0IIuBAoasvWaMTOeJvu67eZ6ii0hHZLcv6xnMfPZJz+5SmgByjAAQVslcRBQBwyoCaA08BPAz9OI63+N/BXfP+PV7hyq+busmNh2TJ/eh/ENt20SztNSbUm+IBUEp0YbGBZ/I//83NF8C6zlSWG0Aje0NDZVlGwMdhm6s3bTHUksil6hBScfzTjkYcyTh4xzBxNIELc8VytNaeMQ0woxNEEOgmMa67+7S43Fmqu3KhZvFezsR0YVYHRhTliaNFvdWknKVo11R58QAiJyQxRyVI7QiL2Khoh0EqhZUQpyZQQSCFY/5TED7aZWtjBKEEMkTffKVjf9GxsZTyw6mi3JEYLWsJxBxDrDnG9YlxGNrc9t5cs84s1y2ueO2uOwkbcU4eQsU0vb9NKErSUSCEQCLTWSCnQShM0iU6TBKU87r679mCDGHFZQp4lpIlmRWmYzREu0L+4SqIEq+uOzf2OmSlFmjSQo6Qg7u3jfcS6SFEGKhuJAiofKFxk/Jkj9Eyffisn0watJVI0hkLjIIRAa4mXAq2kqKVQmQoRiMRIwxg+oqQkM4bpTgclJPe2QIohbQ9awrAIFFXEuWZdCBBC/OjCMYL3DftICXkqSFLJ+MJh+vkEU502mdZIpVB7bcz9TymbFkdLhZCi1jKqbfAHiBBiJIT4EXvEQMMa2tBvtais485myUSICCFopZIYwAeobQQbCQ03AGC0ANHs0W5FdkaSa16hRUYvz2ilCUYpxL/z4P3FQgiEEkglALWtRZRLyHBAKIkMIMTePyNEEfYoURCjIk2abrNQksxH8kwgBIyLQF3vhbiOhAiJFvS6kom+IstgVMH0hOIQNXdf30X91DRGSYySe622uH8sIgri3gWlVIgol3QMXJZantNaEaNACkmMAes8hL2VRDwB5z1SeFoxMtlT5LkkBLi77Nje9WzteMZFc7lWLpndp3nkVMpEX7FvUrApPZ9+NOPbbxSU1mJdghQSJMjGM4QQG3QRAikVUiuo1WXtq/hy1PH56CLBeWJs1Lb3jTggRnyMjMqa3fGY7LUlpg9oWnkDVxtbjo2txsD7rxBhdxhY3XCUZeBHLrTZP6X2lJMgy4ZsXt8m+ZghBtAufBR6QZMuWiqiCo1IsfJl2Vpov+RcKLyPWBsoK0dZOpwLOBuobaAoLINxyWhxm25LkJim2Da3PYt37X80MkDtIrVvUujmQs3rFwvKKjI7JZnqKx45bkjubTU61/nmLNdoYSLIeF+sSAgUrZvpS3JYlggnXxEKdGpIM0WWabRWP9CM0VNai/vXFXq5oCxhc9szGv/AwNpFtkaBu5+YZfNTByjrSGmbfH3vSskb7xTsjiJKwwP7DSYpqZ39SCxLCUo01a+VAGRTZE6/Mqgq1COnT5BMq4HX/peCDwQXcb6pfucDZe0orGO3GGEW18i12JN7P6juso7sPHmAtekutVP4ECkOtZELAyICowT3li0I6HY1rVwwGluWOx0SmdFKDUYqpGrgSGuFNhKpFaEUv7U+P7qijs1NMxtnr8Sp8IUowsH7Ce1D0+N4FxjWFaN6RLK4RS8XSCn2PA1rFnbO7WdUpuSmQ2ZyJIYsidgjLcT8ECVAacHyiqMsI9pIyiqyeakkHJqknaYkRqOlxGhNkhgCAuH1W/pq+luLy4toRltsjob0bPoiWfgbgm8wNEYIDUyEEAkr4/tojJIwKCJbT+6nrDVJ7DDTycgSgxIS7z3DOqG2BVufOojPI+rNFbSB24s1g2FgZlqDcKSJR0uFUY0njdII3eBnGOkXN4oh+9Ia9WuffoBr6xWzYvaKnOLj0nDmfosgRNPiOl9SvnaXA/0ACK6uWKrPPkDwbXpZn16W005SEqWQe4capUmVASS19wznctr3hhgl2B16bAVlrRFHDzLZycnSBKM00jSQJGr9TXHV/O7C0gK/+IkO6r/91Dmu3V1nLFPm4sw3woz7dWXkhJIC1dAuPgTEnGb36pjNsUL3Zuge2890p0cvy8j3jNRaobUg0YpEarLEkJgEJZoWZHNfTn1jh31dxcZOYHzhQabbE/RbLVJjULpp+kDNd2/1PnNteZmD3TG/+cR+tDQJP/P4Af7s4hIrnTbdWj9Pi/+npcjVnpoJIUfKNp0vniLGlDwxpDrBSIVWsuHyvQGukhCFwLvG+5kx9LKMwrYZ12PGT/VY+MdVZnuaJJ9got0izxKkVAQBPorCj8Xzi9vbeL/Di//1Se68vogejkYQI+f2K966Nc9JffLV9LT8suiIP5FCSGKkHVMS3QORIiPN0BbRUF2MQIN/Sv5gRmoStde87aVQCHg6VNYRvjSHloJuK6PXypFGE6XA+RDiSH+5+sC9endrjV/9/BG4tsXl5QItgiVJc07u7zKoB9yYn+cEx1/KzgpE5r9utMg1glaSEomIAM57stRAFMQYPqI9oWRTb5KmpZV7PbwQDUUi2JsSoZTCpAaMIsZIbWNBob5sP4gvza/d44f/8ymeOdTi299+l/U78+hQjXBCkiQJnzk5Tby+wfzCLU6YUy+lD6sFnfOnInEPqgjyvsAmICREH2gmnHGPHJrRTfQemSqIAkEzppFKIvZkoA8CicTbiHcOgph3Bc8XH8RXb96+xZP/qcfzT8zwvb97h+WlO6y88yHqUwczWjoQRMNEx6ZSyvGQ9xbX6diJhQPV5Fdd330cwxmjJFrJJqxO4H3AWU90IAJEF3C1x9aRsvAUI8dg6BmNHMXYU9lAbaFygUHpGFSOYjd807+TfubOjd2Fe7urPPXpGX7zZJ9rl9a49MFVFt64xO1FgfIhMmUcLQNBaoTUHJk0tEXF2zeW2XWR7m7nGzbzb7vAQ7V3B20Zm8R34J2k9mAd+EpQVgFrobbgHHgXG/CWEqQCKXASvJVvhUK+EK+Y353fWoXU8yv/5Rw/c3yC77xyhcU7y2y99yaXPxC8qxRitp1wdq7Nj57oc+LwNHlvmn6vRz9XZErwtX+8wZrPmdv/ALPtHtWx4lllxAsiCU/HGPPgQUXBfTXpQyR4gTGNEpK6EcAoAVEUoeYVV4avtRfb37q7u83GaI0HT83yld/7PPzDRf75u9f43vcv8trfL+Kk4oYWrCrZGArw8QMdvvTYPiYnOnSm95O22kx1c2a7KTdXBnzz7SU264SJiRmm2106Sc7g6O5zSJ7RRp7VmkOoOBEFWfAhSCFridoWQSzFwGXv4su9+e5LO1XB2nCX3WqbqZnAF37hAk+f2QevXuPv3rzK9Uvf443/v8Z8r81O8Kz7Rvj8G6vVoZVEm1YtAAAAAElFTkSuQmCC"
             ,"openBook":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF1JREFUeNrMV01oHVUU%2Fu7MnXl%2F5uUleQkxocGfopiKlUpAumiXLly6cqNuBBeupCAKbgWhCoro0qIbRQy4KIhdWNNasCgSkya2aqxtYpO%2B%2FDXJ%2B5ufezxzZ15m0rymeTF9OHCYO3fmnu%2B73zn33DuCiPB%2FvezJc6PkLF6uXZse%2B%2B7it6de5D6jnQS6Js59RVSZJaovEbkbtDo%2FQz%2BfOfXlx%2B%2Bc6GwHgb7JgED5OpNYIPLKFF6K5qZ%2FoLOjH7y0H4rs7ECI8M55QkpxQ%2BnHgUeP4PDI8U%2FOfPHefw6LvBP0G6%2B9cnBrV5SsxCQ8D4X%2BAxh%2B4si7o599NFTsKbyetmVG8TfVmgPl%2BeOu6552fe88c19K2VI889zLF2MnCaDobk1%2F%2F%2FmcA6vX45lSNOO0beHxp0aCfARZWQgrxyLwe68CQQ7gVvHL%2Ba9R7MnDznRBZgpI5Qqo1gnr5SrKG%2BvwXTckTYF%2BClIQbKqUHjv2%2FCA7dgMF5CMnTp8tdqO3ePAwyHEZw9ODLk1M3Fm7YPlKC1mzCkV5%2BIogfJ%2FF8ZDv6kdxsAAhM4kBTESxCR%2BLUxd6A8wrJ589HhDICmkf9b0qO8yiVppm7JCELhGU0KkZj4hLzIvg1iucGZJVkRCmySGraSNVhch2QTFRYVpHA%2BwggVKbrpQftcTOqLu8KEFqkyiHUCnV%2BCRlNJCUjhNFT%2BLeLvAAKwIytsQU7SjLBErgGDEp7iS%2FDbOnhNLJItJ40Q4FqJkCevbqHoOLsKqSfzsBEbJqkwJopoDuVH57QqCahQC7qDr7mYTbFVDNQxDsiELsIzEuRAkcmSyhYYFIYjOowRyFyRUjqllC7EMOxMt9x0KUsoC%2FL0%2Fg5uwMPKceEUiQ2XMOblNAJApRXMfz91lw6mtYmlvA3MyvMO0sBh56Ej39Q%2BEmo%2FZSuKgJAYEwLkSb7oLHbMpmFQzkMhZ8z4HDKpT%2BuIDZKz%2Fi4UNPo6On2BK8jt5tSidCsL0Q0ZakFZA8646ciULawczkGDaWShwOU%2BdKw%2BIcETsooJocySJSQXyFElucGkZQwYzQmARTQSfVsDz%2FOwx%2BNrUZMKWEZDNNyf1GOI6%2F1jnTGC8ae4GICYQg3OBBtiXhCwXPICi%2BG3yvbFSwuLiMlZU11Gp1XTP4mIe%2BPn7Pqs38OYe6d439sDrdvSj0DWLggWFYme5wVmaaTe%2F5DOaxT2NTKE3A4Ker%2F6xi4uo38Cmu2yIKXKxGmmcTHrMcVnH9hj5OakW0QwaYL63hxsIKpsbHdWLHW28YHpNVydsB5lBMQPLsf7uVQl2Zdz0RiEZucGs4t6r7psqFYB1tvrvb%2BFTN15gxATjrb%2F3U3dHqkn5%2FZBnXnU6cHM%2B3XA4O3O%2BuNwgV2B4MfsVaWNTy0KufvnmzJo%2FpX6i0N3bpwxfe5qbXwnFxhe0voYMI5PThf%2FdXcJDtYWv8I95iW2Krt%2BCDfyxQ3mthD3I6G5%2BoNTCfxdHyfv6vAAMAY9sGXiBC2hIAAAAASUVORK5CYII%3D"
             ,"openBookGold":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA%2FwD%2FAP%2BgvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wMBEg8UUkCmQwAABBhJREFUWMPNlktoXFUYx3%2FfOffOI6mZyWMCJqRSiAXbYrVShCyqrlwIxaJSRbAuFBRcSaEouHUVBUXElYpiaUGzKdnowti6Sota2jS21T60MbZ5NTbpPO6953MxdzKTOHk1afDAZbhzz%2Fc4%2F%2B%2F%2F%2F84nqsr%2FdSXOnujT0vj5wh%2FDx78f%2FPbzA4BZ7yCyxLfmMye%2BmdzRfQzEB7HkC3mGLzzx9eBPZ195%2FVDv9HoksNSJfAHQ%2BAHS6SZ27Tz17N69%2B24O9H348nogsrQDiQFSpUyVciYdLV%2Fx0MOlz747%2Bv6ay%2BItFvqtN1%2Frnv%2BXVn%2FUkWk4z7YHX3yv78uPN7e1Zg%2BlEl7aoeQLJVwYnQ6CoD%2BIwh9VmUgmPHnymVcHq07%2BywF%2F%2BIcjIyX8XOgcqoo6Ryrhs6P7GOChxiLGBwXVEoKCC%2Fj59CO0tTaRSDfjpbMkG7Pki0ow28%2FEzG6iIAB1oOBweKIk9PbYA3te6AQCD%2FC2HuwfyLX8kmttu4g6cBqCwtClpxfHTgGxNNg8TptI208wLokU2sgkIvy2JB250RoDBxoByvjYvtzWg%2F0DF3qfeswDGsRL9IRhBoxPsTCJojjNspIWoWWK1LwniaJpEItvDSICGoKLUA0QL4WLIsT6PUCDAZKx7BdUKFizxCruVGvEpOCcq2xJmgoPnDZtXItTVwkrVQlpYqOiozVQm2pSGpNE7noCqM6FqUFA68n07iCg9RCIJXJ3l9TEmpeAlLPaqJu5HgJs4Fygrl4J2CAO6KIIuMVREFlXdbj6JNRyv54XV8rBpXozrw8KVbkvyYGkD1ev7%2BfGzHOELjYSQcSskYO6cB6QuBHN39iR%2FZQocoyOPM9I8VFsooEt951kUzqIEbmT0midBKRaF6m5NDzPYI2hK3cEUKIo4trl%2FRSd5f7ukzSmglWFFxbMePNLEC34MLOgMoIx0JE7TDZV4reLO5ktbEKMRUSQGA2huAIEXL0E5sLUpCsxByUmpcGIpSVzlEwqZGLqcYy1WGsRDMYTjMwiYhEBM2cX%2B6lwR3WO1V5lgzFlufkWTGSIxOH8NlzUAqUh8vkCxWKJMAoBuHptivZ2h8Fx6fcRimEPIpZsS45seyeducP4yVR8GBvXtmxrjJlTlQdgRLjy103OXNlFVAO5xD1ApCs%2BRfmpAHZrFMBH8MoOnfL32D%2BMXp%2FinNuOutqrt6wga4SmxDhGNlcT8Az8Op2k6OyyvVDmaCRsa7wJwLnZLIJWCbyMfbIQ4ZkaBDxKt9451XLPavX8we5J%2Fixl6D29%2Bmmq697gViWhLLAFaF6FqL3tb3zx9o2CtwegPRUeH%2FropXeBcBU3whRwWQAfaCxPpSteSaAVyMTv08AELKvB2lUCZu%2B0w1ugoTpRUwRuA9FqHf0LU1%2BvOy9Z4oQAAAAASUVORK5CYII%3D"
             ,"racksortVeterinary":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAB1CAYAAADuvqkcAAAABmJLR0QA%2FwD%2FAP%2BgvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wcEEAAkMtsIvAAAIABJREFUeNrtnHd8VFX6%2F9%2F3Tp9MZlImvZKEEAKhBpAqvQqoiKKIiG1Xv66uupbF1XV17WsvWMAVCzZUUJGO0rtAAiGEQEjvZWZSJlPu%2Ff1xJ5MJRVDc%2Fe7v%2B%2F3e1yuvgSn33uc85zznnOfzvo%2FAf%2FYhnPYqAp7z%2FUj133CDF3vI%2F64Lneuc8lnel38Dr0k%2F90X1v7H7BBol%2FSs9pf6VNyr%2FjHc6DBB9ryqfEW7f9UTA6%2FuTL8Jzv1n3O9v3xQBD3Bd5P6oAb8i%2F1mPCr%2BxKHYZ4%2FhUt7Ts0vlfpHN1VvtjuJwRcSAScHb%2BPMhuSR6Zar%2F%2F9yG43T3ljW%2FzpP3StXgh5jXC3GZYXoZ3z%2BRknP%2FnMtPayaptryIjIYGFCDHJZG2KPxWLAjWt%2FSQMKv8Aoja%2FFPAmhxp5VdmcewIiseNKTrQwKDULSagmVnDQ7PZj0Sns1Oz0kxYZzaZTAp3uKsBpFAOpalcZv8OhwtHn5qcrG58smIGyuRmqW8LTV8%2BzWxu2Prz8%2B3uOVnIBOWnGV032kDN3Du8SL7X4dg90DMDAh9ElzePDCK9PCCVO3YzWKmAxmAEKDlCERGmz2%2F7jRYafnbdORD1WQv3t%2FlxM3tngBOFXfBMB1Y1M7%2B1akjp3rK%2BjbN6E946HvepW%2BPKnQVVqBNiICV20tuod3CRdjVEeriK9d1d9jMmi5cUIczM3m4Su%2B4Lk1OXSzGP1fLrK1kvPHYfScmkb67OUU2Vppf2YyNS3Q99kNAFgMWopsrQCEaRWPNrg8uNfdACU2pLp2RKsOZsXBTyegSK%2B8Z1K8jF6DcMNX5%2FSW%2BgK8JP5hXJa7pbUZR5uXO2fEIZtFhK3HefLr2WzJLCfaZMCsFSloaOHYu5OgZwgyUFD1Z56e8SlCUneiahqJCzWQoXURF%2B7msp1udn6%2Blo3COAzLRXqUmLj5zz%2By5OnRiNhgVhzy%2Bkp%2B3Anusm8ZP3Ci3yDZLJ5rarkgTwmA6p%2FzhrgBDpU18tKC3sonTjeu2lq0w3sSddkyAKo%2Bmo5Q0w56TWc3GhKGcCoSd109sWtuwbO1F1OSRwCQ1%2F8Kct7IwxK7hCnJIyitLGNXUT3ujZOYUL6C9fZZuPXVLPn4KClWJ6MzB%2FKnTS28tjHXDLSdax2oPo9B6t9dPsDV3ObC0ebF7nQrXrJLoNco%2FXv7Uaptf4Wtx5FjVGBvAKe7s5tUepFPlqNqq6O9royoKweyl30UvNCPld%2B%2Bxk3Ln0AG4qbfiW3Jw7hyF0C8gfUjNCDfzpIp17DhmSaW9xPR6NRYtJoEwAEYzxXuxfOMJc2m7ccBqGl1UmVTIrnP%2FX6PuJ75BjlGhZCW0vm%2BXgOJFo5%2BX4jcVgfAwP1z%2FCcfdaOHY190I3z2rYz7WsfBuOtZlfsHhEov0tsncX84hHXzZnJbVijL%2B%2B4BPgbgkQndc3wh3uULYMIv6n5%2FGJclr8k5RfcIEwDRFj1VNifpUcG8tKA3rtIKhAQJzbzdPPTAHTyRtR%2FN3Mth63Fef%2F0g93yTQ1ZUMPsXzkRuq2PcM0qgCF%2FbyvqFTzI%2BvoJJ4QLRU1u45S9qqi6v7hIMXKUVvLflCHvtVt6dnYmQYsAX0u8EPgMafbfqvVBPqdbknMKk79yd2F0S6VHBFFQ7kHL2sbQkiAGvq2DbNJ6SV%2FHMpijkwpPIMSqeWJNHVlQwQUYtclsdnrZ6PKEWJfqtfJU%2BJ19nUrjA0d0bAXj0%2Byncah%2BPW1%2Ft7w29Xz5Cn7Qs3p2diWgSEWra0fSKZ%2B1NvV8HcSHQ12eD6kKN0hbZWukfH%2Bp%2Fo7XNRUG1g0pHG57QWG59awMLdmxHrjcizuzNI%2F%2F8hhOPr%2FSH7cDjhE3pqjadgbYPH6ZS5%2BHHXbvRZY%2Fj2b%2FVcKfhOPttzQC49dU88NR3mPQqhk6IRUgxdHYtu8ToVBMgx4DqBiDtF4wpsR1gZFqk%2F51KRxtfz03ipw%2Bv4J0D7aRHmvnjQ8m8dNnnZNxaiOupobjjMnAvP0xB1Z%2FJrXZQUG7zT8hmlYryxja63f%2B%2BMjeNH8sLr7zD0ZNHyej1Pp6aPKaXjGLQgen8MPljpKvuQ3v11zzw1HfIl0YhR%2Bo4eriWq1fUAzQB6SAMuWBP3T61vxdgSIyWWHcCrXUNlDe2oR3eEwrquHNGNx4bl8C4D6q5VyXw6jDFMz17R6CNiEAuPIm77YkzzmsxaCl6%2FkZsfddyZMs%2BwrRqemnb6BvroIfRQlBxM56aPJwnluOpyWPco%2FfwQZ7MA%2FM%2B4pZn99Pn5R3Y3e2A3KoEC3Eo0OuCQnqpow0iRJ68SUSaoOLQFyLfafpDQZ1%2FnrpubCrXzslEE6%2FlElMoE28Y5P9c2FwNuxuo2j8PNrmJpI7WugYi%2Boyhz%2FMraV90Nw5TJJOb2qj58391ubbJ3J3KonyCw8M4drQc58iHWR12lBd1uXywH0RBBATJFwGTQOgL8oHzeqoktYF%2Bv0tGKnWxZ1EJjlUeHv5iP1JzwLSQbiV%2FRzXRPUPY1dzIsrd2d4ZzX0h3Lz%2Fs%2F7rRGkb78Fs5%2Fs2btCSZCA4PY%2Fvtd5z1%2BgfrTGw95kIdmUm3DIGShqsZnWoiTKumoa4J3zzlUQwTMgDDeY3KeqgHg1KN7Py0nOLdNVxx71ia70zssuBc98Fe%2Bny8C12NF02omvlfHUM2i8o8lmihamsNl7yV7%2F9Nv7teYURmDzyORoKKlaAQd6mZ%2BL%2BOJWTADOoPVXO8SWa8dhs1K76nevMaDry4iE%2BfeZthw7fzaFN%2FLAYtYdYQAnYNbp9BqnPOU5Me6CNbbwrl2OcV6ONNJA0zs2fkT0gjzfSe5aG%2BPRb7lkpqU91ENQajDlGimj7exKTscP6W%2FQNJGRYqpDYAxkghfHvLADxt9UxL3UK%2F8o84mb%2FHf70v31kUsOuLQ%2Fi0AdmiRgjzNXxICwAbnJFc%2BeeX0Ld8y1WmQyz6%2FqfXQbT6jGsB71PAsbN6Kie4nE1fHGZQqpFdv88h%2Bu12LH%2BIpudV8WRnZeF2eDD0jyCqMRipwYnrpIPuQ61Myg6nT1MsmnQt1WYnqhCBgfdmYDRoEQxW1I0Vysqk4hQAjvoGHPUN596rN7QhN7RBUxArCkzsEtMQyMWSvZiCwmIX0Bow8QYD8dOT4lRnDRSVj9QLAIuoR61VyRXf5BD3eDDIdvKqU%2FDanHia3EgNypIpcWISlXN%2FYmOrsn2IHhWmrD5GhRCU76WutMp%2F7l4UUGqv8f9%2F7S3fd734arvSfWweZItya%2B%2BttVPjgPLVO4BRHH9BYNAXXlvAKt3jMyr42%2BJy%2Bbxbj%2FRV3SgtDWZSVjgVubXs3VlHtMlIWZONm6ZbeOP3FTR%2Ff5DSEVbc1gbivXFU766lx8Qoui8tJ9%2BlJcYa5j9fWY%2BeJHAn3TSzuLufC2oNyKuDEWyerolBi5pj25VGiw1Ths7%2BUjcb37udzZLM8Oe3Ruybk6UNWMxKIGhBPr9Rjbsa%2BeN9abzzjxMAeJrc1Fokpj03iKdCvmFUj2jMWpFCezNJyVGK94ZEMMAC9pAIqLFh93qprqujubKNYVkC9%2FTz7YtO6s7scj7vdBgpdzNQUe6ixqF8viLiDt5MHk%2FKAisgBPmMEoFmZVwp%2B6tzRr%2FkmxPl1LhEVn2thP9ok5H4eAsDrCLO%2B0vJNIJZK2J3SbSkKJGsxa5iythQ2j6owaxVTt3S6vKfc0euzHc1EzjmEs8wRp6TjmDzIJ1UAkNG767tbQ3TkPf0OgCulNcBgsFnlABUglzbsak9p1G9x8XgLGumeL%2BB7kOtANya3Rfd4jZ618nMn9SPtLBgDrgdDA7pTl1OC6H9jIz41s3EYVmkhQUTE6xEsCirlZSBg7Ed8zL3xsspO6pmg6Nz0yrYPAifFuCtb%2Fe%2FV%2BgeqQQWBxS3qKhrcFOQPxVP70gefuLdRT6veH2GtAN2n5OksxoVeptBpspJtMlIcXM1l2kkpq09yacLljNjcBqT061UNrSxwuHAO8jEkZ8qUScZeGT0ULTBygI4JsxAtEVPTLABua0OwWDFvPEuonrO5B%2FLlMTMBn3QGdcu0Js42qKhsHYbO8tdfoMAShquRiAXEEy%2B%2BUlWDJFLgOqfXSb1GZuIAyeb5xwTAN5dcVDe1uRhYlokowens3TFTg621eLK1hGCiG56NP8sD6Hos1Jcp0dThzJfuRuO0bDyAKNS1%2FJFyIts2XoPA5JaWYkRfYVv0KCnot51hoc6J9Vc7Ksfe0cJCnh9c5QK5BM%2BTwEIZzWqw5iO48eadgEQ1hXWSKMWLiM7NgTJruXUyWpMzSb29xhORDc1oXV1NDo8gJbQYLM%2F9yeaRGiDfr2SeGGgk0scr%2FOn72%2FiuuRniMiMBK2R5IZKf0CArga1xgSxp3499tVD3gZB5wvjviAhbwX5UGAS5pcIBLLH5dXuKqp37SqqJynDQmKIBe2AYD5fn6cEk1AjvUJFqoRgPDo94WEWRqZ5kMNTUTdLRBpbeaQgiEut1WitU1jePIWr8i4FoPY0qazDoOOxj9IiPIyr7u%2BAoPF1Ow%2BgV5ZH8kmgNkDikX%2BNPqUC1CGXG5w3d%2BvLCy%2FtitGoxEqARKvlrD8IV7laNSpBbdSIqh%2BLm7vcfcjwG3EGTfd3LwCzdxM21d2oD9eQPWgj67%2F6cqnPkA4P6ZUFrbwXpM%2BBcp9R3l8rugmAkHplnPfEV%2BV634lCQVwADPQtX5oDBrIn4ILqAEXDL3mO6Rd%2FX3t4JsfdsbQHJaNrOUV3TQU7Nq5fGpBDl3wNqlP%2BL60CeaVv%2ByEGSEO%2FWkkM1GDVvgtrQBgN4rVAtO%2B9dt%2FFpIDX05ULb4CRASsEvyFqX0Aw%2BF4rwPs2cNj3HdXpWtfFyqMdupQ64CY6xIQMEHqBOAiI9zWAGHBNyWe0y%2FfnCZh3RN%2FnGsUz8iGQ1gEFXUO5vwd00bN%2BK823Q0QQA1pcOq2bdcknKuNCGAfCNCAqwGsd3bTDa%2BtA2hrgGXVAo3h%2FiWz6n4geiBcarf9%2FQQ6E%2F0MO%2Fg85%2BF%2BKHAgBnpAusGXFc3Tb%2FyjkQABURoNOo1OLKp1GbQk3WNqPlJfV%2FYxR0m%2BJHPzSSVbrW3f5u29atCXtsdnZj7Vvur9UoxLl0%2F9k%2BaAsy7tkWb5Dlj3vy2f9TsVip7TrUbu04ipZbvmDLH9w5enzm%2FYsPeK3RQ56Job3PLLqwR26fg%2BFBCIHCd3jiFG7ibJ02l1tc5IRZ0UzZQDsLQaLL59na0NubqW2rpZqm5PeM0P96Wo5Uof7SBl73KHbx%2F597Xi3R3IuXjBSvmlmFP8S5OCKQclPNrmlhXP7J3HD%2BEw0qT4exOpLpISdZaUekgDyQSg6S1w6oeAGcnKNkn8PyAALM2%2BTaWlyZfb8fa8jr40tdB8pQxsRgXDbtxdtlB85yHlulierbw8ozoV0Kz%2BsrmbW50cYFwaHShr8yMHmW4cw9K5MhEovUZcto9r%2BI9BIetQ1mPQqmp1ebG2uLhqWSa9i%2F2vjFT3Z6VZy8d18YE2RvlNHBqSCQ6j%2BUXJOw8QLXJ7Iq%2F5rjCfKomf58s3IkToosTHm0VQmJ4WT26Jj9tA0xl%2BSwuxhfRk2uwccbUKOUfHI5MyOzAfdI0z8aXgsM67vxfaGNuR5NpJeq%2Bfq%2BTYskWbufSVHycVHKgzFxJdM%2FPAdrFv7becd6TW8k9v4sw65IOTg8RunuxdMHcaijz7nycviOwXs0gpFrxrZnWlZr7HqoaGKeh%2BAHchmEWHm5QDMmD2H9IQRTKzZz6bYW3j7ixewVdyMJXYJT%2FeIIkebwqeHm3h9SBD%2FvPwg37sUNGHJx0e5aZQiQf1myEFD8THUxyRMXq%2FCTiTEgtPtRw40MSpWvTlZUeh3N3ThKISadjhRAd08%2FNjyLUeFHRya7mHdNdnsH6hm%2F%2F2jkYETjW6SeuhpODyDt658n%2FXXaHB%2FqBi04ZkmTvwuiJcPugkP0qdcNHJQX1pPZnoC61vbsMZH8OCGBkWq6dCgAPfyw53IQaJF6f%2B%2BMXC0sAlSeoOYyGUFcxUWaY%2BaGS8JNGs%2F9iMHz46K5MG3BiOvr%2BSmUb1wfziE%2Be95%2FMhBeb1IN4uRtY9N238%2B5ODnjPL%2BYVxWS51vLOYfaaShtZnM9ATufSVHIV58yIF24Z38ebEG98crYJAJ0q2QbmXZ9%2Fk8urFE2e3LYRgio%2Bg7TyY17AG2rJ%2FFh83LeOXyt%2BinmsQ7yf%2BF9PZJhJp2tBERaIhn2eI5vJPbyM3Dr2PZg%2BM49u4kejaXhAK3AiEBaecLNkp1oKwaKwINrc20Olqw21ycqmwgMz2BqHvX%2BZED6f6FfuQga8w%2B5BgVs%2B%2FbxOMHA7q8oETHbpuWcqLhOfpEfkpB8hUYVn3Hw7pkvrTe40cO5EgdON2MGfYIKXFJvDs709%2BVNb3iEQRhBgh%2FBWHgL0UONNUNbWRnRhNmNGEMDqJRljBbtByoqCM9zuJHDt7JbfQjB3Pf%2BhGALceqyApq9%2BfUO47UdXeTPFgxdurI23FMs3LVP9SMjH%2FTjxzI2%2FZw%2F%2BL1TJ7Uj4mXdDsDOdCIahXIVhBvBFJ%2FQaAQXbY2FwtGpHHkZCMHKiSaHCpyC4rY%2BvY0KKgjPdJM%2FvxQxNXryMicT%2B7CIcw8rMNtcVO1fx5CWgojM1%2F2n9Gs1yDftY6%2FTFbzwJtt9L7%2BOk4eWkF47BAcLzbgzRIZdGA66uBMmAzpW55kzF%2FWcU1%2FLb%2BfO0EZo4drGZIeE7H1aEmBT8S%2BxJf7816ApyQJIHL8VEYnR5AgyVQ66th4Q4pfge9ADhAsvDpMi1wqkmpRoqJ7%2BWHkwpOoTfquIfVVRcppyD5BxY4dxIoGkmNqyLgymTHdExk10IFVuxOPI4%2BCUQ%2BTOO9BPj5lYNn3%2Bdy86AB9Xt7B5L6x0Z0hXRgI9LjgeSq1T5iseyGMvkSw%2Bo2DrIrrz7C%2B4V2XypE6Pvk0j0UH6hQPltg6P3S6leXOjJuAUO6%2FZAzhb9k4%2Fs2bAPT%2FUzxZhlls3vlql3Pu%2BLHM%2F%2B%2Bqegsn83uzfcxH9E5NIHr%2BIh69ZqDrziU7XgVVEmAG6SuQ37mgFUXrbIG%2BRBBS00rzXgU56Co1KsjBLYeL%2FMiBbBY7Q7peg%2FtImRL9hBNYe%2FTl%2BDdvEhZsISitkoIVe%2Fnyk4eIPNhOtqT1%2F2UZMqmqt1BVb8EwMp70QRLjvrMgXB5JXKiBsFC99jTkIDUQOTjnmBoxP1POStGw%2FeMiju%2BzccW9YylqOcn9i9fz%2FC0TQK9h3Qd7mbb2GJpQtR85sDeW8rvbJylruEQLc1%2FZzxcLLSCVYJ7zMuzdRXtUJ4aQfvkgehpmcXTR8wA0hffh%2BWmzINKMHKq0%2BbFpIoP3vsZbiwrI0Lpo93g68uodO2pzoC1n7X5z8y%2BVj31egcqiJ21SGDd%2Fbeemwnr6jm3HNDCD3GeOIYYpY0UdomFQqpHcdpFJ2eG8f%2F1PndsOs5N5od15c%2BVbeLbV0nPFZaSGPUB6snKzr859tlNpkWRGifEInzZAt%2BDOm4kwgbua%2BWv0fL9%2FLULxIh5Iy5fvf2%2FnGyCG4ce7vX%2F1JTvP3v02fXGY7kOtFD1cwKSlKppv6kPfse1kZ2Uhlbow9I%2FA1DvUjxw0RRr9yEFxvo1qs5P2SBXeps5F9D9Mk%2FyhHKClMKbLNS8VhTNxA4DaZlYUmFh6dz2uutVYsheTc6rR7WOTOh490gJxlyXEqs5pVOUj9cInE3YKDS4PZTl1PLcqB4CK3FoctRLtxQ6aDyv8oHlUDCE1rXwwbjezxn8MESIhPoWwx8QodM1tIFjYWCBg6aHyG%2BRxNIK8uounApGDjmPN9mbyt9h8%2B%2Fcsjr8gUG9vt52WDzEAlu9KKy4MOViZJ5OSoCekJpq9J1qJViBNek6JwXb3KaKPNdEO1A73EB8eh9nrwq7S8uS8GBped5FnUtabU65SsyNX5oYRW7n20lKEkzrkNS%2F6jRhR344Q7ttozmlDekOkoELxXqSvN256bwSbJRlHi8vm807gYlbXsb%2B6IOSgutDDyp11eJrclDXZGPREOtObY8gbKBHl%2B%2B5PETJSg5OThXbuuSYS1xLl%2FfY6O8ingAyGZQlcqypFaFTuRQgz%2BLuZKlznRw6kN0SOV6ooDvP4pdJXvsrAe%2BUoHps6lZZjVUdOQw4cPs33%2FEZ1IAfe6miiTUYwgWVqCNHvFaBzhBFmNFFZVssSXT3BERpa7CpC9EFkbDfi0kCLQYvdJYHQwPWiwB2HJKZmivQItSI0Bmih3YKRG9oQbB689e2IKUFkhHs4VQEVPmotf0Mp1XmfA1ORJG8hiB1ykQqo8uli4s8aFfNEuOwsa6a4yUC8Lw1xa3Zf9F%2B56BceT%2BTAJHLVbu7ad5yGgQ1U7xFIGxzJjh6j%2FQmXSo%2BGfXlVwAAi5aexHfsT%2BaUuyhKVsTM%2BIDAEjqP8CgGNdiQVzVu6CNrHI2f4KbsAlUTrW13Ud0g750QOohqDiTYZabJJnMxq4bkqMxVPfo2pvITI8VMhrReLthZyaGAtwzPSUVtl%2Fnb5KCL7ZhBqMhFl0RMdGYYmOBwkBTGI3ft3lh3vf%2BZu1GeQt76dAr0yaAtrt52h0FedvM8noYpnQw4azoscAHw355AyUpdAH22R%2FMDkPvz%2BtRdwf%2FI%2BK388zOrIRpJMUWx8r4DWxQv9qa%2BOI9prw1ZTCUIOCIm4V9zGmvSPaYybxmWaLJo1rUqjB4H%2BuOMM5GB%2FaefG9kftDqKkFzmy%2BrPfBjkA8Li84nNrcqTn9CP4ZP4lGLVamspr8RSbiBoSAYMHKnumxhY0DSFE%2BlJlo7YV%2BtbHJYwZP5RlV%2B7F%2FDLs5hn%2BOPUe1FY7njozyc22LvxEZ3JWQQ5cx1ZzZPVnZ0MOtoG876KQA0B97dJdrQCZ10Ugpui5V5dC7j%2BW0Ds1AaFvrC90miC0mQUj0qCoEQqbSUqKQG5u5Xr1Y3zkeYw9pWa65dUAzi7IQSAQUtTjU2zNV2BfrXn%2FHMhBIQr5fNHIgQoQ77vnkrazIQe9E60cLulMnfeL1bdqVKLabFCr%2Frmj1H%2F3o%2FokkhM8FmfQdD9uAKC1TqG9rgyBXIYYDp%2BOHHSkoYNA3gPS0oDxJF0UcjCmX6L3h4MlHchBFIhzFeRA%2FhXIQcJ9h81KLDwHcuANaFBfXl36DuSvfdf5lyEHah9ycJ0POfD6Qm2gQC2ddg7PaUaeDTlQBSAHWiUoSJ8ABwIUfM%2B%2FEjmQA2SYniCkgTgMSDgNOejwnBvloc2fQw4AuRykNcC%2BAIP%2Fo5CDjgBlAmEyCON9nj0bciADq0HaARz5n4gcCBcarcV%2F841d7CH9uy70f8jB%2FyTkoI3%2F4H7%2Bvxs5UOnUGlEtqESNaGlvai8%2Fj1H%2FWciBIVKfljoj9rGzoQQalSg%2FK98jX9M8W5blh%2BVzfeeGIxOdU9YNssstf5ClY7f89yAHwXHGns4qpcrB1AGpRMcF48j0YLee%2FXTlkxTBur2isTMnWKk0frdTKk6UldFw3RwoqENqlhBSDNw2tMW744Wju%2FJeKB6PV3YuXjBSnpfm7sANLrr7dUEOIgaGPjlhUsLCAn0bRcleomKUa%2BhiQ8lUGbv80JigI8OYpAgC3iZOFXY%2BkSOVdhLspaVOtgwf2AU52HGonlUvJ8pVdS2uJes1ug4t2Vfh4LdBDrIf7y4VJXtJawxi15CrYZCK%2Fve%2Fg2ODneJ6XxKlVml9d97TUHaUqMuW8YLjTra05pJhTOJB3XsQIfq%2F1%2BWIEHE%2FPb2zmsHcZKXCASDtFbo81Czl7Lt45GDE%2FEypXGgg%2B7CJHd5EyNkDW49z4PnbKK53kDQkEn03DfrBOtyLZyIf3oMco6LasYQtrblE6pR9ln6wDtMgNfHz4nhk0wsk3%2Blm9AdtmKZq0YSqIdGCaNUhR%2BqQ11f6kYNA3EA2ixePHITeZpDSe6UxYIPIm7NTu8g0rtpatA%2FNwNj3CVr%2BPg0hJFjRrgLUeWbF8aLRSXBbKQ9kfkXIuAya6mtJ6raQ4q%2Fvw1ZxM0nzttNUX0vz9y7cGyex7I1TXDc21f909g9rDwRWOBBQHgI7J3Igng85cOcJeG1O6ltqkOrauxQD0EZEQJGa1kOPQM%2BQTm0qgE75Zr%2BN%2FNZi9soSI7O1qC2nyJ5j47Exr5H9jJqQqNFET%2Fsb7YXgbrwDBqRibyyFW273MxQTP3Lx8MqDBH3fD32oLt6XvNSe6%2F7PixxYeyiPGa0zN%2FHsxlJFoum4cb0G12df4Xrmm07cINBLiRYeCz%2BqpI51nczSqT1qnimK8iMHcd1u4NHJEuxtRnr7JDeN6sW6eTP9yAF8THm9SP7xItIfSDpvlYOfRQ7G9U9uMXtdVG1pIlwM453oJkK%2FWt05YOva0S68E%2B3CnZ24wdxsSLfy7PpyNBM%2F4PrMfv4Trt5p8CMHLQ29kEtfJHzkjWy5%2B1ZCkh%2BHgjpEk4g2IoLxMTF%2B5EB66ROWPTiOz1Z66DstJRA5kH8xcrDDXU2LXcmTtNtdqBq9JKdEEXXHKqScfSw55kS6fyFsm9aJGxSeJO2ulfxl009o0rVnnLTwg6c40fAcQf20kNifksOr%2BGRzOl9a7%2BmscBCpI2NpIwPGPMV4q94f%2BTS94rn%2B5TJAmAHiwyAM%2BKXIgdbd6CHI7EVn1qIzKzdYl9NCcEqQv8rBO7mNyPVGP25w4vGVFOfblGjWIbOWKk%2BwaULVnNj7NMmDPVR%2F9yO7Ll9KYu9pjJMkRsYrOrBbX428bQ%2B1wz0UDWwnbdLILrjB6FQTgiiqQI7yIQdpvwQ5aKdWQgzT017WQpOzBWeRm5Y7BqKNiOD1dWW8GmmmoHodL0pDuPOpocy0aZQqB3nToZsHjeERIjFjTFAkGneBi76fLmbRZWqu142m2y1JVO%2BuJeENEzqzlh0DrqWq3oI6OJOkbnnU576K5paVnVV6cvZx9WYd%2BrSgiLYCx3EfcjDEl6E9P3LQUeVAHaJBZ9bibZJx%2F3WyQo13n1tMAAAHbklEQVSBv8oBgoV7VcpYTbW46dk7gqpPNkORGnfe0%2BR7S7pMsIceVZ6VL19UQtmaSqVlkwxYLw2j3F2G13yEduELAKKGvcW4R%2B%2FhmsfXULh2K7pXy7G72wnNNEb7VA4PCNlA%2BgV1v3X7T6JJ19J9qJWJs6zk9PWpbadVOVh27VVo4rVoh%2Ff002XRSTrYtBV27KKmXQnzYaoQonsN59EPmnjiz48RMjSaRz57nud2fUDUZaMhsT9B%2FbTKWAO%2FcWVHy2kMGcnsKEWdbDGrEIL8XFI7CN1BGHR6tvWsh2VO5GPJw8NI1cG6L%2BvY%2FGMjN45NVRacWsGPHAx5fxuR3cxE5zWSNS4VWjpxA9ks8l1qO5E6C22ykzTdc1Ru%2F4zKoAakPk6Ot1ZydP%2BXSIaoLtd2V3mRCwXU6l6IQREUeOZTVxKMu3krWlFGSNeqmvY6Dvry6iolCsrbOyZj9blwg6T7IzDvb%2BL9pwtwN3oIvTOZ%2Bxev59k54%2Fw3vP6DvcpitsbL%2FC0BuAG%2Bsg3bj5IxM4v81mK%2FqFSuVrZWLQddBIUdwZ3Yn9Bp11D25IcAZI0oZtm1h5B7hACbARj2dTxH3s0CIFllpsDbBl2rHFh%2BFjmY9EAfud6k7L6jTUYSouC9u8uZ%2FIoK08AMinfYaT7cSHWog6jGYIYOtLD3RCszL0%2Fiqeu24y5woUnXogoR8DbJ%2FD33evJbi9F%2F3Y%2B9xp40H1oLQFDYEXbdldNFyL70c2NX3AAgpIUNzkg%2B%2FNHO6q8up7d9A0cznXLVstoLRw5ygsvpcXUsg1KNrHnoMFPG9yPrrlA%2FbuB2eDD1DvVXOWiKNNJ9qJU%2BTbG4C1wkZVgIjzYRZddz7ezObiWqb8CSd6QTOWjodVbkoAM38CMHTUHsEtNYenc9luzFeO4y01LidAfIoX7kYGZC3NmRg8pH6oWPMzYLi%2BYqgts7G%2FOJS7X7cQOvzUnz4UZ%2FlYOQmla%2BuHGfHzdoj1SGadrkeMpbzERiJtG5nSOkU%2B7uZI5yhnx3JnLgUxUDpdL31trZ%2Bd4%2BAI6%2FIFC2pwGPQzorcrCy9AKrHAQjkhmVxcoVxUSblC4ZPNRISE0r7z6QR976epKGROINVWH2ujhZaGfe7d35cNFxvE0y1z87gYoDKqZcpaZk%2BV%2FoppnFXVc6EHYbkNdc3QU5wKfQC1McrH3RCDQTaxIx5rX4DZ8xeh1vbRxyOnIgK0FDls%2B7n2rc1UhmVBArVxQruEGZEp6v7ZPOuwsOE90zhOieIbTbXX6DUtLMfPJFAWqr0vI12KmoVliol66ZqBgUgBz4w3CHQTYP3jdEknz4QYc6%2F8pXGVyR%2FC7b8o7hOuEMRA4ERcSWG7jQKge7N9QCEB9vYdaNaSREweoNB9EP1qFOMqAza1EnGWixq4iKDGX4hChCwiMIF8P82%2FiOo6PCgRwaqTBHHc08Jx3ZovZXOBBTuj5Tbw3TkL%2BhFFAqHMiSVBhQ5QCf6Gbv2NSqzoUb9BuYRNMpGyathpiBFuYnZrJ%2BayuHjpVDXAjJg6JwNbSikdwYQjUkWkMRswxUtsoY9KDRAy0Cc%2BaPQswMQbbdxNuvPURm2zeUOyVS7IoBtHkQ9tcitEvIbV5Eo5r8BuW2jtZ7qHHAiWovrW0Sxy03suafD32DjNMnZvuChFylqIo0cq4qB4q%2Br1Q5CM4ykhkVxNyFy9mbd5SeU2KwDNBDlROpwUlinyjqcloYcX0kERFGIiKMqCx6dEnB6MxaYohQFiCWqdiar%2BCtbdE0l7T%2BbIUDgJ2%2B4hqdorbyxLYsSXmnVTnw1aOg5mcXtOndrV2qHPRPCJFDegTxxOLZ1GBn6YJvabGrCE7Ws%2FG9AkZN7c7uw46zts0P3v3%2BpZLHlszOiluwXZLAgyUP8oo7jCRNo7%2FKQUXz2SocSLTGBLH12D9xrJ71qm9u8gYgPOKvQg4OlDYJ6mqVvED3MvrBOlLSFNjj1MlqumdbyH6qBzXtNv8Ww%2BLLd2qC1YSpQqhB%2BWzonDgctavY%2FO5DrE1uJiLTSD3GLrgBnFmyYU%2F9egRW41sWaQOQAx1wXHnk59criRq1VuUCiB4VRli8Cm2KsgKITgsjOELpzWKC1p%2FbExO0GBN0HP2sFmdZM3Gpdg5%2FqcYWtIIMcT69jafOuEigQcdjH6UoX8a%2B%2Bm%2FvB6iHHciBCaT3QV4bqBX%2FUtXD7XF51YC62dTsvCa0L6%2F%2BTSns1Gg9%2B9N5JSZHrdooBgkqQe3OdWsP%2BT8Zgq5PIl8Gz%2BmCHEQY3qam7XXUh2vw9q5miDuXQ6u%2FXBpgDL7J1qh4SN4fMLZ%2BtZAtjOmXKJWkeAmochAB4jwQ%2BiupK7k5QDw4B3Ig%2BBX%2BYeMm3BdY4QCgdsvSpR2wzWnIgU5JukgrQF7Pv6HKwaW%2BLbaVzgf9vedADuDCqxyofd1Nq4D10kdADv%2FGKgcdiZBkEPqAOBjodhpyIPpCssv32hYwXgKRA62yEZTLQNoO7ObfXOUgMKsjnUc%2F0vo8OxTEyb79UIeXvHQ%2B8CyA%2FIOvykFFgGfOplv5r%2Ff%2FAHFadfpWLplrAAAAAElFTkSuQmCC"
             };
// cases(%=number): %=money, "c%"=coins, "f%"=fictive money
// task_new_plant task_new_product
//patch0803
// 13102016
const NPC=[[,0.5,1.1,1.34,2.75,3.95,8.05,17.8,18.5,"f85","f110","f180","f280",,,,,0.16,0.52,1.02,1.44,1.96,2.28,3.8,3.69,"f340",4.38,"f510","f590",12.4,"f650",3.49,5.19,8.75,6,15.63,16.88,37.5,3.9,52.44,51.75,60.25,58.13,66.19,18.2,"c79",150,,1200,,1200,,,,,4500,,14400,1200,,"c125",,"c23",,4800,4200,,,,,,,,750,2100,"c25",,,,,,,10800,12000,,1500,3300,,,,,"f650","f1500","f1500",5000,12000,"c10",,"c20",,"c5","c5","c5","c5",,"c5",,,10.12,3.72,"f155.1","f545.7",37.42,23.32,7.44,82.36,"f106.8","f148.8","f69.6","f196.8","f278.4","f408","f240","f324","f250","f864",47.15,140.56,125.88,,"f12.8","f73.5","f127","f106","f53.05","f113.75","f44","f33.33","f71.3","f73.2","f181.2","f321","f316","f491","f350","f484.2","f906.5","f421.7","f473.5","f749.98","f237.1","f675","f975",12.25,37.5,"f1025","f1100","f810",,"f231","f6500","f58","f137.67","f197.67","f342.5","f830","f700.5","f1063.2","f704.42","f734","f339.53",3.1,3.15,3.27,7.3,4.9,5.92,6.61,6.1,7.3,5.6,5.2,3.6,10,8.1,23.5,7.8,8.2,,,,,,,,,,,,,"f410","f490","f503","f589","f469","f1312","f598","f533","f480","f420","f1620","f1030","f675","f950","f2350","f2400","f2450","f3550","f3600","f3650","f8000","f8000",,,,,,,,,,,,,,,,,,,,,,,,,,,,,3.7,3,3.3,3.45,5.1,8.20,2.1,4.3,1.95,8.85,1.4,2.1,4.8,4.85,7.4,5,5.1,2.3,3.95,10.6,11,3.5,2.9,3.6,3.2,3.95,4.3,,,,,,,,,,,,,,,,,,,,,,,,"f1618","f1340","f1836","f1654","f1579",,,"f1839",,"f2655",,"f2165",,"f2877",,"f2462",,"f3093",,"f3289","f3138",,"f3622",,"f3300","f4636","f3980","f4872", "f4408", "f4157", "f2794",,, "f4678",,"f2910","f6309",,"f5230",,"f6554",,"f5624",,,"f6786",,"f7078","f6676",,"f600","f14.5","f9","f42","f22","f24","f185","f7.5","f92.5","f9.9","f12.8","f12.5",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f7544",,"f4725",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f315.9","f671.77","f273","f600.9","f666.53","f1581.6","f504","f308.75","f528.4","f568","f450","f320.25","f348","f405.6","f940","f1004","f541","f439.75","f1024","f893.66","f746.40","f543.5","f650","f495","f732.2","f447.6","f592.04","f822","f753.33","f368","f372.85","f416.67","f701.33","f1346",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f610",,"f560","f610","f550",,"f700",,,,,,,,,,,,,,,,,,,,,,,,,,,,"f930","f890","f890","f3080",,"f820",,,,,,,,,,,,,,,,,,,,,,,,"f1140",,,"f720","f700","f290","f1340",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f46","f11","f19","f38","f13.5","f9.5","f34.5","f21","f30","f50",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f1450","f2310","f2930","f2100","f2780","f3260","f3850","f2330","f4330","f2140",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"f200","f170","f210","f190","f140","f380","f120","f240","f260","f290","f200","f320","f410","f350","f590","f160","f470","f440","f420","f600",938,855,715,840,1460,11.4,34.2,22.6,8.3,35.7,36.7,27.8,240,33.1,49.7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"3170","3490","f2000","3840","f2000","2980","f2000","2710","f2000","2980","f2000","f2000","2900","3000","f2000","3220","f2000","4160","f2000","4090","f2000","f2000",,,,,,,,,,,,,,,,,,,,,,,,,,,,,90,100,100,120,130,105,145,115,,,,,,,,,,,,,"f650","f2300","f600","f800","f850","f1400","f600","f800","f800","f600","f1300","f450","f1150","f1800","f1100","f600",null,null,null,null,null,null,null,null,null,null,null,null,null,null,1280,"f1200",2900,"f2800",2520,"f2600",2500,"f2600"],{},[],[]];
/*
    var new_NPC=NPC.clone();
    for(var x=1000; x<=1010; x++){
        new_NPC[0][x]='f'+unsafeWindow.produkt_price[''+x];
    }
    console.log(implode(new_NPC));
*/

// task_new_product
const INIT_NPC_SAISON={"94":false,"95":false,"96":false,"98":false,"100":false,"101":false,"102":false,"103":false,"105":false};
// task_new_zone
const ALL_ZONES = {"farm":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],"farmersmarket":["farmersmarket-0","farmersmarket-1","farmersmarket-2","farmersmarket-3","farmersmarket-4","farmersmarket-5","farmersmarket-6","farmersmarket-7","farmersmarket-8","farmersmarket-9","farmersmarket-11"],"forestry":["forest","sawmill","carpentry"],"city":["windmill"],"foodworld":["foodworld-0","foodworld-1","foodworld-2","foodworld-3","foodworld-4"],"map_stall":["map_stall0","map_stall1","map_stall2"],"megafield":["megafield"]};
unsafeData.ALL_ZONES=ALL_ZONES.clone();
// task_new_zone
const DATA_zones = {"1":{"location":"farm","farmNr":0,"zoneNr":1,"productional":true},"2":{"location":"farm","farmNr":0,"zoneNr":2,"productional":true},"3":{"location":"farm","farmNr":0,"zoneNr":3,"productional":true},"4":{"location":"farm","farmNr":0,"zoneNr":4,"productional":true},"5":{"location":"farm","farmNr":0,"zoneNr":5,"productional":true},"6":{"location":"farm","farmNr":0,"zoneNr":6,"productional":true},"7":{"location":"farm","farmNr":1,"zoneNr":1,"productional":true},"8":{"location":"farm","farmNr":1,"zoneNr":2,"productional":true},"9":{"location":"farm","farmNr":1,"zoneNr":3,"productional":true},"10":{"location":"farm","farmNr":1,"zoneNr":4,"productional":true},"11":{"location":"farm","farmNr":1,"zoneNr":5,"productional":true},"12":{"location":"farm","farmNr":1,"zoneNr":6,"productional":true},"13":{"location":"farm","farmNr":2,"zoneNr":1,"productional":true},"14":{"location":"farm","farmNr":2,"zoneNr":2,"productional":true},"15":{"location":"farm","farmNr":2,"zoneNr":3,"productional":true},"16":{"location":"farm","farmNr":2,"zoneNr":4,"productional":true},"17":{"location":"farm","farmNr":2,"zoneNr":5,"productional":true},"18":{"location":"farm","farmNr":2,"zoneNr":6,"productional":true},"19":{"location":"farm","farmNr":3,"zoneNr":1,"productional":true},"20":{"location":"farm","farmNr":3,"zoneNr":2,"productional":true},"21":{"location":"farm","farmNr":3,"zoneNr":3,"productional":true},"22":{"location":"farm","farmNr":3,"zoneNr":4,"productional":true},"23":{"location":"farm","farmNr":3,"zoneNr":5,"productional":true},"24":{"location":"farm","farmNr":3,"zoneNr":6,"productional":true},"25":{"location":"farm","farmNr":4,"zoneNr":1,"productional":true},"26":{"location":"farm","farmNr":4,"zoneNr":2,"productional":true},"27":{"location":"farm","farmNr":4,"zoneNr":3,"productional":true},"28":{"location":"farm","farmNr":4,"zoneNr":4,"productional":true},"29":{"location":"farm","farmNr":4,"zoneNr":5,"productional":true},"30":{"location":"farm","farmNr":4,"zoneNr":6,"productional":true},"31":{"location":"farm","farmNr":5,"zoneNr":1,"productional":true},"32":{"location":"farm","farmNr":5,"zoneNr":2,"productional":true},"33":{"location":"farm","farmNr":5,"zoneNr":3,"productional":true},"34":{"location":"farm","farmNr":5,"zoneNr":4,"productional":true},"35":{"location":"farm","farmNr":5,"zoneNr":5,"productional":true},"36":{"location":"farm","farmNr":5,"zoneNr":6,"productional":true},"37":{"location":"farm","farmNr":6,"zoneNr":1,"productional":true},"38":{"location":"farm","farmNr":6,"zoneNr":2,"productional":true},"39":{"location":"farm","farmNr":6,"zoneNr":3,"productional":true},"40":{"location":"farm","farmNr":6,"zoneNr":4,"productional":true},"41":{"location":"farm","farmNr":6,"zoneNr":5,"productional":true},"42":{"location":"farm","farmNr":6,"zoneNr":6,"productional":true},"43":{"location":"farm","farmNr":7,"zoneNr":1,"productional":true},"44":{"location":"farm","farmNr":7,"zoneNr":2,"productional":true},"45":{"location":"farm","farmNr":7,"zoneNr":3,"productional":true},"46":{"location":"farm","farmNr":7,"zoneNr":4,"productional":true},"47":{"location":"farm","farmNr":7,"zoneNr":5,"productional":true},"48":{"location":"farm","farmNr":7,"zoneNr":6,"productional":true},"49":{"location":"farm","farmNr":8,"zoneNr":1,"productional":true},"50":{"location":"farm","farmNr":8,"zoneNr":2,"productional":true},"51":{"location":"farm","farmNr":8,"zoneNr":3,"productional":true},"52":{"location":"farm","farmNr":8,"zoneNr":4,"productional":true},"53":{"location":"farm","farmNr":8,"zoneNr":5,"productional":true},"54":{"location":"farm","farmNr":8,"zoneNr":6,"productional":true},"windmill":{"location":"city","cityNr":2,"zoneNr":1,"productional":true},"forest":{"location":"forestry","productional":true},"sawmill":{"location":"forestry","zoneNr":1,"productional":true},"carpentry":{"location":"forestry","zoneNr":2,"productional":true},"foodworld-0":{"location":"foodworld","productional":false},"foodworld-1":{"location":"foodworld","zoneNr":1,"productional":true},"foodworld-2":{"location":"foodworld","zoneNr":2,"productional":true},"foodworld-3":{"location":"foodworld","zoneNr":3,"productional":true},"foodworld-4":{"location":"foodworld","zoneNr":4,"productional":true},"farmersmarket-0":{"location":"farmersmarket","productional":false},"farmersmarket-1":{"location":"farmersmarket","zoneNr":1,"productional":true},"farmersmarket-2":{"location":"farmersmarket","zoneNr":2,"productional":true},"farmersmarket-3":{"location":"farmersmarket","zoneNr":3,"productional":true},"farmersmarket-4":{"location":"farmersmarket","zoneNr":4,"productional":true},"farmersmarket-5":{"location":"farmersmarket","zoneNr":5,"productional":true},"farmersmarket-6":{"location":"farmersmarket","zoneNr":6,"productional":true},"farmersmarket-7":{"location":"farmersmarket","productional":true},"farmersmarket-8":{"location":"farmersmarket","zoneNr":8,"productional":true},"farmersmarket-9":{"location":"farmersmarket","zoneNr":9,"productional":true},"farmersmarket-11":{"location":"farmersmarket","zoneNr":11,"productional":true},"megafield":{"location":"megafield","zoneNr":1,"productional":true},"map_stall0":{"location":"map","productional":false},"map_stall1":{"location":"map","zoneNr":1,"productional":true},"map_stall2":{"location":"map","zoneNr":2,"productional":true}};
// All single-slot-zones themselves and all slots of multi-slot-zones
var ALL_SLOTS={};
// [farm, forestry, recipes, powerups]
// Growing duration in minutes (just where game data has to be overridden)
// task_new_plant task_new_product task_fix_growtime
//13102021 overwritten
/*
,"950":540,"951":600,"952":600,"953":1440,"954":3060,"955":1260,"956":3480,"957":1350,"970":165,"971":585,"972":390,"973":150,"974":135,"975":570,"976":420,"977":180,"978":180,"979":135,"980":540,"981":420,"982":135,"983":600,"984":180,"985":435
*/
const PRODUCT_GROWTIME=[{"7":480,"8":960,"19":240,"20":480,"21":600,"22":500,"23":800,"24":720,"92":0,"93":0,"111":1000,"130":180,"131":180,"132":90,"133":90,"134":200,"135":200,"136":100,"137":130,"138":150,"139":80,"140":80,"141":120,"142":120,"143":120,"145":300,"146":240,"147":300,"148":480,"149":220,"150":360,"159":0,"160":0,"161":210,"162":130,"163":260,"164":190,"165":160,"166":195,"167":250,"168":90,"169":150,"170":300,"300":420,"301":315,"302":480,"303":450,"304":480,"305":240,"306":240,"307":285,"308":240,"309":285,"310":240,"311":300,"312":240,"313":240,"314":240,"315":570,"316":240,"317":330,"318":240,"319":450,"320":330,"321":240,"322":300,"323":240,"324":240,"325":420,"326":315,"327":480,"328":450,"329":480,"330":120,"331":240,"332":240,"333":285,"334":240,"335":120,"336":285,"337":240,"338":300,"339":240,"340":240,"341":240,"342":570,"343":240,"344":120,"345":330,"346":240,"347":450,"348":330,"349":240,"351":480,"352":360,"353":720,"354":720,"355":1320,"356":2880,"357":480,"358":1440,"359":480,"360":1440,"361":180,"400":300,"401":240,"402":300,"403":240,"450":132,"451":56,"452":168,"453":132,"454":192,"455":144,"456":116,"457":120,"458":144,"459":132,"460":160,"461":168,"462":208,"463":180,"464":132,"465":168,"466":192,"467":208,"468":176,"469":192,"470":180,"471":152,"472":132,"473":144,"474":192,"475":160,"476":204,"477":224,"478":128,"479":160,"480":192,"481":180,"482":204,"483":144,"600":240,"601":180,"602":720,"603":480,"604":240,"605":340,"606":600,"607":140,"608":260,"609":480,"630":240,"631":210,"632":200,"633":200,"634":220,"635":420,"636":180,"637":160,"638":280,"639":600,"660":180,"661":340,"662":600,"663":260,"664":480,"665":260,"666":300,"667":720,"668":720,"669":280,"700":720,"701":360,"702":720,"703":2880,"704":480,"705":300,"706":600,"707":360,"708":240,"709":1440,"750":480,"751":720,"752":1440,"753":600,"754":2160,"755":1440,"756":2520,"757":1200,"758":1920,"759":1080,"800":360,"801":240,"802":240,"803":480,"804":120,"805":600,"806":240,"807":720,"808":360,"809":360,"810":240,"811":480,"812":600,"813":180,"814":720,"815":360,"816":420,"817":300,"818":240,"819":360,"820":2880,"821":4320,"822":1440,"823":5040,"824":5760,"825":1200,"826":2880,"827":7200,"828":1140,"829":6900,"830":5100,"831":2880,"832":7800,"833":2580,"834":5100,"900":720,"901":480,"902":480,"903":720,"904":600,"905":960,"906":600,"907":960,"908":600,"909":960,"910":720,"911":720,"912":480,"913":720,"914":480,"915":720,"916":600,"917":480,"918":600,"919":480,"920":720,"921":720}
                       ,{"1":600,"2":960,"3":2160,"4":480,"5":2750,"6":490,"7":1200,"8":2520,"9":2790,"10":1440,"41":300,"42":345,"43":360,"44":270,"45":300,"46":330,"47":420,"48":480,"49":510,"50":180,"51":210,"52":240,"53":480,"54":510,"55":540,"56":300,"57":375,"58":470,"59":360,"60":450,"61":420,"62":290,"63":410,"64":530,"65":480,"66":510,"67":540,"101":240,"102":700,"103":640,"104":360,"105":960,"106":90,"107":120,"108":1320,"109":570,"110":330,"111":160,"112":935,"113":120,"114":300,"115":180,"116":1040,"117":1920,"118":300,"119":1440,"120":2010,"121":480,"122":300,"123":840,"124":690,"125":120,"126":240,"127":255,"128":525,"129":375,"130":410,"131":480,"132":225,"133":120,"134":1080,"143":720,"144":480,"146":400,"148":1440,"149":240,"150":480,"151":720,"152":600,"153":360,"154":960,"200":300,"201":300,"202":300,"203":300,"204":300,"205":300,"206":300,"207":300,"208":300,"209":300,"210":300,"211":300,"212":300,"213":300,"214":300,"215":300,"500":0,"501":0,"502":0,"511":0,"512":0}
                       ];
/*
var new_PRODUCT_GROWTIME=PRODUCT_GROWTIME.clone();
   for(var v=950;v<=957;v++){
       new_PRODUCT_GROWTIME[0][v]=Math.round(parseInt(unsafeWindow.produkt_zeit[v],10)/60);
}
console.log(implode(new_PRODUCT_GROWTIME))
*/

// Points earned at cropping (just where game data has to be overridden)
// task_new_plant task_new_product task_fix_points
const PRODUCT_POINTS=[{"7":267,"164":36,"165":27,"166":54}
                     ,{"1":30,"2":48,"3":108,"4":24,"5":138,"6":0,"7":60,"8":126,"9":150,"10":80,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"41":150,"42":105,"43":108,"44":108,"45":60,"46":66,"47":294,"48":144,"49":153,"50":54,"51":42,"52":48,"53":48,"54":51,"55":54,"56":33,"57":38,"58":47,"59":39,"60":45,"61":42,"62":39,"63":45,"64":62,"65":46,"66":60,"67":78,"101":48,"102":140,"103":128,"104":74,"105":0,"106":18,"107":66,"108":0,"109":114,"110":70,"111":32,"112":187,"113":24,"114":60,"115":36,"116":208,"117":384,"118":660,"119":0,"120":0,"121":96,"122":60,"123":168,"124":138,"125":24,"126":48,"127":51,"128":105,"129":75,"130":82,"131":96,"132":45,"133":24,"134":320,"143":180,"144":100,"146":130,"148":1,"149":75,"150":155,"151":250,"152":200,"153":130,"154":400,"200":131,"201":150,"202":307,"203":312,"204":120,"205":194,"206":236,"207":350,"208":138,"209":199,"210":184,"211":379,"212":157,"213":183,"214":230,"215":330,"300":0,"500":0,"501":0,"502":0,"511":0,"512":0}
                     ];
// Required quest to unlock product
// task_new_product task_new_quest
const PRODUCT_QUEST=[{"117":["main",2,15],"118":["main",2,25],"119":["main",2,35],"120":["main",2,45],"121":["main",2,50],"123":["main",2,15],"124":["main",2,25],"125":["main",2,35],"351":["main",3,1],"352":["main",3,3],"353":["main",3,8],"354":["main",3,31],"355":["main",3,39],"356":["main",3,55],"357":["main",3,63],"358":["main",3,79],"359":["main",3,87],"360":["main",3,103],"361":["main",3,111],"700":["main",4,1],"701":["main",4,3],"702":["main",4,5],"703":["main",4,10],"704":["main",4,17],"705":["main",4,31],"706":["main",4,46],"707":["main",4,61],"708":["main",4,74],"709":["main",4,89],"950":["main",5,4],"951":["main",5,8],"952":["main",5,1],"953":["main",5,43],"954":["main",5,63],"955":["main",5,16],"956":["main",5,88],"957":["main",5,28]}
                    ,{"1":["forestry",1,3],"2":["forestry",1,9],"3":["forestry",1,24],"4":["forestry",1,47],"5":["forestry",1,63],"7":["forestry",2,35],"8":["forestry",2,45],"9":["forestry",2,51],"10":["forestry",2,77],"21":["forestry",1,3],"22":["forestry",1,9],"23":["forestry",1,24],"24":["forestry",1,47],"25":["forestry",1,63],"26":["forestry",2,35],"27":["forestry",2,45],"28":["forestry",2,51],"29":["forestry",2,77],"41":["forestry",1,6],"42":["forestry",1,6],"43":["forestry",1,6],"44":["forestry",1,9],"45":["forestry",1,9],"46":["forestry",1,9],"47":["forestry",1,24],"48":["forestry",1,24],"49":["forestry",1,24],"50":["forestry",1,47],"51":["forestry",1,47],"52":["forestry",1,47],"53":["forestry",1,63],"54":["forestry",1,63],"55":["forestry",1,63],"56":["forestry",2,35],"57":["forestry",2,35],"58":["forestry",2,35],"59":["forestry",2,45],"60":["forestry",2,45],"61":["forestry",2,45],"62":["forestry",2,51],"63":["forestry",2,51],"64":["forestry",2,51],"65":["forestry",2,77],"66":["forestry",2,77],"67":["forestry",2,77],"101":["forestry",1,12],"102":["forestry",1,18],"103":["forestry",1,21],"104":["forestry",1,27],"105":["forestry",1,30],"106":["forestry",1,33],"107":["forestry",1,36],"108":["forestry",1,39],"109":["forestry",1,42],"110":["forestry",1,60],"111":["forestry",1,50],"112":["forestry",1,53],"115":["forestry",1,66],"116":["forestry",1,69],"117":["forestry",1,75],"118":["forestry",1,72],"119":["forestry",2,16],"120":["forestry",2,24],"121":["forestry",2,35],"122":["forestry",2,35],"123":["forestry",2,36],"124":["forestry",2,42],"125":["forestry",2,43],"126":["forestry",2,46],"127":["forestry",2,46],"128":["forestry",2,47],"129":["forestry",2,47],"130":["forestry",2,48],"131":["forestry",2,48],"132":["forestry",2,49],"134":["forestry",2,67],"143":["forestry",2,62],"144":["forestry",2,59],"146":["forestry",2,52],"148":["forestry",2,64],"149":["forestry",2,83],"150":["forestry",2,89],"151":["forestry",2,95],"152":["forestry",2,101],"153":["forestry",2,107],"154":["forestry",2,113],"200":["forestry",1,6],"201":["forestry",1,9],"202":["forestry",1,24],"203":["forestry",1,47],"204":["forestry",1,6],"205":["forestry",1,9],"206":["forestry",1,24],"207":["forestry",1,47],"208":["forestry",1,6],"209":["forestry",1,9],"210":["forestry",1,24],"211":["forestry",1,47],"212":["forestry",1,6],"213":["forestry",1,9],"214":["forestry",1,24],"215":["forestry",1,47]}
                    ];
// Required level to unlock product
// task_new_product
//const 13102016
 PRODUCT_LEVEL={"veterinary":{"250":1,"251":1,"252":1,"253":2,"254":3,"255":4,"256":5,"257":6,"258":7,"259":8,"260":9,"261":10,"262":11,"263":12,"264":13,"265":14,"266":16,"267":18,"268":20,"269":22,"270":24,"271":26,"272":28,"273":30,"274":32,"275":44,"276":60,"300":1,"301":1,"302":1,"303":2,"304":3,"305":4,"306":5,"307":6,"308":7,"309":8,"310":9,"311":10,"312":11,"313":12,"314":13,"315":14,"316":16,"317":18,"318":20,"319":22,"320":24,"321":26,"322":28,"323":30,"324":32,"325":34,"326":36,"327":38,"328":40,"329":42,"330":44,"331":46,"332":48,"333":50,"334":51,"335":52,"336":53,"337":54,"338":55,"339":56,"340":57,"341":58,"342":59,"343":60,"344":61,"345":62,"346":63,"347":64,"348":65,"349":66,"400":67,"401":68,"402":69,"403":70},
"breeding":{"600":1,"601":2,"602":3,"603":8,"604":7,"605":14,"606":12,"607":10,"608":11,"609":5,"630":6,"631":13,"632":4,"633":14,"634":2,"635":5,"636":1,"637":9,"638":8,"639":11,"660":14,"661":9,"662":7,"663":13,"664":3,"665":12,"666":6,"667":4,"668":1,"669":10},
"sushibar":{"970":16,"971":20,"972":3,"973":2,"974":1,"975":17,"976":8,"977":12,"978":11,"979":1,"980":15,"981":6,"982":5,"983":19,"984":13,"985":9}
};

// Required products to produce in format -> "prodId": [[type_p1, prodId_p1, amount_p1], [type_p2, prodId_p2, amount_p2], ...]
// [-1, amount] is money; [0, 0, amount] are coins
// 13102016
const PRODUCT_REQUIRE=[{"25":[[0,9,30]],"27":[[0,10,12]],"28":[[0,11,8]],"30":[[0,12,5]],"111":[[0,110,5]],"116":[[0,2,1980]],"117":[[0,7,550]],"118":[[0,4,1020]],"119":[[0,38,650]],"120":[[0,42,110]],"121":[[0,43,100]],"122":[[0,112,130],[0,116,35]],"123":[[0,113,220],[0,117,35]],"124":[[0,114,345],[0,118,35]],"125":[[0,115,80],[0,119,35]],"130":[[0,17,400]],"131":[[0,21,150]],"132":[[0,20,100],[0,10,2]],"133":[[0,19,100],[0,10,2]],"134":[[0,17,400],[0,6,25]],"135":[[0,21,150],[0,6,25]],"136":[[0,2,120]],"137":[[0,1,200]],"138":[[0,1,200],[0,23,30]],"139":[[0,18,150],[0,22,30]],"140":[[0,21,150],[0,22,30]],"141":[[0,26,100],[0,144,3]],"142":[[0,26,100],[0,25,3]],"143":[[0,26,100],[0,25,3],[0,144,3]],"144":[[0,21,450]],"145":[[0,33,300],[0,12,2]],"146":[[0,35,200],[0,10,4],[0,12,2]],"147":[[0,37,60],[0,12,2]],"148":[[0,31,250],[0,26,150],[0,27,7]],"149":[[0,21,300],[0,43,10],[0,22,50],[0,121,4]],"150":[[0,38,60],[0,119,6],[0,17,50]],"152":[[0,151,5]],"155":[[0,152,5],[0,28,6]],"156":[[0,152,8],[0,28,5]],"157":[[0,152,2],[0,28,9]],"161":[[0,1,300],[0,17,150]],"162":[[0,1,250],[0,20,200]],"163":[[0,22,190],[0,26,120]],"164":[[0,1,150],[0,10,30]],"165":[[0,10,10],[0,12,5]],"166":[[0,10,10],[0,27,7]],"167":[[0,40,60],[0,111,10]],"168":[[0,10,10],[0,42,25]],"169":[[0,6,300],[0,9,15],[0,121,3]],"170":[[0,1,200],[0,43,20],[0,121,4]],"200":[[-1,1200],[0,171,24],[0,172,20],[0,173,12]],"201":[[-1,1400],[0,171,25],[0,172,18],[0,174,15]],"202":[[-1,1500],[0,172,22],[0,173,19],[0,174,16]],"203":[[-1,1460],[0,172,19],[0,173,16],[0,175,29]],"204":[[-1,1510],[0,171,7],[0,173,18],[0,174,8],[0,176,21]],"205":[[-1,1622],[0,171,14],[0,173,22],[0,176,10],[0,177,12]],"206":[[-1,1787],[0,174,16],[0,176,9],[0,177,10],[0,178,9]],"207":[[-1,1894],[0,173,15],[0,175,10],[0,177,11],[0,179,8]],"208":[[-1,1950],[0,173,12],[0,175,13],[0,178,15],[0,180,18]],"209":[[-1,2110],[0,171,12],[0,176,21],[0,179,7],[0,181,9]],"210":[[-1,2250],[0,171,12],[0,175,5],[0,179,34],[0,182,11]],"211":[[-1,2357],[0,172,9],[0,176,12],[0,181,22],[0,183,18]],"212":[[-1,2488],[0,171,13],[0,182,13],[0,183,16],[0,184,6]],"213":[[-1,2595],[0,171,3],[0,179,8],[0,185,7],[0,186,9],[0,187,7]],"214":[[0,0,2],[0,171,10],[0,172,14],[0,173,13],[0,174,18]],"215":[[0,0,2],[0,171,12],[0,172,22],[0,174,10],[0,175,19]],"216":[[0,0,2],[0,173,14],[0,175,8],[0,177,19],[0,178,16]],"217":[[0,0,3],[0,171,19],[0,177,5],[0,178,17],[0,180,13]],"218":[[0,0,3],[0,180,9],[0,181,8],[0,182,9],[0,183,9]],"219":[[0,0,3],[0,179,4],[0,182,1],[0,185,6],[0,186,15],[0,187,7]],"220":[[-1,1500],[0,171,70],[0,172,180],[0,173,80],[0,174,80],[0,188,1]],"221":[[-1,1500],[0,171,80],[0,172,50],[0,173,65],[0,174,140],[0,189,1]],"300":[[-1,100],[0,250,240],[0,251,210]],"301":[[-1,200],[0,251,160],[0,252,200]],"302":[[-1,300],[0,252,230],[0,250,210]],"303":[[-1,400],[0,253,220],[0,252,150]],"304":[[-1,500],[0,253,150],[0,254,110]],"305":[[0,0,1],[0,254,90],[0,255,100]],"306":[[0,0,1],[0,256,80],[0,255,80]],"307":[[-1,600],[0,257,210],[0,256,160]],"308":[[0,0,1],[0,258,130],[0,257,160]],"309":[[-1,700],[0,259,190],[0,258,140]],"310":[[0,0,2],[0,260,90],[0,259,90]],"311":[[-1,800],[0,261,390],[0,260,390]],"312":[[0,0,2],[0,262,130],[0,261,150]],"313":[[-1,900],[0,263,180],[0,262,230]],"314":[[0,0,2],[0,264,90],[0,263,80]],"315":[[-1,1000],[0,265,100],[0,264,130]],"316":[[0,0,3],[0,266,130],[0,265,90]],"317":[[-1,1100],[0,267,290],[0,266,260]],"318":[[0,0,3],[0,268,160],[0,267,170]],"319":[[-1,1200],[0,269,130],[0,268,180]],"320":[[-1,1300],[0,270,90],[0,269,80]],"321":[[0,0,3],[0,271,50],[0,270,100]],"322":[[-1,1400],[0,272,380],[0,271,320]],"323":[[0,0,4],[0,273,190],[0,272,160]],"324":[[-1,1500],[0,272,321],[0,274,281]],"325":[[-1,1600],[0,250,480],[0,251,420]],"326":[[-1,1700],[0,251,320],[0,252,400]],"327":[[-1,1800],[0,250,420],[0,252,460]],"328":[[-1,1900],[0,252,300],[0,253,440]],"329":[[-1,2000],[0,253,300],[0,254,220]],"330":[[-1,2100],[0,273,71],[0,275,111]],"331":[[0,0,4],[0,254,180],[0,255,200]],"332":[[0,0,4],[0,255,160],[0,256,160]],"333":[[-1,2200],[0,256,320],[0,257,420]],"334":[[0,0,4],[0,257,320],[0,258,260]],"335":[[-1,2300],[0,272,111],[0,274,90]],"336":[[-1,2400],[0,258,280],[0,259,380]],"337":[[0,0,5],[0,259,180],[0,260,180]],"338":[[-1,2500],[0,260,780],[0,261,780]],"339":[[0,0,5],[0,261,300],[0,262,160]],"340":[[-1,2600],[0,262,460],[0,263,360]],"341":[[0,0,5],[0,263,160],[0,264,180]],"342":[[-1,2700],[0,264,260],[0,265,200]],"343":[[0,0,6],[0,265,180],[0,266,260]],"344":[[0,0,6],[0,256,71],[0,276,51]],"345":[[-1,2800],[0,266,520],[0,267,580]],"346":[[0,0,6],[0,267,340],[0,268,320]],"347":[[-1,2900],[0,268,360],[0,269,260]],"348":[[-1,3000],[0,269,160],[0,270,180]],"349":[[0,0,6],[0,270,200],[0,271,100]],"400":[[-1,3100],[0,271,640],[0,272,760]],"401":[[0,0,7],[0,272,320],[0,273,380]],"402":[[-1,3200],[0,272,181],[0,275,221]],"403":[[0,0,7],[0,257,111],[0,276,141]],"450":[[0,20,190],[0,10,15]],"451":[[0,33,120],[0,111,5]],"452":[[0,34,100],[0,9,15]],"453":[[0,35,150],[0,10,10]],"454":[[0,36,190],[0,10,12]],"455":[[0,37,200],[0,9,8]],"456":[[0,40,40],[0,10,8]],"457":[[0,351,20],[0,9,8]],"458":[[0,356,10],[0,10,12]],"459":[[0,361,18],[0,111,8]],"460":[[0,360,14],[0,10,15]],"461":[[0,357,18],[0,10,16]],"462":[[0,352,16],[0,9,20]],"463":[[0,353,20],[0,10,18]],"464":[[0,359,22],[0,111,14]],"465":[[0,355,12],[0,9,16]],"466":[[0,354,15],[0,111,8],[0,12,5]],"467":[[0,358,14],[0,10,12],[0,9,16]],"468":[[0,10,6],[0,356,20]],"469":[[0,6,40],[0,37,120],[0,352,60]],"470":[[0,351,120],[0,355,50],[0,359,80]],"471":[[0,10,12],[0,351,100],[0,360,40]],"472":[[0,10,20],[0,360,100]],"473":[[0,352,120],[0,357,120]],"474":[[0,6,20],[0,117,6],[0,154,50]],"475":[[0,9,20],[0,44,40],[0,153,40]],"476":[[0,6,15],[0,111,6],[0,115,25]],"477":[[0,1,200],[0,27,12],[0,351,80]],"478":[[0,39,20],[0,111,6]],"479":[[0,1,250],[0,9,10],[0,41,20]],"480":[[0,10,10],[0,12,10],[0,352,30]],"481":[[0,111,6],[0,355,12],[0,359,25]],"482":[[0,1,200],[0,9,8],[0,356,20]],"483":[[0,10,10],[0,111,8],[0,127,15]],"600":[[-1,200],[0,1,340],[0,10,3],[0,12,4]],"601":[[0,0,1],[0,6,60],[0,17,500],[0,111,12]],"602":[[-1,300],[0,1,500],[0,2,200],[0,3,200],[0,26,20]],"603":[[-1,600],[0,8,15],[0,108,100],[0,109,150]],"604":[[-1,400],[0,32,50],[0,33,30],[0,34,30]],"605":[[0,0,4],[0,9,12],[0,10,10],[0,27,10]],"606":[[-1,800],[0,3,220],[0,6,150],[0,18,200],[0,23,30]],"607":[[0,0,2],[0,5,220],[0,17,500],[0,24,200],[0,111,20]],"608":[[0,0,3],[0,1,400],[0,10,8],[0,37,20],[0,111,6]],"609":[[0,0,2],[0,35,30],[0,36,10],[0,37,20]],"630":[[0,0,2],[0,28,7],[0,30,12],[0,109,100]],"631":[[0,0,3],[0,11,17],[0,26,20],[0,29,20],[0,35,20]],"632":[[0,0,1],[0,7,20],[0,17,300],[0,28,10]],"633":[[0,0,4],[0,2,350],[0,11,12],[0,28,8]],"634":[[-1,300],[0,1,400],[0,6,50],[0,28,5]],"635":[[-1,400],[0,11,10],[0,17,420],[0,38,100]],"636":[[-1,200],[0,19,30],[0,30,5],[0,38,20]],"637":[[-1,600],[0,24,60],[0,34,200],[0,35,30],[0,111,18]],"638":[[0,0,2],[0,28,18],[0,153,40]],"639":[[-1,800],[0,9,13],[0,21,100],[0,26,80]],"660":[[0,0,4],[0,11,15],[0,17,450],[0,28,11]],"661":[[0,0,2],[0,4,250],[0,11,17],[0,20,30],[0,23,60]],"662":[[0,0,2],[0,4,300],[0,5,75],[0,36,25],[0,108,20]],"663":[[-1,800],[0,8,40],[0,11,11],[0,108,140],[0,109,200]],"664":[[0,0,1],[0,2,250],[0,7,25],[0,8,25]],"665":[[0,0,3],[0,1,460],[0,4,80],[0,11,17]],"666":[[-1,400],[0,3,100],[0,11,8],[0,18,0],[0,24,50]],"667":[[-1,300],[0,1,400],[0,7,30],[0,11,6]],"668":[[-1,200],[0,5,100],[0,6,30],[0,18,200]],"669":[[-1,600],[0,11,10],[0,28,7],[0,33,20]],"750":[[0,700,30],[0,701,60],[0,702,30]],"751":[[0,701,100],[0,702,70],[0,703,30]],"752":[[0,702,100],[0,703,80],[0,704,120]],"753":[[0,703,40],[0,704,60],[0,705,120]],"754":[[0,704,330],[0,705,450],[0,706,30]],"755":[[0,705,300],[0,706,80],[0,707,80]],"756":[[0,706,100],[0,707,200],[0,708,100]],"757":[[0,707,80],[0,708,100],[0,709,50]],"758":[[0,708,110],[0,709,65],[0,700,80]],"759":[[0,709,50],[0,700,80],[0,701,70]],"800":[[0,0,1],[0,1,400],[0,3,200],[0,6,60]],"801":[[-1,30],[0,1,400],[0,2,260]],"802":[[0,0,2],[0,17,420],[0,26,180]],"803":[[0,0,3],[0,8,20],[0,109,80],[0,154,8]],"804":[[-1,20],[0,5,60],[0,17,150]],"805":[[-1,40],[0,2,250],[0,4,160]],"806":[[0,0,5],[0,3,70],[0,6,50],[0,154,6]],"807":[[-1,150],[0,4,100],[0,7,30]],"808":[[0,0,7],[0,7,30],[0,8,20],[0,109,100]],"809":[[-1,180],[0,5,80],[0,17,200],[0,26,80]],"810":[[-1,250],[0,3,220],[0,17,330]],"811":[[0,0,9],[0,2,160],[0,4,200],[0,7,50]],"812":[[-1,500],[0,1,400],[0,8,50]],"813":[[-1,500],[0,6,40],[0,26,80]],"814":[[-1,1000],[0,5,220],[0,109,130]],"815":[[0,0,15],[0,1,240],[0,154,18]],"816":[[0,0,16],[0,6,50],[0,7,70],[0,8,20]],"817":[[0,0,20],[0,2,250],[0,4,260],[0,26,180]],"818":[[-1,1600],[0,5,30],[0,154,10]],"819":[[-1,2000],[0,3,240],[0,109,180]],"820":[[0,12,4],[0,10,3],[0,20,6]],"821":[[0,12,4],[0,10,8],[0,40,10]],"822":[[0,12,3],[0,10,3],[0,33,20]],"823":[[0,12,6],[0,352,15],[0,357,16],[0,355,6]],"824":[[0,12,6],[0,360,12],[0,351,10],[0,359,15]],"900":[[0,2,180],[0,27,8],[0,109,45]],"901":[[0,10,15],[0,40,16],[0,108,40]],"902":[[0,0,2],[0,9,15],[0,35,30],[0,154,20]],"903":[[0,7,30],[0,18,220],[0,27,10]],"904":[[0,0,4],[0,12,4],[0,29,40],[0,114,80]],"905":[[0,3,200],[0,24,120],[0,25,10]],"906":[[0,0,3],[0,9,20],[0,31,100],[0,109,120]],"907":[[0,4,270],[0,12,6],[0,20,230]],"908":[[0,0,3],[0,25,3],[0,41,10],[0,108,50]],"909":[[0,8,35],[0,10,20],[0,26,60]],"910":[[0,0,4],[0,7,20],[0,9,20],[0,153,30]],"911":[[0,0,5],[0,3,150],[0,27,6],[0,44,20]],"912":[[0,4,110],[0,9,15],[0,33,55]],"913":[[0,5,130],[0,8,30],[0,10,20]],"914":[[0,0,2],[0,9,20],[0,37,15],[0,108,50]],"915":[[0,22,180],[0,27,5],[0,154,20]],"916":[[0,0,3],[0,7,30],[0,10,10],[0,42,10]],"917":[[0,12,7],[0,112,15],[0,114,60]],"918":[[0,0,3],[0,3,120],[0,27,4],[0,34,25]],"919":[[0,21,240],[0,25,4],[0,109,80]],"920":[[0,0,4],[0,4,90],[0,12,6],[0,19,260]],"921":[[0,0,5],[0,8,20],[0,9,15],[0,43,6]],"922":[[0,12,5],[0,32,20],[0,108,45]],"923":[[0,7,25],[0,25,5],[0,39,5]],"970":[[0,950,9],[0,954,7],[0,18,6]],"971":[[0,0,20],[0,950,6],[0,956,8],[0,11,7]],"972":[[0,0,2],[0,950,15],[0,115,12],[0,18,15]],"973":[[0,950,7],[0,952,7],[0,9,7]],"974":[[0,952,14],[0,9,9],[0,115,11]],"975":[[0,0,17],[0,954,13],[0,21,10],[0,351,12]],"976":[[0,0,4],[0,955,8],[0,951,6],[0,112,7]],"977":[[0,957,14],[0,26,10],[0,34,11]],"978":[[0,957,14],[0,17,11],[0,19,12]],"979":[[0,952,14],[0,22,9],[0,112,13]],"980":[[0,0,15],[0,953,13],[0,29,10],[0,113,9]],"981":[[0,0,3],[0,950,8],[0,951,7],[0,17,10]],"982":[[0,951,14],[0,12,9],[0,42,11]],"983":[[0,0,19],[0,956,12],[0,42,10],[0,9,12]],"984":[[0,950,8],[0,953,7],[0,12,5]],"985":[[0,0,5],[0,950,6],[0,955,9],[0,360,7]]
,"1000":[[0,18,400],[0,22,90],[0,25,3]]
,"1001":[[0,0,3],[0,21,105],[0,9,9],[0,27,2]]
,"1002":[[0,1,410],[0,42,9],[0,10,8]]
,"1003":[[0,0,3],[0,2,185],[0,110,6],[0,12,3]]
,"1004":[[0,1,400],[0,26,80],[0,37,25]]
,"1005":[[0,0,3],[0,4,75],[0,32,45],[0,7,90]]
,"1006":[[0,9,11],[0,5,55],[0,20,150]]
,"1007":[[0,0,3],[0,40,10],[0,113,10],[0,6,230]]


}
                      ,{"41":[[1,21,1]],"42":[[1,21,1]],"43":[[1,21,1]],"44":[[1,22,1]],"45":[[1,22,1]],"46":[[1,22,1]],"47":[[1,23,1]],"48":[[1,23,1]],"49":[[1,23,1]],"50":[[1,24,1]],"51":[[1,24,1]],"52":[[1,24,1]],"53":[[1,25,1]],"54":[[1,25,1]],"55":[[1,25,1]],"56":[[1,26,1]],"57":[[1,26,1]],"58":[[1,26,1]],"59":[[1,27,1]],"60":[[1,27,1]],"61":[[1,27,1]],"62":[[1,28,1]],"63":[[1,28,1]],"64":[[1,28,1]],"65":[[1,29,1]],"66":[[1,29,1]],"67":[[1,29,1]],"101":[[1,41,4]],"102":[[1,41,18],[1,42,2]],"103":[[1,44,11]],"104":[[1,42,1],[1,43,5]],"105":[[1,44,20],[1,45,50],[1,46,70]],"106":[[1,49,1]],"107":[[1,46,1]],"108":[[1,47,125],[1,48,65],[1,49,32]],"109":[[1,47,5]],"110":[[1,50,9],[1,51,4]],"111":[[1,52,4]],"112":[[1,50,12],[1,51,7],[1,52,6]],"113":[[1,42,1]],"114":[[1,41,1],[1,43,1]],"115":[[1,53,8],[1,55,2]],"116":[[1,53,120],[1,54,40],[1,55,40]],"117":[[1,53,80],[1,54,65],[1,55,125]],"118":[[1,53,6],[1,54,8]],"119":[[1,54,20],[1,55,25]],"120":[[1,54,35],[1,55,40]],"121":[[1,56,7],[1,57,3]],"122":[[1,58,9]],"123":[[1,57,4],[1,58,5]],"124":[[1,56,9],[1,57,4]],"125":[[1,58,3]],"126":[[1,61,5]],"127":[[1,60,3]],"128":[[1,60,6],[1,61,5]],"129":[[1,59,10],[1,60,8],[1,61,5]],"130":[[1,60,9],[1,61,8]],"131":[[1,59,6],[1,61,12]],"132":[[1,59,10],[1,60,8],[1,61,5]],"133":[[1,42,1]],"134":[[1,62,21],[1,63,15]],"143":[[1,62,21],[1,63,22],[1,64,15]],"144":[[1,64,15]],"146":[[1,45,12],[1,63,12],[1,46,6],[1,64,6]],"148":[[1,64,15],[1,63,10]],"149":[[1,65,10],[1,62,10]],"150":[[1,67,12],[1,46,12]],"151":[[1,67,6],[1,64,5]],"152":[[1,66,5],[1,65,7]],"153":[[1,64,6],[1,67,10]],"154":[[1,66,10],[1,64,10]],"200":[[1,41,12]],"201":[[0,0,2],[1,44,8]],"202":[[1,47,21]],"203":[[0,0,4],[1,51,20]],"204":[[1,42,6]],"205":[[0,0,2],[1,45,4]],"206":[[1,48,9]],"207":[[0,0,4],[1,52,20]],"208":[[1,41,15]],"209":[[0,0,2],[1,45,5]],"210":[[1,48,8]],"211":[[0,0,4],[1,50,27]],"212":[[1,43,15]],"213":[[0,0,2],[1,44,11]],"214":[[1,51,21]],"215":[[0,0,4],[1,52,22]]
                  }
                      ];
// Mapping between original material and final good, e.g. sapling with tree
// task_new_product
const PRODUCT_MAP={"forestry":{"1":21,"2":22,"3":23,"4":24,"5":25,"7":26,"8":27,"9":28,"10":29}
                  };
unsafeData.PRODUCT_MAP=PRODUCT_MAP.clone();
// Yielded amount of forestry production
// task_new_product
const PRODUCT_YIELD=[,{"1":1,"2":1,"3":1,"4":1,"5":1,"7":1,"8":1,"9":1,"10":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"41":5,"42":3,"43":3,"44":4,"45":2,"46":2,"47":7,"48":3,"49":3,"50":3,"51":2,"52":2,"53":8,"54":4,"55":4,"56":5,"57":3,"58":5,"59":6,"60":4,"61":3,"62":7,"63":5,"64":5,"65":6,"66":5,"67":4,"101":1,"102":1,"103":1,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1,"112":1,"113":1,"114":1,"115":1,"116":1,"117":1,"118":1,"119":1,"120":1,"121":1,"122":1,"123":1,"124":1,"125":1,"126":1,"127":1,"128":1,"129":1,"130":1,"131":1,"132":1,"133":1,"134":1,"143":1,"144":1,"146":1,"148":1,"149":1,"150":1,"151":1,"152":1,"153":1,"154":1,"200":1,"201":1,"202":1,"203":1,"204":1,"205":1,"206":1,"207":1,"208":1,"209":1,"210":1,"211":1,"212":1,"213":1,"214":1,"215":1}];
    /*
    var new_data=PRODUCT_YIELD.clone();
    new_data[1][7]=;
    GM_log(implode(new_data));
    */
const ANIMAL_MOVE=[,,[false,0,0,255,10,10,505],[false,0,0,280,1,0,525],[false,0,0,280,1,25,500],,,,,,,[false,2,20,120,4,0,200]];
// Upgrade-data of buildings
        /*  BUILDING    NAME                    TYPE
            0           empty
            1           Field                   Field
            2           Chickens                Stable
            3           Cows                    Stable
            4           Sheep                   Stable
            5           Bees                    Stable
            6           Clubhouse
            7           Cheese                  Factory
            8           Mayo                    Factory
            9           Whool                   Factory
            10          Bonbons                 Factory
            11          Fishs                   Stable
            12          Goats                   Stable
            13          Oil                     Factory
            14          Special-Oil             Factory
            15          Angora shed             Stable
            16          Knitting mill           Factory
            17          Architectural office
            18          Pony farm               Factory
            19          Megafield               Factory
            20          Fuelstation             Factory
            21          Tea Factory             Factory
            22          Bergstation
            23          Sushibar
            fw1         Soda stall              Foodworld
            fw2         Snack booth             Foodworld
            fw3         Pastry shop             Foodworld
            fw4         ice cream parlor        Foodworld
            fl1         Flower meadow           Farmersmarket
            fl2         Flower workshop         Farmersmarket
            fl3         Monster fruit culture   Farmersmarket
            fl4         Animal breeding         Farmersmarket
            fl5         Veterinary              Farmersmarket
            fl6         Speed eating            Farmersmarket
            fl7         Butterfly               Farmersmarket
            fl8         cowracing               Farmersmarket
            fl9         fishing                 Farmersmarket
            fl11        scouts                  farmersmarket
            m1          map_stall1              Map
            m2          map_stall2              Map
        */
// BUILDING_UPGRADES[zoneType][levelNr-1][needed level,buildcost,bonus,animalamount]
//     for Fuelstation: [needed level,buildcost,bonus=1,animalamount=1,yield per slot,duration]
// task_new_building
const BUILDING_UPGRADES={"1":[[1,2000,0.95,0],[15,21500,0.9,0],[21,76000,0.85,0],[27,192300,0.8,0],[33,"c20",0.8,0]],"2":[[2,2500,1,5],[7,15200,1,10],[12,32500,1,15],[23,134500,0.9,20],[29,350800,0.8,20]],"3":[[11,3400,1,2],[13,16300,1,3],[17,50200,1,4],[25,159600,0.9,5],[32,441000,0.8,6]],"4":[[14,6200,1,2],[18,33500,1,3],[20,76000,1,4],[28,210500,0.9,5],[34,482000,0.8,6]],"5":[[19,6800,1,1],[22,44800,1,2],[26,128200,1,3],[31,230600,0.9,4],[35,482000,0.8,4]],"7":[[16,5200,1,1],[19,33500,0.95,1],[25,106400,0.9,1],[30,230600,0.85,1],[33,441000,0.8,1]],"8":[[18,6800,1,1],[21,38000,0.95,1],[27,128200,0.9,1],[31,230600,0.85,1],[35,482000,0.8,1]],"9":[[27,8100,1,1],[30,53200,0.95,1],[33,140300,0.9,1],[36,264600,0.85,1],[38,597200,0.8,1]],"10":[[30,9700,1,1],[33,70200,0.95,1],[34,153700,0.9,1],[37,289200,0.85,1],[39,626300,0.8,1]],"11":[[16,10000,1,1],[20,85000,1,3],[24,200000,1,5],[28,"c22",0.9,6],[32,"c38",0.8,6]],"12":[[15,38000,1,2],[17,17200,1,3],[23,54600,1,4],[29,168800,0.9,5],[38,472400,0.8,6]],"13":[[31,16800,1,1],[32,86400,0.95,1],[34,174200,0.9,1],[36,362800,0.85,1],[38,796300,0.8,1]],"14":[[35,19400,1,1],[37,97100,0.95,1],[39,218400,0.9,1],[40,509800,0.85,1],[41,1388600,0.8,1]],"15":[[37,23000,1,1],[37,95300,1,2],[38,198500,1,3],[38,391700,0.9,4],[39,842200,0.8,5]],"16":[[38,97100,1,1],[39,209736,0.95,1],[40,467711,0.9,1],[41,1080413,0.85,1],[42,2538970,0.8,1]],"17":[[10,1000,1,1]],"18":[[10,5000,1,1]],"19":[[28,250000,1,1]],"20":[[40,421500,1,1,1,360],[40,0,1,1,2,420],[40,0,1,1,3,480],[40,0,1,1,4,510],[40,0,1,1,5,540],[40,0,1,1,6,570],[40,0,1,1,7,600],[40,0,1,1,8,660],[40,0,1,1,9,690],[40,0,1,1,10,720]],"21":[[42,150000,1,1],[42,400000,0.95,1],[43,800000,0.9,1],[43,1500000,0.85,1],[44,3000000,0.8,1]],"23":[[47,800000,1,1]],"fw1":[[11,7000,1,1],[11,24600,0.95,1],[11,64200,0.9,1],[11,114400,0.85,1],[11,186300,0.8,1]],"fw2":[[12,8400,1,1],[12,32500,0.95,1],[12,68900,0.9,1],[12,122400,0.85,1],[12,178600,0.8,1]],"fw3":[[12,11200,1,1],[12,43300,0.95,1],[12,91900,0.9,1],[12,163200,0.85,1],[12,238100,0.8,1]],"fw4":[[31,14400,1,1],[31,55700,0.95,1],[31,118100,0.9,1],[31,209800,0.85,1],[31,306200,0.8,1]],"fl1":[[23,85000,0.95,36]],"fl2":[[23,75000,1,1]],"fl3":[[31,900000,1,1]],"fl4":[[36,900000,1,1]],"fl5":[[36,1000000,1,1]],"fl6":[[31,900000,1,1]],"fl7":[[31,1500000,1,1]],"fl8":[[42,2000000,1,1]],"fl9":[[44,2000000,1,1]],"fl11":[[43,1750000,1,1]],"m1":[[9,30000,1,1]],"m2":[[13,60000,1,1]]
                        };
// produced thing -> production area
// task_new_plant task_new_product
// 13102016
const PRODUCT2BUILDING=[[,1,1,1,1,1,1,1,1,2,3,4,5,,,,,1,1,1,1,1,1,1,1,7,1,8,9,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,,,,,1,,,,,,,1,,,1,1,1,12,8,1,1,1,1,13,13,13,13,13,13,14,14,14,14,1,1,1,1,"fw1","fw1","fw1","fw1","fw1","fw1","fw2","fw2","fw2","fw2","fw2","fw2","fw2","fw2",7,"fw1","fw1","fw1","fw2","fw2","fw2",15,9,1,1,16,16,16,1,,,"fw3","fw3","fw3","fw3","fw3","fw3","fw3","fw3","fw3","fw3","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1","fl1",,,,,,,,,,,"fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2","fl2",,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,"fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5","fl5",20,1,1,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"fl5","fl5","fl5","fl5"
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw4","fw1","fw1","fw1","fw1","fw1","fw1","fw2","fw2","fw2","fw2","fw3","fw3","fw3","fw3","fw3","fw3",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4",,,,,,,,,,,,,,,,,,,,,"fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4",,,,,,,,,,,,,,,,,,,,,"fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4","fl4",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,21,21,21,21,21,21,21,21,21,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8","fl8",10,10,10,10,10,1,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9","fl9",,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,1,1,1,1,1,1,1,,,,,,,,,,,,,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,,,,,,,,,,,,,,,"fl11","fl11","fl11","fl11","fl11","fl11","fl11","fl11"]
                       ,{"1":"forest","2":"forest","3":"forest","4":"forest","5":"forest","7":"forest","8":"forest","9":"forest","10":"forest","21":"forest","22":"forest","23":"forest","24":"forest","25":"forest","26":"forest","27":"forest","28":"forest","29":"forest","41":"sawmill","42":"sawmill","43":"sawmill","44":"sawmill","45":"sawmill","46":"sawmill","47":"sawmill","48":"sawmill","49":"sawmill","50":"sawmill","51":"sawmill","52":"sawmill","53":"sawmill","54":"sawmill","55":"sawmill","56":"sawmill","57":"sawmill","58":"sawmill","59":"sawmill","60":"sawmill","61":"sawmill","62":"sawmill","63":"sawmill","64":"sawmill","65":"sawmill","66":"sawmill","67":"sawmill","101":"carpentry","102":"carpentry","103":"carpentry","104":"carpentry","105":"carpentry","106":"carpentry","107":"carpentry","108":"carpentry","109":"carpentry","110":"carpentry","111":"carpentry","112":"carpentry","113":"carpentry","114":"carpentry","115":"carpentry","116":"carpentry","117":"carpentry","118":"carpentry","119":"carpentry","120":"carpentry","121":"carpentry","122":"carpentry","123":"carpentry","124":"carpentry","125":"carpentry","126":"carpentry","127":"carpentry","128":"carpentry","129":"carpentry","130":"carpentry","131":"carpentry","132":"carpentry","133":"carpentry","134":"carpentry","143":"carpentry","144":"carpentry","146":"carpentry","148":"carpentry","149":"carpentry","150":"carpentry","151":"carpentry","152":"carpentry","153":"carpentry","154":"carpentry","200":"carpentry","201":"carpentry","202":"carpentry","203":"carpentry","204":"carpentry","205":"carpentry","206":"carpentry","207":"carpentry","208":"carpentry","209":"carpentry","210":"carpentry","211":"carpentry","212":"carpentry","213":"carpentry","214":"carpentry","215":"carpentry"}
                       ,[]
                       ,[,"windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill","windmill"]
                       ,[,"megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield",,,,,"megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"megafield","megafield","megafield",,,,"megafield",,,,,,,"megafield",,,"megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield",,,,,,,,,,,,,,,"megafield",,,,,,,"megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield","megafield"]
                       ];
unsafeData.PRODUCT2BUILDING=PRODUCT2BUILDING.clone();

/*var new_PRODUCT2BUILDING=PRODUCT2BUILDING.clone();
for(var v=970;v<=985;v++){
    new_PRODUCT2BUILDING[0][v]=23
}
console.log(implode(new_PRODUCT2BUILDING))
*/

// produced thing <- production area
// task_new_product
const BUILDING2PRODUCT=[,,[9],[10],[11],[12],,[25,144],[27,111],[28,152],[30,820,821,822,823,824],[91],[110],[116,117,118,119,120,121],[122,123,124,125],[151],[155,156,157],,,,[350],[750,751,752,753,754,755,756,757,758,759],,[970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985]];
unsafeData.BUILDING2PRODUCT=BUILDING2PRODUCT.clone();
// task_new_building
/*  TYPE             NUMBER
    Empty                   0
    Field                   1
    Stable                  2
    Factory                 3
    Foodworld               4
    Farmersmarket           4
    Pony                    5
    Monster fruit culture   7
    SpeedEating             8
    Butterfly               9
    Bergstation             10
    Obststand               11
    fishing                 12
    Sushibar                13
*/
const BUILDINGTYPE={"0":0,"1":1,"2":2,"3":2,"4":2,"5":2,"6":0,"7":3,"8":3,"9":3,"10":3,"11":2,"12":2,"13":3,"14":3,"15":2,"16":3,"17":0,"18":5,"19":0,"20":6,"21":3,"22":10,"23":13,"fl1":1,"fl2":4,"fl3":7,"fl4":4,"fl5":4,"fl6":8,"fl7":9,"fl8":4,"fl9":4,"fl11":4,"fw1":4,"fw2":4,"fw3":4,"fw4":4,"m1":11,"m2":11};
unsafeData.BUILDINGTYPE=BUILDINGTYPE.clone();
// task_new_building
const BUILDING_SIZE={"1":120,"forest":25,"fl1":36,"megafield":[11,9]};
unsafeData.BUILDING_SIZE=BUILDING_SIZE.clone();
// task_new_building

//13102016
const BUILDING_SLOTS={"13":3,"14":3,"16":3,"18":3,"20":4,"21":3,"23":14,"windmill":2,"sawmill":3,"carpentry":3,"fw1":3,"fw2":3,"fw3":3,"fw4":3,"fl0":17,"fl2":3,"fl3":3,"fl4":7,"fl5":7,"fl7":6,"fl8":34,"fl9":8,"fl11":4,"megafield":99,"m1":4,"m2":3};

unsafeData.BUILDING_SLOTS=BUILDING_SLOTS.clone();
// Needed input of a zone
// BUILDING_INPUT[buildTyp]{output}[alternatives]=[[prod1,amount1||reducing time1],...]
// task_new_product
const BUILDING_INPUT=[,,{"9":[[[1,600]],[[2,1200]]]},{"10":[[[3,900]],[[4,1800]]]},{"11":[[[5,2400]],[[6,4800]]]},{"12":[[[7,4800]],[[8,9600]]]},,{"25":[[[9,30]]],"144":[[[21,450]]]},{"27":[[[10,12]]],"111":[[[110,5]]]},{"28":[[[11,8]]],"152":[[[151,5]]]},{"30":[[[12,5]]],"820":[[[12,4],[10,3],[20,60]]],"821":[[[12,4],[10,8],[40,10]]],"822":[[[12,3],[10,3],[33,20]]],"823":[[[12,6],[352,15],[357,16],[355,6]]],"824":[[[12,6],[360,12],[351,10],[359,15]]]},{"91":[[[92,14400]],[[93,28800]]]},{"110":[[[108,3600]],[[109,1800]]]},{"116":[[[2,1980]]],"117":[[[7,550]]],"118":[[[4,1020]]],"119":[[[38,650]]],"120":[[[42,110]]],"121":[[[43,100]]]},{"122":[[[112,130],[116,35]]],"123":[[[113,220],[117,35]]],"124":[[[114,345],[118,35]]],"125":[[[115,80],[119,35]]]},{"151":[[[153,1560]],[[154,3120]]]},{"155":[[[152,5],[28,6]]],"156":[[[152,8],[28,5]]],"157":[[[152,2],[28,9]]]},,,,,{"750":[[[700,30],[701,60],[702,30]]],"751":[[[701,100],[702,70],[703,30]]],"752":[[[702,100],[703,80],[704,120]]],"753":[[[703,40],[704,60],[705,120]]],"754":[[[704,330],[705,450],[706,30]]],"755":[[[705,300],[706,80],[707,80]]],"756":[[[706,100],[707,200],[708,100]]],"757":[[[707,80],[708,100],[709,50]]],"758":[[[708,110],[709,65],[700,80]]],"759":[[[709,50],[700,80],[701,70]]]
},,{
"970":[[[950,9],[954,7],[18,6]]],"971":[[[0,20],[950,6],[956,8],[11,7]]],"972":[[[0,2],[950,15],[115,12],[18,15]]],"973":[[[950,7],[952,7],[9,7]]],"974":[[[952,14],[9,9],[115,11]]],"975":[[[0,17],[954,13],[21,10],[351,12]]],"976":[[[0,4],[955,8],[951,6],[112,7]]],"977":[[[957,14],[26,10],[34,11]]],"978":[[[957,14],[17,11],[19,12]]],"979":[[[952,14],[22,9],[112,13]]],"980":[[[0,15],[953,13],[29,10],[113,9]]],"981":[[[0,3],[950,8],[951,7],[17,10]]],"982":[[[951,14],[12,9],[42,11]]],"983":[[[0,19],[956,12],[42,10],[9,12]]],"984":[[[950,8],[953,7],[12,5]]],"985":[[[0,5],[950,6],[955,9],[360,7]]]}

];
 /*
"970":[[[0,950,9],[0,954,7],[0,18,6]]],"971":[[[0,0,20],[0,950,6],[0,956,8],[0,11,7]]],"972":[[[0,0,2],[0,950,15],[0,115,12],[0,18,15]]],"973":[[[0,950,7],[0,952,7],[0,9,7]]],"974":[[[0,952,14],[0,9,9],[0,115,11]]],"975":[[[0,0,17],[0,954,13],[0,21,10],[0,351,12]]],"976":[[[0,0,4],[0,955,8],[0,951,6],[0,112,7]]],"977":[[[0,957,14],[0,26,10],[0,34,11]]],"978":[[[0,957,14],[0,17,11],[0,19,12]]],"979":[[[0,952,14],[0,22,9],[0,112,13]]],"980":[[[0,0,15],[0,953,13],[0,29,10],[0,113,9]]],"981":[[[0,0,3],[0,950,8],[0,951,7],[0,17,10]]],"982":[[[0,951,14],[0,12,9],[0,42,11]]],"983":[[[0,0,19],[0,956,12],[0,42,10],[0,9,12]]],"984":[[[0,950,8],[0,953,7],[0,12,5]]],"985":[[[0,0,5],[0,950,6],[0,955,9],[0,360,7]]]
*/
unsafeData.BUILDING_INPUT=BUILDING_INPUT.clone();
// Zone  2 -> "9":[[[0,1,600]],[[0,2,1200]]]
// Zone  3 -> "10":[[[0,3,900]],[[0,4,1800]]]
// Zone  4 -> "11":[[[0,5,2400]],[[0,6,4800]]]
// Zone  5 -> "12":[[[0,7,4800]],[[0,8,9600]]]
// Zone 11 -> "91":[[[0,92,14400]],[[0,93,28800]]]
// Zone 12 -> "110":[[[0,108,3600]],[[0,109,1800]]]
// Zone 15 -> "151":[[[0,153,1560]],[[0,154,3120]]]
const FUELSTATION_INPUT=[
                        [[17,0],[31,0],[33,0],[113,0]],
                        [[1,0],[109,0],[108,0],[112,0]],
                        [[18,0],[23,0],[153,0],[37,0]],
                        [[19,0],[24,0],[29,0],[154,0]],
                        [[2,0],[38,0],[35,0],[39,0]],
                        [[3,0],[5,0],[36,0],[40,0]],
                        [[20,0],[26,0],[7,0],[115,0]],
                        [[21,0],[32,0],[44,0],[42,0],[126,0]],
                        [[22,0],[6,0],[34,0],[41,0],[127,0]],
                        [[4,0],[114,0],[8,0],[43,0],[128,0],[825,0],[826,0],[827,0],[828,0],[829,0],[830,0],[831,0],[832,0],[833,0],[834,0]]
                        ];

unsafeData.FUELSTATION_INPUT=FUELSTATION_INPUT.clone();
// price of an animal. formula: cost=Math.round(ANIMALCOST[zone][0]+nr*ANIMALCOST[zone][1])
// task_new_building
const ANIMALCOST=[,,[309,1000/19],[419,320],[529,320],[1599,2600/3],,,,,,[999,1000],[789,320],,,[2400,1200],,,];
// sizes of Farmis [width,height,left,top] in px , taken from setFarmis()
const FARMISIZE=[,[40,60,-1,-5],[30,40,0,0],[30,40,2,0],[33,45,2,0],[33,45,4,2],[40,65,2,-11],[40,65,-2,-20],[45,60,-2,-14]];
// QUESTS[questType][campaign][nr]=[[[type1,id1,amount1],...],waitdays,points,more]
// more: Array of items:
// [0,money]
// [1,type of gained product,id of gained product,amount]
// [2,number of accessed rack]
// [3,number of accessed farm]
// [4,type of product,id of product,minutes this product grows faster]]
// [5,number of additional farmis ('<img src=GFX+"adbonus.gif" style="border:0;height:15px;">')]
// [6,increase of stock capacity logs]
// [7,watering bonus in %]
// [8,id of accessed zone]
// [9,type of accessed product,id of accessed product]
// [10] access to watering of forest
// [11,number of additional farmi slots]
// [12,id of gained farmhouse item]
// [13,id of gained gift]
// [14,reduce treatment-time in %]
// [15,reduce production-time in %]
// [16,reward: more bandages in %]
// [17,reward: more money in %]
// [18,reward: more points in %]
// [19,reward: mumpfis pay more money in %]
// task_new_quest
const QUESTS =
                        {"main":{"1":[,[[[0,17,43],[0,9,1]],1,142,[[0,54]]],[[[0,1,173],[0,9,2]],1,348,[[0,145]]],[[[0,18,192],[0,17,288]],1,255,[[0,73]]],[[[0,18,672],[0,9,10]],1,1883,[[0,608]]],[[[0,17,922],[0,9,19]],1,2304,[[0,890]]],[[[0,20,360],[0,18,960]],1,3300],[[[0,19,540],[0,20,720]],1,6413],[[[0,2,240],[0,21,245]],1,2895],[[[0,20,1440],[0,9,24]],1,11700,[[1,0,47,1]]],[[[0,21,1152],[0,9,48]],1,16200],[[[0,9,72],[0,22,1037]],1,16202],[[[0,20,3456],[0,10,27]],1,25476],[[[0,18,8064],[0,10,48]],1,15660],[[[0,23,3110],[0,9,144]],1,57240],[[[0,10,96],[0,9,180]],1,33930,[[1,0,59,1]]],[[[0,9,240],[0,6,1836]],1,62190],[[[0,10,384],[0,9,144]],1,70920],[[[0,10,192],[0,23,6739]],1,116280,[[2,2]]],[[[0,22,7518],[0,9,216]],1,108956],[[[0,11,150],[[0,10,272],[0,110,112]]],1,34650],[[[0,7,1350],[0,12,50]],1,78375,[[1,0,63,1]]],[[[0,23,15552],[0,9,1008]],1,318600],[[[0,29,6552],[0,25,130]],1,373645,[[3,2]]],[[[0,1,51840],[[0,27,55],[0,111,51]]],1,60579],[[[0,11,280],[0,12,210]],1,138705],[[[[0,10,672],[0,110,276]],[0,12,210]],1,169785],[[[0,1,75600],[0,2,25000]],1,42131,[[1,0,90,1]]],[[[0,11,480],[0,12,272]],1,206760],[[[0,9,2688],[[0,10,1024],[0,110,420]]],1,448320],[[[0,12,320],[0,11,560]],1,242160],[[[0,29,14742],[[0,27,194],[0,111,180]]],1,836328,[[2,3]]],[[[0,20,77760],[0,12,383]],1,620831,[[1,0,78,1]]],[[[0,12,540],[0,32,14600]],1,449550],[[[0,32,50400],[0,25,432]],1,1208880],[[[[0,10,1760],[0,110,722]],[0,11,1000]],1,481800,[[3,3]]],[[[0,9,4800],[0,12,595]],1,749738],[[[0,26,46550],[[0,27,216],[0,111,201]]],1,933756,[[1,0,77,1]]],[[[0,1,259200],[0,30,216]],1,252960],[[[0,23,51840],[0,28,230]],1,856800],[[[0,9,5280],[[0,10,1795],[0,110,736]]],1,849816],[[[0,25,475],[0,30,238]],1,1665576,[[1,0,80,1]]],[[[0,34,64152],[0,28,253]],1,1704780],[[[0,11,1320],[0,12,880]],1,615120],[[[[0,27,238],[0,111,221]],[0,24,30294]],1,576923,[[1,0,76,1]]],[[[[0,10,2304],[0,110,945]],[0,30,259]],1,538272],[[[0,9,5760],[[0,10,2304],[0,110,945]]],1,976320],[[[0,37,13800],[0,25,518]],1,5559806,[[1,0,61,1]]],[[[0,9,5760],[[0,10,1958],[0,110,803]]],1,927072],[[[0,28,276],[0,30,259]],1,417312],[[[0,12,1040],[0,30,281]],1,376253,[[1,0,52,1]]],[[[0,20,72000],[0,12,800]],1,732000,[[4,0,23,15]]],[[[0,12,4000],[[0,10,1920],[0,110,787]]],1,1683600],[[[0,23,64800],[0,9,4800]],1,1395000],[[[0,25,432],[0,28,230]],1,373680,[[4,0,24,15]]],[[[0,24,72000],[[0,27,216],[0,111,201]]],1,1135800],[[[0,7,18000],[[0,10,1920],[0,110,787]]],1,1083600],[[[[0,27,216],[0,111,201]],[0,11,1200]],1,423000,[[4,0,31,15]]],[[[0,31,103700],[0,30,216]],1,2965498],[[[0,11,1200],[0,25,432]],1,478080,[[4,0,21,10]]],[[[0,21,57600],[[0,10,1920],[0,110,787]]],1,813600],[[[0,12,800],[[0,27,216],[0,111,201]]],1,427800,[[4,0,29,15]]],[[[0,29,27300],[0,25,432]],1,1506635],[[[0,4,48000],[0,9,4800]],1,855000],[[[0,28,230],[[0,27,216],[0,111,201]]],1,318600,[[4,0,33,15]]],[[[0,33,43200],[0,25,432]],1,1685880,[[5,1]]],[[[0,9,4800],[0,12,800]],1,822000,[[4,0,22,10]]],[[[0,8,18000],[0,28,230]],1,1792800],[[[[0,10,1920],[0,110,787]],[0,11,1200]],1,550800,[[4,0,34,15]]],[[[0,34,64800],[0,30,216]],1,1704960],[[[0,6,10800],[0,28,230]],1,207000],[[[0,11,1200],[[0,10,1920],[0,110,787]]],1,550800,[[4,0,35,20]]],[[[0,35,12950],[[0,27,216],[0,111,201]]],1,932692],[[[0,25,432],[0,11,1200]],1,478080],[[[0,32,72000],[0,12,800]],1,1722000,[[4,0,36,15]]],[[[0,36,24500],[0,9,4800]],1,3235000],[[[[0,27,216],[0,111,201]],[0,30,216]],1,320760,[[4,0,7,10]]],[[[0,26,66500],[0,28,230]],1,1298451],[[[0,12,800],[[0,10,1920],[0,110,787]]],1,555600,[[4,0,37,30]]],[[[0,37,3833],[0,9,4800]],1,2017431],[[[0,28,230],[0,25,432]],1,373680],[[[0,33,43200],[0,12,800]],1,1767000,[[4,0,38,15]]],[[[0,38,108000],[0,30,216]],1,3594960],[[[0,9,4800],[0,28,230]],1,712800,[[4,0,19,5]]],[[[0,5,72000],[[0,10,1920],[0,110,787]]],1,963600],[[[0,30,216],[0,9,4800]],1,714960,[[4,0,39,30]]],[[[0,39,2867],[0,12,800]],1,1834778],[[[[0,10,1920],[0,110,787]],[0,25,432]],1,474480],[[[0,32,72000],[[0,27,216],[0,111,201]]],1,1585800,[[4,0,40,30]]],[[[0,40,2250],[0,12,800]],1,1782000],[[[0,25,432],[0,11,1200]],1,478080,[[4,0,20,10]]],[[[0,3,64000],[0,30,216]],1,374960],[[[[0,27,216],[0,111,201]],[0,11,1200]],1,423000,[[4,0,41,30]]],[[[0,41,1975],[[0,10,1920],[0,110,787]]],1,1819998],[[[0,11,1200],[[0,27,216],[0,111,201]]],1,423000,[[4,0,8,15]]],[[[0,24,72000],[[0,10,1280],[0,110,787]]],1,1172400,[[5,1]]],[[[0,12,800],[0,9,4800]],1,822000,[[4,0,26,15]]],[[[0,36,24500],[0,28,230]],1,2867800],[[[0,31,103700],[[0,10,1920],[0,110,787]]],1,3064138,[[4,0,42,30]]],[[[0,28,230],[0,25,432]],1,373680],[[[0,42,1680],[0,30,216]],1,1693960,[[4,0,33,15]]],[[[0,4,80000],[0,30,210]],2,722800],[[[0,6,48000],[0,12,300]],2,854400],[[[0,1,800000],[0,25,320]],2,998400,[[4,0,32,10]]],[[[0,35,64000],[0,32,12000]],2,1629600],[[[0,26,108000],[0,11,540]],2,1452600],[[[0,39,12000],[0,9,5600]],2,2160000,[[4,0,43,30]]],[[[0,43,10000],[[0,27,600],[0,111,558]]],2,2556000],[[[0,24,184000],[0,25,480]],2,2248000],[[[0,9,10200],[[0,10,24000],[0,110,9840]]],2,2205600],[[[0,23,108000],[0,91,250]],2,1359600,[[12,105]]],[[[0,34,36936],[0,37,10580]],2,1959726],[[[0,29,78624],[0,26,5200]],2,2164176],[[[0,44,2016],[0,28,1600]],2,2059245],[[[[0,10,12000],[0,110,4920]],[0,12,1200]],2,1536000],[[[0,30,840]],2,906800,[[12,123]]],[[[0,40,3240],[0,36,9800]],2,1265312],[[[0,91,750],[0,31,72590]],2,1233972],[[[0,26,113050],[[0,27,600],[0,111,558]]],2,1874430],[[[0,38,7020],[0,42,2352]],2,2134942],[[[0,41,9480],[0,9,28800]],2,1886172,[[5,1]]],[[[0,23,174960],[0,22,98515]],2,2267541],[[[0,8,5040],[0,7,3780]],2,2022804],[[[0,32,27000],[[0,10,24000],[0,110,9840]]],2,2357400],[[[0,39,2580],[0,37,7935]],2,1525641,[[1,0,99,1]]],[[[0,33,51840],[0,35,20720]],2,2464720],[[[0,43,5000],[0,21,146880]],2,2139910],[[[0,31,60664],[0,26,100520]],2,1945541],[[[0,20,100800],[0,9,15360]],2,1216320,[[4,0,44,20]]],[[[[0,10,10080],[0,110,4132]],[0,11,4500]],2,1571400],[[[0,7,18900],[0,38,5400]],2,2239480],[[[0,40,3500],[0,35,12000]],2,1168200],[[[0,91,1000]],2,600000,[[12,137]]],[[[0,44,4400],[0,26,22400]],2,1284560],[[[0,3,280000],[0,31,40000]],2,1328000],[[[0,12,1200],[0,39,3900]],2,1228860],[[[0,7,9800],[0,2,240000]],2,1003320],[[[0,26,60000],[0,1,275000]],2,1031000],[[[0,11,6400]],2,1088000],[[[0,6,14444],[0,33,34000]],2,1158911],[[[[0,27,625],[0,111,581]]],2,1078125],[[[0,38,8600],[0,41,2900]],2,1056220],[[[0,43,4050],[0,7,5250]],2,1133280],[[[0,9,16200]],2,453600,[[5,1]]],[[[0,25,900],[[0,10,5400],[0,110,2214]]],2,990000],[[[0,37,8600]],2,1016520],[[[0,28,300],[[0,10,7500],[0,110,3075]]],2,1050000],[[[0,30,400],[0,42,3600]],2,1096880],[[[0,29,51000],[0,9,3600]],2,1069800],[[[0,91,175],[0,8,18200]],2,1087560],[[[0,36,10300],[0,41,3800]],2,1312700],[[[0,24,90000],[[0,10,800],[0,110,328]]],2,1028000],[[[0,22,95500],[0,1,300000]],2,930300],[[[0,35,13000],[0,32,33000]],2,1176800],[[[0,17,155000],[0,21,99999]],2,1049993],[[[0,38,13000],[[0,27,250],[0,111,232]]],2,1104650],[[[0,37,4444],[0,39,3333]],2,1083225],[[[0,2,122000],[0,21,122000]],2,1146800],[[[0,20,112000],[[0,10,2800],[0,110,1148]]],2,1097600],[[[0,9,1111],[0,26,66000]],2,1142108],[[[0,11,2320],[0,23,72000]],2,1200800],[[[0,19,116000],[0,25,900]],2,976200,[[5,1]]],[[[0,5,220000],[0,12,720]],2,1049600],[[[0,18,240000],[0,6,50000]],2,1028000],[[[0,41,4400],[0,1,150000]],2,1076640],[[[0,40,3250],[0,30,500]],2,1069300],[[[0,29,45000],[0,20,25000]],2,1050000],[[[0,91,840],[0,1,510000]],2,1014000],[[[0,34,45000],[0,12,680]],2,1190400],[[[0,31,425000],[0,43,2800]],2,1048680],[[[[0,10,7500],[0,110,3075]],[0,3,140000]],2,1048000,[[7,5]]]]
                        ,"2":[,[[[0,8,6500],[0,12,300]],,495000],[[[0,34,18600],[0,111,75]],,496298],[[[0,33,5650],[0,30,315]],,498270],[[[0,26,15600],[0,9,11200]],,506380],[[[0,37,2150],[0,12,530]],,508530],[[[0,18,175000],[0,91,505]],,511250],[[[0,108,6350],[0,7,5400]],,505010],[[[0,35,6530],[0,110,950]],,507946],[[[0,24,19150],[0,27,412]],,511190],[[[0,23,33000],[0,25,480]],,518500,[[3,4]]],[[[0,28,366],[0,46,100]],,516000],[[[0,116,460],[0,11,1400]],,523880],[[[0,21,42000],[0,9,8000]],,534800],[[[0,32,15420],[0,10,3630]],,540204],[[[0,7,5000],[0,30,265]],,550550,[[9,0,117],[9,0,123]]],[[[0,116,480],[0,91,777]],,551640],[[[0,19,84000],[0,110,1255]],,554475],[[[0,117,917],[0,18,277000]],,559816],[[[0,12,625],[0,109,42000]],,560400],[[[0,108,12300],[0,116,670]],,559600],[[[0,5,50500],[0,26,32000]],,564800],[[[0,117,490],[0,9,16000]],,569520],[[[0,29,16600],[0,31,24000]],,574600],[[[0,33,18200],[0,11,1800]],,589560],[[[0,4,40450],[0,116,1560]],,594810,[[9,0,118],[9,0,124]]],[[[0,3,110000],[0,12,515]],,599200],[[[0,17,75000],[0,10,6800]],,605000],[[[0,91,700],[0,34,9900]],,610080],[[[0,2,155000],[0,28,305]],,615000],[[[0,37,3800],[0,118,1450]],,617360,[[8,"20"]]],[[[0,1,172350],[0,111,558]],,622350],[[[0,117,1090],[0,36,5800]],,625320],[[[0,12,900],[0,25,310]],,624400],[[[0,31,38380],[0,118,1800]],,623304],[[[0,38,9200],[0,116,840]],,623304,[[9,0,119],[9,0,125]]],[[[0,65,10],[0,27,680]],,623333],[[[0,36,7500],[0,9,8000]],,627000],[[[0,6,13150],[0,110,2214]],,626620],[[[0,37,2415],[0,11,2000]],,625453],[[[0,119,735],[0,30,360]],,626280],[[[0,21,19000],[0,10,6120]],,630200],[[[0,33,14400],[0,35,4750]],,634970],[[[0,38,8200],[0,111,116]],,640341],[[[0,73,30],[0,28,600]],,650000],[[[0,42,2980],[0,117,430]],,660324,[[9,0,120]]],[[[0,39,2250],[0,12,666]],,696030],[[[0,40,2400],[0,30,286]],,700580],[[[0,41,2200],[0,118,2275]],,702800],[[[0,20,36000],[0,23,38000]],,706400],[[[0,43,1850],[0,120,690]],,709770,[[9,0,121]]],[[[0,108,14000],[0,8,13200]],,715040],[[[0,40,1950],[0,9,14200]],,719600],[[[0,39,1900],[0,116,1540]],,729920],[[[0,27,268],[0,43,1300]],,735580],[[[0,42,2300],[0,109,34850]],,740010],[[[0,112,3300],[0,121,500]],,748000],[[[0,41,2500],[0,111,138]],,754830],[[[0,119,1000],[0,29,22750]],,760250],[[[0,112,3300],[0,22,52300]],,766260],[[[0,32,24799],[0,9,13333]],,766260,[[8,"21"]]],[[[0,113,9100],[0,27,400]],,750000],[[[0,44,1142],[0,144,790]],,755000],[[[0,154,1695],[0,111,210]],,760000],[[[0,24,39500],[0,118,2350]],,765000],[[[0,153,6250],[0,26,22650]],,765000],[[[0,23,39500],[0,28,385]],,770000],[[[0,6,34500],[0,122,37]],,770000],[[[0,32,13400],[0,10,3900]],,775000],[[[0,39,990],[0,38,8400]],,775000],[[[0,144,1150],[0,123,46]],,780000],[[[0,9,7900],[0,151,85]],,780000],[[[0,5,56200],[0,4,41500]],,785000],[[[0,64,15],[0,152,80]],,785000],[[[0,31,28500],[0,91,550]],,790000],[[[0,20,59000],[0,30,720]],,790000,[[8,"22"]]],[[[0,114,15000],[0,29,25000]],,795000],[[[0,120,400],[0,11,4500]],,795000],[[[0,2,150000],[0,6,45000]],,800000],[[[0,40,9000],[0,25,200]],,800000],[[[0,7,28000],[0,30,225]],,805000],[[[0,32,65000],[0,1,190000]],,805000],[[[0,109,125000],[0,108,65000]],,810000],[[[0,22,92000],[0,27,450]],,810000],[[[0,124,1125],[0,21,85000]],,815000],[[[0,36,9500],[0,112,6600]],,815000],[[[0,116,840],[0,24,63000]],,820000],[[[0,26,63000],[0,117,700]],,820000],[[[0,152,120],[0,44,15000]],,825000],[[[0,144,450],[0,113,30000]],,825000],[[[0,125,650],[0,151,550]],,830000,[[8,"23"]]],[[[0,115,1680],[0,10,4200]],,835000],[[[0,154,7500],[0,118,3300]],,840000],[[[0,153,18500],[0,31,22000]],,845000],[[[0,42,2250],[0,110,1450]],,850000],[[[0,43,1500],[0,1,150000]],,855000],[[[0,41,2200],[0,12,1100]],,860000],[[[0,157,550],[0,120,600]],,865000],[[[0,33,14000],[0,35,16500]],,870000],[[[0,21,29500],[0,112,11500]],,875000],[[[0,10,3500],[0,114,18200]],,880000],[[[0,22,32000],[0,123,1250]],,885000],[[[0,30,650],[0,155,350]],,890000],[[[0,91,1050],[0,7,14000]],,895000],[[[0,29,18400],[0,26,21200]],,900000],[[[0,28,650],[0,152,250]],,905000],[[[0,157,320],[0,156,410]],,910000],[[[0,121,1000],[0,9,15000]],,915000],[[[0,44,62000],[0,144,450]],,920000],[[[0,8,18000],[0,12,1350]],,925000],[[[0,113,18000],[0,27,350]],,930000],[[[0,21,42500],[0,122,1850]],,935000],[[[0,22,95000],[0,120,950]],,940000],[[[0,40,5500],[0,41,6800]],,945000],[[[0,116,2500],[0,38,18600]],,950000],[[[0,111,650],[0,119,750]],,955000],[[[0,36,18500],[0,37,12000]],,960000],[[[0,6,32500],[0,117,1450]],,965000],[[[0,34,27500],[0,32,32100]],,970000],[[[0,151,600],[0,11,1200]],,980000],[[[0,125,1000],[0,124,1600]],,985000,[[8,"24"]]]]
                        ,"3":[,[[[0,18,134862],[0,26,16011]],,1134580,[[1,0,351,5],[9,0,351]]],[[[0,351,1080],[0,31,20094]],,1268060],[[[0,12,251],[0,9,826]],,1401540,[[1,0,352,5],[9,0,352]]],[[[0,352,1440],[0,350,10]],,1535020],[[[0,1,140257],[0,25,207]],,1668500],[[[0,351,1800],[0,23,18455]],,1801980],[[[0,113,3008],[0,18,134862]],,1935460],[[[0,352,3600],[0,31,20094]],,2068940,[[1,0,353,5],[9,0,353]]],[[[0,353,360],[0,3,52335]],,2202420],[[[0,352,4320],[0,34,11689]],,2335900],[[[0,351,720],[0,352,2160]],,2469380],[[[0,29,5656],[0,36,4155]],,2602860],[[[0,352,5040],[0,350,40]],,2736340],[[[0,21,35780],[0,26,16011]],,2869820],[[[0,27,138],[0,25,207]],,3003300],[[[0,353,1200],[0,29,5656]],,3136780],[[[0,22,30758],[0,28,119]],,3270260],[[[0,352,5760],[0,21,35780]],,3403740],[[[0,30,108],[0,10,638]],,3537220],[[[0,32,13513],[0,153,1871]],,3670700],[[[0,351,3600],[0,350,60]],,3804180],[[[0,111,129],[0,37,1871]],,3937660],[[[0,91,108],[0,22,33834]],,4071140],[[[0,351,3600],[0,21,43016]],,4204620,[[8,"26"]]],[[[0,352,4320],[0,30,130]],,4338100],[[[0,110,544],[0,22,36979]],,4471580],[[[0,353,840],[0,44,4633]],,4605060],[[[0,113,3616],[0,40,1630]],,4738540],[[[0,43,1274],[0,350,77]],,4872020],[[[0,351,720],[0,352,4320]],,5005500],[[[0,2,76647],[0,23,22188]],,5138980,[[1,0,354,5],[9,0,354]]],[[[0,354,540],[0,110,544]],,5272460],[[[0,20,58550],[0,39,1608]],,5405940],[[[0,351,720],[0,353,600]],,5539420],[[[0,353,720],[0,40,1630]],,5672900],[[[0,37,2249],[0,41,1400]],,5806380],[[[0,354,1260],[0,20,58550]],,5813054],[[[0,352,3600],[0,12,302]],,5814388],[[[0,17,526942],[0,33,9636]],,5815723,[[1,0,355,5],[9,0,355]]],[[[0,355,720],[0,350,104]],,5817058],[[[0,354,900],[0,10,767]],,5818393],[[[0,355,1680],[0,152,87]],,5819728],[[[0,42,1451],[0,108,8332]],,5821062],[[[0,355,2400],[0,109,22665]],,5822397],[[[0,111,155],[0,9,992]],,5823732],[[[0,352,5040],[0,30,130]],,5825067],[[[[0,144,342],[0,141,241]],[0,25,248]],,5826402],[[[0,351,3840],[0,43,1571]],,5827736,[[8,"27"]]],[[[0,31,29780],[0,37,2772]],,5829071],[[[0,355,2160],[0,351,1320]],,5830406],[[[0,354,1350],[0,350,207]],,5831741],[[[0,353,900],[0,11,578]],,5833076],[[[0,355,1920],[0,352,1080]],,5834410],[[[0,29,8382],[0,28,177]],,5835745],[[[0,354,1890],[0,40,2009]],,5837080,[[1,0,356,5],[9,0,356]]],[[[0,356,120],[0,8,5618]],,5838415],[[[0,18,199865],[0,12,372]],,5839750],[[[0,354,1350],[0,353,360]],,5841084],[[[0,356,300],[0,1,207860]],,5842419],[[[0,353,1080],[0,34,17322]],,5843754],[[[0,154,2772],[0,115,1262]],,5845089],[[[0,354,1890],[0,36,6157]],,5846424],[[[0,355,1920],[0,44,5711]],,5847758,[[1,0,357,5],[9,0,357]]],[[[0,357,2160],[0,22,11878]],,5849093],[[[0,356,180],[0,355,720]],,5850428],[[[0,357,3360],[0,356,120]],,5851763],[[[0,21,53026],[0,19,101892]],,5853098],[[[0,355,2640],[0,32,20025]],,5854432],[[[0,356,300],[0,37,2772]],,5855767],[[[0,355,2160],[0,351,600]],,5857102],[[[0,2,94482],[0,7,5839]],,5858437],[[[0,356,480],[0,350,320]],,5859772,[[8,"28"]]],[[[0,354,1980],[0,357,2160]],,5861106],[[[0,24,27256],[0,33,11837]],,5862441],[[[0,357,9840],[0,111,190]],,5863776],[[[0,353,1200],[0,156,95]],,5865111],[[[0,357,10080],[0,155,102]],,5866446],[[[0,27,204],[0,10,942]],,5867780],[[[0,356,480],[0,12,370]],,5869115,[[1,0,358,5],[9,0,358]]],[[[0,358,360],[0,354,1440]],,5870450],[[[0,357,7200],[0,108,10235]],,5871785],[[[0,351,4320],[0,3,77291]],,5873120],[[[0,156,120],[0,6,19395]],,5874454],[[[0,352,11520],[0,350,320]],,5875789],[[[0,358,720],[0,35,6627]],,5877124],[[[0,17,647308],[0,91,160]],,5878459],[[[0,358,960],[0,30,160]],,5879794,[[1,0,359,5],[9,0,359]]],[[[0,359,2160],[0,31,29676]],,5881128],[[[0,356,360],[0,350,240]],,5882463],[[[0,36,6136],[0,32,19956]],,5883798],[[[0,357,7680],[0,353,840]],,5885133],[[[0,9,1219],[0,34,17262]],,5886468],[[[0,359,2880],[0,356,240]],,5887802],[[[0,358,840],[0,35,6627]],,5889137],[[[0,353,1680],[0,36,6136]],,5890472],[[[0,355,2400],[0,351,3000]],,5891807,[[8,"29"]]],[[[0,358,1080],[0,37,3740]],,5893142],[[[0,10,1275],[0,38,35956]],,5894476],[[[0,356,600],[0,39,2675]],,5895811],[[[0,359,6360],[0,40,2710]],,5897146],[[[0,352,12600],[0,41,2328]],,5898481],[[[0,358,1200],[0,43,2119]],,5899816],[[[0,351,4200],[0,356,180]],,5901150,[[1,0,360,5],[9,0,360]]],[[[0,360,1800],[0,42,2413]],,5902485],[[[0,12,501],[0,6,26260]],,5903820],[[[0,360,3900],[0,357,9120]],,5905155],[[[0,358,600],[0,360,3000]],,5906490],[[[0,358,1200],[0,8,7580]],,5907824],[[[0,359,7560],[0,11,780]],,5909159],[[[0,21,71545],[0,10,1275]],,5910494],[[[0,355,4320],[0,360,2400]],,5911829,[[1,0,361,5],[9,0,361]]],[[[0,361,2880],[0,359,1800]],,5913164],[[[0,358,780],[0,354,1350]],,5914498],[[[0,155,137],[0,23,36903]],,5915833],[[[0,361,12000],[0,350,400]],,5917168],[[[0,31,40180],[0,25,413]],,5918503],[[[0,360,4500],[0,361,5400]],,5919838],[[[0,354,3870],[0,26,32016]],,5921172],[[[0,360,3000],[0,361,6600]],,5922507],[[[0,359,3960],[0,361,9000]],,5923842,[[8,"30"]]]]
                        ,"4":[,[[[0,37,1512],[0,9,945]],,2000000,[[1,0,700,5],[9,0,700]]],[[[0,36,4295],[0,113,3600]],, 2050000],[[[0,700,262],[0,109,14000]],, 2100000,[[1,0,701,5],[9,0,701]]],[[[0,20,37800],[0,10,756]],, 2150000],[[[0,701,1470],[0,700,368]],, 2200000,[[1,0,702,5],[9,0,702],[21,21]]],[[[0,155,472],[0,115,2372]],, 2250000],[[[0,700,472],[0,8,7088]],, 2300000],[[[0,108,26250],[0,12,525]],, 2350000,[[8,"32"],[21,22]]],[[[0,702,1155],[0,114,15400]],, 2400000],[[[0,701,2520],[0,23,34020]],, 2450000,[[1,0,703,5],[9,0,703]]],[[[0,35,14742],[0,7,10238]],, 2500000],                       [[[0,29,16712],[0,40,5512]],, 2550000],[[[0,43,5003],[0,30,213]],, 2600000],[[[0,700,1680],[0,38,75600]],, 2650000],[[[0,701,7140],[0,33,32130]],, 2700000],[[[0,6,42525],[0,154,7088]],, 2750000],[[[0,702,3990],[0,35,21546]],, 2800000,[[1,0,704,5],[9,0,704]]],[[[0,703,2625],[0,111,269]],, 2850000],[[[0,700,2205],[0,24,66150]],, 2900000],[[[0,22,99792],[0,26,63969]],, 2950000,[[8,"33"]]],[[[0,156,1164],[0,108,60375]],, 3000000],[[[0,40,9450],[0,115,7115]],, 3050000],[[[0,702,5250],[0,153,26250]],, 3100000],[[[0,700,2730],[0,27,369]],, 3150000],[[[0,703,3544],[0,701,11340]],, 3200000],[[[0,39,10584],[0,34,79380]],, 3250000],[[[0,3,121800],[0,35,32886]],, 3300000],[[[0,704,9450],[0,5,94500]],, 3350000],[[[0,42,11340],[0,19,292950]],, 3400000],[[[0,109,89600],[0,144,806]],, 3450000],[[[0,37,16632],[0,33,62370]],, 3500000,[[1,0,705,5],[9,0,705]]],[[[0,700,5355],[0,36,36511]],, 3550000],[[[0,704,16538],[0,112,18375]],, 3600000],[[[0,702,11340],[0,43,12007]],, 3650000],[[[0,29,44166],[0,31,167832]],, 3700000],[[[0,701,23940],[0,110,1995]],, 3750000],[[[0,703,7678],[0,18,655200]],, 3800000],[[[0,157,3038],[0,704,18900]],, 3850000],[[[0,705,30996],[0,115,12155]],, 3900000],[[[0,44,52920],[0,32,132300]],, 3950000,[[8,"34"]]],[[[0,109,120400],[0,26,125030]],, 4000000],[[[0,40,17325],[0,11,3465]],, 4050000],[[[0,6,106312],[0,153,47250]],, 4100000],[[[0,700,7245],[0,705,34776]],, 4150000],[[[0,704,22208],[0,154,18506]],, 4200000],[[[0,33,90720],[0,7,37800]],, 4250000,[[1,0,706,5],[9,0,706]]],[[[0,702,15435],[0,35,55566]],, 4300000],[[[0,705,37800],[0,22,226800]],, 4350000],[[[0,706,9639],[0,20,321300]],, 4400000],[[[0,703,10238],[0,25,1474]],, 4450000],[[[0,24,166950],[0,108,139125]],, 4500000],[[[0,704,25515],[0,701,34020]],, 4550000],[[[0,705,41580],[0,41,18900]],, 4600000],[[[0,706,10584],[0,700,8820]],, 4650000],[[[0,113,51300],[0,114,79800]],, 4700000],[[[0,8,45675],[0,152,677]],, 4750000],[[[0,21,297360],[0,44,74340]],, 4800000],[[[0,705,60480],[0,37,30240]],, 4850000],[[[0,155,3603],[0,706,15372]],, 4900000],[[[0,702,26040],[0,115,18381]],, 4950000],[[[0,704,39690],[0,701,52920]],, 5000000,[[1,0,707,5],[9,0,707]]],[[[0,707,26880],[0,43,21345]],, 5050000],[[[0,703,17062],[0,36,69801]],, 5100000],[[[0,706,16632],[0,12,3465]],, 5150000],[[[0,707,28140],[0,705,67536]],, 5200000],[[[0,29,81170],[0,31,308448]],, 5250000],[[[0,26,200630],[0,19,652050]],, 5300000,[[8,"35"]]],[[[0,32,220500],[0,34,198450]],, 5350000],[[[0,704,44730],[0,44,89460]],, 5400000],[[[0,707,30240],[0,706,18144]],, 5450000],[[[0,706,18396],[0,10,9198]],, 5500000],[[[0,705,74592],[0,700,15540]],, 5550000],[[[0,703,19688],[0,109,210000]],, 5600000],[[[0,108,199500],[0,24,239400]],, 5650000,[[1,0,708,5],[9,0,708]]],[[[0,708,24255],[0,35,87318]],, 5700000],[[[0,708,24570],[0,701,65520]],, 5750000],[[[0,156,3999],[0,707,33180]],, 5800000],[[[0,705,80640],[0,21,403200]],, 5850000],[[[0,704,63788],[0,30,1148]],, 5900000],[[[0,702,43050],[0,42,29995]],, 5950000],[[[0,708,32681],[0,700,21788]],, 6000000],[[[0,37,42336],[0,29,100269]],, 6050000],[[[0,706,26775],[0,41,29209]],, 6100000],[[[0,707,45150],[0,22,390096]],, 6150000],[[[0,705,109620],[0,111,1170]],, 6200000],[[[0,708,34650],[0,701,92400]],, 6250000],[[[0,23,252315],[0,24,280350]],, 6300000],[[[0,704,70875],[0,707,47250]],, 6350000],[[[0,31,412776],[0,26,264599]],, 6400000,[[1,0,709,5],[9,0,709]]],[[[0,709,24150],[0,27,1304]],, 6450000],[[[0,708,36619],[0,705,117180]],, 6500000],[[[0,3,394800],[0,38,444150]],, 6550000],[[[0,157,7214],[0,706,29925]],, 6600000],[[[0,707,50400],[0,701,100800]],, 6650000],[[[0,709,25462],[0,700,25462]],, 6700000],[[[0,702,51450],[0,28,1482]],, 6750000],[[[0,703,32484],[0,40,38981]],, 6800000],[[[0,708,39375],[0,706,31500]],, 6850000],[[[0,709,26512],[0,152,1178]],, 6900000,[[8,"36"]]]
                    ]
                    ,"5":[,[[[0,111,251],[0,112,1776]],, 2100000,[[1,0,952,5],[9,0,952]]],[[[0,155,132],[0,27,292]],, 2400000],[[[0,952,423],[0,31,44853]],, 2650000,[[8,"44"],[21,23]]],[[[0,25,2706],[0,38,40139]],, 2900000,[[1,0,950,5],[9,0,950]]],[[[0,91,725],[0,974,172]],, 3100000],[[[0,122,889],[0,110,662]],, 3300000],[[[0,151,352],[0,115,5448]],, 3500000],[[[0,973,248],[0,950,3684]],, 3700000,[[1,0,951,5],[9,0,951]]],[[[0,29,16235],[0,113,12492]],, 3850000],[[[0,120,744],[0,152,300]],, 4050000],[[[0,974,274],[0,24,69981]],, 4200000],[[[0,40,5170],[0,952,3731]],, 4350000],[[[0,12,971],[0,119,1353]],, 4500000],[[[0,950,4141],[0,153,28661]],, 4650000],[[[0,123,841],[0,42,5035]],, 4800000],[[[0,982,344],[0,951,4307]],, 4950000,[[1,0,955,5],[9,0,955]]],[[[0,32,62538],[0,118,4013]],, 5100000],[[[0,121,677],[0,120,1249]],, 5200000],[[[0,952,4677],[0,11,1804]],, 5350000],[[[0,119,1927],[0,12,996]],, 5500000],[[[0,982,421],[0,973,326]],, 5600000,[[8,"45"]]],[[[0,19,1332],[0,155,293]],, 5750000],[[[0,110,1403],[0,36,17898]],, 5850000],[[[0,950,4911],[0,44,23204]],, 6000000],[[[0,28,508]],, 6100000],[[[0,113,19449],[0,123,1072]],, 6200000],[[[0,108,103532],[0,40,5949]],, 6350000],[[[0,982,369],[0,955,6140]],, 6450000,[[1,0,957,5],[9,0,957]]],[[[0,123,1293],[0,10,3220]],, 6550000],[[[0,155,467],[0,29,26811]],, 6700000],[[[0,950,8034],[0,31,93293]],, 6800000],[[[0,126,18121],[0,119,2170]],, 6900000],[[[0,125,468],[0,955,6047]],, 7000000],[[[0,36,24046],[0,123,1324]],, 7100000],[[[0,973,454],[0,27,843]],, 7200000],[[[0,112,6366],[0,23,142528]],, 7300000],[[[0,28,642],[0,19,523972]],, 7400000],[[[0,978,406],[0,951,8105]],, 7500000,[[8,"46"]]],[[[0,1,1055674],[0,40,9975]],, 7600000],[[[0,43,6068],[0,124,3422]],, 7700000],[[[0,155,502],[0,120,1576]],, 7800000],[[[0,120,1451],[0,28,907]],, 7900000],[[[0,977,625],[0,957,5091]],, 8000000,[[1,0,953,5],[9,0,953]]],[[[0,123,1397],[0,19,1731]],, 8100000],[[[0,116,3754],[0,44,31807]],, 8200000],[[[0,952,8864],[0,151,634]],, 8300000],[[[0,157,612],[0,40,10183]],, 8350000],[[[0,152,465],[0,957,7455]],, 8450000],[[[0,24,160219],[0,157,582]],, 8550000],[[[0,950,10362],[0,155,420]],, 8650000],[[[0,27,878],[0,154,7305]],, 8700000],[[[0,37,12223],[0,28,975]],, 8800000],[[[0,110,1712],[0,984,662]],, 8900000],[[[0,123,1355],[0,125,742]],, 9000000],[[[0,978,722],[0,128,4109]],, 9050000],[[[0,151,801],[0,8,32164]],, 9150000],[[[0,116,5350],[0,122,2244]],, 9250000],[[[0,19,2096],[0,953,6013]],, 9300000],[[[0,34,85164],[0,109,159454]],, 9400000],[[[0,957,6307],[0,36,36839]],, 9500000],[[[0,128,5898],[0,18,1239025]],, 9550000],[[[0,19,1678],[0,31,182854]],, 9650000],[[[0,984,687],[0,953,6810]],, 9750000,[[1,0,954,5],[9,0,954]]],[[[0,8,35600],[0,21,283174]],, 9800000],[[[0,10,6184],[0,157,644]],, 9900000],[[[0,953,6979],[0,108,146349]],, 9950000],[[[0,154,7625],[0,114,42448]],, 10050000],[[[0,42,9904],[0,957,7884]],, 10100000],[[[0,110,2060],[0,21,346807]],, 10200000],[[[0,952,7999],[0,8,39335]],, 10300000],[[[0,154,9443],[0,153,46803]],, 10350000],[[[0,978,741],[0,151,905]],, 10450000],[[[0,10,4657],[0,152,784]],, 10500000],[[[0,984,843],[0,977,571]],, 10600000,[[8,"47"]]],[[[0,116,6240],[0,2,599571]],, 10650000],[[[0,123,1656],[0,118,10828]],, 10750000],[[[0,953,8009],[0,3,539388]],, 10800000],[[[0,32,143228],[0,27,1000]],, 10850000],[[[0,37,19169],[0,954,6849]],, 10950000],[[[0,3,527133],[0,27,1273]],, 11000000],[[[0,984,850],[0,9,6304]],, 11100000],[[[0,39,13595],[0,36,34198]],, 11150000],[[[0,116,5932],[0,970,995]],, 11250000],[[[0,18,1389343],[0,28,1287]],, 11300000],[[[0,954,6691],[0,39,14769]],, 11350000],[[[0,10,5727],[0,151,1113]],, 11450000],[[[0,112,9694],[0,39,14954]],, 11500000],[[[0,970,941],[0,978,794]],, 11600000,[[1,0,956,5],[9,0,956]]],[[[0,127,9573],[0,11,3048]],, 11650000],[[[0,153,76277],[0,26,134307]],, 11700000],[[[0,12,2329],[0,20,602591]],, 11800000],[[[0,953,8543],[0,9,8112]],, 11850000],[[[0,41,11665],[0,119,3543]],, 11900000],[[[0,8,42523],[0,954,8031]],, 12000000],[[[0,10,5669],[0,38,189500]],, 12050000],[[[0,984,905],[0,118,9163]],, 12100000],[[[0,40,15522],[0,28,1060]],, 12200000],[[[0,111,1054],[0,38,201452]],, 12250000],[[[0,27,1364],[0,5,192562]],, 12300000],[[[0,956,6785],[0,970,1162]],, 12400000,[[8,"48"]]]
                    ]
                        }
                        ,"forestry":{"1":[,[[[0,4,3300],[0,19,4500],[0,24,1400]],,51520],[[[0,5,2600],[0,17,8000],[0,91,50]],,50360],[[[0,6,1250],[0,21,6600],[0,18,7300]],,0,[[1,1,1,5],[8,"forest"],[9,1,1],[9,1,21]]],[[[0,22,1400],[0,7,750]],,48630],[[[0,25,64],[0,3,3200],[1,21,8]],,50800],[[[0,8,650],[0,27,85],[0,4,4800],[0,91,25]],,0,[[8,"sawmill"],[9,1,41],[9,1,42],[9,1,43]]],[[[0,10,420],[0,19,1600]],,39360],[[[0,2,6000],[0,22,2100],[0,21,1800]],,38980],[[[0,24,1800],[1,21,12],[1,41,10]],,0,[[1,1,2,5],[9,1,2],[9,1,22],[9,1,44],[9,1,45],[9,1,46]]],[[[0,3,3200],[0,5,3150],[0,20,1900]],,36200],[[[0,27,40],[0,18,7700]],,39240],[[[0,91,60],[1,22,30],[1,44,12]],,0,[[8,"carpentry"],[9,1,101]]],[[[0,8,300],[0,6,2000]],,39600],[[[0,17,16000],[1,22,30],[1,42,10]],,34520],[[[0,11,90],[1,101,6],[1,22,18]],,0,[[10]]],[[[0,22,800],[0,7,430],[0,2,2200]],,32642],[[[0,10,380]],,30400],[[[0,9,460],[1,41,20]],,0,[[9,1,102]]],[[[0,19,2600],[0,3,3000],[0,18,5400],[0,4,1200]],,31740],[[[0,91,15],[0,26,1700]],,31420],[[[0,25,35],[0,5,2800],[1,102,4]],,0,[[9,1,103]]],[[[0,24,1900],[0,6,1400]],,31060],[[[0,20,1350],[0,23,1250],[0,1,4900]],,30230],[[[0,12,75],[0,21,2500],[1,45,15]],,0,[[1,1,3,5],[9,1,3],[9,1,23],[9,1,47],[9,1,48],[9,1,49]]],[[[0,8,310],[0,9,240]],,31520],[[[0,7,130],[0,6,400],[0,27,30]],,32562],[[[0,3,5400],[1,23,18],[1,103,3]],,0,[[9,1,104]]],[[[0,11,185]],,31450],[[[0,22,1900],[0,91,22],[0,2,2600]],,30940],[[[0,10,110],[1,41,32],[1,101,24]],,0,[[9,1,105]]],[[[0,25,55],[1,46,27]],,35025],[[[0,20,2300],[0,23,1350],[1,43,36]],,34485],[[[0,5,2000],[1,104,12],[1,47,72]],,0,[[9,1,106]]],[[[0,26,2100],[0,8,150]],,36600],[[[0,3,2200],[0,18,4500],[0,19,3000],[0,4,1400],[0,17,2800]],,37520],[[[0,9,600],[1,106,20]],,0,[[9,1,107]]],[[[0,7,700]],,37380],[[[0,29,1400],[0,12,40]],,42000],[[[0,1,45000],[1,107,52],[1,48,18]],,0,[[9,1,108]]],[[[0,5,3000],[0,11,240]],,44400],[[[0,3,5800],[0,9,380],[0,21,2400]],,46970],[[[0,6,1600],[1,102,12],[1,23,48]],,0,[[9,1,109]]],[[[0,25,75]],,48500],[[[0,29,1200],[0,8,1300],[0,17,20000],[0,2,5600],[1,49,24]],,50340,[[5,1]]],[[[0,20,5400],[0,10,100],[1,42,35]],,52325],[[[0,26,450],[0,25,45],[0,9,850]],,52510],[[[0,5,18000],[0,4,3600],[1,109,50]],,0,[[1,1,4,5],[9,1,4],[9,1,24],[9,1,50],[9,1,51],[9,1,52]]],[[[0,11,100],[0,3,9200],[1,45,30],[1,103,18]],,52207],[[[0,91,50],[0,22,3300],[0,18,4000],[1,46,45]],,52953],[[[1,101,40],[1,21,80],[1,48,30]],,0,[[9,1,111]]],[[[0,21,3000],[0,23,1600],[0,6,800]],,51960],[[[0,25,50],[0,24,2200],[1,43,60]],,53008],[[[1,104,70],[1,107,55],[1,24,60]],,0,[[9,1,112]]],[[[0,8,500],[0,7,450]],,50730],[[[0,91,35],[0,2,3500],[0,29,1200],[1,23,30]],,52432],[[[0,11,290],[1,52,30]],,50496,[[5,1]]],[[[0,10,360],[0,9,720],[1,106,100]],,52200],[[[0,27,75],[1,112,15]],,50049,[[11,1]]],[[[0,23,2000],[0,12,60],[1,42,50],[1,102,20]],,53630],[[[1,50,65],[1,47,30],[1,111,50]],,0,[[9,1,110]]],[[[0,109,3500],[0,24,2500],[1,48,30]],,50792],[[[0,11,275],[1,22,60]],,51934],[[[0,10,250],[0,12,100],[1,41,50],[1,23,33]],,0,[[1,1,5,5],[9,1,5],[9,1,25],[9,1,53],[9,1,54],[9,1,55]]],[[[0,9,250],[0,23,4000]],,51800],[[[0,25,90],[0,18,6400],[0,21,1000],[1,44,50]],,55282],[[[0,108,7500],[1,53,15],[1,112,5]],,0,[[9,1,115]]],[[[0,6,500],[0,22,6250]],,48650],[[[0,3,9700],[0,17,30000],[0,5,2200],[1,25,36]],,51590],[[[0,91,50],[1,115,26],[1,101,62]],,0,[[9,1,116]]],[[[0,112,2900],[0,12,80],[1,22,32]],,54505],[[[0,108,3700],[0,11,200]],,51020],[[[0,27,125],[1,115,22]],,0,[[9,1,118]]],[[[0,29,2700],[1,104,27]],,54896],[[[0,10,380],[0,19,5100],[1,50,65],[1,109,8]],,52508],[[[0,91,40],[1,118,10],[1,50,80],[1,107,65]],,0,[[9,1,117],[7,5]]]]
                        ,"2":[,[[[0,111,45],[0,9,380]],,48150],[[[1,21,400]],,,[[6,100]]],[[[0,12,100],[0,5,315]],,49140],[[[1,24,350]],,,[[6,100]]],[[[0,26,3200],[0,9,220],[1,106,30]],,47452],[[[1,22,450]],,,[[6,100]]],[[[0,11,150],[1,111,35]],,51945],[[[1,21,600],[1,41,80]],,,[[6,100]]],[[[0,8,555],[1,44,40],[1,45,30]],,46164],[[[0,91,55],[1,23,550]],,,[[6,100]]],[[[1,25,150]],,103843],[[[1,102,22]],,276206],[[[1,115,45]],,145202],[[[1,21,650],[1,22,100]],,,[[6,100]]],[[[1,110,15]],,124977],[[[1,53,120],[1,55,50],[1,54,50]],,,[[9,1,119]]],[[[0,7,5200],[0,6,1200],[0,24,3500]],,103941],[[[1,21,350],[1,22,300]],,,[[6,100]]],[[[0,10,240],[0,27,85],[0,26,2500]],,135945],[[[1,1,125],[1,2,100],[1,3,90],[1,4,70],[1,5,50]],,138279],[[[1,109,30]],,168612],[[[0,144,40],[0,110,100],[0,12,50]],,,[[6,100]]],[[[1,103,20]],,179495],[[[1,53,210],[1,55,160]],,,[[9,1,120]]],[[[1,41,100],[1,48,75],[1,52,50]],,156645],[[[1,25,190]],,,[[6,100]]],[[[0,11,400]],,125956],[[[1,24,220],[1,47,50],[1,43,85]],,114596],[[[1,118,20]],,221544],[[[1,1,250],[1,2,200],[1,3,180],[1,4,140],[1,5,100]],,,[[6,100]]],[[[0,110,100],[0,12,80],[1,41,45],[1,53,40],[1,52,20]],,237672],[[[1,41,100],[1,21,80],[1,43,125],[1,42,75]],,257504],[[[1,46,70],[1,49,50],[1,23,60],[1,25,80]],,273176],[[[0,10,60],[1,118,5],[0,27,100],[0,26,8000]],,288144],[[[1,5,200],[1,4,200],[1,3,200]],,,[[1,1,7,5],[9,1,7],[9,1,26],[9,1,56],[9,1,57],[9,1,58],[9,1,121],[9,1,122],[13,309]]],[[[1,121,20],[1,122,5]],,288743,[[9,1,123]]],[[[1,123,15],[1,56,120]],,313426],[[[0,5,8000],[0,1,15000],[0,11,500],[1,111,40]],,346934],[[[1,24,200],[1,23,200],[1,53,100],[1,58,50]],,305630],[[[1,54,100],[1,42,150],[1,51,250]],,512943],[[[0,12,200],[0,6,3000],[0,7,2500],[1,110,20]],,382357],[[[1,109,15],[1,107,15],[1,106,4],[1,102,8]],,311131,[[9,1,124]]],[[[1,124,25]],,401729,[[9,1,125]]],[[[1,125,80]],,298927],[[[1,7,250],[1,5,200],[1,1,500]],,,[[1,1,8,5],[9,1,8],[9,1,27],[9,1,59],[9,1,60],[9,1,61],[13,310]]],[[[0,27,80],[0,26,3000],[1,27,80],[1,122,5],[1,121,10]],,337285,[[9,1,126],[9,1,127]]],[[[1,126,20],[1,127,20]],,322536,[[9,1,128],[9,1,129]]],[[[1,128,10],[1,129,5]],,377008,[[9,1,130],[9,1,131]]],[[[1,130,10],[1,131,5]],,390178,[[9,1,132]]],[[[1,132,35],[1,41,400]],,807960],[[[0,6,3000],[1,129,8],[1,128,8]],,328800,[[1,1,9,5],[9,1,9],[9,1,28],[9,1,62],[9,1,63],[9,1,64]]],[[[1,127,12],[1,126,10],[1,28,100]],,356200,[[9,1,146]]],[[[1,146,6],[1,111,5],[1,110,15]],,383600],[[[1,122,8],[1,121,12],[1,124,15]],,411000],[[[1,62,150],[1,63,150],[1,64,150]],,438400,[[6,100]]],[[[0,35,1000],[1,111,50],[1,64,150],[1,106,15]],,465800],[[[1,125,25],[1,124,10],[1,118,10]],,493200],[[[0,110,200],[0,27,45],[0,111,50]],,520600],[[[0,1,1260],[1,62,150],[1,109,50]],,548000,[[9,1,144]]],[[[1,144,25]],,575400],[[[0,10,144],[0,12,250],[1,106,100]],,602800],[[[1,102,20],[1,107,30],[1,110,10],[1,104,20]],,630200,[[9,1,143]]],[[[1,143,10],[1,112,5]],,657600],[[[1,41,250],[1,42,250],[1,43,250],[1,21,200]],,685000,[[9,1,148]]],[[[1,57,150],[1,63,100],[1,60,150]],,712400],[[[0,144,100],[0,25,40],[1,53,300],[1,50,300]],,739800],[[[0,11,450],[0,9,300],[1,49,300]],,767200,[[9,1,134]]],[[[1,134,10],[1,146,5],[1,50,15]],,794600],[[[1,44,250],[1,115,40]],,822000],[[[1,123,15],[1,132,15]],,849400],[[[1,109,20],[1,131,10],[1,44,200]],,876800,[[6,100]]],[[[1,21,158],[1,111,68]],,904200],[[[1,25,34],[1,121,23]],,931600],[[[1,57,61],[1,132,34],[1,53,130]],,959000,[[6,50]]],[[[1,60,106],[1,124,17]],,986400],[[[1,64,116],[1,104,32]],,1013800],[[[1,24,156],[1,103,12],[1,42,74]],,1041200,[[1,1,10,5],[9,1,10],[9,1,29],[9,1,65],[9,1,66],[9,1,67]]],[[[1,29,81],[1,101,56]],,1068600],[[[1,67,102],[1,112,13]],,1096000],[[[1,66,92],[1,127,35],[1,101,40]],,1123400,[[6,50]]],[[[1,61,102],[1,130,34]],,1150800],[[[1,48,95],[1,134,14]],,1178200],[[[1,55,77],[1,146,24],[1,47,173]],,1205600,[[9,1,149]]],[[[1,66,155],[1,106,178]],,1233000],[[[1,52,137],[1,110,46]],,1260400],[[[1,27,39],[1,122,36],[1,42,96]],,1287800,[[6,50]]],[[[1,65,216],[1,125,144]],,1315200],[[[1,67,131],[1,149,74]],,1342600],[[[1,66,118],[1,109,20],[1,122,39]],,1370000,[[9,1,150]]],[[[1,22,168],[1,115,103]],,1397400],[[[1,53,317],[1,129,48]],,1424800],[[[1,67,96],[1,107,108],[1,45,84]],,1452200,[[6,50]]],[[[1,66,193],[1,102,28]],,1479600],[[[1,62,489],[1,118,66]],,1507000],[[[1,65,173],[1,149,58],[1,150,29]],,1534400,[[9,1,151]]],[[[1,26,152],[1,151,29]],,1561800],[[[1,65,270],[1,150,45]],,1589200],[[[1,29,88],[1,123,17],[1,24,265]],,1616600,[[6,50]]],[[[1,58,234],[1,128,52]],,1644000],[[[1,65,286],[1,131,48]],,1671400],[[[1,63,187],[1,149,65],[1,60,137]],,1698800,[[9,1,152]]],[[[1,66,231],[1,143,33]],,1726200],[[[1,67,179],[1,151,34]],,1753600],[[[1,49,95],[1,150,34],[1,152,27]],,1781000,[[6,50]]],[[[1,51,238],[1,107,209]],,1808400],[[[1,56,425],[1,151,35]],,1835800],[[[1,67,128],[1,144,36],[1,48,108]],,1863200,[[9,1,153]]],[[[1,29,159],[1,153,73]],,1890600],[[[1,65,335],[1,23,105]],,1918000],[[[1,41,302],[1,150,38],[1,153,50]],,1945400,[[6,50]]],[[[1,66,269],[1,151,38]],,1972800],[[[1,67,208],[1,149,117]],,2000200],[[[1,28,57],[1,153,53],[1,128,44]],,2027600,[[9,1,154]]],[[[1,50,482],[1,154,27]],,2055000],[[[1,65,367],[1,152,48]],,2082400],[[[1,59,331],[1,154,18],[1,124,28]],,2109800,[[6,50]]],[[[1,67,224],[1,150,63]],,2137200],[[[1,29,185],[1,152,50]],,2164600],[[[1,66,302],[1,149,130]],,2192000],[[[1,65,263],[1,151,29],[1,154,19]],,2219400,[[6,50]]]
                    ]
                        }
                        ,"foodworld":{"1":[,[[[0,2,17000]],2,57800],[[[0,21,2000],[0,23,2500],[0,22,2750]],2,97800],[[[0,3,30000]],2,60000],[[[0,1,10000],[0,20,2500],[0,10,50]],2,36500],[[[0,22,6000]],2,62400],[[[0,4,8000]],2,70400],[[[0,131,40],[0,137,21],[0,140,23]],2,65400],[[[0,24,3000],[0,10,80]],2,70400],[[[0,1,6000],[0,2,4000],[0,5,2500]],2,65000],[[[0,19,2000],[0,109,3500],[0,2,7000]],2,55100],[[[0,11,50],[0,22,2500]],2,41400],[[[0,10,70],[0,110,45],[0,9,100]],2,49000],[[[0,6,2500],[0,21,2000],[0,17,9000]],2,91000],[[[0,20,4500],[0,21,3500],[0,10,30]],2,87600],[[[0,108,1500],[0,109,4000]],2,78500],[[[0,23,2000],[0,26,600],[0,9,150]],2,70660],[[[0,6,2200],[0,22,5000]],2,108320],[[[0,21,4000],[0,26,3500]],2,126000],[[[0,24,1200],[0,10,85],[0,17,20000]],2,42230],[[[0,1,20000],[0,12,35],[0,20,7500]],2,91450,[[8,"foodworld-3"]]],[[[0,161,35],[0,164,35],[0,166,20]],2,70000],[[[0,7,1100],[0,108,2200]],2,144760],[[[0,29,350],[0,111,25],[0,6,1200]],2,77550],[[[0,165,60]],2,123215],[[[0,21,2200],[0,6,1500],[0,12,25]],2,77870],[[[0,20,3200],[0,10,100]],2,45880],[[[0,32,1200],[0,5,2850],[0,9,115]],2,85650],[[[0,131,82]],2,59040],[[[0,33,6000],[0,32,4000]],2,381200],[[[0,1,25000],[0,34,3700]],2,131180],[[[0,164,150],[0,35,2000]],2,267000],[[[0,36,2500],[0,12,60]],2,394700],[[[0,37,1200]],2,616560],[[[0,38,3500],[0,111,40],[0,9,120]],2,204900],[[[0,20,7700],[0,33,4500],[0,34,5500]],2,443480,[[8,"foodworld-4"]]],[[[0,35,150],[0,161,50]],2,12560],[[[0,39,100],[0,450,20]],2,72396],[[[0,6,1800],[0,163,40]],2,46440],[[[0,40,120],[0,10,90]],2,123756],[[[0,451,25],[0,111,45],[0,162,25]],2,44330,[[19,5]]],[[[0,41,100],[0,9,150]],2,126900],[[[0,452,80],[0,167,60]],2,10080],[[[0,42,110],[0,162,50]],2,132916],[[[0,453,30],[0,12,70]],2,33104],[[[0,43,100],[0,168,30]],2,135518],[[[0,169,50],[0,10,110],[0,161,55]],2,21521,[[19,10]]],[[[0,154,200],[0,6,2000]],2,155200],[[[0,455,50],[0,113,80]],2,57900],[[[0,114,180],[0,170,25]],2,87550],[[[0,27,250],[0,112,70]],2,231860],[[[0,351,300],[0,456,50]],2,12900],[[[0,352,280],[0,10,120]],2,29800],[[[0,353,310],[0,166,100],[0,451,40]],2,40152,[[19,15]]]]
                        }
                        ,"veterinary":{"1":[,[[[0,302,56],[0,301,232]],,425680,[[14,0.5]]],[[[0,301,156],[0,300,104]],,424320,[[15,0.5]]],[[[0,302,60],[0,300,232]],,436200,[[14,0.5]]],[[[0,303,140],[0,302,92]],,308680,[[16,1]]],[[[0,302,60],[0,301,236]],,435720,[[14,0.5]]],[[[0,301,156],[0,300,104]],,424320,[[15,0.5]]],[[[0,303,48],[0,301,192]],,388800,[[15,0.5]]],[[[0,302,60],[0,300,240]],,449400,[[14,0.5]]],[[[0,303,48],[0,300,192]],,394560,[[17,0.5]]],[[[0,304,52],[0,303,200]],,393160,[[17,0.5]]],[[[0,303,148],[0,302,96]],,325200,[[18,1]]],[[[0,302,60],[0,301,244]],,448680,[[14,0.5]]],[[[0,304,180],[0,302,76]],,307040,[[18,1]]],[[[0,303,48],[0,301,196]],,395280,[[17,0.5]]],[[[0,304,52],[0,301,208]],,406120,[[15,0.5]]],[[[0,304,52],[0,303,208]],,406120,[[14,0.5]]],[[[0,303,152],[0,302,100]],,335240,[[18,1]]],[[[0,302,64],[0,301,252]],,465200,[[17,0.5]]],[[[0,304,184],[0,302,80]],,315920,[[18,1]]],[[[0,303,52],[0,301,204]],,414720,[[18,1]]],[[[0,304,52],[0,301,212]],,412600,[[17,0.5]]],[[[0,304,52],[0,303,216]],,419080,[[18,1]]],[[[0,303,156],[0,302,104]],,345280,[[18,1]]],[[[0,302,64],[0,301,260]],,478160,[[15,0.5]]],[[[0,304,192],[0,302,80]],,326560,[[14,0.5]]],[[[0,303,52],[0,301,212]],,427680,[[14,0.5]]],[[[0,304,56],[0,301,220]],,430880,[[16,1]]],[[[0,307,224],[0,304,148]],,376040,[[15,0.5]]],[[[0,304,56],[0,303,224]],,437360,[[14,0.5]]],[[[0,303,160],[0,302,108]],,355320,[[18,1]]],[[[0,307,228],[0,303,152]],,428640,[[15,0.5]]],[[[0,304,196],[0,302,84]],,335440,[[14,0.5]]],[[[0,307,228],[0,302,152]],,317680,[[15,0.5]]],[[[0,307,232],[0,304,152]],,387760,[[18,1]]],[[[0,304,56],[0,303,228]],,443840,[[18,1]]],[[[0,303,164],[0,302,112]],,365360,[[18,1]]],[[[0,307,232],[0,303,156]],,438320,[[16,1]]],[[[0,304,204],[0,302,88]],,349640,[[16,1]]],[[[0,307,236],[0,302,156]],,327640,[[14,0.5]]],[[[0,309,76],[0,307,304]],,344280,[[17,0.5]]],[[[0,307,240],[0,304,160]],,404800,[[17,0.5]]],[[[0,304,60],[0,303,236]],,462120,[[14,0.5]]],[[[0,309,232],[0,304,156]],,516040,[[16,1]]],[[[0,307,240],[0,303,160]],,451200,[[15,0.5]]],[[[0,309,236],[0,303,156]],,566600,[[17,0.5]]],[[[0,309,80],[0,307,316]],,359200,[[16,1]]],[[[0,307,244],[0,304,164]],,413320,[[14,0.5]]],[[[0,304,60],[0,303,244]],,475080,[[18,1]]],[[[0,309,240],[0,304,160]],,532000,[[18,1]]],[[[0,307,248],[0,303,164]],,464080,[[18,1]]],[[[0,309,240],[0,303,160]],,578400,[[18,1]]],[[[0,311,200],[0,309,132]],,515560,[[14,0.5]]],[[[0,309,80],[0,307,324]],,365600,[[15,0.5]]],[[[0,307,252],[0,304,168]],,425040,[[14,0.5]]],[[[0,311,68],[0,307,268]],,330000,[[17,0.5]]],[[[0,309,248],[0,304,164]],,547960,[[15,0.5]]],[[[0,311,204],[0,304,136]],,527680,[[15,0.5]]],[[[0,311,204],[0,309,136]],,527680,[[18,1]]],[[[0,309,84],[0,307,332]],,377320,[[18,1]]],[[[0,307,260],[0,304,172]],,436760,[[14,0.5]]],[[[0,311,68],[0,307,276]],,336400,[[15,0.5]]],[[[0,309,252],[0,304,168]],,558600,[[18,1]]],[[[0,311,208],[0,304,140]],,539800,[[17,0.5]]],[[[0,313,244],[0,311,104]],,372000,[[16,1]]],[[[0,311,208],[0,309,140]],,539800,[[18,1]]],[[[0,309,84],[0,307,344]],,386920,[[15,0.5]]],[[[0,313,212],[0,309,140]],,355800,[[15,0.5]]],[[[0,311,72],[0,307,284]],,349600,[[18,1]]],[[[0,313,72],[0,307,284]],,284800,[[15,0.5]]],[[[0,313,248],[0,311,108]],,382000,[[15,0.5]]],[[[0,311,216],[0,309,144]],,558720,[[18,1]]],[[[0,309,88],[0,307,352]],,398640,[[18,1]]],[[[0,313,216],[0,309,144]],,364320,[[17,0.5]]],[[[0,311,72],[0,307,288]],,352800,[[15,0.5]]],[[[0,313,72],[0,307,292]],,291200,[[17,0.5]]],[[[0,315,36],[0,313,140]],,144040,[[18,1]]],[[[0,313,256],[0,311,108]],,388400,[[15,0.5]]],[[[0,311,220],[0,309,148]],,570840,[[18,1]]],[[[0,315,36],[0,311,140]],,270040,[[18,1]]],[[[0,313,224],[0,309,148]],,376040,[[15,0.5]]],[[[0,315,36],[0,309,140]],,218240,[[16,1]]],[[[0,315,36],[0,313,140]],,144040,[[15,0.5]]],[[[0,313,264],[0,311,112]],,401600,[[18,1]]],[[[0,311,228],[0,309,152]],,589760,[[18,1]]],[[[0,315,36],[0,311,144]],,276840,[[15,0.5]]],[[[0,313,228],[0,309,152]],,384560,[[18,1]]],[[[0,315,36],[0,309,144]],,223560,[[16,1]]],[[[0,315,36],[0,313,144]],,147240,[[16,1]]],[[[0,313,268],[0,311,116]],,411600,[[15,0.5]]],[[[0,311,232],[0,309,156]],,601880,[[17,0.5]]],[[[0,315,36],[0,311,148]],,283640,[[14,0.5]]],[[[0,313,232],[0,309,156]],,393080,[[17,0.5]]],[[[0,315,36],[0,309,148]],,228880,[[14,0.5]]],[[[0,315,36],[0,313,148]],,150440,[[17,0.5]]],[[[0,313,276],[0,311,116]],,418000,[[16,1]]],[[[0,311,236],[0,309,156]],,608680,[[17,0.5]]],[[[0,315,36],[0,311,148]],,283640,[[14,0.5]]],[[[0,313,240],[0,309,160]],,404800,[[18,1]]],[[[0,315,36],[0,309,152]],,234200,[[17,0.5]]],[[[0,317,228],[0,315,152]],,317680,[[16,1]]],[[[0,315,40],[0,313,152]],,157200,[[17,0.5]]],[[[0,313,284],[0,311,120]],,431200,[[14,0.5]]],[[[0,317,232],[0,313,156]],,310400,[[14,0.5]]],[[[0,315,40],[0,311,152]],,294000,[[17,0.5]]],[[[0,317,232],[0,311,156]],,450800,[[16,1]]],[[[0,317,236],[0,315,156]],,327640,[[14,0.5]]],[[[0,315,40],[0,313,156]],,160400,[[16,1]]],[[[0,313,288],[0,311,124]],,441200,[[16,1]]],[[[0,317,236],[0,313,156]],,313600,[[17,0.5]]],[[[0,315,40],[0,311,156]],,300800,[[16,1]]],[[[0,317,240],[0,311,160]],,464000,[[14,0.5]]],[[[0,317,240],[0,315,160]],,334400,[[18,1]]],[[[0,315,40],[0,313,160]],,163600,[[17,0.5]]],[[[0,313,296],[0,311,128]],,454400,[[15,0.5]]],[[[0,317,240],[0,313,160]],,320000,[[14,0.5]]],[[[0,315,40],[0,311,160]],,307600,[[17,0.5]]],[[[0,317,244],[0,311,164]],,474000,[[17,0.5]]],[[[0,317,244],[0,315,164]],,341160,[[17,0.5]]],[[[0,315,40],[0,313,164]],,166800,[[15,0.5]]],[[[0,313,300],[0,311,128]],,457600,[[14,0.5]]],[[[0,317,248],[0,313,164]],,329600,[[14,0.5]]],[[[0,315,40],[0,311,164]],,314400,[[15,0.5]]],[[[0,317,248],[0,311,164]],,477200,[[16,1]]],[[[0,319,52],[0,317,208]],,208000,[[17,0.5]]],[[[0,317,248],[0,315,168]],,347920,[[16,1]]],[[[0,315,40],[0,313,164]],,166800,[[15,0.5]]],[[[0,319,160],[0,315,104]],,220560,[[17,0.5]]],[[[0,317,252],[0,313,168]],,336000,[[14,0.5]]],[[[0,319,52],[0,313,212]],,211200,[[17,0.5]]],[[[0,319,52],[0,317,212]],,211200,[[17,0.5]]],[[[0,317,256],[0,315,168]],,354320,[[14,0.5]]],[[[0,315,44],[0,313,168]],,173560,[[15,0.5]]],[[[0,319,160],[0,315,108]],,224120,[[17,0.5]]],[[[0,317,256],[0,313,172]],,342400,[[15,0.5]]],[[[0,319,56],[0,313,216]],,217600,[[15,0.5]]],[[[0,320,260],[0,319,172]],,345600,[[14,0.5]]],[[[0,319,56],[0,317,216]],,217600,[[15,0.5]]],[[[0,317,260],[0,315,172]],,361080,[[14,0.5]]],[[[0,320,304],[0,317,132]],,348800,[[17,0.5]]],[[[0,319,164],[0,315,108]],,227320,[[14,0.5]]],[[[0,320,264],[0,315,176]],,367840,[[16,1]]],[[[0,320,264],[0,319,176]],,352000,[[14,0.5]]],[[[0,319,56],[0,317,224]],,224000,[[16,1]]],[[[0,317,264],[0,315,176]],,367840,[[17,0.5]]],[[[0,320,312],[0,317,132]],,355200,[[17,0.5]]],[[[0,319,168],[0,315,112]],,234080,[[17,0.5]]],[[[0,320,268],[0,315,180]],,374600,[[15,0.5]]],[[[0,320,268],[0,319,180]],,358400,[[16,1]]],[[[0,319,56],[0,317,228]],,227200,[[17,0.5]]],[[[0,317,272],[0,315,180]],,377800,[[15,0.5]]],[[[0,320,316],[0,317,136]],,361600,[[17,0.5]]],[[[0,319,172],[0,315,116]],,240840,[[15,0.5]]],[[[0,320,272],[0,315,184]],,381360,[[17,0.5]]],[[[0,320,276],[0,319,184]],,368000,[[17,0.5]]],[[[0,319,56],[0,317,232]],,230400,[[17,0.5]]],[[[0,317,276],[0,315,184]],,384560,[[15,0.5]]],[[[0,320,324],[0,317,140]],,371200,[[16,1]]],[[[0,319,176],[0,315,116]],,244040,[[14,0.5]]],[[[0,320,280],[0,315,184]],,387760,[[17,0.5]]],[[[0,322,396],[0,320,264]],,528000,[[17,0.5]]],[[[0,320,280],[0,319,188]],,374400,[[16,1]]],[[[0,319,60],[0,317,236]],,236800,[[15,0.5]]],[[[0,322,400],[0,319,264]],,531200,[[15,0.5]]],[[[0,320,328],[0,317,140]],,374400,[[17,0.5]]],[[[0,322,400],[0,317,268]],,534400,[[14,0.5]]],[[[0,322,400],[0,320,268]],,534400,[[17,0.5]]],[[[0,320,284],[0,319,188]],,377600,[[14,0.5]]],[[[0,319,60],[0,317,240]],,240000,[[14,0.5]]],[[[0,322,404],[0,319,272]],,540800,[[14,0.5]]],[[[0,320,336],[0,317,144]],,384000,[[14,0.5]]],[[[0,322,408],[0,317,272]],,544000,[[15,0.5]]],[[[0,322,408],[0,320,272]],,544000,[[15,0.5]]],[[[0,320,288],[0,319,192]],,384000,[[16,1]]],[[[0,319,60],[0,317,244]],,243200,[[16,1]]],[[[0,322,412],[0,319,276]],,550400,[[14,0.5]]],[[[0,320,340],[0,317,148]],,390400,[[15,0.5]]],[[[0,322,416],[0,317,276]],,553600,[[14,0.5]]],[[[0,322,416],[0,320,276]],,1066640],[[[0,320,296],[0,319,196]],,1128760],[[[0,319,60],[0,317,248]],,628360],[[[0,322,420],[0,319,280]],,1384600],[[[0,320,348],[0,317,148]],,916640],[[[0,322,420],[0,317,280]],,1068200],[[[0,324,92],[0,322,364]],,674560],[[[0,322,424],[0,320,284]],,1092160],[[[0,320,300],[0,319,200]],,1148000],[[[0,324,92],[0,320,368]],,874920],[[[0,322,428],[0,319,284]],,1407040],[[[0,324,276],[0,319,184]],,1114120],[[[0,324,92],[0,322,372]],,685200],[[[0,322,432],[0,320,288]],,1110240],[[[0,320,304],[0,319,204]],,1167240],[[[0,324,92],[0,320,376]],,889800],[[[0,322,436],[0,319,288]],,1429480],[[[0,324,284],[0,319,188]],,1142480],[[[0,325,104],[0,324,416]],,1056640],[[[0,324,96],[0,322,380]],,704120],[[[0,322,440],[0,320,292]],,1128320],[[[0,325,104],[0,322,420]],,754120],[[[0,324,96],[0,320,380]],,905520],[[[0,325,104],[0,320,420]],,976720],[[[0,325,104],[0,324,424]],,1073200],[[[0,324,96],[0,322,384]],,709440],[[[0,322,448],[0,320,296]],,1146400],[[[0,325,108],[0,322,428]],,772280],[[[0,324,96],[0,320,388]],,920400],[[[0,325,108],[0,320,428]],,999120],[[[0,326,336],[0,325,224]],,1032640],[[[0,325,108],[0,324,432]],,1097280],[[[0,324,100],[0,322,392]],,728360],[[[0,326,336],[0,324,224]],,1075200],[[[0,325,108],[0,322,436]],,782920],[[[0,326,112],[0,322,452]],,805000],[[[0,326,340],[0,325,228]],,1047440],[[[0,325,108],[0,324,436]],,1105560],[[[0,324,100],[0,322,400]],,739000],[[[0,326,344],[0,324,228]],,1098040],[[[0,325,112],[0,322,440]],,795760],[[[0,326,116],[0,322,460]],,822920],[[[0,327,128],[0,326,516]],,1147760],[[[0,326,344],[0,325,232]],,1062240],[[[0,325,112],[0,324,444]],,1129640],[[[0,327,132],[0,325,520]],,1192760],[[[0,326,348],[0,324,232]],,1113600],[[[0,327,132],[0,324,524]],,1299840],[[[0,327,132],[0,326,524]],,1168840],[[[0,326,352],[0,325,232]],,1076800],[[[0,325,112],[0,324,452]],,1146200],[[[0,327,132],[0,325,528]],,1207800],[[[0,326,352],[0,324,236]],,1129160],[[[0,327,132],[0,324,532]],,1316400],[[[0,328,320],[0,327,212]],,1001560],[[[0,327,132],[0,326,536]],,1190680],[[[0,326,356],[0,325,236]],,1091600],[[[0,328,108],[0,326,428]],,1000360],[[[0,327,136],[0,325,540]],,1236880],[[[0,328,108],[0,325,432]],,1033560],[[[0,328,324],[0,327,216]],,1016280],[[[0,327,136],[0,326,540]],,1204480],[[[0,326,364],[0,325,240]],,1113680],[[[0,328,108],[0,326,436]],,1014920],[[[0,327,136],[0,325,544]],,1244400],[[[0,328,108],[0,325,436]],,1041080],[[[0,329,116],[0,328,456]],,1164480],[[[0,328,328],[0,327,220]],,1031000],[[[0,327,136],[0,326,552]],,1226320],[[[0,329,404],[0,327,172]],,1080280],[[[0,328,112],[0,326,444]],,1037680],[[[0,329,116],[0,326,464]],,1074160],[[[0,329,116],[0,328,464]],,1180880],[[[0,328,336],[0,327,224]],,1053920],[[[0,327,140],[0,326,560]],,1247400],[[[0,329,408],[0,327,176]],,1094720],[[[0,328,112],[0,326,448]],,1044960],[[[0,329,116],[0,326,468]],,1081440],[[[0,330,988],[0,329,660]],,2013220],[[[0,329,116],[0,328,472]],,1197280],[[[0,328,340],[0,327,228]],,1068640],[[[0,330,996],[0,328,664]],,2073340],[[[0,329,416],[0,327,176]],,1110560],[[[0,330,1000],[0,327,664]],,1797320],[[[0,330,1000],[0,329,668]],,2037640],[[[0,329,120],[0,328,476]],,1213400],[[[0,328,344],[0,327,228]],,1076840],[[[0,330,1008],[0,328,672]],,2098320],[[[0,329,420],[0,327,180]],,1125000],[[[0,330,1012],[0,327,676]],,1825460],[[[0,330,1016],[0,329,676]],,2064920],[[[0,329,120],[0,328,484]],,1229800],[[[0,328,348],[0,327,232]],,1091560],[[[0,330,1020],[0,328,680]],,2123300],[[[0,329,428],[0,327,184]],,1147360],[[[0,330,1028],[0,327,684]],,1849940],[[[0,330,1028],[0,329,684]],,2089340],[[[0,329,124],[0,328,492]],,1254120],[[[0,328,356],[0,327,236]],,1114480],[[[0,330,1036],[0,328,692]],,2159340],[[[0,329,432],[0,327,184]],,1155280],[[[0,330,1040],[0,327,692]],,1871560],[[[0,330,1044],[0,329,696]],,2124540],[[[0,329,124],[0,328,496]],,1262320],[[[0,328,360],[0,327,240]],,1129200],[[[0,330,1048],[0,328,700]],,2184320],[[[0,329,440],[0,327,188]],,1177640],[[[0,330,1052],[0,327,704]],,1899700],[[[0,330,1056],[0,329,704]],,2148960],[[[0,329,128],[0,328,504]],,1286640],[[[0,328,364],[0,327,244]],,1143920],[[[0,330,1064],[0,328,708]],,2212160],[[[0,329,444],[0,327,192]],,1192080],[[[0,330,1068],[0,327,712]],,1924180],[[[0,333,172],[0,330,688]],,747340],[[[0,330,1072],[0,329,716]],,2184160],[[[0,329,128],[0,328,512]],,1303040],[[[0,333,520],[0,329,344]],,1453320],[[[0,330,1080],[0,328,720]],,2248200],[[[0,333,520],[0,328,348]],,1485600],[[[0,333,172],[0,330,696]],,753060],[[[0,330,1084],[0,329,724]],,2208580],[[[0,329,128],[0,328,520]],,1319440],[[[0,333,524],[0,329,348]],,1467180],[[[0,330,1092],[0,328,728]],,2273180],[[[0,333,528],[0,328,352]],,1505680],[[[0,335,940],[0,333,628]],,1731580],[[[0,333,176],[0,330,704]],,764720],[[[0,330,1100],[0,329,736]],,2243780],[[[0,335,1104],[0,330,472]],,1275880],[[[0,333,532],[0,329,356]],,1494900],[[[0,335,952],[0,329,632]],,2060560],[[[0,336,172],[0,335,688]],,856560],[[[0,335,956],[0,333,636]],,1757060],[[[0,333,180],[0,330,716]],,779240],[[[0,336,172],[0,333,696]],,1305320],[[[0,335,1120],[0,330,480]],,1295200],[[[0,336,176],[0,330,696]],,775720],[[[0,336,176],[0,335,700]],,873080],[[[0,335,968],[0,333,644]],,1779140],[[[0,333,180],[0,330,724]],,784960],[[[0,336,176],[0,333,704]],,1323520],[[[0,335,1136],[0,330,488]],,1314520],[[[0,336,176],[0,330,704]],,781440],[[[0,338,432],[0,336,288]],,1297440],[[[0,336,176],[0,335,708]],,879880],[[[0,335,980],[0,333,652]],,1801220],[[[0,338,144],[0,335,580]],,773800],[[[0,336,180],[0,333,712]],,1341720],[[[0,338,148],[0,333,584]],,1155840],[[[0,338,440],[0,336,292]],,1319360],[[[0,336,180],[0,335,716]],,893000],[[[0,335,992],[0,333,660]],,1823300],[[[0,338,148],[0,335,588]],,788400],[[[0,336,180],[0,333,720]],,1353600],[[[0,338,148],[0,333,592]],,1167720],[[[0,340,520],[0,338,224]],,1456000],[[[0,338,444],[0,336,296]],,1333480],[[[0,336,180],[0,335,728]],,903200],[[[0,340,448],[0,336,296]],,1345760],[[[0,338,148],[0,335,596]],,795200],[[[0,340,148],[0,335,600]],,800080],[[[0,340,524],[0,338,224]],,1463840],[[[0,338,452],[0,336,300]],,1355400],[[[0,336,184],[0,335,736]],,916320],[[[0,340,452],[0,336,300]],,1359920],[[[0,338,152],[0,335,604]],,809800],[[[0,340,152],[0,335,604]],,811320],[[[0,342,72],[0,340,288]],,864000],[[[0,340,532],[0,338,228]],,1487320],[[[0,338,456],[0,336,304]],,1369520],[[[0,342,72],[0,338,288]],,861120],[[[0,340,460],[0,336,304]],,1381920],[[[0,342,72],[0,336,288]],,754560],[[[0,342,72],[0,340,292]],,871840],[[[0,340,536],[0,338,232]],,1502960],[[[0,338,460],[0,336,308]],,1383640],[[[0,342,72],[0,338,292]],,868920],[[[0,340,464],[0,336,308]],,1396080],[[[0,342,72],[0,336,292]],,760880],[[[0,342,72],[0,340,292]],,871840],[[[0,340,544],[0,338,232]],,1518640],[[[0,338,468],[0,336,312]],,1405560],[[[0,342,72],[0,338,296]],,876720],[[[0,340,468],[0,336,312]],,1410240],[[[0,342,76],[0,336,296]],,783840],[[[0,345,448],[0,342,300]],,2175360],[[[0,342,76],[0,340,296]],,896320],[[[0,340,552],[0,338,236]],,1542120],[[[0,345,452],[0,340,300]],,1523640],[[[0,342,76],[0,338,300]],,901160],[[[0,345,452],[0,338,304]],,1528440],[[[0,345,456],[0,342,304]],,2208560],[[[0,342,76],[0,340,300]],,904160],[[[0,340,556],[0,338,240]],,1557760],[[[0,345,456],[0,340,304]],,1539760],[[[0,342,76],[0,338,304]],,908960],[[[0,345,460],[0,338,304]],,1545000],[[[0,347,96],[0,345,384]],,1112640],[[[0,345,460],[0,342,308]],,2233480],[[[0,342,76],[0,340,304]],,912000],[[[0,347,292],[0,342,192]],,1765240],[[[0,345,464],[0,340,308]],,1564160],[[[0,347,96],[0,340,388]],,1078240],[[[0,348,464],[0,347,308]],,1989240],[[[0,347,96],[0,345,388]],,1120920],[[[0,345,464],[0,342,312]],,2258400],[[[0,348,544],[0,345,232]],,1617200],[[[0,347,292],[0,342,196]],,1781880],[[[0,348,468],[0,342,312]],,2276040],[[[0,348,468],[0,347,312]],,2010840],[[[0,347,100],[0,345,392]],,1142440],[[[0,345,472],[0,342,312]],,2274960],[[[0,348,552],[0,345,236]],,1642200],[[[0,347,296],[0,342,196]],,1795120],[[[0,348,472],[0,342,316]],,2301040],[[[0,400,672],[0,348,448]],,1934240],[[[0,348,476],[0,347,316]],,2040800],[[[0,347,100],[0,345,400]],,1159000],[[[0,400,672],[0,347,448]],,2480800],[[[0,348,556],[0,345,240]],,1658840],[[[0,400,676],[0,345,452]],,1939500],[[[0,400,676],[0,348,452]],,1948540],[[[0,348,480],[0,347,320]],,2062400],[[[0,347,100],[0,345,404]],,1167280],[[[0,400,680],[0,347,452]],,2505920],[[[0,348,564],[0,345,240]],,1675560],[[[0,400,684],[0,345,456]],,1959660],[[[0,402,800],[0,400,344]],,1706840],[[[0,400,684],[0,348,456]],,1968780],[[[0,348,484],[0,347,324]],,2084000],[[[0,402,688],[0,348,460]],,1989960],[[[0,400,688],[0,347,460]],,2544280],[[[0,402,692],[0,347,460]],,2557140],[[[0,402,808],[0,400,344]],,1718800],[[[0,400,692],[0,348,460]],,1989020],[[[0,348,492],[0,347,328]],,2113960],[[[0,402,696],[0,348,464]],,2010280],[[[0,400,696],[0,347,464]],,2569400],[[[0,402,696],[0,347,464]],,2576360]]
                        }
                        ,"breed":{"1":[,[[[0,600,72],[0,668,24]],,80100],[[[0,636,132],[0,600,74]],,79500],[[[0,668,26],[0,636,135]],,81600],[[[0,600,78],[0,668,26]],,86800],[[[0,636,141],[0,600,80]],,85500],[[[0,668,27],[0,636,144]],,85900],[[[0,600,83],[0,636,148]],,89100],[[[0,668,29],[0,600,85]],,95600],[[[0,668,29],[0,636,154]],,92000],[[[0,600,59],[0,668,20],[0,636,105]],,96300,[[20,2]]],[[[0,636,160],[0,668,30]],, 95400],[[[0,634,134],[0,600,92]],, 133800],[[[0,668,32],[0,636,167]],, 100700],[[[0,600,96],[0,668,32]],, 106800],[[[0,636,173],[0,634,142]],, 136600],[[[0,668,33],[0,600,99]],, 110100],[[[0,634,147],[0,636,180]],, 141700],[[[0,668,35],[0,636,183]],, 110300],[[[0,600,105],[0,634,152]],, 152100],[[[0,668,24],[0,600,71],[0,602,16]],, 141800,[[20,3]]],[[[0,634,158],[0,602,24]],, 190200],[[[0,600,110],[0,634,160]],, 159900],[[[0,602,25],[0,636,199]],, 154400],[[[0,668,38],[0,600,114]],, 126800],[[[0,634,168],[0,602,26]],, 204100],[[[0,636,208],[0,668,39]],, 124000],[[[0,600,119],[0,634,173]],, 172900],[[[0,602,27],[0,636,215]],, 166800],[[[0,668,41],[0,600,123]],, 136800],[[[0,636,148],[0,634,121],[0,668,28]],, 162800,[[20,2]]],[[[0,602,28],[0,668,42]],, 178300],[[[0,636,228],[0,600,128]],, 137400],[[[0,634,189],[0,602,29]],, 228600],[[[0,636,234],[0,668,44]],, 139700],[[[0,602,30],[0,634,194]],, 235600],[[[0,667,45],[0,602,30]],, 238100],[[[0,634,199],[0,636,244]],, 191900],[[[0,600,139],[0,667,47]],, 204900],[[[0,602,32],[0,634,205]],, 250100],[[[0,667,32],[0,668,32],[0,634,138]],, 223600,[[20,3]]],[[[0,600,144],[0,602,32]],, 205500],[[[0,634,213],[0,667,49]],, 262600],[[[0,636,263],[0,668,50]],, 158000],[[[0,667,50],[0,602,34]],, 267200],[[[0,600,152],[0,634,220]],, 220200],[[[0,602,34],[0,667,51]],, 269900],[[[0,636,276],[0,600,155]],, 166400],[[[0,667,53],[0,634,228]],, 282600],[[[0,602,36],[0,668,53]],, 227500],[[[0,636,190],[0,667,36],[0,634,156]],, 247200,[[20,4]]],[[[0,635,93],[0,600,162]],, 272900],[[[0,668,55],[0,667,55]],, 239100],[[[0,602,37],[0,635,95]],, 329800],[[[0,600,168],[0,636,298]],, 180000],[[[0,635,97],[0,667,57]],, 343400],[[[0,668,57],[0,602,38]],, 241900],[[[0,636,308],[0,635,99]],, 282000],[[[0,667,59],[0,600,175]],, 257600],[[[0,635,101],[0,668,59]],, 294800],[[[0,602,27],[0,667,40],[0,635,68]],, 345900,[[20,2]]],[[[0,600,180],[0,635,103]],, 302600],[[[0,667,61],[0,636,324]],, 257500],[[[0,635,105],[0,602,41]],, 364900],[[[0,600,186],[0,667,62]],, 271800],[[[0,602,42],[0,635,107]],, 372700],[[[0,666,152],[0,667,63]],, 393400],[[[0,635,110],[0,602,43]],, 382400],[[[0,667,65],[0,666,155]],, 403200],[[[0,634,283],[0,635,112]],, 392300],[[[0,666,105],[0,602,30],[0,636,233]],, 338000,[[20,3]]],[[[0,635,114],[0,667,66]],, 400900],[[[0,634,291],[0,666,160]],, 413400],[[[0,602,45],[0,635,116]],, 402000],[[[0,666,163],[0,636,362]],, 343500],[[[0,667,69],[0,668,69]],, 299900],[[[0,635,119],[0,666,166]],, 476700],[[[0,602,47],[0,667,70]],, 371700],[[[0,666,169],[0,634,307]],, 436500],[[[0,668,71],[0,635,122]],, 355700],[[[0,667,48],[0,666,115]],, 467600,[[20,4]]],[[[0,604,144],[0,635,124]],, 483900],[[[0,667,73],[0,666,175]],, 454200],[[[0,635,126],[0,602,49]],, 437100],[[[0,634,323],[0,604,148]],, 446000],[[[0,666,179],[0,635,128]],, 513400],[[[0,604,150],[0,667,75]],, 453800],[[[0,668,76],[0,666,182]],, 392900],[[[0,635,131],[0,602,51]],, 454600],[[[0,668,77],[0,604,154]],, 385200],[[[0,667,52],[0,600,155],[0,604,104]],, 401800,[[20,2]]],[[[0,666,188],[0,634,341]],, 485200],[[[0,604,158],[0,635,135]],, 528900],[[[0,602,53],[0,636,423]],, 327700],[[[0,667,80],[0,666,192]],, 498000],[[[0,635,138],[0,604,161]],, 539800],[[[0,603,162],[0,667,81]],, 538300],[[[0,666,196],[0,602,55]],, 502200],[[[0,668,83],[0,604,165]],, 413500],[[[0,635,142],[0,603,166]],, 605300],[[[0,667,84],[0,634,364]],, 449500],[[[0,604,112],[0,666,135],[0,668,56]],, 478600,[[20,3]]],[[[0,603,170],[0,636,452]],, 465300],[[[0,602,57],[0,635,147]],, 509300],[[[0,667,86],[0,668,86]],, 373800],[[[0,604,173],[0,603,173]],, 631500],[[[0,666,209],[0,600,261]],, 454000],[[[0,603,176],[0,602,59]],, 577100],[[[0,634,385],[0,635,152]],, 533000],[[[0,667,89],[0,604,178]],, 538500],[[[0,666,144],[0,603,120],[0,634,261]],, 608400,[[20,4]]],[[[0,637,540],[0,635,155]],, 645200],[[[0,602,61],[0,604,182]],, 542500],[[[0,603,183],[0,666,219]],, 683200],[[[0,667,92],[0,637,551]],, 597200],[[[0,604,185],[0,668,93]],, 463600],[[[0,666,224],[0,603,186]],, 696400],[[[0,637,562],[0,602,63]],, 601200],[[[0,635,162],[0,604,189]],, 633600],[[[0,634,414],[0,667,95]],, 509800],[[[0,666,153],[0,637,382],[0,604,128]],, 681500,[[20,2]]],[[[0,603,192],[0,602,64]],, 628100],[[[0,604,194],[0,635,166]],, 649800],[[[0,637,584],[0,666,234]],, 713900],[[[0,667,98],[0,604,196]],, 592900],[[[0,603,197],[0,637,591]],, 763300],[[[0,669,425],[0,603,198]],, 783600],[[[0,604,200],[0,635,171]],, 669700],[[[0,637,602],[0,666,241]],, 735600],[[[0,667,101],[0,669,432]],, 671600],[[[0,603,136],[0,602,46],[0,669,290]],, 715500,[[20,3]]],[[[0,635,175],[0,637,612]],, 729900],[[[0,669,440],[0,604,206]],, 751900],[[[0,666,248],[0,668,104]],, 536100],[[[0,637,623],[0,603,208]],, 805300],[[[0,667,105],[0,669,448]],, 697200],[[[0,604,210],[0,634,459]],, 633200],[[[0,603,212],[0,666,254]],, 791900],[[[0,669,456],[0,637,638]],, 825500],[[[0,635,184],[0,604,214]],, 718600],[[[0,603,144],[0,669,307],[0,637,430]],, 840300,[[20,4]]],[[[0,639,130],[0,603,216]],, 884700],[[[0,637,652],[0,666,261]],, 796700],[[[0,669,468],[0,604,219]],, 799600],[[[0,603,220],[0,639,132]],, 899700],[[[0,635,190],[0,667,111]],, 670900],[[[0,634,485],[0,669,476]],, 736900],[[[0,639,134],[0,637,670]],, 896900],[[[0,604,225],[0,603,225]],, 821400],[[[0,669,484],[0,639,136]],, 926700],[[[0,602,51],[0,666,182],[0,639,91]],, 786900,[[20,2]]],[[[0,637,684],[0,635,196]],, 816600],[[[0,639,138],[0,603,230]],, 940600],[[[0,604,231],[0,669,494]],, 843700],[[[0,666,278],[0,637,695]],, 848900],[[[0,603,233],[0,639,140]],, 953500],[[[0,606,141],[0,666,281]],, 918700],[[[0,604,236],[0,669,504]],, 861400],[[[0,639,142],[0,606,142]],, 1009900],[[[0,637,713],[0,603,238]],, 921500],[[[0,669,342],[0,635,137],[0,606,96]],, 928200,[[20,3]]],[[[0,606,144],[0,604,240]],, 918800],[[[0,666,290],[0,639,145]],, 937500],[[[0,637,728],[0,603,243]],, 940900],[[[0,669,522],[0,606,147]],, 1009500],[[[0,639,147],[0,667,123]],, 850000],[[[0,604,246],[0,635,211]],, 825000],[[[0,606,149],[0,637,742]],, 1004400],[[[0,603,249],[0,639,150]],, 1020400],[[[0,666,300],[0,669,535]],, 935300],[[[0,637,502],[0,606,101],[0,604,168]],, 961900,[[20,4]]],[[[0,663,398],[0,639,152]],, 1081400],[[[0,604,254],[0,603,254]],, 927200],[[[0,606,153],[0,669,546]],, 1053200],[[[0,637,767],[0,663,404]],, 1039600],[[[0,635,221],[0,666,309]],, 886400],[[[0,663,408],[0,603,258]],, 1068500],[[[0,639,156],[0,606,156]],, 1109500],[[[0,669,558],[0,602,87]],, 854200],[[[0,604,262],[0,663,414]],, 1006700],[[[0,667,88],[0,637,526],[0,663,277]],, 950200,[[20,2]]],[[[0,603,264],[0,639,159]],, 1081700],[[[0,663,419],[0,606,160]],, 1148100],[[[0,666,320],[0,669,571]],, 998000],[[[0,635,230],[0,663,423]],, 1029500],[[[0,639,162],[0,604,269]],, 1022100],[[[0,606,162],[0,637,810]],, 1094100],[[[0,602,91],[0,603,272]],, 891100],[[[0,663,431],[0,669,584]],, 1130300],[[[0,666,329],[0,639,165]],, 1065400],[[[0,637,550],[0,606,110],[0,663,290]],, 1140400,[[20,3]]],[[[0,604,276],[0,663,436]],, 1060300],[[[0,669,594],[0,635,238]],, 1014200],[[[0,639,168],[0,603,279]],, 1143100],[[[0,663,442],[0,637,839]],, 1137300],[[[0,606,169],[0,666,337]],, 1101500],[[[0,667,141],[0,669,605]],, 939300],[[[0,603,284],[0,663,448]],, 1174600],[[[0,637,854],[0,639,171]],, 1143900],[[[0,634,624],[0,606,172]],, 999000],[[[0,663,302],[0,604,192],[0,668,96]],, 894200,[[20,4]]]]
                        },
                        "butterfly":{"1":[,[[[0,5,9450],[0,175,1512]],,80000],[[[0,22,18144],[0,179,1578]],,90000],[[[0,6,11813],[0,177,2035]],,100000,[[22,2]]],[[[0,18,100800],[0,182,4999]],,110000],[[[0,23,19845],[0,176,3024]],,120000],[[[0,33,15120],[0,171,5184]],,130000],[[[0,41,3093],[0,173,5292]],,140000],[[[0,42,3658],[0,180,5259]],,150000],[[[0,108,28875],[0,183,3119]],,160000],[[[0,154,4725],[0,181,6350]],,170000,[[22,3]]],[[[0,39,4914],[0,178,5897]],,180000],[[[0,36,15034],[0,172,9408]],,190000],[[[0,40,5906],[0,174,4639]],,200000],[[[0,8,12600],[0,176,6912]],,210000],[[[0,4,71400],[0,180,8941]],,220000],[[[0,20,113400],[0,173,10584]],,230000],[[[0,32,59850],[0,175,9576]],,240000],[[[0,35,22680],[0,177,8142]],,250000],[[[0,37,10584],[0,172,14112]],,260000],[[[0,153,23100],[0,181,11642]],,270000,[[22,4]]],[[[0,114,32200],[0,171,14904]],,280000],[[[0,7,18900],[0,183,6804]],,290000],[[[0,3,105000],[0,178,11340]],,300000],[[[0,26,75600],[0,174,8041]],,310000],[[[0,38,127575],[0,179,10650]],,320000],[[[0,43,9339],[0,182,23328]],,330000],[[[0,109,81200],[0,181,15347]],,340000],[[[0,44,37800],[0,175,15120]],,350000],[[[0,34,87885],[0,180,16303]],,360000],[[[0,31,145152],[0,176,13824]],,370000,[[22,5]]],[[[0,21,166320],[0,182,27494]],,380000],[[[0,24,107100],[0,183,9639]],,390000],[[[0,19,330750],[0,172,23520]],,400000],[[[0,154,14175],[0,174,11134]],,410000],[[[0,33,69930],[0,177,15062]],,420000],[[[0,8,29925],[0,179,14989]],,430000],[[[0,114,54600],[0,171,25272]],,440000],[[[0,42,14632],[0,178,18144]],,450000],[[[0,18,688800],[0,173,24108]],,460000],[[[0,41,14433],[0,175,21168]],,470000,[[22,6]]],[[[0,36,46176],[0,179,16961]],,480000],[[[0,44,55440],[0,177,17911]],,490000],[[[0,4,189000],[0,182,37491]],,500000],[[[0,20,289800],[0,176,19872]],,510000],[[[0,24,148050],[0,171,30456]],,520000],[[[0,38,226800],[0,173,28224]],,530000],[[[0,22,222264],[0,180,25770]],,540000],[[[0,5,157500],[0,183,14175]],,550000],[[[0,7,40163],[0,181,26989]],,560000],[[[0,31,235872],[0,178,23587]],,570000],[[[0,35,60102],[0,172,35616]],,580000],[[[0,40,21263],[0,174,16701]],,590000],[[[0,43,18344],[0,176,23760]],,600000],[[[0,109,156800],[0,180,29451]],,610000],[[[0,23,161595],[0,173,33516]],,620000],[[[0,6,137025],[0,175,29232]],,630000],[[[0,21,297360],[0,177,24018]],,640000],[[[0,32,189000],[0,172,40320]],,650000],[[[0,108,160125],[0,181,32281]],,660000],[[[0,34,175770],[0,171,40176]],,670000],[[[0,3,264600],[0,183,17861]],,680000],[[[0,19,604800],[0,178,29030]],,690000],[[[0,26,189000],[0,174,20103]],,700000],[[[0,39,24948],[0,179,26033]],,710000],[[[0,37,33768],[0,182,55821]],,720000],[[[0,153,71400],[0,181,35986]],,730000],[[[0,6,163013],[0,175,34776]],,740000],[[[0,24,220500],[0,180,36814]],,750000],[[[0,18,1192800],[0,176,30672]],,760000],[[[0,20,453600],[0,182,59986]],,770000],[[[0,32,229950],[0,183,20696]],,780000],[[[0,40,29138],[0,172,49728]],,790000],[[[0,23,212625],[0,174,23195]],,800000],[[[0,8,59850],[0,177,30938]],,810000],[[[0,26,223892],[0,179,30371]],,820000],[[[0,33,147420],[0,171,50544]],,830000],[[[0,39,29862],[0,178,35834]],,840000],[[[0,37,40320],[0,173,47040]],,850000],[[[0,34,229635],[0,175,40824]],,860000],[[[0,31,371952],[0,179,32344]],,870000],[[[0,19,784350],[0,177,33787]],,880000],[[[0,22,381024],[0,182,69984]],,890000],[[[0,43,28350],[0,176,36720]],,900000],[[[0,109,240800],[0,171,55728]],,910000],[[[0,114,121800],[0,173,51156]],,920000],[[[0,42,32191],[0,180,46280]],,930000],[[[0,38,420525],[0,183,25232]],,940000],[[[0,35,102060],[0,181,47628]],,950000],[[[0,44,114660],[0,178,41278]],,960000],[[[0,36,98795],[0,172,61824]],,970000],[[[0,21,468720],[0,174,28762]],,980000],[[[0,7,74025],[0,176,40608]],,990000],[[[0,4,399000],[0,171,61560]],,1000000],[[[0,41,32989],[0,172,64512]],,1010000],[[[0,108,254625],[0,173,57036]],,1020000]]
                        },
                        "cow":{"1":[,[[[0,804,192]],, 50000],[[[0,804,197]],, 60000],[[[0,804,202]],, 70000,[[9,0,801]]],[[[0,801,78],[0,804,104]],, 80000],[[[0,801,80],[0,804,106]],, 90000],[[[0,801,81],[0,804,108]],, 100000,[[9,0,800]]],[[[0,801,83],[0,804,111]],, 110000],[[[0,801,85],[0,804,113]],, 120000],[[[0,801,87],[0,804,116]],, 130000],[[[0,801,89],[0,804,118]],, 140000,[[9,0,805]]],[[[0,805,24],[0,804,120]],, 150000],[[[0,804,123],[0,801,92]],, 160000],[[[0,805,25],[0,801,94]],, 170000,[[23,2]]],[[[0,805,26],[0,804,128]],, 180000],[[[0,801,65],[0,805,18],[0,804,87]],, 190000,[[9,0,802]]],[[[0,804,132],[0,805,27]],, 200000],[[[0,805,27],[0,801,101]],, 210000],[[[0,801,103],[0,804,137]],, 220000],[[[0,804,140],[0,801,105]],, 230000],[[[0,801,71],[0,805,19],[0,804,95]],, 240000,[[9,0,807]]],[[[0,807,48],[0,804,144]],, 250000],[[[0,805,30],[0,807,49]],, 260000],[[[0,804,149],[0,805,30]],, 270000],[[[0,801,114],[0,805,31]],, 280000],[[[0,805,21],[0,807,35],[0,804,103]],, 290000,[[9,0,803]]],[[[0,807,52],[0,801,117]],, 300000],[[[0,807,53],[0,804,159]],, 310000],[[[0,805,22],[0,807,36],[0,801,81]],, 320000,[[23,3]]],[[[0,804,164],[0,801,123]],, 330000],[[[0,807,37],[0,804,111],[0,805,23]],, 340000,[[9,0,809]]],[[[0,809,84],[0,807,56]],, 350000],[[[0,805,35],[0,809,86]],, 360000],[[[0,804,173],[0,807,58]],, 370000],[[[0,807,59],[0,801,132]],, 380000],[[[0,809,60],[0,805,24],[0,807,40]],, 390000,[[9,0,806]]],[[[0,805,36],[0,804,180]],, 400000],[[[0,807,61],[0,809,92]],, 410000],[[[0,804,185],[0,805,37]],, 420000],[[[0,805,38],[0,807,63]],, 430000],[[[0,809,64],[0,801,95],[0,805,26]],, 440000,[[9,0,810]]],[[[0,810,144],[0,804,192]],, 450000],[[[0,810,146],[0,809,98]],, 460000],[[[0,805,27],[0,807,44],[0,801,99]],, 470000,[[23,4]]],[[[0,807,67],[0,810,150]],, 480000],[[[0,801,101],[0,809,68],[0,804,135]],, 490000,[[9,0,808]]],[[[0,810,153],[0,807,68]],, 500000],[[[0,805,42]],, 510000],[[[0,807,70],[0,810,157]],, 520000],[[[0,801,159],[0,809,106]],, 530000],[[[0,810,107],[0,805,29],[0,804,143]],, 540000,[[9,0,812]]],[[[0,812,87],[0,810,162]],, 550000],[[[0,809,110],[0,812,88]],, 560000],[[[0,805,45],[0,801,166]],, 570000],[[[0,807,75],[0,810,168]],, 580000],[[[0,812,61],[0,809,76],[0,804,151]],, 590000,[[9,0,811]]],[[[0,810,171],[0,805,46]],, 600000],[[[0,804,231],[0,801,173]],, 610000],[[[0,805,32],[0,812,63],[0,809,78]],, 620000,[[23,5]]],[[[0,807,79],[0,810,177]],, 630000],[[[0,812,64],[0,809,80],[0,801,119]],, 640000,[[9,0,813]]],[[[0,813,240],[0,804,240]],, 650000],[[[0,813,243],[0,812,97]],, 660000],[[[0,807,82],[0,809,123]],, 670000],[[[0,801,186],[0,813,248]],, 680000],[[[0,812,67],[0,805,34],[0,807,56]],, 690000,[[9,0,815]]],[[[0,809,126],[0,810,189]],, 700000],[[[0,812,102],[0,813,255]],, 710000],[[[0,810,193],[0,809,129]],, 720000],[[[0,807,87],[0,812,104]],, 730000],[[[0,813,175],[0,810,131],[0,801,131]],, 740000,[[9,0,814]]],[[[0,814,88],[0,807,88]],, 750000],[[[0,812,107],[0,814,89]],, 760000],[[[0,809,90],[0,810,135],[0,805,36]],, 770000[[23,6]]],[[[0,804,272],[0,813,272]],, 780000],[[[0,807,61],[0,801,137],[0,809,92]],, 790000,[[9,0,816]]],[[[0,812,111],[0,810,207]],, 800000],[[[0,813,279],[0,807,93]],, 810000],[[[0,809,141],[0,812,113]],, 820000],[[[0,810,213],[0,813,284]],, 830000],[[[0,814,64],[0,805,39],[0,801,143]],, 840000,[[9,0,818]]],[[[0,818,360],[0,812,116]],, 850000],[[[0,818,363],[0,814,97]],, 860000],[[[0,813,293],[0,814,98]],, 870000],[[[0,818,369],[0,810,222]],, 880000],[[[0,812,80],[0,813,199],[0,807,67]],, 890000,[[9,0,817]]],[[[0,810,225],[0,814,100]],, 900000],[[[0,809,152],[0,804,303]],, 910000],[[[0,813,204],[0,812,82],[0,801,153]],, 920000],[[[0,818,384],[0,814,103]],, 930000],[[[0,812,83],[0,809,104],[0,804,207]],, 90000,[[9,0,819]]]]
                        },
                        "infinite":{"1":[,[[[0,0,0],[0,0,0],[0,0,0]], ,0,[[0,0] ]]]},
                        "fishing":{"1":[,[[[0,900,12],[0,22,3240]], ,50000],[[[0,912,14],[0,18,13200]], ,60000,[[24,0,1] ]],[[[0,913,16],[0,35,1053]], ,70000,[[24,1,5] ]],[[[0,901,18],[0,5,3375]], ,80000],[[[0,915,16],[0,913,16],[0,9,600]], ,90000,[[24,4,2] ]],[[[0,900,23],[0,3,5700]], ,100000],[[[0,901,26],[0,29,1780]], ,110000,[[24,2,1] ]],[[[0,912,28],[0,153,1725]], ,120000,[[24,0,1] ]],[[[0,915,30],[0,33,3375]], ,130000,[[24,1,3] ]],[[[0,903,24],[0,913,24],[0,10,360]], ,140000,[[24,4,3] ]],[[[0,900,35],[0,8,1624]], ,150000],[[[0,912,38],[0,20,13950]], ,160000],[[[0,915,40],[0,2,19800]], ,170000,[[24,2,1] ]],[[[0,901,42],[0,37,1260]], ,180000],[[[0,900,45],[0,40,1018]], ,190000,[[24,3,2] ]],[[[0,903,47],[0,19,26325]], ,200000,[[24,0,1] ]],[[[0,913,50],[0,42,984]], ,210000,[[24,1,3] ]],[[[0,915,52],[0,24,9675]], ,220000],[[[0,901,54],[0,109,9000]], ,230000],[[[0,917,40],[0,913,27],[0,25,135]], ,240000,[[24,4,4] ]],[[[0,900,59],[0,7,2744]], ,250000],[[[0,912,62],[0,34,10328]], ,260000,[[24,0,1] ]],[[[0,901,64],[0,26,10971]], ,270000,[[24,2,1] ]],[[[0,917,66],[0,154,1540]], ,280000],[[[0,915,69],[0,112,2338]], ,290000,[[24,3,3] ]],[[[0,903,71],[0,4,17700]], ,300000],[[[0,912,74],[0,41,1373]], ,310000,[[24,1,3] ]],[[[0,913,76],[0,108,11813]], ,320000],[[[0,917,78],[0,43,1365]], ,330000],[[[0,905,64],[0,903,86],[0,27,104]], ,340000,[[24,4,5] ]],[[[0,901,83],[0,31,22356]], ,350000,[[24,0,2] ]],[[[0,915,86],[0,44,6390]], ,360000],[[[0,903,88],[0,114,7300]], ,370000,[[24,2,1] ]],[[[0,917,90],[0,21,27000]], ,380000],[[[0,919,93],[0,42,1848]], ,390000,[[24,3,4] ]],[[[0,905,95],[0,40,2173]], ,400000],[[[0,912,98],[0,154,2268]], ,410000,[[24,1,3] ]],[[[0,919,100],[0,19,56025]], ,420000],[[[0,905,102],[0,112,3188]], ,430000],[[[0,907,80],[0,917,160],[0,12,500]], ,440000,[[24,4,6] ]],[[[0,900,107],[0,43,1869]], ,450000],[[[0,905,110],[0,33,12285]], ,460000,[[24,0,2] ]],[[[0,907,112],[0,35,7533]], ,470000],[[[0,919,114],[0,22,30780]], ,480000],[[[0,905,117],[0,24,21825]], ,490000,[[24,2,1] ]],[[[0,909,119],[0,108,18563]], ,500000],[[[0,907,122],[0,41,2273]], ,510000],[[[0,909,124],[0,44,9270]], ,520000],[[[0,919,126],[0,153,7875]], ,530000,[[24,0,2] ]],[[[0,907,129],[0,909,129]], ,540000]
                        ]},
                        "scouts":{"1":[,[[[0,28,21],[0,3,3000]],,50000],
[[[0,1000,53],[0,19,7425]],,60000],
[[[0,111,24],[0,4,3900]],,70000,[[25,0,5]]],
[[[0,10,270],[0,19,10125]],,80000],
[[[0,1002,16],[0,22,4320],[0,9,600]],, 90000],
[[[0,8,1064],[0,109,3800]],,100000],
[[[0,110,158]],,110000],
[[[0,44,2070],[0,33,3105]],,120000],
[[[0,1000,80],[0,154,467],[0,10,300]],, 130000,[[25,0,3]]],
[[[0,27,59],[0,153,2250]],,140000,[[25,1,3]]],
[[[0,17,208800],[0,41,653]],,150000],
[[[0,1002,38],[0,2,18600]],,160000],
[[[0,22,10692],[0,12,248]],,170000],
[[[0,28,74],[0,29,2967]],,180000],
[[[0,830,1943],[0,42,888]],,190000],
[[[0,1000,188],[0,10,702]],,200000],
[[[0,151,142],[0,20,18450]],,210000,[[25,0,3]]],
[[[0,834,1806],[0,108,8063]],,220000],
[[[0,31,14580],[0,9,2025]],,230000],
[[[0,1004,40],[0,21,12000],[0,25,135]],, 240000],
[[[0,144,177],[0,26,10143]],,250000],
[[[0,829,3060],[0,42,1224]],,260000],
[[[0,18,63600],[0,44,4770]],,270000],
[[[0,1000,264],[0,22,17820]],,280000],
[[[0,28,120],[0,24,12825]],,290000],
[[[0,91,266],[0,33,7965]],,300000],
[[[0,25,248],[0,5,13725]],,310000,[[25,0,3]]],
[[[0,1002,51],[0,35,3402],[0,27,82]],, 320000],
[[[0,27,82],[0,10,1170]],,],
[[[0,111,144],[0,35,6480]],,340000,[[25,1,4]]],
[[[0,833,4296],[0,153,5175]],,350000],
[[[0,1004,86],[0,37,2556]],,360000],
[[[0,7,4088],[0,31,23652]],,370000],
[[[0,4,22500],[0,114,7500]],,380000],
[[[0,1006,124],[0,153,5775]],,390000],
[[[0,11,889],[0,8,4424]],,400000],
[[[0,12,608],[0,111,146]],,410000,[[25,0,3]]],
[[[0,151,287],[0,43,1743]],,420000],
[[[0,1002,102],[0,34,17213]],,430000],
[[[0,827,9000],[0,108,18750]],,440000,[[25,1,5]]],
[[[0,5,20025],[0,43,1869]],,450000],
[[[0,8,5096],[0,30,178]],,460000],
[[[0,1004,112],[0,7,5208]],,470000],
[[[0,21,34200],[0,44,8550]],,480000,[[25,1,6]]],
[[[0,27,190],[0,112,3638]],,490000],
[[[0,11,1114],[0,41,2228]],,500000],
[[[0,1006,162],[0,40,2778]],,510000],
[[[0,12,773],[0,33,13905]],,520000,[[25,1,7]]],
[[[0,126,6930],[0,40,2888]],,530000],
[[[0,1000,514],[0,112,4013]],,540000]
                        ]}

               };

unsafeData.QUESTS=QUESTS.clone();
const INIT_questDataItem = {"nr":0,"time":0,"calcTo":0,"state":0,"given":{}};
//22102016
const INIT_questData = {"main":{"1":INIT_questDataItem.clone(),"2":INIT_questDataItem.clone(),
    "3":INIT_questDataItem.clone(),"4":INIT_questDataItem.clone(),"5":INIT_questDataItem.clone()}
                       ,"forestry":{"1":INIT_questDataItem.clone(),"2":INIT_questDataItem.clone()}
                       ,"foodworld":{"1":INIT_questDataItem.clone()}
                       ,"veterinary":{"1":INIT_questDataItem.clone()}
                       ,"breed":{"1":INIT_questDataItem.clone()}
                       ,"butterfly":{"1":INIT_questDataItem.clone()}
                       ,"cow":{"1":INIT_questDataItem.clone()}
                       ,"infinite":{"1":INIT_questDataItem.clone()}
                       ,"fishing":{"1":INIT_questDataItem.clone()}
                       ,"scouts":{"1":INIT_questDataItem.clone()}
                       };
// state: 0:not available, 1:not activated, 2:active
/*
// Generate PRODUCT_QUEST
var new_PRODUCT_QUEST=[];
for(var type in QUESTS){
    if(!QUESTS.hasOwnProperty(type)){ continue; }
    for(var campaign in QUESTS[type]){
        if(!QUESTS[type].hasOwnProperty(campaign)){ continue; }
        for(var nr=1;nr<QUESTS[type][campaign].length;nr++){
            if(QUESTS[type][campaign][nr][3]){
                for(var i=0;i<QUESTS[type][campaign][nr][3].length;i++){
                    if(QUESTS[type][campaign][nr][3][i][0]==9){
                        if(!new_PRODUCT_QUEST[QUESTS[type][campaign][nr][3][i][1]]){ new_PRODUCT_QUEST[QUESTS[type][campaign][nr][3][i][1]]={}; }
                        new_PRODUCT_QUEST[QUESTS[type][campaign][nr][3][i][1]][QUESTS[type][campaign][nr][3][i][2]] = [type,parseInt(campaign,10),nr];
                    }
                }
            }
        }
    }
}
for(type=0;type<new_PRODUCT_QUEST.length;type++){
    new_PRODUCT_QUEST[type].sortObj();
}
GM_log("new_PRODUCT_QUEST:\n"+implode(new_PRODUCT_QUEST));
*/

// Default values for Mimimum stock-amount of goods
const INIT_valMinRack={"v":200,"ex":200,"e":50,"o":10,"z":0,"f1":25,"f2":10,"f3":10,"f4":0,"fw1":10,"fw2":10,"fw3":10,"fw4":10,"hr":1000,"md":10,"breed":10,"alpin":200,"tea":50,"cow":10,"fish":10,"fl":1000,"fla":100, "water":200,"sushi":25,"scouts":10};
// task_new_level
const LEVEL_POINTS=[0,0,58,2420,6620,15620,27900,58700,101700,163100,211900
                   ,276900,359000,467000,730000,1190000,1750000,2680000,3900000,5660000,7850000
                   ,10590000,15300000,20640000,26020000,37340000,50030000,65160000,85030000,108900000,139150000
                   ,175520000,222430000,276920000,345930000,429330000,535520000,669000000,797010000,927020000,1069440000
                   ,1202920000,1336400000,1469880000,1603360000,1896272000,2220357000,2576977000,2967479000,3393198000,3855457000
                   ,4355565000,4894822000,5474516000,6095926000,6760322000,7468962000,8223098000,9023973000,9872820000,10770866000
                   ,11719330000,12719423000,13772351000,14879311000,16041494000,17260085000,18536263000,19871201000,21266065000,22722017000
                   ,24240212000,25821802000,27467932000,29179741000,30958366000,32804936000,34720579000,36706414000,38763560000,40893128000
                   ,43096227000,45373962000,47727432000,50157733000,52665958000,55253195000,57920530000,60669042000,63499810000,66413907000
                   ,69412404000,72496369000,75666864000,78924952000,82271688000,85708127000,89235321000,92854318000,96566163000,100371897000
                   ];
// Description of Stored GM-Data
// VARIABLES = {CATEGORY:{VAR:[Description, Type]}}
//      1 = historic data - not reproducible!
//      2 = collectable data
//      3 = options, settings
//      4 = temporary data
//      5 = useless, old data
const VARIABLES = {
            "USER":{"bargeld":["Cash amount",2],
                    "calcToLodgeCampaign":["Target lodge campaign",5],
                    "calcToLodgeQuest":["Target lodge quest",5],
                    "calcToQuest":["Target quest",3],
                    "changedata":["Data version",1],
                    "clubmemberLog":["Log-data club",1],
                    "contractSave":["Saved contract templates",3],
                    "css_styles":["CSS",3],
                    "farmiLog":["Log-data farmies",1],
                    "farmiOk":["Limit at farmi-log",5],
                    "farmname":["Name of farm",2],
                    "highlight":["Highlighted users",3],
                    "highlightProducts":["Highlighted products",3],
                    "infoPanelFormulas":["Mode",4],
                    "kauf":["Log-data sales",5],
                    "logSales":["Log-data sales",1],
                    "lastContractTo":["Last contract recipient",2],
                    "lastOffer":["Last market offer",2],
                    "levelLog":["Log-data points",1],
                    "lodgeCampaignNr":["Lodge campaign",5],
                    "lodgeQuestData":["Lodge quest data",5],
                    "lodgeQuestNr":["Lodge quest number",5],
                    "lodgeTimeEnd":["Lodge quest time",5],
                    "logClothingDonation":["Log-Data Clothing donation",1],
                    "logDonkey":["Log-data Donkey",1],
                    "logMegafieldJob":["Log-data Megafield Job",1],
                    "lotteryCollectForPrize":["Lottery collect data",3],
                    "lotteryLastLot":["Lottery taken time",2],
                    "lotteryLog":["Log-data lottery",1],
                    "marketOffers":["Market offers",5],
                    "ownMarketOffers":["Own market offers",2],
                    "marketOfferTimes":["Market offer times",5],
                    "megafieldSmartTimer":["Option",3],
                    "megafieldVehicle":["Last Megafield Vehicle",3],
                    "modeBuildPreise":["Mode",4],
                    "modeBuyNotepad":["Mode",4],
                    "modeInfoPanelDonkey":["Mode",4],
                    "modeInfoPanelClothingDonation":["Mode",4],
                    "modeInfoPanelFarmies":["Mode",4],
                    "modeInfoPanelFormulas":["Mode",4],
                    "modeInfoPanelLottery":["Mode",4],
                    "modeInfoPanelMessages":["Mode",4],
                    "modeLotteryLog":["Mode",5],
                    "modeMarket":["Mode",4],
                    "modeProfittable":["Mode",4],
                    "modeProfittableFeed":["Mode",5],
                    "modeProfittableSterne":["Mode",5],
                    "modeQuestsTable":["Mode",4],
                    "modeStatistic":["Mode",4],
                    "modeStockTable":["Mode",4],
                    "nachrichten":["Messages",1],
                    "nachrichten_doread":["Messages auto-read",5],
                    "nachrichten_doreadState":["Messages auto-read",5],
                    "nachrichten_letzte":["Messages",2],
                    "nachrichten_system":["Messages",5],
                    "nachrichtvorlage":["Message template",3],
                    "notepad":["Notepad",3],
                    "prodBestand":["Product stock",5],
                    "prodBlock":["Blocked products",2],
                    "prodGrowTime":["Product growtime",2],
                    "prodMinRack":["Minimal rackamounts",2],
                    "prodMinRackInit":["Minimal rackamounts",3],
                    "prodRequire":["Recursive needed products",5],
                    "prodStock":["Product stock",2],
                    "prodStockMax":["Product stock limit",2],
                    "prodYield":["Product yield",2],
                    "quest":["Quest number",5],
                    "questState":["Quest state",5],
                    "questTime":["Quest time",5],
                    "questData":["Quest data",2],
                    "raisedEvents":["Raised events",4],
                    "session":["Session",4],
                    "show":["Mode",4],
                    "totalEndtime":["Total endtime",2],
                    "totalFarmis":["Farmi needings",2],
                    "valAnimalBreedingDelay":["Option",3],
                    "valAssumeWater":["Option",3],
                    "valAutoCrop":["Option",3],
                    "valAutoWater":["Option",3],
                    "valClickErrorbox":["Option",3],
                    "valClothingDonation":["Option",3],
                    "valContractLogAmount":["Option",3],
                    "valDrag":["Option",3],
                    "valEmptyFieldForestLimit":["Option",5],
                    "valErnte":["Option",5],
                    "valErnteMsg":["Option",3],
                    "valFarmiLimits":["Option",3],
                    "valFarmiMiniInfo":["Option",3],
                    "valFoodworldFarmiPlacing":["Option",3],
                    "valGamecursor":["Option",3],
                    "valGiess":["Option",5],
                    "valGiessAnnehm":["Option",5],
                    "valGiessNotw":["Option",5],
                    "valGlobalTimeAdd":["Option",3],
                    "valGlobaltimeShowCroppedZone":["Option",3],
                    "valHotkey":["Option",3],
                    "valJoinPreise":["Option",3],
                    "valKauflimit":["Option",3],
                    "valKauflimitNPC":["Option",3],
                    "valLeereFelderLimit":["Option",5],
                    "valLimitEmptyFields":["Option",3],
                    "valMessageRe":["Option",3],
                    "valMessagesSystemMarkRead":["Option",3],
                    "valMinAlpinFarm6":["Option",3,1],
                    "valMinExFruitsFarms5":["Option",3,1],
                    "valMinRack":["Option",3],
                    "valMinRackE":["Option",5],
                    "valMinRackF":["Option",5],
                    "valMinRackP":["Option",5],
                    "valMinRackV":["Option",5],
                    "valMinRackFarmis":["Option",3],
                    "valMinRackForestryFarmis":["Option",3],
                    "valMinRackFoodworldFarmis":["Option",3],
                    "valMinRackFarmersmarketFarmis":["Option",3],
                    "valMinRackGrowing":["Option",3],
                    "valMinRackLodgeQuest":["Option",5],
                    "valMinRackMan":["Option",3],
                    "valMinRackPlantsize":["Option",3],
                    "valMinRackQuest":["Option",5],
                    "valMinRackRecursive":["Option",3],
                    "valMoveAnimals":["Option",3],
                    "valMsgFormat":["Option",3],
                    "valNachr":["Option",5],
                    "valPreiseBeobNum":["Option",3],
                    "valPrivNachr":["Option",3],
                    "valProtectMinRack":["Option",3],
                    "valQuicklinks":["Option",3],
                    "valSpoilerZoneUpdate":["Option",5],
                    "valStatistik":["Option",3],
                    "valStatistikNpc":["Option",5],
                    "valStatistikTime":["Option",5],
                    "valTurnOffUpjersNews":["Option",3],
                    "valVerkaufLimitDown":["Option",3],
                    "valVerkaufLimitUp":["Option",3],
                    "valVet":["Option",3],
                    "valVetAutostart":["Option",3],
                    "valVetAutoSet":["Option",3],
                    "valVetNoCoinDrugs":["Option",3],
                    "vetTreatment":["Option",3],
                    "sushibarFarmi":["Option",3],
                    "valWaterNeeded":["Option",3],
                    "vertraegeIn":["Contracts received",1],
                    "vertraegeOut":["Contracts sent",1],
                    "vertraegePreise":["Contract prices",3],
                    "zoneAnimals":["Amount of animals",5],
                    "zoneBlock":["Blocked zones",5],
                    "zoneBonus":["Zones bonus",5],
                    "zoneBonusSpecialAmount":["Zone special product",5],
                    "zoneBonusSpecialProduct":["Zone special product",5],
                    "zoneEndProducts":["Zones productions",5],
                    "zoneEndTimes":["Zones endtimes",5],
                    "zoneErnte":["Zones productions",5],
                    "zoneFieldData":["Zones productions",5],
                    "zoneProductionData":["Zones productions",5],
                    "zoneMainprod":["Zones productions",5],
                    "zones":["Zones",2],
                    "zoneTyp":["Zones types",5],
                    "zoneWaterTimes":["Times watering",5]},
          "SERVER":{"buildPreiseShowAll":["Mode",5],
                    "changedata":["Data version",1],
                    "competition":["Competition data",2],
                    "farmNamen":["Farm names",2],
                    "gut":["Product prices",3],
                    "gutBeob":["Product observed prices",2],
                    "NpcSaison":["Products saisons",2],
                    "pagedataNachrichtenNew":["Page attributes",4],
                    "pagedataStadtMarktstand":["Page attributes",4],
                    "pagedataVertraegeNew":["Page attributes",4],
                    "pagedataVertraegeOverview":["Page attributes",4],
                    "preisBeob":["Price observation",2],
                    "prodId":["Product names lookup",2],
                    "prodName":["Product names",2],
                    "prodNameSort":["Product names",2],
                    "prodPlantSize":["Plant sizes",2],
                    "prodPoints":["Product points",2],
                    "prodRequire":["Recursive needed products",2],
                    "prodTyp":["Product types",2],
                    "sessionlost":["Page attributes",4],
                    "username":["Username",4],
                    "valNimmBeob":["Option",3],
                    "valUse3TimesNpcPrices":["Option",3]},
         "COUNTRY":{"changedata":["Data version",1],
                    "pagedataLogin":["Page attributes",4],
                    "valServerTimeOffset":["Option",3]},
          "GLOBAL":{"changedata":["Data version",1],
                    "changelogShownVersion":["Last shown version",3],
                    "devmode_log_error":["Option",3],
                    "devmode_log_warning":["Option",3],
                    "devmode":["Option",3],
                    "devmode_function":["Option",3],
                    "devmode_events":["Option",3],
                    "hotkeymap":["Option",3],
                    "loginbusy":["Page attributes",4],
                    "logindata":["Accounts",3],
                    "tutorial":["Tutorial step",3],
                    "updateCheck":["Script update",5],
                    "valAnimateStartscreen":["Option",3],
                    "valAutoLogin":["Option",3],
                    "valUpdate":["Option",3]}
};

var npcSaison = INIT_NPC_SAISON.clone();
var prodName=new Array();
var prodId=new Array();
var recipeNameToId=null; //TODO maybe rename / save as var
var prodTyp=new Array(); //c:coins, v:plant, e:product, u:garbage, z:deco, f:forestry, d:forestry deco
var prodBlock=new Array(); //c:only by club, u:garbage, l:level too low, t:not tradable, f:forestry, q:forestry quest too low, v:veterinary level to low
var prodMinRackInit=new Array(); // initial minimal rack amounts
// integer<0 is possible and means something like "product is produced"
// call: unsafeWindow.prodMinRackAddon.add(type,1,"Mill-Queue",20000);
// call: unsafeWindow.prodMinRackAddon.remove(type,1,"Mill-Queue");
var prodMinRackAddon=new Array(new Array(), new Object()); // additional minimal rack data from addons
unsafeWindow.prodMinRackAddon=new Object();
unsafeWindow.prodMinRackAddon.newdata=new Array();
unsafeWindow.prodMinRackAddon.busy=false;
var prodMinRack=new Array(); // + quest amount - field and powerup amounts
var prodNameSort=new Array(); // sorted by type(cveoz)
var prodStock=new Array();
var prodStockMax=new Array();//if not id is undefined then there is no max
var prodPlantSize=new Array();
var prodYield=new Array();
var prodRequire=new Array();
var prodPoints=new Array();
var prodGrowTime=new Array();
var gut=new Array();
var gutBeob=new Array();
var preisBeob=new Array();
var questData;
var css_styles=new Object();
var regMsgContentMarketsale,regMsgContentContractsale,regMsgContentContractsaleList,regMsgSubjectFriend,regMsgSubjectFriendCancel;
var valAutoWater, valWaterNeeded, valAssumeWater, valAutoCrop, valErnteMsg, valLimitEmptyFields, valStatistik, valClickErrorbox, valGlobaltimeShowCroppedZone;
var valMoveAnimals, valMinRackMan, valMinRack, valMinRackPlantsize, valMinRackFarmis,valMinRackForestryFarmis,valMinRackFoodworldFarmis,valMinRackFarmersmarketFarmis, valMinRackGrowing, valMinRackRecursive, valFarmiLimits, valFarmiMiniInfo,valMinAlpinFarm6,valMinExFruitsFarms5;
var upjersAds, buyNotePadShowBlocked, show;
var farmiLog, farmiDailyCount, levelLog, levelLogId, lotteryLog, lotteryLogId, logSales, logSalesId, logDonkey, logDonkeyId, logClothingDonation;
var zoneAddToGlobalTime;
var totalAnimals, totalFarmis, totalPowerups, totalQuest, totalRecursive, totalZones, totalEndtime;
var valKauflimit, valKauflimitNPC, highlightProducts, highlightUser, valAnimalBreedingDelay, valNimmBeob, valPreiseBeobNum, valUse3TimesNpcPrices, valVerkaufLimitDown, valVerkaufLimitUp, valJoinPreise, lastOffer, protectMinRack, ownMarketOffers, valClothingDonation, valVet, valVetAutostart, valVetAutoSet, valVetNoCoinDrugs, vetTreatment, sushibarFarmi;
var valAnimateStartscreen, valAutoLogin;
var valMessagesSystemMarkRead;
var megafieldVehicle, megafieldJob, logMegafieldJob, megafieldSmartTimer;
unsafeData.battleDailyBonusDone=false;
unsafeData.xMasCalendarDailyDone=false;
unsafeData.oktoberfestBonus=false;

top.unsafeData.autoAction=null;

// animierte Hintergründe ausblenden code by Harry 24.11.2015
if (GM_getValue("valAnimateStartscreen",false)){
    var divdel1 = document.getElementById("clouds1");
    var divdel2 = document.getElementById("clouds2");
    var divdel3 = document.getElementById("sheepcloud");
    if (divdel1) {
        divdel1.style.display = "none";
    }
    if (divdel2) {
        divdel2.style.display = "none";
    }
    if (divdel3) {
        divdel3.style.display = "none";
    }
}
// animierte Hintergründe ausblenden

//***********************************************************************************************************
// developer functions
if(DEVMODE_FUNCTION){ tracking.init("berater"); }

//***********************************************************************************************************
//*********************** FUNCTIONS *************************************************************************
var reloader=new function(){
    var counters={};
    var runInterval=null;
    var bubble=null;
/*
        if(time>0){
            if(self==top){
                div=$("bubbleBeraterNotLoaded");
                if(!div){
                    div=createElement("div",{"id":"bubbleBeraterNotLoaded","style":"position:absolute;top:0;left:0;width:340px;padding:30px;background-color:yellow;border:3px solid black;border-radius:10px;z-index:1000;font-family:Verdana,sans-serif;color:#000000;font-size:12pt;font-weight:bold;"},document.getElementsByTagName("body")[0]);
                }
                div.innerHTML = getText("pageXNotLoaded").replace(/%1%/,location.href)
                              + "<br><br>"
                              + getText("reloadInXSec").replace(/%1%/,time);
            }
            window.setTimeout(function(){ scriptWait(--time); },1000);
        }else{
            location.href=location.href;
        }
*/
    this.start=function(name,time,text){
        try{
            counters[name]=[time,text];
            runInterval=window.setInterval(reloader.run,1000);
        }catch(err){ GM_logError("reloader.start","name="+name+" time="+time,"",err); }
    }
    this.stop=function(name){
        try{
            delete counters[name];
            if(counters.isEmpty()){
                if(runInterval){
                    window.clearInterval(runInterval);
                    runInterval=null;
                }
                if(bubble){
                    removeElement(bubble);
                    bubble=null;
                }
            }
        }catch(err){ GM_logError("reloader.stop","name="+name,"",err); }
    }
    this.run=function(){
        try{
            var a=0,time;
            for(var name in counters){
                if(!counters.hasOwnProperty(name)){ continue; }
                time=(--counters[name][0]);
                if(time>0){
                    if((++a==1)&&(self==top)){
                        if(!bubble){
                            bubble=createElement("div",{"style":"position:absolute;top:0;left:0;width:340px;padding:30px;background-color:yellow;border:3px solid black;border-radius:10px;z-index:1000;font-family:Verdana,sans-serif;color:#000000;font-size:12pt;font-weight:bold;"},document.getElementsByTagName("body")[0]);
                        }
                        bubble.innerHTML = counters[name][1]
                                      + "<br><br>"
                                      + getText("reloadInXSec").replace(/%1%/,time);
                    }
                }else{
                    location.href=location.href;
                    break;
                }
            }
        }catch(err){ GM_logError("reloader.run","","",err); }
    }
}
// DOM
function SortableTable (sortRow){
    // Sortable HTML table inspired by http://www.webtoolkit.info/
    // example-call: new SortableTable(x);
    // sorting by value-attribute of td-elements
    // only cols with sortdir-attribute in the thead-cell
    function sortCol(cell){
    try{
        var tableEl=cell;
        while(tableEl.tagName!="TABLE"){ tableEl=tableEl.parentNode; }
        var tbody=tableEl.getElementsByTagName("tbody")[0];
        var sortRow=cell.parentNode;
        var newclass,oldclass,sortdir;
        // clone the rows
        var newRows=new Array();
        for(j=0; j < tbody.rows.length; j++){
            newRows[j]=tbody.rows[j];
        }
        //sort them
        newRows.sort(function(a,b){
            aa=parseFloat(a.cells[cell.cellIndex].getAttribute("value"),10);
            if (isNaN(aa)) aa=0;
            bb=parseFloat(b.cells[cell.cellIndex].getAttribute("value"),10);
            if (isNaN(bb)) bb=0;
            return (aa-bb);
        });
        // set classes of headercells
        if (cell.getAttribute("sortdir") == "Asc"){
            newRows.reverse();
            sortdir="Desc";
        }else{
            sortdir="Asc";
        }
        cell.setAttribute("sortdir",sortdir);
        for(var i=0; i<sortRow.cells.length; i++){
            if(typeof(sortRow.cells[i].getAttribute("sortdir"))=="string"){
                oldclass=sortRow.cells[i].getAttribute("class");
                newclass=oldclass.replace(/sortableCol(.*)\b/,"sortableCol"+(i==cell.cellIndex?sortdir:""));
                if(oldclass!=newclass){ sortRow.cells[i].setAttribute("class",newclass); }
            }
        }
        // rebuild table
        for(i=0;i<newRows.length;i++){
            tbody.appendChild(newRows[i]);
        }
        tableEl=null;tbody=null;sortRow=null;newRows=null;
    }catch(err){ GM_logError("sortCol","",sortRow.cells[i].innerHTML,err); }
    }
    // constructor actions
    try{
    for(var i=0; i<sortRow.cells.length; i++){
        if(typeof(sortRow.cells[i].getAttribute("sortdir"))=="string"){
            var oldclass=sortRow.cells[i].getAttribute("class");
            sortRow.cells[i].setAttribute("class",(oldclass?oldclass+" ":"")+"sortableCol");
            sortRow.cells[i].addEventListener("click",function (){
                sortCol(this);
                return false;
            },false);
        }
    }
    }catch(err){ GM_logError("SortableTable","","",err); }
}
function bar(size,markvalue,maxvalue){
    size=Math.floor(size);
    var mark=Math.floor(size*markvalue/maxvalue);
    var cell=createElement("div",{"style":"border:2px solid black; position:absolute;width:"+size+"px;height:12px;"});
        createElement("div",{"style":"position:absolute;width:"+mark+"px;height:12px;background-color:#5555FF;"},cell);
    return cell;
}
function setSelRange(inputEl, selStart, selEnd){
    if (inputEl.setSelectionRange){
        inputEl.focus();
        inputEl.setSelectionRange(selStart, selEnd);
    }else if (inputEl.createTextRange){
        var range=inputEl.createTextRange();
        range.collapse(true);
        range.moveEnd('character', selEnd);
        range.moveStart('character', selStart);
        range.select();
    }
}

// Strings
function getKeySymbol(keyCode){
    if((46<keyCode)&&(keyCode<91)){ return String.fromCharCode(keyCode); }
    var codelist={"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause/break","20":"caps lock","27":"escape","33":"page up","34":"page down","35":"end","36":"home","37":"<-","38":"up arrow","39":"->","40":"down arrow","45":"insert","46":"delete","91":"left window key","92":"right window key","93":"select key","96":"numpad 0","97":"numpad 1","98":"numpad 2","99":"numpad 3","100":"numpad 4","101":"numpad 5","102":"numpad 6","103":"numpad 7","104":"numpad 8","105":"numpad 9","106":"*","107":"+","109":"-","110":"decimal point","111":"divide","112":"F1","113":"F2","114":"F3","115":"F4","116":"F5","117":"F6","118":"F7","119":"F8","120":"F9","121":"F10","122":"F11","123":"F12","144":"num lock","145":"scroll lock","186":"semi-colon","187":"equal sign","188":",","189":"dash","190":"period","191":"forward slash","192":"grave accent","219":"open bracket","220":"back slash","221":"close braket","222":"single quote"};
    return codelist[keyCode]?codelist[keyCode]:"key("+keyCode+")";
}

// Game
function igm(name,append,betreff){
try{
    var link=createElement("span",{"to":name,"subject":(betreff?betreff:""),"class":"link playerMsg"});
    createElement("div",{},link);
    link.addEventListener("click",function(){
    try{
        if(unsafeWindow.messages_write_block == 1){
            unsafeWindow.showDiv("messages_view_info");
            unsafeWindow.hideDiv("messages_view_form");
        }else{
            unsafeWindow.hideDiv("messages_view_info");
            unsafeWindow.showDiv("messages_view_form");
        }
        $("messages_view_name").value = this.getAttribute("to");
        $("messages_view_subject").value = this.getAttribute("subject");
        $("messages_view_body").value = "";
        unsafeWindow.hideDiv("messages_list");
        unsafeWindow.hideDiv("messages_contacts");
        unsafeWindow.showDiv("messages_view");
        unsafeWindow.messagesNavi("new");
        unsafeWindow.messagesCalcBody();
    }catch(err){GM_logError("igm.click","","",err);}
    },false);
    link.addEventListener("mouseover",function(event){
        toolTip.show(event,getText("writeMessage"),this);
    },false);
    if (append){ append.appendChild(link); }
    return link;
}catch(err){GM_logError("igm","","",err);}
}
function vertrag(name,append){
    var link=createElement("span",{"to":name,"class":"link playerContract"});
    createElement("div",{},link);
    link.addEventListener("click",function(){
        var pagedata=new Object();
        pagedata["to"]=this.getAttribute("to");
        window.setTimeout(function(){
            GM_setValue(COUNTRY+"_"+SERVER+"_pagedataVertraegeNew",implode(pagedata,"vertrag/pagedata"));
            if($top("multiframe")){
                toolTip.hide(this);
                $top("multiframe").src="../vertraege/new.php";
                $top("multiframe").style.display="block";
            }else{
                window.open("../vertraege/new.php");
            }
        },0);
    },false);
    link.addEventListener("mouseover",function(event){
        toolTip.show(event,getText("sendContract"));
    },false);
    if (append) append.appendChild(link);
    return link;
}
function stats(name,append){
    var link=createElement("span", {"mouseOverText":getText("statistics"),"class":"link playerStats","href":"../stadt/stats.php?search=1&searchterm="+name});
    createElement("div",{},link);
    if($top("shop")){
        link.addEventListener("click",function(){
            toolTip.hide(this);
            showShopframePage(this.getAttribute("href"));
        },false);
    }else{
        link.addEventListener("click",function(){location.href=this.getAttribute("href");},false);
    }
    link.addEventListener("mouseover",function(event){
        toolTip.show(event,this.getAttribute("mouseOverText"),this);
    },false);
    if (append) append.appendChild(link);
    return link;
}

function loadProductData(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","loadProductData"); }

        gut=explode(GM_getValue(COUNTRY+"_"+SERVER+"_gut"),"loadProductData/gut",[]);
        gutBeob=explode(GM_getValue(COUNTRY+"_"+SERVER+"_gutBeob"),"loadProductData/gutBeob",[]);
        preisBeob=explode(GM_getValue(COUNTRY+"_"+SERVER+"_preisBeob"),"loadProductData/preisBeob",[]); //isNotSent,time,min,max,amount
        prodName=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodName"),"loadProductData/prodName",[]);
        prodId=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodId"),"loadProductData/prodId",[]);
        prodPlantSize=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodPlantSize"),"loadProductData/err/prodPlantSize",[]);
        prodStock=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock"),"loadProductData/prodStock",[]);
        prodStockMax=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStockMax"),"loadProductData/prodStockMax",[]);
        prodYield=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodYield"),"loadProductData/prodYield",[]);
        prodRequire=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodRequire"),"loadProductData/prodRequire",[]);
        prodTyp=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodTyp"),"loadProductData/prodTyp",[]);//c:coins, v:plant, e:product, u:garbage, z:deco, f:forestry, r:recipe
        prodGrowTime=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodGrowTime"),"loadProductData/prodGrowTime",[]);
        prodPoints=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodPoints"),"loadProductData/prodPoints",[]);
        prodNameSort=explode(GM_getValue(COUNTRY+"_"+SERVER+"_prodNameSort"),"loadProductData/err/prodNameSort",[]);
        prodBlock=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodBlock"),"loadProductData/err/prodBlock",[]);
        prodMinRackInit=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRackInit"),"loadProductData/err/prodMinRackInit",[]);
        prodMinRack=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRack"),"loadProductData/err/prodMinRack",[]);
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
}catch(err){ GM_logError("loadProductData","","",err); }
}
function updateProductDataFarm(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","updateProductDataFarm"); }
        if(USERLEVEL<parseInt(unsafeWindow.currentuserlevel,10)){
            raiseEvent("gameUserlevelUp");
        }
        USERLEVEL=parseInt(unsafeWindow.currentuserlevel,10);
        if(!(prodName instanceof Array)){ prodName=[]; }
        if(!(prodId instanceof Array)){ prodId=[]; }
        if(!(prodPlantSize instanceof Array)){ prodPlantSize=[]; }
        if(!(prodStock instanceof Array)){ prodStock=[]; }
        if(!(prodStockMax instanceof Array)){ prodStockMax=[]; }
        if(!(prodYield instanceof Array)){ prodYield=[]; }
        if(!(prodRequire instanceof Array)){ prodRequire=[]; }
        if(!(prodTyp instanceof Array)){ prodTyp=[]; }
        if(!(prodGrowTime instanceof Array)){ prodGrowTime=[]; }
        if(!(prodPoints instanceof Array)){ prodPoints=[]; }
        if(!(prodNameSort instanceof Array)){ prodNameSort=[]; }
        if(!(prodBlock instanceof Array)){ prodBlock=[]; }

        if(!prodName[0]||!(prodName[0] instanceof Array)){ prodName[0]=[]; }
        if(!prodId[0]||(typeof prodId[0]!="object")||(prodId[0] instanceof Array)){ prodId[0]={}; }
        if(!prodPlantSize[0]||!(prodPlantSize[0] instanceof Array)){ prodPlantSize[0]=[]; }
        if(!prodStock[0]||!(prodStock[0] instanceof Array)){ prodStock[0]=[]; }
        if(!prodStockMax[0]||!(prodStockMax[0] instanceof Array)){ prodStockMax[0]=[]; }
        if(!prodYield[0]||!(prodYield[0] instanceof Array)){ prodYield[0]=[]; }
        if(!prodRequire[0]||!(prodRequire[0] instanceof Array)){ prodRequire[0]=[]; }
        if(!prodTyp[0]||!(prodTyp[0] instanceof Array)){ prodTyp[0]=[]; }
        if(!prodGrowTime[0]||!(prodGrowTime[0] instanceof Array)){ prodGrowTime[0]=[]; }
        if(!prodPoints[0]||!(prodPoints[0] instanceof Array)){ prodPoints[0]=[]; }
        // if(!prodBlock[0]||!(prodBlock[0] instanceof Array)){ prodBlock[0]=[]; }

        // b:block recipe/powerup
        // c:only by club
        // f:forestry
        // p:powerup
        // q:quest too low (main or forestry)
        // r:recipe
        // l:level too low
        // t:not tradable
        // v:level veterinary too low
        // u:garbage
        //
        // task_new_plant task_new_product
        //13102016
        prodBlock[0]=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","ct","","ct","","ct","ct","","ct","","","","","","","","","","ct","ct","ct","ct","ct","ct","ct","","","","","","","ct","","ct","","","ct","","","ct","ct","ct","","","","","","","","t","","","","","","","t","","t","t","","","","","","","","","","","","","","","","","","","","","","t","","","","","","","","","","","","","","","","","","","","","","","","","","","","","t","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","ut","ut",,,,,,,,,,,"","","","","","","","","","","","","","","t","t","t","t","t","t","t","t",,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","","","","","","","","","","","","","","","","","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,"","","","","","t","t","","t","","t","","t","","t","","t","","t","","","t","","t","","","","","","","","t","t","","t","","","t","","t","","t","","t","t","","t","","","t","","","","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","t","","t",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","t","","","","t","","t","t","t",,,,,,,,,,,,,,,,,,,,,"t","t","t","t","","","","","t","",,,,,,,,,,,,,,,,,,,,,"t","t","t","","t","t","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"t","","t","t","","","t","","t","","","t","","","","t","t","t","","","","","","","","","","","","","","","","","",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","t","","t","","t","","t","","t","t","","","t","","t","","t","","t","t",,,,,,,,,,,,,,,,,,,,,,,,,,,,,"","","","","","","","",,,,,,,,,,,,,"","t","t","","","t","t","","","","t","t","","t","","t",,,,,,,,,,,,,,,"","t","","t","","t","","t"
    ];

    /*
    var new_prodBlock=prodBlock[0].clone();
    for(var v=950;v<=957;v++){
        new_prodBlock[v]=v;
    }
    console.log(implode(new_prodBlock));*/

        // 13102016
        var help={"v":[],"ex":[],"hr":[],"e":[],"o":[],"fw1":[],"fw2":[],"fw3":[],"fw4":[],"z":[],"fl":[],"fla":[],"md":[],"breed":[],"alpin":[],"tea":[],"cow":[],"fish":[],"water":[],"sushi":[],"scouts":[]};
        // for(var v=1;v<unsafeWindow.produkt_name.length;v++){
        //*task_fix_growtime*/ var newProductGrowtime={};
        //*task_fix_points*/ var newProductPoints={};
        var vet_data;
        if(unsafeWindow.vet_data&&unsafeWindow.vet_data.info&&unsafeWindow.vet_data.drugs){
            vet_data=unsafeWindow.vet_data;
        }

        if(!prodStock[5]||!(prodStock[5] instanceof Array)){ prodStock[5]=[]; }
        if(!prodStock[6]||!(prodStock[6] instanceof Array)){ prodStock[6]=[]; }
        if(!prodStock[7]||!(prodStock[7] instanceof Array)){ prodStock[7]=[]; }
        if(!prodStock[8]||!(prodStock[8] instanceof Array)){ prodStock[8]=[]; }
        if(!prodStock[9]||!(prodStock[9] instanceof Array)){ prodStock[9]=[]; }

        for(var v in unsafeWindow.produkt_name){
            prodStock[5][v] = 0; //Wert auf 0 setzen, wenn nicht vorhanden
            prodStock[6][v] = 0;
            prodStock[7][v] = 0;
            prodStock[8][v] = 0;
            prodStock[9][v] = 0;
        }
        var prodStockTemp=new Array();    //Stock Farm 1
        for(var i in unsafeWindow.rackobj) {
            for(var j in unsafeWindow.rackobj[i]) {
                for(var k in unsafeWindow.rackobj[i][j]) {

                    switch (i) {
                        case "1":
                            prodStockTemp[unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                        case "5":
                            prodStock[5][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                        case "6":
                            prodStock[6][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                        case "7":
                            prodStock[7][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                        case "8":
                            prodStock[8][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                        case "9":
                            prodStock[9][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                            break;
                    }
                }
            }
        }

        for(var v in unsafeWindow.produkt_name){
            if(!unsafeWindow.produkt_name.hasOwnProperty(v)){continue;}
            if(isNaN(gut[v])){ gut[v]=0; }
            prodName[0][v]=unsafeWindow.produkt_name[v];
            prodId[0][prodName[0][v]]=v;
            prodPlantSize[0][v]=unsafeWindow.produkt_x[v]*unsafeWindow.produkt_y[v];
            var c=(prodStockTemp[v])?prodStockTemp[v]:0;
            prodStock[0][v]=(c?parseInt(c,10):0);
            /* kann gelöscht werden
            if (prodStock[5][v]==null) prodStock[5][v] = 0; //Wert auf 0 setzen, wenn nicht vorhanden
            if (prodStock[6][v]==null) prodStock[6][v] = 0;
            if (!prodStock[7][v]) {prodStock[7][v] = 0;}
            */
            prodYield[0][v]=(unsafeWindow.produkt_ernte[v]?parseInt(unsafeWindow.produkt_ernte[v],10):0);
            prodTyp[0][v]=unsafeWindow.produkt_category[v];
            prodRequire[0][v]=PRODUCT_REQUIRE[0][v];
            prodGrowTime[0][v]=(undefined!=PRODUCT_GROWTIME[0][v]?PRODUCT_GROWTIME[0][v]:(unsafeWindow.produkt_zeit[v]?Math.round(parseInt(unsafeWindow.produkt_zeit[v],10)/60):0));
            prodPoints[0][v]=(undefined!=PRODUCT_POINTS[0][v]?PRODUCT_POINTS[0][v]:(unsafeWindow.produkt_points[v]?parseInt(unsafeWindow.produkt_points[v],10):0));

            if(prodTyp[0][v]=="u"){
                prodBlock[0][v]="ut";
            }else{
                if(typeof prodBlock[0][v]=="undefined"){
                    prodBlock[0][v]="t";
                }
                // Hack: split picnic products in different categories
                if(prodTyp[0][v]=="fw"){
                    // task_new_picnic_product
                    switch(parseInt(v,10)){
                    case 130:case 131:case 132:case 133:case 134:case 135:case 145:case 146:case 147:case 468:case 469:case 470:case 471:case 472:case 473:
                        prodTyp[0][v]+="1"; break;

                    case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:case 148:case 149:case 150:case 474:case 475:case 476:case 477:
                        prodTyp[0][v]+="2"; break;

                    case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 169:case 170:case 478:case 479:case 480:case 481:case 482:case 483:
                        prodTyp[0][v]+="3"; break;
                    case 450:case 451:case 452:case 453:case 454:case 455:case 456:case 457:case 458:case 459:case 460:case 461:case 462:case 463:case 464:case 465:case 466:case 467:
                        prodTyp[0][v]+="4"; break;
                    default: prodTyp[0][v]+="4";
                    }
                }

                if(help[prodTyp[0][v]]){
                    help[prodTyp[0][v]].push(v);
                }

                switch(prodTyp[0][v]){
                    case "alpin":
                        if(PRODUCT_QUEST[0][v]&&(questData[PRODUCT_QUEST[0][v][0]][PRODUCT_QUEST[0][v][1]]["nr"]<=PRODUCT_QUEST[0][v][2])){
                            prodBlock[0][v]+="v";
                        }
                    break;
                    case "breed": //13102016
                        if (unsafeWindow.pets.data.block==0) {
                            if (unsafeWindow.pets.data.data.level < PRODUCT_LEVEL["breeding"][v]) {
                                prodBlock[0][v]+="v"+PRODUCT_LEVEL["breeding"][v];
                            }
                        } else {
                            prodBlock[0][v]+="v"+PRODUCT_LEVEL["breeding"][v];
                        }
                    break;
                    case "ex":
                        if(PRODUCT_QUEST[0][v]&&(questData[PRODUCT_QUEST[0][v][0]][PRODUCT_QUEST[0][v][1]]["nr"]<=PRODUCT_QUEST[0][v][2])){
                            prodBlock[0][v]+="v";
                        }
                        // ToDo: this is a workaround - "q" would be enough. but with "q" only, all "ex" products are shown on the market-list. Even the not released
                        // bugfix should be performed when populating the marketlist.
                    break;
                    case "hr":
                        if(unsafeWindow.vet_data && unsafeWindow.vet_data.info){
                            var vetdiv = $("farmersmarket_pos5_block");
                            if( vetdiv.style.display=="block" || unsafeWindow.vet_data.info.level < PRODUCT_LEVEL["veterinary"][v] ){
                                prodBlock[0][v]+="v"+PRODUCT_LEVEL["veterinary"][v];
                            }
                            vetdiv=null;
                        }else{
                            prodBlock[0][v]+="v"+PRODUCT_LEVEL["veterinary"][v];
                        }
                    break;
                    case "md":
                        if(unsafeWindow.vet_data && unsafeWindow.vet_data.info){
                            var vetdiv = $("farmersmarket_pos5_block");
                            if( vetdiv.style.display=="block" || unsafeWindow.vet_data.info.level < PRODUCT_LEVEL["veterinary"][v] ){
                                prodBlock[0][v]+="v"+PRODUCT_LEVEL["veterinary"][v];
                            }
                            vetdiv=null;
                        }else{
                            prodBlock[0][v]+="v"+PRODUCT_LEVEL["veterinary"][v];
                        }
                        //Fix Produkt Points Tinkturen
                        prodPoints[0][v]=(prodPoints[0][v]?prodPoints[0][v]/prodYield[0][v]:0);
                    break;

                    case "scouts":
                        if(unsafeWindow.scouts && unsafeWindow.scouts.data && unsafeWindow.scouts.data.data) {
                            if (unsafeWindow.scouts.data.data.level < unsafeWindow.scouts.data.config.products[v].level) {
                                prodBlock[0][v]+="v"
                            }
                        } else {
                            prodBlock[0][v]+="v"
                        }
                    break

                    case "sushi":
                        if(unsafeWindow.sushibar && unsafeWindow.sushibar.data && unsafeWindow.sushibar.data.config) {
                            if (unsafeWindow.sushibar.data.data.level < PRODUCT_LEVEL["sushibar"][v]) {
                                prodBlock[0][v]+="v"+PRODUCT_LEVEL["sushibar"][v];
                            }
                        } else {
                            prodBlock[0][v]+="v"+PRODUCT_LEVEL["sushibar"][v];
                        }
                    break;
                    case "water":
                        if(PRODUCT_QUEST[0][v]&&(questData[PRODUCT_QUEST[0][v][0]][PRODUCT_QUEST[0][v][1]]["nr"]<=PRODUCT_QUEST[0][v][2])){
                            prodBlock[0][v]+="v";
                        }
                    break;
                    default:
                        if(USERLEVEL<unsafeWindow.produkt_level[v]){
                            prodBlock[0][v]+="l"+unsafeWindow.produkt_level[v];
                        }
                }
                if(PRODUCT_QUEST[0][v]&&(questData[PRODUCT_QUEST[0][v][0]][PRODUCT_QUEST[0][v][1]]["nr"]<=PRODUCT_QUEST[0][v][2])){
                    prodBlock[0][v]+="q";
                }
            }
        }
        //*task_fix_growtime*/ GM_logInfo("updateProductDataFarm","","","newProductGrowtime="+implode(newProductGrowtime,1));
        //*task_fix_points*/ GM_logInfo("updateProductDataFarm","","","newProductPoints="+implode(newProductPoints,1));
        prodTyp[0][0]="c";
        try{ prodStock[0][0]=parseInt($("coins").innerHTML,10); }catch(err){}
        //13102016
        prodNameSort[0]=[0].concat(help["v"],help["ex"],help["e"],help["o"],help["fw1"],help["fw2"],help["fw3"],help["fw4"],help["fl"],help["fla"],help["hr"],help["md"],help["breed"],help["alpin"],help["tea"],help["cow"],help["fish"],help["water"],help["sushi"],help["scouts"],help["z"]);
        // quest boni
        for(var v=1;v<questData["main"]["1"]["nr"];v++){
            if(QUESTS["main"]["1"][v]&&QUESTS["main"]["1"][v][3]){
                for(var w=0;w<QUESTS["main"]["1"][v][3].length;w++){
                    if(QUESTS["main"]["1"][v][3][w][0]==4){
                        prodGrowTime[QUESTS["main"]["1"][v][3][w][1]][QUESTS["main"]["1"][v][3][w][2]]-=QUESTS["main"]["1"][v][3][w][3];
                    }
                }
            }
        }
        publishProductData();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){
        GM_logError("updateProductDataFarm","","",err);
        loadProductData();
    }
}
function updateProductDataForestry(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","updateProductDataForestry"); }
        prodName[1]={};
        if(!prodId[1]||(typeof prodId[1]!="object")||(prodId[1] instanceof Array)){ prodId[1]={}; }
        if(!prodPlantSize[1]||(typeof prodPlantSize[1]!="object")||(prodPlantSize[1] instanceof Array)){ prodPlantSize[1]={}; }
        if(!prodStock[1]||(typeof prodStock[1]!="object")||(prodStock[1] instanceof Array)){ prodStock[1]={}; }
        if(!prodStockMax[1]||(typeof prodStockMax[1]!="object")||(prodStockMax[1] instanceof Array)){ prodStockMax[1]={}; }
        if(!prodYield[1]||(typeof prodYield[1]!="object")||(prodYield[1] instanceof Array)){ prodYield[1]={}; }
        if(!prodRequire[1]||(typeof prodRequire[1]!="object")||(prodRequire[1] instanceof Array)){ prodRequire[1]={}; }
        if(!prodTyp[1]||(typeof prodTyp[1]!="object")||(prodTyp[1] instanceof Array)){ prodTyp[1]={}; }
        if(!prodGrowTime[1]||(typeof prodGrowTime[1]!="object")||(prodGrowTime[1] instanceof Array)){ prodGrowTime[1]={}; }
        if(!prodPoints[1]||(typeof prodPoints[1]!="object")||(prodPoints[1] instanceof Array)){ prodPoints[1]={}; }
        if(!prodNameSort[1]||!(prodNameSort[1] instanceof Array)){ prodNameSort[1]=[]; }
        if(!prodBlock[1]||(typeof prodBlock[1]!="object")||(prodBlock[1] instanceof Array)){ prodBlock[1]={}; }

        var help={"f1":[],"f2":[],"f3":[],"f4":[],"f5":[]};
        for(var v in unsafeWindow.produkt_name_forestry){
            if(!unsafeWindow.produkt_name_forestry.hasOwnProperty(v)){continue;}
            prodName[1][v]=unsafeWindow.produkt_name_forestry[v];
            prodId[1][prodName[1][v]]=v;
            prodPlantSize[1][v]=1;
            // prodStock
            // prodStockMax
            prodYield[1][v]=PRODUCT_YIELD[1][v];
            if(v==105||v==108||v==116||v==117||v==119||v==120||v==148){ prodTyp[1][v]="f5"; } // farmhouse-items from carpentry
            else if(v==300){ prodTyp[1][v]="u"; } //if(v==300){ prodTyp[1][v]="f1"; }
            else if(v<20){ prodTyp[1][v]="f1"; } // saplings
            else if(v<40){ prodTyp[1][v]="f2"; } // logs
            else if(v<100){ prodTyp[1][v]="f3"; } // sawmill-products
            else if(v<500){ prodTyp[1][v]="f4"; } // carpentry-products
            else { prodTyp[1][v]="u"; } // useless "products"
            prodRequire[1][v]=PRODUCT_REQUIRE[1][v];
            prodGrowTime[1][v]=PRODUCT_GROWTIME[1][v];
            prodPoints[1][v]=PRODUCT_POINTS[1][v];

            if(prodTyp[1][v]=="u"){
                prodBlock[1][v]="tu";
            }else{
                prodBlock[1][v]="t";
                if((unsafeWindow.forestry_unlock===undefined)||(PRODUCT_QUEST[1][v]&&(questData[PRODUCT_QUEST[1][v][0]][PRODUCT_QUEST[1][v][1]]["nr"]<=PRODUCT_QUEST[1][v][2]))){
                    prodBlock[1][v]+="q";
                }
                if(v==113||v==114||v==133){ prodBlock[1][v]+="s"; }
                if(help[prodTyp[1][v]]){
                    help[prodTyp[1][v]].push(v);
                }
            }
        }
        prodNameSort[1]=help["f1"].concat(help["f2"],help["f3"],help["f4"],help["f5"]);
        // prodName[1].sortObj();
        publishProductData();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("updateProductDataForestry","","",err); }
}
function updateProductDataWindmill(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","updateProductDataWindmill"); }
        if(!prodName[2]||!(prodName[2] instanceof Array)){ prodName[2]=[]; }
        if(!prodId[2]||(typeof prodId[2]!="object")||(prodId[2] instanceof Array)){ prodId[2]={}; }
        if(!prodPlantSize[2]||!(prodPlantSize[2] instanceof Array)){ prodPlantSize[2]=[]; }
        if(!prodStock[2]||!(prodStock[2] instanceof Array)){ prodStock[2]=[]; }
        if(!prodStockMax[2]||!(prodStockMax[2] instanceof Array)){ prodStockMax[2]=[]; }
        // if(!prodYield[2]||!(prodYield[2] instanceof Array)){ prodYield[2]=[]; }
        // if(!prodRequire[2]||!(prodRequire[2] instanceof Array)){ prodRequire[2]=[]; }
        if(!prodTyp[2]||!(prodTyp[2] instanceof Array)){ prodTyp[2]=[]; }
        // if(!prodGrowTime[2]||!(prodGrowTime[2] instanceof Array)){ prodGrowTime[2]=[]; }
        // if(!prodPoints[2]||!(prodPoints[2] instanceof Array)){ prodPoints[2]=[]; }
        if(!prodBlock[2]||!(prodBlock[2] instanceof Array)){ prodBlock[2]=[]; }

        prodYield[2]=[];
        prodRequire[2]=[];
        prodGrowTime[2]=[];
        prodPoints[2]=[];
        // GM_log("formulas:\n"+print_r(unsafeWindow.formulas,"",true,"\n"));
        for(var v in unsafeWindow.formulas[0]){
            if(!unsafeWindow.formulas[0].hasOwnProperty(v)){continue;}
            pId=unsafeWindow.formulas[0][v][0];
            // GM_log("updateProductDataWindmill loop formulas v="+v+" pId="+pId);
            prodName[2][pId]="*"+unsafeWindow.formulas[0][v][2];
            prodId[2][prodName[2][pId]]=pId;
            prodId[2][unsafeWindow.formulas[0][v][2]]=pId;
            prodPlantSize[2][pId]=1;
            if(!prodStock[2][pId]||(typeof prodStock[2][pId]!="number")){ prodStock[2][pId]=0; }
            //1=earn prods,2=earn extra amount,3=earn extra score
            if(unsafeWindow.formulas[0][v][5][0]!=0){ prodTyp[2][pId]="r0"; }
            else if(unsafeWindow.formulas[0][v][5][1]!=0){ prodTyp[2][pId]="r1"; }
            else if(unsafeWindow.formulas[0][v][5][2]!=0){ prodTyp[2][pId]="r2" }
            prodBlock[2][pId]="rt"+(USERLEVEL<unsafeWindow.formulas[0][v][1]?"l":"")+(unsafeWindow.formulas[0][v]["endremain"]<0?"s":"");
        }
        // prodTyp[2].sortObj();
        var help={"r0":[],"r1":[],"r2":[]};
        for(var v in prodTyp[2]){
            if(!prodTyp[2].hasOwnProperty(v)){continue;}
            if(help[prodTyp[2][v]]){ help[prodTyp[2][v]].push(v); }
        }
        prodNameSort[2]=help["r0"].concat(help["r1"],help["r2"]);
        publishProductData();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("updateProductDataWindmill","","",err); }
}
function updateProductDataPowerup(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","updateProductDataPowerup"); }
        if(!prodName[3]||!(prodName[3] instanceof Array)){ prodName[3]=[]; }
        if(!prodId[3]||(typeof prodId[3]!="object")||(prodId[3] instanceof Array)){ prodId[3]={}; }
        if(!prodPlantSize[3]||!(prodPlantSize[3] instanceof Array)){ prodPlantSize[3]=[]; }
        if(!prodStock[3]||!(prodStock[3] instanceof Array)){ prodStock[3]=[]; }
        if(!prodStockMax[3]||!(prodStockMax[3] instanceof Array)){ prodStockMax[3]=[]; }
        if(!prodYield[3]||!(prodYield[3] instanceof Array)){ prodYield[3]=[]; }
        if(!prodRequire[3]||!(prodRequire[3] instanceof Array)){ prodRequire[3]=[]; }
        if(!prodTyp[3]||!(prodTyp[3] instanceof Array)){ prodTyp[3]=[]; }
        if(!prodGrowTime[3]||!(prodGrowTime[3] instanceof Array)){ prodGrowTime[3]=[]; }
        if(!prodPoints[3]||!(prodPoints[3] instanceof Array)){ prodPoints[3]=[]; }
        if(!prodBlock[3]||!(prodBlock[3] instanceof Array)){ prodBlock[3]=[]; }

        var pId;
        for(var v in unsafeWindow.formulas[0]){
            if(!unsafeWindow.formulas[0].hasOwnProperty(v)){continue;}
            pId=unsafeWindow.formulas[0][v][0];
            // GM_log("updateProductDataPowerup loop formulas v="+v+" pId="+pId);
            prodName[3][pId]=unsafeWindow.formulas[0][v][2];
            prodPlantSize[2][pId]=1;
            prodStock[3][pId]=0;
            prodYield[3][pId]=1;
            prodRequire[3][pId]=[[2,pId,1]];
            for(var i=0;i<unsafeWindow.formulas[0][v][3].length;i++){
                prodRequire[3][pId].push([0,unsafeWindow.formulas[0][v][3][i][0],unsafeWindow.formulas[0][v][3][i][1]]);
            }
            //1=earn prods,2=earn extra amount,3=earn extra score
            if(unsafeWindow.formulas[0][v][5][0]!=0){ prodTyp[3][pId]="p0"; }
            else if(unsafeWindow.formulas[0][v][5][1]!=0){ prodTyp[3][pId]="p1"; }
            else if(unsafeWindow.formulas[0][v][5][2]!=0){ prodTyp[3][pId]="p2"; }
            prodGrowTime[3][pId]=Math.round(unsafeWindow.formulas[0][v][4]/60);
            prodPoints[3][pId]=unsafeWindow.formulas[0][v][8];
            prodBlock[3][pId]="pt"+(USERLEVEL<unsafeWindow.formulas[0][v][1]?"l":"");
        }
        if (unsafeWindow.poweruprack == null) unsafeWindow.poweruprack = 0;
        for(var v in unsafeWindow.poweruprack){
            if(!unsafeWindow.poweruprack.hasOwnProperty(v)){continue;}
            pId=unsafeWindow.poweruprack[v][0];
            // GM_log("updateProductDataPowerup loop poweruprack v="+v+" pId="+pId);
            prodName[3][pId]=unsafeWindow.poweruprack[v][2];
            prodStock[3][pId]=unsafeWindow.poweruprack[v]["rack"];
            if(unsafeWindow.poweruprack[v]["endremain"]<0){ prodBlock[3][pId]+="s"; }
        }
        for(var v=0;v<prodName[3].length;v++){
            prodId[3][prodName[3][v]]=v;
        }
        // prodTyp[3].sortObj();
        var help={"p0":[],"p1":[],"p2":[]};
        for(var v in prodTyp[3]){
            if(!prodTyp[3].hasOwnProperty(v)){continue;}
            if(help[prodTyp[3][v]]){ help[prodTyp[3][v]].push(v); }
        }
        prodNameSort[3]=help["p0"].concat(help["p1"],help["p2"]);
        publishProductData();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("updateProductDataPowerup","","",err); }
}
function updateProductDataMegafield(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","updateProductDataMegafield"); }
        if(!(prodName instanceof Array)){ prodName=[]; }
        if(!(prodId instanceof Array)){ prodId=[]; }
        if(!(prodPlantSize instanceof Array)){ prodPlantSize=[]; }
        if(!(prodStock instanceof Array)){ prodStock=[]; }
        if(!(prodStockMax instanceof Array)){ prodStockMax=[]; }
        if(!(prodYield instanceof Array)){ prodYield=[]; }
        if(!(prodRequire instanceof Array)){ prodRequire=[]; }
        if(!(prodTyp instanceof Array)){ prodTyp=[]; }
        if(!(prodGrowTime instanceof Array)){ prodGrowTime=[]; }
        if(!(prodPoints instanceof Array)){ prodPoints=[]; }
        if(!(prodNameSort instanceof Array)){ prodNameSort=[]; }
        if(!(prodBlock instanceof Array)){ prodBlock=[]; }

        if(!prodName[4]||!(prodName[4] instanceof Array)){ prodName[4]=[]; }
        if(!prodId[4]||(typeof prodId[4]!="object")||(prodId[4] instanceof Array)){ prodId[4]={}; }
        if(!prodPlantSize[4]||!(prodPlantSize[4] instanceof Array)){ prodPlantSize[4]=[]; }
        if(!prodStock[4]||!(prodStock[4] instanceof Array)){ prodStock[4]=[]; }
        if(!prodStockMax[4]||!(prodStockMax[4] instanceof Array)){ prodStockMax[4]=[]; }
        if(!prodYield[4]||!(prodYield[4] instanceof Array)){ prodYield[4]=[]; }
        if(!prodRequire[4]||!(prodRequire[4] instanceof Array)){ prodRequire[4]=[]; }
        if(!prodTyp[4]||!(prodTyp[4] instanceof Array)){ prodTyp[4]=[]; }
        if(!prodGrowTime[4]||!(prodGrowTime[4] instanceof Array)){ prodGrowTime[4]=[]; }
        if(!prodPoints[4]||!(prodPoints[4] instanceof Array)){ prodPoints[4]=[]; }
        if(!prodBlock[4]||!(prodBlock[4] instanceof Array)){ prodBlock[4]=[]; }

        var products,pId;
        // collect new data from current job
        if(unsafeWindow.megafield_data&&unsafeWindow.megafield_data.job&&(products=unsafeWindow.megafield_data.job.products)){
            for(var v in products){
                if(!products.hasOwnProperty(v)){continue;}
                pId=products[v].pid;
                prodName[4][pId]="*"+unsafeWindow.produkt_name[pId];
                prodId[4][prodName[4][pId]]=pId;
                prodPlantSize[4][pId]=1;
                prodStock[4][pId]=products[v].have;
                prodStockMax[4][pId]=products[v].need;
                prodYield[4][pId]=1;
                prodTyp[4][pId]=(products[v].harvest?"m1":"m2");
                prodRequire[4][pId]=[[0,pId,products[v].amount?products[v].amount:1]];
                prodGrowTime[4][pId]=(products[v].duration?products[v].duration/60:0);
                prodPoints[4][pId]=0;
            }
        }
        // calculate prodNameSort
        var help={"v":[],"e":[],"o":[]};
        for(var v in prodName[4]){
            if(!prodName[4].hasOwnProperty(v)){continue;}
            if(help[prodTyp[4][v]]){
                help[prodTyp[4][v]].push(v);
            }
        }
        prodNameSort[4]=help["v"].concat(help["e"],help["o"]);
        publishProductData();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){
        GM_logError("updateProductDataMegafield","","",err);
        loadProductData();
    }
}
function publishProductData(){
    window.setTimeout(function(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","publishProductData"); }
        top.unsafeData.prodName     =prodName.clone();
        top.unsafeData.prodNameSort =prodNameSort.clone();
        top.unsafeData.prodTyp      =prodTyp.clone();
        top.unsafeData.prodBlock    =prodBlock.clone();
        top.unsafeData.prodYield    =prodYield.clone();
        top.unsafeData.prodRequire  =prodRequire.clone();
        top.unsafeData.prodStock    =prodStock.clone();
        top.unsafeData.prodStockMax =prodStockMax.clone();
        top.unsafeData.prodGrowTime =prodGrowTime.clone();
        top.unsafeData.prodPlantSize=prodPlantSize.clone();
        top.unsafeData.prodPoints   =prodPoints.clone();
        top.unsafeData.prodId       =prodId.clone();
        top.unsafeData.gut          =gut.clone();
        top.unsafeData.preisBeob    =explode(GM_getValue(COUNTRY+"_"+SERVER+"_preisBeob"),"publishProductData/preisBeob",[]).clone();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle);}
    }catch(err){ GM_logError("publishProductData","","",err); }
    },0);
}
function saveProductData(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","saveProductData"); }
        GM_setValue(COUNTRY+"_"+SERVER+"_prodName",implode(prodName,"saveProductData/prodName"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodNameSort",implode(prodNameSort,"saveProductData/prodNameSort"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodId",implode(prodId,"saveProductData/prodId"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodPoints",implode(prodPoints,"saveProductData/prodPoints"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodPlantSize",implode(prodPlantSize,"saveProductData/prodPlantSize"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"saveProductData/prodStock"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStockMax",implode(prodStockMax,"saveProductData/prodStockMax"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodYield",implode(prodYield,"saveProductData/prodYield"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodRequire",implode(prodRequire,"saveProductData/prodRequire"));
        GM_setValue(COUNTRY+"_"+SERVER+"_prodTyp",implode(prodTyp,"saveProductData/prodTyp"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodGrowTime",implode(prodGrowTime,"saveProductData/prodGrowTime"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodBlock",implode(prodBlock,"saveProductData/prodBlock"));
        GM_setValue(COUNTRY+"_"+SERVER+"_gut",implode(gut,"saveProductData/gut"));
        GM_setValue(COUNTRY+"_"+SERVER+"_gutBeob",implode(gutBeob,"saveProductData/gutBeob"));
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("saveProductData","","",err); }
}
var gameLocation=new function(){
    var data=[null,null];
    this.set=function(main,sub){
        try{
            if(!sub){ sub=null; }
            data=[main,sub];
        }catch(err){GM_logError("gameLocation.set","main="+main+" sub="+sub,"",err);}
    }
    this.get=function(){
        try{
            return data;
        }catch(err){GM_logError("gameLocation.get","","",err);}
    }
    this.check=function(main,sub){
        try{
            return ((!main)||(main==data[0]))&&((!sub)||(sub==data[1]));
        }catch(err){GM_logError("gameLocation.check","main="+main+" sub="+sub,"",err);}
    }
};
unsafeData.gameLocation=gameLocation;
/*
function checkRequest(request){
    if((request.readyState==4)&&(request.status==200)){
        var response=request.responseText;
        if(response!=0){
            var result=eval('('+response+')');
            if(result[0]!=0){
                return result;
            }
        }
    }
    return null;
}
*/
// function for validation of AJAX-response. taken from game and shrunk on return value
function checkRequest(request, mode) {
try{
    if (request.readyState == 4 && request.status == 200) {
        var response = request.responseText;
        if ((response!="failed") && (response!="maintenance") && (response!=0)) {
            var result = eval("(" + response + ")");
            if (result.datablock) {
                return result.datablock;
            } else {
                return result;
            }
        }
    }
    return 0;
}catch(err){
    GM_logError("checkRequest","","",err);
    return null;
}
}
function showMultiframePage(page){
try{
//GM_log("showMultiframePage:"+page);
    top.window.wrappedJSObject.gclr();
    top.window.wrappedJSObject.clr();
    var i=0,help;
    while (help=$top("kunde"+(i++))){ help.style.display="none"; }
    closeInfoPanel();
    if(help=$top("einkaufszettel")){ help.style.display="none"; }
    if(help=$top("popup_garden")){ help.style.display="block"; }
    if(help=$top("multiframe")){ help.style.display="block"; }
    if(help=$top("multiframe")){ help.src=page; }
}catch(err){GM_logError("showMultiframePage","page="+page,"",err);}
}
function showShopframePage(page){
    var cell=$top("shop");
    if(cell){
        if (top.window.wrappedJSObject.city!=1){
            top.document.addEventListener("gameCity1",function(){
                GM_logInfo("showShopframePage","page="+page,"","Arrived in city 1");
                top.document.removeEventListener("gameCity1",arguments.callee,false);
                showShopframePage(page);
            },false);
            click($top("speedlink_city1"));
        }else if (cell.style.display!="block"){
            cell.style.display="block";
            cell.style.visibility="visible";
            cell=$top("transp3");
            cell.style.display="block";
            cell.style.visibility="visible";
            showShopframePage(page);
        }else{
            $top("travel2city").style.display="none";
            $top("shopframe").src=page;
        }
        //closeInfoPanel();
    }else{
        location.href=page;
    }
    cell=null;
}
function showMessage(from,page,msg){
//GM_log("showMessage:"+from+":"+page+":"+msg);
    //click($top("menueimg1"));
    showMultiframePage("http://s"+SERVER+"."+GAMEPAGES[COUNTRY]+"/nachrichten/read.php?from="+from+"&page="+page+"&msg="+msg+"&mass=0");
}
function showSeedVendor(productId){
    try{
        if(!gameLocation.check("city",1)){
            top.document.addEventListener("gameCity1",function(productId){
                return function(){
                    top.document.removeEventListener("gameCity1",arguments.callee,false);
                    window.setTimeout(showSeedVendor,100,productId);
                }
            }(productId),false);
            GM_logInfo("showSeedVendor","productId="+productId,"",getText("goToX").replace(/%1%/,unsafeWindow.cityname1));
            click($top("speedlink_city1"));
        }else if(undefined===productId){
            GM_logInfo("showSeedVendor","productId="+productId,"",getText("goToX").replace(/%1%/,getText("seedVendor")));
            unsafeWindow.shopAction("shopinit",1);
        }else{
            GM_logInfo("showSeedVendor","productId="+productId,"",getText("goToX").replace(/%1%/,getText("seedVendor")));
            unsafeWindow.shopAction("shopinit",1,productId);
        }
    }catch(err){ GM_logError("showSeedVendor","productId="+productId,"",err); }
}
function showLottery(){
    var div=$top("speedlink_city2");
    if(div&&($top("lotterycontainer"))){
        top.document.addEventListener("gameCity2",function(){
            click($top("cityzone_2_8"));
            top.document.removeEventListener("gameCity2",arguments.callee,false);
        },false);
        click(div);
    }
    div=null;
}

// 22102016
function goToAnimalBreedingReady(){
    try{
        var div;
        if(gameLocation.check("farmersmarket",0)){
            if(div=$("farmersmarket_pos4_click")){
                click(div);
            }
        }else if(div=$("speedlink_farmersmarket")){
            document.addEventListener("gameFarmersmarketOpened",function(){
                document.removeEventListener("gameFarmersmarketOpened",arguments.callee,false);
                window.setTimeout(goToAnimalBreedingReady,100);
            },false);
            click(div);
        }
        div=null;
    }catch(err){GM_logError("goToAnimalBreedingReady","","",err);}
}

function goToMonsterFruitCultureReady(){
    try{
        var div;
        if(gameLocation.check("farmersmarket",0)){
            if(div=$("farmersmarket_pos3_click")){
                click(div);
            }
        }else if(div=$("speedlink_farmersmarket")){
            document.addEventListener("gameFarmersmarketOpened",function(){
                document.removeEventListener("gameFarmersmarketOpened",arguments.callee,false);
                window.setTimeout(goToMonsterFruitCultureReady,100);
            },false);
            click(div);
        }
        div=null;
    }catch(err){GM_logError("goToMonsterFruitCultureReady","","",err);}
}

function goToSpeedEatingReady(){
    try{
        var div;
        if(gameLocation.check("farmersmarket",0)){
            if(div=$("farmersmarket_pos6_click")){
                click(div);
            }
        }else if(div=$("speedlink_farmersmarket")){
            document.addEventListener("gameFarmersmarketOpened",function(){
                document.removeEventListener("gameFarmersmarketOpened",arguments.callee,false);
                window.setTimeout(goToSpeedEatingReady,100);
            },false);
            click(div);
        }
        div=null;
    }catch(err){GM_logError("goToSpeedEatingReady","","",err);}
}

function goToBuyPetsParts(){
    try{
        var div=$("pets_parts");
        var listeningEvent=null;
        if(div&&(div=div.querySelector(".buy"))) {
            click(div);
        } else if(!(gameLocation.check("farm",0)) && (div=$("speedlink_farm1"))){
            document.addEventListener("gameFarmOpened",function(){
                document.removeEventListener("gameFarmOpened",arguments.callee,false);
                action=function(){ click($("pets_parts_link")); }
                listeningEvent="gamegoToBuyPetsParts";
            },false);
            listeningEvent="gameFarmOpened";
            action=function(){ click(div); };
        } else {
            action=function(){ click($("pets_parts_link")); }
            listeningEvent="gamegoToOpenPetsParts";
        }

        if(listeningEvent){
            document.addEventListener(listeningEvent,function(listeningEvent){
                return function(){
                    document.removeEventListener(listeningEvent,arguments.callee,false);
                    window.setTimeout(function(){ goToBuyPetsParts(); },300);
                };
            }(listeningEvent),false);
        }
        if(action){ action(); }

        listeningEvent=null;action=null;div=null;
    }catch(err){GM_logError("goToBuyPetsParts","","",err);}
}

function goToDonkey(){
try{
    var div;
    if(gameLocation.check("farm",0)){
        if(div=$("farm_inner_waltraud")){
            click(div);
        }
    }else if(div=$("speedlink_farm1")){
        document.addEventListener("gameFarmOpened",function(){
            document.removeEventListener("gameFarmOpened",arguments.callee,false);
            window.setTimeout(goToDonkey,100);
        },false);
        click(div);
    }
    div=null;
}catch(err){GM_logError("goToDonkey","","",err);}
}
function goToClothingDonation(){
    try{
        var div=$top("speedlink_city2");
        if (div && $top("clothingdonation_link")) {
            top.document.addEventListener("gameCity2",function(){
                click($top("clothingdonation_link_2"));
                top.document.removeEventListener("gameCity2",arguments.callee,false);
            },false);
            click(div);
        }
        div=null;
    } catch(err) {GM_logError("goToClothingDonation","","",err); }
}
function goToVet(){
try{
    var div;
    if(gameLocation.check("farmersmarket",0)){
        if(div=$("farmersmarket_pos5_click")){
            click(div);
        }
    }else if(div=$("speedlink_farmersmarket")){
        document.addEventListener("gameFarmersmarketOpened",function(){
            document.removeEventListener("gameFarmersmarketOpened",arguments.callee,false);
            window.setTimeout(goToVet,100);
        },false);
        click(div);
    }
    div=null;
}catch(err){GM_logError("goToVet","","",err);}
}
function showGoToMarketToolTip(event,prod,add1,add2){
    var str='<table>';
    str += '<tr><th colspan="2" class="lightBg">'+getText("goToMarketOfX").replace(/%1%/,prodName[0][prod])+'</th></tr>';
    if(add1){
        str += add1;
        str += '<tr><td colspan="2" style="border-bottom:1px solid black;"></td></tr>';
    }
    str += '<tr><td>'+getText("marketPrice")+'</td><td style="text-align:right;">'+(gut[prod]>=100?moneyFormatInt(gut[prod]):moneyFormat(gut[prod]))+'</td></tr>';
    str += '<tr><td>'+getText("inventory")+'</td><td style="text-align:right;">'+numberFormat(prodStock[0][prod])+'</td></tr>';
    str += '<tr><td>'+getText("value")+'</td><td style="text-align:right;">'+moneyFormatInt(gut[prod]*prodStock[0][prod])+'</td></tr>';
    if(add2){
        str += '<tr><td colspan="2" style="border-bottom:1px solid black;"></td></tr>';
        str += add2;
    }
    str += '</table>';
    toolTip.show(event,str);
    str=null;
}
function showStatisticFullscreen(pid){
    var mode=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeStatistic"),"showStatisticFullscreen/modeStatistic");
    var newdiv=createElement("div",{"style":"position:absolute;top:0;left:0;height:"+window.innerHeight+"px;width:"+window.innerWidth+"px;background-color:white;color:black;z-index:995;"},ALL,getText("loading")+"...");
    var url=STAT_VIEW[COUNTRY]+"/chart.php?w="+window.innerWidth+"&h="+window.innerHeight+"&t=h"+mode["time"]+"&shownpc="+(mode["npc"]?1:0)+"&clip=1&server1="+SERVER+"&product1="+pid+"&color1=green";
    var newobject=createElement("object",{"data":url,"type":"type=image/svg+xml","style":"position:absolute;top:0;left:0;","width":window.innerWidth+"px","height":window.innerHeight+"px"},newdiv);
    createElement("param",{"name":"src","value":url},newobject);
    var newimg=createElement("img",{"src":GFX+"close.jpg","class":"link","style":"position:absolute;top:30px;right:10px;z-index:2;"},newdiv);
    newimg.addEventListener("click",function(){removeElement(this.parentNode);},false);
    newimg=createElement("div",{"style":"position:absolute;top:0px;left:40%;padding:5px;z-index:2;border-width:0px 2px 2px 2px;border-style:solid;border-radius:0px 0px 10px 10px;background-color:white;"},newdiv);
    produktPic(0,pid,newimg);
    createElement("span",{"style":"font-weight:bold;"},newimg,prodName[0][pid]);
    newdiv=null;newobject=null;newimg=null;
}

function calcProductionTime(buildingType,productType,productId,bonus,feedTime,feedAmount){
// bonus like 0.85
try{
    var time;
    switch(buildingType){
    case 1:
    case "forest":
        time=calcGrowDuration(prodGrowTime[productType][productId]*60,bonus);
        break;
    case 2:
        var totalTime=prodGrowTime[productType][productId]*60*bonus;
        time=totalTime;
        if(!feedAmount){
            feedAmount=Math.ceil(totalTime/feedTime);
        }
        totalTime*=0.5;
        if(unsafeWindow.premium==0 && USERLEVEL>9){ totalTime+=5; } // hack: non-premiums cant feed completely
        for(var i=1;i<=feedAmount;i++){
            if(time-feedTime>=totalTime){
                time-=feedTime;
            } else { break; }
        }
        totalTime=null;
        time=[time,i-1];
        break;
    case 3:
    case 4:
        time=prodGrowTime[productType][productId]*60*bonus;
        break;
    case "windmill":
        time=parseInt(unsafeWindow.formulas[0][productId][4],10);
        //time*=bonus;
        break;
    case "forest":
        time=calcGrowDuration(prodGrowTime[productType][productId]*60,bonus);
        break;
    case "sawmill":
    case "carpentry":
        time=prodGrowTime[productType][productId]*60*bonus;
        break;
    }
    return time;
}catch(err){
    GM_logError("calcProductionTime_Berater","product:"+[productType,productId]+" bonus="+bonus,"",err);
    return 0;
}
}
function calcGrowDuration(growDurationInitial,bonus){
//growDurationInitial in seconds, bonus like 0.85
    var gesamtdauer=0;
    while(growDurationInitial>0){
        growDurationInitial *= bonus;
        var help=Math.min(growDurationInitial,86400);
        growDurationInitial -= help;
        gesamtdauer += help;
    }
    return Math.round(gesamtdauer);
}
function calcGrowTimes(growDurationInitial,period,bonus){
    return period/calcGrowDuration(growDurationInitial,bonus);
}

// Zones
var zones=new function(){
    var data, totalCrop=null, cropByTime=null;
    const INIT_zoneItem={"animals":null,"block":"blpqs","bonus":0,"bonusSpecial":null,"building":null,"crop":[],"endproduct":null,"endtime":NEVER,"mainproduct":null,"production":[[{},{}],0,0,true],"slots":null,"watertime":NEVER};
    const INIT_zoneSlotItem={"block":"blpqs"};
    this.init=function(){
        try{
            data=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones","{}"),"zones.init/data",{});
            var zoneNrF, slot, building;
            for(var zoneNr in data){
                if(!data.hasOwnProperty(zoneNr)){ continue; }
                // Wrong format
                if((typeof data[zoneNr]!="object")||(data[zoneNr] instanceof Array)){
                    delete data[zoneNr];
                    continue;
                }
                if(zoneNr.match(/\.(\d+)$/)){
                    // Slot
                    slot=parseInt(/\.(\d+)$/.exec(zoneNr)[1],10);
                    zoneNrF=zoneNr.replace(/\.\d+$/g,"");
                    // Slot not defined in record of zone
                    if((!data[zoneNrF])||(!data[zoneNrF]["slots"])||(!data[zoneNrF]["slots"][slot])){
                        delete data[zoneNr];
                        continue;
                    }
                }else{
                    // Zone
                    zoneNrF=zoneNr;
                    building=data[zoneNrF]["building"];
                    if(BUILDING_SLOTS[building]){
                        for(var i=BUILDING_SLOTS[building];i>=1;i--){
                            if (data[zoneNrF]["slots"] == null) {
                                data[zoneNrF]["slots"] = [];
                            }
                            if(undefined===data[zoneNrF]["slots"][i]){
                                // Slot not defined in record of zone
                                data[zoneNrF]["slots"][i]=INIT_zoneSlotItem.clone();
                            }
                        }
                        if(data[zoneNrF]["slots"] && data[zoneNrF]["slots"].length>1+BUILDING_SLOTS[building]){
                            // Too many slots defined in record of zone
                            data[zoneNrF]["slots"].splice(1+BUILDING_SLOTS[building],data[zoneNrF]["slots"].length-BUILDING_SLOTS[building]-1);
                        }
                    }else if(null!=data[zoneNrF]["slots"]){
                        // Slots defined in record of zone without slots
                        data[zoneNrF]["slots"]=null;
                    }
                }
            }
            totalEndtime=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_totalEndtime",-1);
            }catch(err){GM_logError("zones.init","","zoneNrF="+zoneNrF+",i="+i+",zoneNr="+zoneNr,err);}
    }
    this.save=function(){
        try{
            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones",implode(data,"zones.save/data"));
        }catch(err){GM_logError("zones.save","","",err);}
    }

    this.delete=function(zoneNr){
        try{
            if(data[zoneNr]){
                delete data[zoneNr];
                zones.save();
                return true;
            } else {
                return false;
            }
            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones",implode(data,"zones.delete/data"));
        }catch(err){GM_logError("zones.delete","","",err);}
    }

    this.create=function(zoneNrF){
        try{
            data[zoneNrF]=INIT_zoneItem.clone();
            if(isNaN(zoneNrF)){
                var building;
                switch(zoneNrF){
                case "farmersmarket-0": building="fl0";break;
                case "farmersmarket-1": building="fl1";break;
                case "farmersmarket-2": building="fl2";break;
                case "farmersmarket-3": building="fl3";break;
                case "farmersmarket-4": building="fl4";break;
                case "farmersmarket-5": building="fl5";break;
                case "farmersmarket-6": building="fl6";break;
                case "farmersmarket-7": building="fl7";break;
                case "farmersmarket-8": building="fl8";break;
                case "farmersmarket-9": building="fl9";break;
                case "farmersmarket-11": building="fl11";break;
                case "windmill":        building="windmill";break;
                case "forest":          building="forest";break;
                case "sawmill":         building="sawmill";break;
                case "carpentry":       building="carpentry";break;
                case "foodworld-0":     building="fw0";break;
                case "foodworld-1":     building="fw1";break;
                case "foodworld-2":     building="fw2";break;
                case "foodworld-3":     building="fw3";break;
                case "foodworld-4":     building="fw4";break;
                case "megafield":       building="megafield";break;
                case "map_stall0":      building="m0";break;
                case "map_stall1":      building="m1";break;
                case "map_stall2":      building="m2";break;
                default:                building=null;
                }
                zones.setBuilding(zoneNrF,building);
            }
        }catch(err){GM_logError("zones.create","","",err);}
    }
    this.swap=function(zoneNr1,zoneNr2){
    // TODO: swap belonging slots
        try{
            if(data[zoneNr1]&&data[zoneNr1]){
                var help=data[zoneNr1].clone();
                data[zoneNr1]=data[zoneNr2].clone();
                data[zoneNr2]=help;
            }
        }catch(err){GM_logError("zones.swap","","",err);}
    }
    // Values
    this.setAnimals=function(zoneNrF,value){
        try{
            if(!data[zoneNrF]){
                zones.create(zoneNrF);
            }
            if(data[zoneNrF]["animals"]!=value){
                data[zoneNrF]["animals"]=value;
                zones.save();
                calcTotalAnimals();
            }
        }catch(err){GM_logError("zones.setAnimals","","",err);}
    }
    this.getAnimals=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(data[zoneNrF]){
                return data[zoneNrF]["animals"];
            }else{
                return INIT_zoneItem["animals"];
            }
        }catch(err){GM_logError("zones.getAnimals","","",err);}
    }
    this.getData=function(zoneNrS) {
        return data[zoneNrS];
    }
    this.setBlock=function(zoneNr,value){
        // b: payment
        // l: level requirement
        // p: premium-feature
        // q: quest
        // s: status
        // t: type (not handled)
        try{
            zoneNr=zoneNr.toString();
            var slot=(zoneNr.match(/\.(\d+)$/)?parseInt(/\.(\d+)$/.exec(zoneNr)[1],10):null);
            var zoneNrF=zoneNr.replace(/\.\d+$/g,"");
            if(!data[zoneNrF]){
                zones.create(zoneNrF);
            }
            if(slot){
                if (!data[zoneNrF]["slots"]) {
                    data[zoneNrF]["slots"] = [];
                }
                if(undefined===data[zoneNrF]["slots"][slot]){
                    data[zoneNrF]["slots"][slot]=INIT_zoneSlotItem.clone();
                }
                if(data[zoneNrF]["slots"][slot]["block"]!=value){
                    data[zoneNrF]["slots"][slot]["block"]=value;
                    if(data[zoneNr]){
                        data[zoneNr]["block"]=value;
                    }
                    zones.save();
                }
            }else if(data[zoneNrF]["block"]!=value){
                data[zoneNrF]["block"]=value;
                zones.save();
            }
        }catch(err){GM_logError("zones.setBlock","zoneNr="+zoneNr+" value="+value,"data['"+zoneNrF+"']="+implode(data[zoneNrF],"zones.setBlock/data"),err);}
    }
    this.getBlock=function(zoneNr){
        try{
            zoneNr=zoneNr.toString();
            var slot=(zoneNr.match(/\.(\d+)$/)?parseInt(/\.(\d+)$/.exec(zoneNr)[1],10):null);
            var zoneNrF=zoneNr.replace(/\.\d+$/g,"");
            if(!data[zoneNrF]){
                return INIT_zoneItem["block"];
            }else if(data[zoneNrF]["block"]){
                return data[zoneNrF]["block"];
            }else if(slot&&data[zoneNrF]["slots"]){
                return data[zoneNrF]["slots"][slot]["block"];
            }else{
                return "";
            }
        }catch(err){GM_logError("zones.getBlock","zoneNr="+zoneNr,"",err);}
    }
    this.setBonus=function(zoneNrF,value){
        try{
            if(!data[zoneNrF]){
                zones.create(zoneNrF);
            }
            if(data[zoneNrF]["bonus"]!=value){
                data[zoneNrF]["bonus"]=value;
                zones.save();
            }
        }catch(err){GM_logError("zones.setBonus","","",err);}
    }
    this.getBonus=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(data[zoneNrF]){
                return data[zoneNrF]["bonus"];
            }else{
                return INIT_zoneItem["bonus"];
            }
        }catch(err){GM_logError("zones.getBonus","","",err);}
    }
    this.setBonusSpecial=function(zoneNrF,value){
        try{
            if(!data[zoneNrF]){
                zones.create(zoneNrF);
            }
            if(data[zoneNrF]["bonusSpecial"]==null){
                if(value!=null){
                    data[zoneNrF]["bonusSpecial"]=value;
                    zones.save();
                }
            }else if((value==null)||(data[zoneNrF]["bonusSpecial"][0]!=value[0])||(data[zoneNrF]["bonusSpecial"][1]!=value[1])){
                data[zoneNrF]["bonusSpecial"]=value;
                zones.save();
            }
        }catch(err){GM_logError("zones.setBonusSpecial","","",err);}
    }
    this.getBonusSpecial=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(data[zoneNrF]){
                return data[zoneNrF]["bonusSpecial"];
            }else{
                return INIT_zoneItem["bonusSpecial"];
            }
        }catch(err){GM_logError("zones.getBonusSpecial","","",err);}
    }
    this.setBuilding=function(zoneNrF,value){
        /*  BUILDING    NAME                    TYPE
            0           empty
            1           Field                   Field
            2           Chickens                Stable
            3           Cows                    Stable
            4           Sheep                   Stable
            5           Bees                    Stable
            6           Clubhouse
            7           Cheese                  Factory
            8           Mayo                    Factory
            9           Whool                   Factory
            10          Bonbons                 Factory
            11          Fishs                   Stable
            12          Goats                   Stable
            13          Oil                     Factory
            14          Special-Oil             Factory
            15          Angora shed             Stable
            16          Knitting mill           Factory
            17          Architectural office
            18          Pony farm               Factory
            19          Megafield               Factory
            20          Fuelstation             Factory
            23          Sushibar
            fw1         Soda stall              Foodworld
            fw2         Snack booth             Foodworld
            fw3         Pastry shop             Foodworld
            fw4         ice cream parlor        Foodworld
            fl1         Flower meadow           Farmersmarket
            fl2         Flower workshop         Farmersmarket
            fl3         Monster fruit culture   Farmersmarket
            fl4         Animal breeding         Farmersmarket
            fl5         Veterinary              Farmersmarket
            fl6         Speed eating            Farmersmarket
            fl7         Butterfly               Farmersmarket
            fl8         cowracing               Farmersmarket
            fl9         fishing                 Farmersmarket
            fl11        scouts                 Farmersmarket
            m1          map_stall1              Map
            m2          map_stall2              Map
        */
        try{
            if(!data[zoneNrF]){
                zones.create(zoneNrF);
            }
            if(data[zoneNrF]["building"]!=value){
                data[zoneNrF]["building"]=value;
                if(BUILDING_SLOTS[value]){
                    data[zoneNrF]["slots"]=[];
                    for(var i=BUILDING_SLOTS[value];i>=1;i--){
                        data[zoneNrF]["slots"][i]=INIT_zoneSlotItem.clone();
                    }
                }else{
                    data[zoneNrF]["slots"]=null;
                }
                zones.save();
            }
        }catch(err){GM_logError("zones.setBuilding","zoneNrF="+zoneNrF+" value="+value,"",err);}
    }
    this.getBuilding=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(data[zoneNrF]){
                return data[zoneNrF]["building"];
            }else{
                return INIT_zoneItem["building"];
            }
        }catch(err){GM_logError("zones.getBuilding","zoneNr="+zoneNr,"",err);}
    }
    this.getBuildingName=function(zoneNr){
        try{
            return getBuildingName(zones.getBuilding(zoneNr));
        }catch(err){GM_logError("zones.getBuildingName","zoneNr="+zoneNr,"",err);}
    }
    this.getLocation=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(DATA_zones[zoneNrF]){
                return DATA_zones[zoneNrF];
            }else{
                GM_logWarning("getLocation","zoneNr="+zoneNr,"","Function returns null.");
                return null;
            }
        }catch(err){
            GM_logError("getLocation","zoneNr="+zoneNr,"",err);
            return null;
        }
    }
    this.getName=function(zoneNr){
        try{
            var currLocation=zones.getLocation(zoneNr);
            if("farm"==currLocation.location){
                return getText("farm")+" "+(1+currLocation.farmNr)+"."+currLocation.zoneNr;
            }else{
                return zones.getBuildingName(zoneNr);
            }
        }catch(err){GM_logError("zones.getName","zoneNr="+zoneNr,"",err);}
    }
    // Production
    this.setProduction=function(zoneNrS,value,noFollowing){
        // production[0][i]={"id":item,...}
        // i = product-type
        // case production : item=[[amount,points,endtime,nextwatertime],...]
        // - amount : amount of production with these times
        // - points : points given for this production
        // - endtime : time of cropping (without future waterings)
        // - nextwatertime : NEVER if not possible to water in future
        // case deco : item=[[amount1,time1],[amount2,time2],...]
        // case garbage : item=amount
        // production[1]=[,int,int,,int]||int : free places for currently planting with that size
        // production[2]=[,int,int,,int]||int : free places for possibly planting with that size (cropped field)
        // production[3]=true||false : flag if data is ready
        try{
            if(!data[zoneNrS]){
                zones.create(zoneNrS);
            }
            if(!data[zoneNrS]["production"].equals(value)){
                data[zoneNrS]["production"]=value;
                totalCrop=null;
                cropByTime=null;
                zones.processProduction(zoneNrS,noFollowing);
            }
        }catch(err){GM_logError("zones.setProduction","zoneNrS="+zoneNrS+" value="+value,"",err);}
    }
    this.getProduction=function(zoneNrS){
        try{
            if(data[zoneNrS]){
                return data[zoneNrS]["production"];
            }else{
                return INIT_zoneItem["production"];
            }
        }catch(err){GM_logError("zones.getProduction","zoneNrS="+zoneNrS,"",err);}
    }
    this.processProduction = function(zoneNrS, noFollowing) {
          try {
            if (DEVMODE_FUNCTION) {
              var trackingHandle = tracking.start("berater", "zones.processProduction", [zoneNrS]);
            }
            var err_trace = "begin";
            var zoneNrF = zoneNrS.toString().replace(/\.\d+$/g, "");
            var help;
            data[zoneNrS]["crop"] = new Array();
            data[zoneNrS]["endtime"] = NEVER;
            data[zoneNrS]["endproduct"] = null;
            data[zoneNrS]["watertime"] = NEVER;
            data[zoneNrS]["mainproduct"] = null;
            if (!zones.getBlock(zoneNrS)) {
              var currLocation = zones.getLocation(zoneNrS).location;
              var currBonus = zones.getBonus(zoneNrS);
              var currBonusSpecial = zones.getBonusSpecial(zoneNrS);
              var zoneErnteCurr = new Object();
              var iZoneTyp = zones.getBuilding(zoneNrS);
              var isProductional = zones.isProductional(zoneNrS);
              var nowServer = unsafeWindow.Zeit.Server;
              var c = 0, item;
              err_trace = "product loop";
              for (var iType = 0; iType < data[zoneNrS]["production"][0].length; iType++) {
                for (var iProdStr in data[zoneNrS]["production"][0][iType]) {
                  if (!data[zoneNrS]["production"][0][iType].hasOwnProperty(iProdStr)) {
                    continue; }
                  var iProd = parseInt(iProdStr, 10);
                  if ((prodTyp[iType][iProd] != "u") && (prodTyp[iType][iProd] != "z")) { // only products
                    item = data[zoneNrS]["production"][0][iType][iProdStr];
                    for (var i = 0; i < item.length; i++) {
                      var z = item[i][2];
                      var w = item[i][3];
                      if (data[zoneNrS]["mainproduct"] == iProd) { c += item[i][0]; } else { c -= item[i][0]; }
                      if (c < 1) {
                        data[zoneNrS]["mainproduct"] = iProd;
                        c = item[i][0];
                      }
                      if (!zoneErnteCurr[iType]) { zoneErnteCurr[iType] = {}; }
                      if (!zoneErnteCurr[iType][iProdStr]) { zoneErnteCurr[iType][iProdStr] = [0, 0]; }
                      zoneErnteCurr[iType][iProdStr][0] += item[i][0];
                      zoneErnteCurr[iType][iProdStr][1] += item[i][1];
                      if (w) {
                        data[zoneNrS]["watertime"] = Math.min(data[zoneNrS]["watertime"], w);
                        if (valAssumeWater[currLocation] && (nowServer <= z) && (w <= z)) {
                          // calculate future watering
                          // w<nowServer means that now can be watered. because it isnt watered, assume that watering is not wanted
                          // if (nowServer<=w){
                          w = Math.max(0, Math.min(86400, w - nowServer)); // time till watering
                          z -= nowServer; // remaining time
                          z = nowServer + w + calcGrowDuration(z - w, (100 - currBonus - ((currBonusSpecial && (iProd == currBonusSpecial[0])) ? currBonusSpecial[1] : 0)) / 100);
                        }
                      }

                      if (z < data[zoneNrS]["endtime"]) {
                        data[zoneNrS]["endtime"] = z;
                        data[zoneNrS]["endproduct"] = [iType, iProd];
                      }
                    }
                  }
                }
              }
              if (isProductional) {
                for (var iTypeStr in zoneErnteCurr) {
                  if (!zoneErnteCurr.hasOwnProperty(iTypeStr)) {
                    continue; }
                  for (var iProdStr in zoneErnteCurr[iTypeStr]) {
                    if (!zoneErnteCurr[iTypeStr].hasOwnProperty(iProdStr)) {
                      continue; }
                    if (iTypeStr == "0") {
                      // zoneErnteCurr[iTypeStr][iProdStr][0] /= 10; // Fix Seberoth ... why ... TODO!
                    }
                    data[zoneNrS]["crop"].push([parseInt(iTypeStr, 10), parseInt(iProdStr, 10)].concat(zoneErnteCurr[iTypeStr][iProdStr]));
                  }
                }
              }
              // too many empty fields
              err_trace = "empty fields";
              if (now < data[zoneNrS]["endtime"]) {
                if (!isNaN(valLimitEmptyFields[iZoneTyp])) {
                  help = (typeof data[zoneNrS]["production"][1] == "object" ? data[zoneNrS]["production"][1][1] : data[zoneNrS]["production"][1]);
                  if (help > valLimitEmptyFields[iZoneTyp]) {
                    data[zoneNrS]["endtime"] = NEVER;
                    data[zoneNrS]["endproduct"] = null;
                  }
                } else if (iZoneTyp == "megafield") {
                  help = (typeof data[zoneNrS]["production"][1] == "object" ? data[zoneNrS]["production"][1][1] : data[zoneNrS]["production"][1]);
                  if (help > 0) {
                    if (megafieldJob) {
                      for (var prod in megafieldJob.products) {
                        if (!megafieldJob.products.hasOwnProperty(prod)) {
                          continue; }
                        if (megafieldJob.products[prod].have + megafieldJob.products[prod].growing < megafieldJob.products[prod].need) {
                          data[zoneNrS]["endtime"] = NEVER;
                          data[zoneNrS]["endproduct"] = null;
                        }
                      }
                    }
                  }
                } else if (valGlobaltimeShowCroppedZone[currLocation]) {
                  help = (typeof data[zoneNrS]["production"][1] == "object" ? data[zoneNrS]["production"][1][1] : data[zoneNrS]["production"][1]);
                  if (help > 0) {
                    data[zoneNrS]["endtime"] = NEVER;
                    data[zoneNrS]["endproduct"] = null;
                  }
                }
              }
              // create watering timer
              if (iZoneTyp == 1) {
                var farmNR = Math.floor((zoneNrF - 1) / 6) + 1;
                var zoneNr = zoneNrF - 6 * (farmNR - 1);
                createZoneTimer("zoneTimerWater_" + zoneNrS, zoneNrS, "zoneTimerWater", "top:20px;left:5px;", $("farm" + farmNR + "_pos" + zoneNr));
              }
            }
            err_trace = "timer";
            updateZoneTimer("zoneTimer_" + zoneNrS, zoneNrS, "zonetimer");
            updateZoneTimer("zoneTimerWater_" + zoneNrS, zoneNrS, "zoneTimerWater");
            updateZoneTimer("globalZoneTimer_" + zoneNrS, zoneNrS, "zonetimer");
            updateZoneTimer("globalZoneTimerWater_" + zoneNrS, zoneNrS, "zoneTimerWater");
            if (!noFollowing) {
              err_trace = "readyZone";
              zones.checkReady(zoneNrS);
              calcTotalEndtime();
              zones.save();
            }
            if (DEVMODE_FUNCTION) { tracking.end("berater", trackingHandle); }
          } catch (err) { GM_logError("zones.processProduction", "zoneNrS=" + zoneNrS, "err_trace=" + err_trace + " iProdStr=" + iProdStr, err); }
}

    this.flagProduction=function(zoneNrS){
        try{
            if(!data[zoneNrS]){
                zones.create(zoneNrS);
            }
            data[zoneNrS]["production"][3]=false;
        }catch(err){GM_logError("zones.flagProduction","","",err);}
    }
    this.getEndproduct=function(zoneNr){
        try{
            if(data[zoneNr]&&data[zoneNr]["endproduct"]){
                return data[zoneNr]["endproduct"];
            }else{
                return INIT_zoneItem["endproduct"];
            }
        }catch(err){GM_logError("zones.getEndproduct","","",err);}
    }
    this.getEndtime=function(zoneNr){
        try{
            if(data[zoneNr]&&data[zoneNr]["endtime"]){
                return data[zoneNr]["endtime"];
            }else{
                return INIT_zoneItem["endtime"];
            }
        }catch(err){GM_logError("zones.getEndtime","","",err);}
    }
    //Fix Linus--Tux function hinzugefügt
    this.setEndtime=function(zoneNr,endtime){
        try{
            if(data[zoneNr]&&data[zoneNr]["endtime"]){
                data[zoneNr]["endtime"]=endtime;
            }
        }catch(err){GM_logError("zones.getEndtime","","",err);}
    }
    this.getWatertime=function(zoneNr){
        try{
            if(data[zoneNr]&&data[zoneNr]["watertime"]){
                return data[zoneNr]["watertime"];
            }else{
                return INIT_zoneItem["watertime"];
            }
        }catch(err){GM_logError("zones.getWatertime","","",err);}
    }
    this.getCrop=function(zoneNr){
    // return: [[prodType1,prodId1,amount1,points1],[prodType2,prodId2,amount2,points2],...]
        try{
            if(data[zoneNr]&&data[zoneNr]["crop"]){
                return data[zoneNr]["crop"];
            }else{
                return INIT_zoneItem["crop"];
            }
        }catch(err){GM_logError("zones.getCrop","","",err);}
    }
    this.getMainproduct=function(zoneNr){
        try{
            if(data[zoneNr]&&data[zoneNr]["mainproduct"]){
                return data[zoneNr]["mainproduct"];
            }else{
                return INIT_zoneItem["mainproduct"];
            }
        }catch(err){GM_logError("zones.getMainproduct","","",err);}
    }
    this.checkReady = function(zoneNrS) {
    try {
        var readyZoneAdded = 0;
        if ((!zoneNrS.toString().match("megafield\.\d+")) && (!zones.getBlock(zoneNrS)) && (zones.isProductional(zoneNrS))) {
            var zoneNrF = zoneNrS.toString().replace(/\.\d+$/g, "");
            var farmNR = Math.floor((zoneNrF - 1) / 6) + 1;
            var zoneNr = zoneNrF - 6 * (farmNR - 1);
            var currZoneType = zones.getBuilding(zoneNrF);
            var currLocation = zones.getLocation(zoneNrF);
            var zT = zones.getEndtime(zoneNrS);
            var zTw = zones.getWatertime(zoneNrS);
            var div;
            /*
             * The following code block handles smart setting of the megafield time(s)
             *  - Running tour => Mark megafield ready after tour
             *  - No more planting needed/possible/wise => Mark megafield ready when next plant is ready. If field is empty => when job has timed out
             *  - Else (no running tour, but more planting needed&possible): Do nothing
             */
            if (megafieldSmartTimer && zoneNrF == "megafield" && unsafeWindow.megafield_data) {
                var toHarvestInCurrentTour = 0; // Amount of fields, that the machine still has to harvest
                if (unsafeWindow.megafield_data.tour && unsafeWindow.megafield_data.tour.steps) {
                    // Iterate over all steps (completed and to do ones)
                    for (var i = 0; i < unsafeWindow.megafield_data.tour.steps.length; i++) {
                        // If the i-th step has attributes, it's not completed yet
                        if (Object.keys(unsafeWindow.megafield_data.tour.steps[i]).length > 0) {
                            toHarvestInCurrentTour += unsafeWindow.megafield_data.vehicle_slots[unsafeWindow.megafield_data.tour.vid].size; // Muss durch Vehicle-Größe ersetzt werden
                        }
                    }
                }
                var toPlantForCurrentJob = 0; // Amount of plants missing/not yet planted to finish the job. Leave out plants that won't finish in time (-5min).
                if (unsafeWindow.megafield_data.job && unsafeWindow.megafield_data.job.products) {
                    // Iterate over needed products for current job
                    for (var i = 0; i < unsafeWindow.megafield_data.job.products.length; i++) {
                        var product = unsafeWindow.megafield_data.job.products[i];
                        // If the product can be planted...
                        if (product.duration) { // Only check plants: Cheese/Milk/Honey/... don't have a duration
                            // Only count plants, that finish before the job runs out of time: NOW + GROWING TIME - (JOB START + 1 WEEK + 5 MIN)
                            if (0 > unsafeWindow.servertimetime + product.duration - (3600 * 24 * 7 + 300 + parseInt(unsafeWindow.megafield_data.job_start, 10))) {
                                // ... we add the total needed amount minus the amount we have minus the amount currently growing
                                toPlantForCurrentJob += product.need - product.have - product.growing;
                            }
                        }
                    }
                }
                var plantedCurrently = Object.keys(unsafeWindow.megafield_data.area).length; // Amount of planted fields
                var unlocked = Object.keys(unsafeWindow.megafield_data.area_free).length; // Amount unlocked fields
                if (toPlantForCurrentJob && (toHarvestInCurrentTour + plantedCurrently) < unlocked) {
                    // Do nothing. Bot should start planting.
                } else {
                    var readyFields = 0; // Amount of ready fields that could be started to be harvested right now
                    var nextReadyField; // Determines that field, which is ready next. Might be in the past or empty
                    for (var key in unsafeWindow.megafield_data.area) {
                        if (!unsafeWindow.megafield_data.area.hasOwnProperty(key)) { continue; }
                        var area = unsafeWindow.megafield_data.area[key];
                        if (area.remain <= 0) {
                            readyFields++;
                        }
                        if (!nextReadyField || nextReadyField.remain > area.remain) {
                            nextReadyField = area;
                        }
                    }
                    if (readyFields > 0 && !(unsafeWindow.megafield_data.tour && unsafeWindow.megafield_data.tour.remain > 0)) {
                        // Do nothing. Bot should start harvesting.
                    } else {
                        if (unsafeWindow.megafield_data.tour && unsafeWindow.megafield_data.tour.remain > 0) {
                            // Set time to end of the currently running tour.
                            zT = unsafeWindow.megafield_data.tour.duration + unsafeWindow.megafield_data.tour.start;
                            zones.setEndtime(zoneNrF, zT);
                        } else if (nextReadyField) {
                            // Set time to end of growth of next field
                            zT = nextReadyField.time + nextReadyField.duration;
                            zones.setEndtime(zoneNrF, zT);
                        } else {
                            // Set time to end of job
                            zT = 3600 * 24 * 7 + parseInt(unsafeWindow.megafield_data.job_start, 10);
                            zones.setEndtime(zoneNrF, zT);
                        }
                    }
                }
            }

            var slot=(zoneNrS.toString().match(/\.(\d+)$/)?parseInt(/\.(\d+)$/.exec(zoneNrS)[1],10):null);
            if (zoneNrS=="farmersmarket-6" && zT <= unsafeWindow.Zeit.Server) {
              zT = NEVER;
              zones.setEndtime(zoneNrS, zT);
            } else if(zoneNrF=="farmersmarket-3" && zT <= unsafeWindow.Zeit.Server) {
              zT = NEVER;
              zones.setEndtime(zoneNrS, zT);
            } else if (zoneNrF=="farmersmarket-8" && slot>4 && zT <= unsafeWindow.Zeit.Server) {
                zT = NEVER;
                if (zones.getEndtime(zoneNrF)!=NEVER) {
                    zones.setEndtime(zoneNrF, zT);
                }
                zones.setEndtime(zoneNrS, zT);
            }

            if (zT == NEVER) { // EMPTY
                if (unsafeData.readyZone[zoneNrS] && (unsafeData.readyZone[zoneNrS][1] == "e")) {
                    if (!unsafeData.readyZone[zoneNrS][2]) {
                        unsafeData.readyZone[zoneNrS][2] = true;
                    }
                } else {
                    GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Empty zone found", 0);
                    //GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Empty zone found"+zoneNrS+"   "+zoneNrF);
                    unsafeData.readyZone[zoneNrS] = [currLocation.farmNr === undefined ? currLocation.location : currLocation.farmNr, "e", true];
                    readyZoneAdded = 1;
                }
                if ((currZoneType == 1) && (div = $("farm_production_ready" + farmNR + "_" + zoneNr))) {
                    div.setAttribute("class", "farm_production_ready1 fieldReady");
                }
            } else if (zT <= unsafeWindow.Zeit.Server) { // READY
                if (unsafeData.readyZone[zoneNrS] && (unsafeData.readyZone[zoneNrS][1] == "r")) {
                    if (!unsafeData.readyZone[zoneNrS][2]) { unsafeData.readyZone[zoneNrS][2] = true; }
                } else {
                    GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Ready zone for cropping found", 0);
                    //GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Ready zone for cropping found"+zoneNrS+"   "+zoneNrF);
                    unsafeData.readyZone[zoneNrS] = [currLocation.farmNr === undefined ? currLocation.location : currLocation.farmNr, "r", true];
                    readyZoneAdded = 1;
                }
                if ((currZoneType == 1) && (div = $("farm_production_ready" + farmNR + "_" + zoneNr))) {
                    div.setAttribute("class", "farm_production_ready1 fieldReady");
                }
                // RUNNING (unsafeWindow.Zeit.Server < zT)
            } else if (valWaterNeeded[currLocation.location] && (zTw < unsafeWindow.Zeit.Server) && (zones.getBonus(zoneNrF) > 0)) {
                // zTw < zT removes the watertimer if ready later then the field timer
                if (unsafeData.readyZone[zoneNrS] && (unsafeData.readyZone[zoneNrS][1] == "w")) {
                    if (!unsafeData.readyZone[zoneNrS][2]) { unsafeData.readyZone[zoneNrS][2] = true; }
                } else {
                    GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Ready zone for watering found", 0);
                    unsafeData.readyZone[zoneNrS] = [currLocation.farmNr === undefined ? currLocation.location : currLocation.farmNr, "w", true];
                    readyZoneAdded = 1;
                }
                if ((currZoneType == 1) && (div = $("farm_production_ready" + farmNR + "_" + zoneNr))) {
                    div.setAttribute("class", "farm_production_ready1 fieldWaterReady blinking");
                }
            } else if (unsafeData.readyZone[zoneNrS]) {
                GM_logInfo("zones.checkReady", "zoneNrS=" + zoneNrS, "", "Zone not ready anymore", 0);
                delete unsafeData.readyZone[zoneNrS];
                if ((currZoneType == 1) && (div = $("farm_production_ready" + farmNR + "_" + zoneNr))) {
                    div.setAttribute("class", "farm_production_ready1");
                }
            }
            div = null;
            if (readyZoneAdded) {
                console.log("Found Ready Zone: " + zoneNrS);
            }
        }
        return readyZoneAdded;
    } catch (err) { GM_logError("zones.checkReady", "zoneNrS=" + zoneNrS, "", err); }
    }

    this.getTotalCrop=function(timeBegin,timeEnd){
        try{
            if((!timeBegin)&&(!timeEnd)&&totalCrop){
                return totalCrop.clone();
            }else if(cropByTime){
                var t1=timeBegin?timeBegin:0;
                var t2=timeEnd?timeEnd:NEVER;
                var production={}, zoneErnteCurr;
                var iType, sProd;
                if(t1<=t2){
                    for(var i=0,il=cropByTime.length;i<il;i++){
                        if(cropByTime[i][0]<t1){ continue; }
                        if(t2<cropByTime[i][0]){ break; }
                        iType=cropByTime[i][1];
                        sProd=cropByTime[i][2];
                        if(!production[iType]){ production[iType]={}; }
                        if(!production[iType][sProd]){ production[iType][sProd]=0; }
                        production[iType][sProd]+=cropByTime[i][3];
                    }
                    if((!timeBegin)&&(!timeEnd)){
                        totalCrop=production;
                    }
                }
                return production.clone();
            }else{
                var t1=timeBegin?timeBegin:0;
                var t2=timeEnd?timeEnd:NEVER;
                var production={}, zoneErnteCurr;
                cropByTime=[];
                for(var zoneNrS in data){
                    if(!data.hasOwnProperty(zoneNrS)){ continue; }
                    if((!data[zoneNrS]["slots"])&&zones.isProductional(zoneNrS)&&(!zones.getBlock(zoneNrS))){
                        zoneErnteCurr=data[zoneNrS]["production"];
                        if(zoneErnteCurr&&(zoneErnteCurr=zoneErnteCurr[0])){
                            for(var iType=0;iType<zoneErnteCurr.length;iType++){
                                for(var sProd in zoneErnteCurr[iType]){
                                    if(!zoneErnteCurr[iType].hasOwnProperty(sProd)){ continue; }
                                    for(var i=0;i<zoneErnteCurr[iType][sProd].length;i++){
                                        cropByTime.push([zoneErnteCurr[iType][sProd][i][2],iType,sProd,zoneErnteCurr[iType][sProd][i][0]]);
                                        if((t1<=zoneErnteCurr[iType][sProd][i][2])&&(zoneErnteCurr[iType][sProd][i][2]<=t2)){
                                            if(!production[iType]){ production[iType]={}; }
                                            if(!production[iType][sProd]){ production[iType][sProd]=0; }
                                            production[iType][sProd]+=zoneErnteCurr[iType][sProd][i][0];
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                cropByTime.sort(sortObjFunctions["int"]);
                if((!timeBegin)&&(!timeEnd)){
                    totalCrop=production;
                }
                return production.clone();
            }
        }catch(err){
            GM_logError("zones.getTotalCrop","timeBegin="+timeBegin+" timeEnd="+timeEnd,"zoneNrS="+zoneNrS+" iType="+iType+" sProd="+sProd,err);
            return {};
        }
    }
    // Type
    this.isMultiSlot=function(zoneNrF){
    try{
        if(!data[zoneNrF]){
            zones.create(zoneNrF);
        }
        if(data[zoneNrF]["slots"]==null){
            return false;
        }else{
            return data[zoneNrF]["slots"].length-1;
        }
    }catch(err){GM_logError("isMultiSlot","","",err);}
    }
    this.isProductional=function(zoneNr){
        try{
            var zoneNrF=zoneNr.toString().replace(/\.\d+$/g,"");
            if(DATA_zones[zoneNrF]){
                return DATA_zones[zoneNrF]["productional"];
            }else{
                GM_logWarning("zones.isProductional","zoneNr="+zoneNr,"","Function returns null.");
                return null;
            }
        }catch(err){
            GM_logError("zones.isProductional","zoneNr="+zoneNr,"",err);
            return null;
        }
    }
};
unsafeData.zones=zones;
function getBuildingName(building){
    try{
        if(unsafeWindow.buildinginfos[0][building]){
            return unsafeWindow.buildinginfos[0][building][10];
        }else if(getText(building,true)){
            return getText(building);
        }else{
            return "???";
        }
    }catch(err){GM_logError("getBuildingName","","",err);}
}
// Totals
function calcTotalRecursive() {
    var type, id, req, i, amountMissingProducts, j, k;
    try {
        if (DEVMODE_FUNCTION) {
            var trackingHandle = tracking.start("berater", "calcTotalRecursive", []);
        }

        totalRecursive = new Array(new Object(), new Object(), new Object(), new Object());
        var types = [0, 1]; // 0 = normal products, 1 = forestry products

        for (k = 0; k < types.length; k++) {
            type = types[k];

            // Iterate over all products starting with those which are no pre-product.
            // It is important that an inspected product won't be needed by a non-yet-inspected product!
            for (i = prodNameSort[type].length - 1; i >= 0; i--) {
                // Id of currently inspected product
                id = prodNameSort[type][i];

                /** Calculate the amount of missing products:
                 *   - Amount of directly needed product and currently in production in 'prodMinRack'
                 *   - Amount of recursivly needed product in 'totalRecursive'
                 *   - Amount of already produced/existing product in stock in 'ProdStock'
                 */
                amountMissingProducts = prodMinRack[type][id] + (totalRecursive[type][id] ? totalRecursive[type][id] : 0) - prodStock[type][id];

                // If there is a need to gain this product...
                if (amountMissingProducts > 0) {
                    // If this product requires other products... (e.g. tree logs DON'T!)
                    if (prodRequire[type][id]) {
                        // Iterate over pre-products
                        for (j = 0; j < prodRequire[type][id].length; j++) {
                            // Cache the currently inspected pre-product
                            req = prodRequire[type][id][j];

                            // Do only consider pre-products (ignore money)
                            if (req[0] >= 0) {
                                // Initialize result storage of pre-product, if necessary
                                if (!totalRecursive[req[0]]) { totalRecursive[req[0]] = []; }
                                if (!totalRecursive[req[0]][req[1]]) { totalRecursive[req[0]][req[1]] = 0; }

                                /** Some real magic is done here: We calculate, how many pre-products are recursivly needed!
                                 *  We know the amount to produce ('amountMissingProducts') and divide it by the yielded amount per production
                                 *  cycle ('prodYield'). Then we (should) multiply with the amount of needed pre-product ('req[2]') to initiate
                                 *  the production. Finally, we round up, since we can't produce fractions ('Math.ceil()').
                                 *  If the production needs more than one unit of the pre-product, we need to round up to a multiple of 'req[2]'.
                                 *  The formula therefore is 'Math.ceil(x / req[2]) * req[2]'. We then reduce 'req[2]' inside the ceiling-function.
                                 */
                                totalRecursive[req[0]][req[1]] += Math.ceil((amountMissingProducts) / prodYield[type][id]) * req[2];
                            }
                        }
                    }
                }
            }
        }
        if (DEVMODE_FUNCTION) {
            tracking.end("berater", trackingHandle);
        }
    } catch (err) {
        GM_logError("calcTotalRecursive\ntype=" + type + " id=" + id + " req=" + implode(req) + " i=" + i + " j=" + j + "\n" + err);
    }
}
function calcTotalFarmis(){
    try{
        totalFarmis[0]=new Object();
        var farmiNr=-1;
        // GM_log("farmisinfo:\n"+print_r(unsafeWindow.farmisinfo,"",true,"\n"));
        // GM_log("farmilist:\n"+print_r(unsafeWindow.farmilist,"",true,"\n"));
        if(top.window.wrappedJSObject.farmisinfo&&top.window.wrappedJSObject.farmisinfo[0]){
            for(var farmiNr in top.window.wrappedJSObject.farmisinfo[0]){ // loop through all farmis...
                if(!top.window.wrappedJSObject.farmisinfo[0].hasOwnProperty(farmiNr)){continue;}
                if(top.window.wrappedJSObject.farmilist[farmiNr]==1){ // ...which are waiting...
                    // {"id":integer(string),"pic":integer(string),"verkauft":"0","price":float(string),"p1":prod(string),"a1":amount(string),...,"p7":...,"a7":...}
                    if(valFarmiLimits[0]<=top.window.wrappedJSObject.farmisinfo[0][farmiNr]["costQuotient"]){ // ...and pay enough
                        for(var i=1 ; i <= 7 ; i++){ // 7=max-amount of products per farmi
                            var pid=top.window.wrappedJSObject.farmisinfo[0][farmiNr]["p"+i];
                            var amount=parseInt(top.window.wrappedJSObject.farmisinfo[0][farmiNr]["a"+i],10);
                            if((pid > 0) && (amount > 0)){
                                if (totalFarmis[0][pid]) totalFarmis[0][pid] += amount;
                                else totalFarmis[0][pid]=amount;
                            }
                        }
                    }
                }
            }
            // totalFarmis[0].sortObj();
        }
    }catch(err){GM_logError("calcTotalFarmis","","",err);}
    //GM_log("calcTotalFarmis totalFarmis:"+implode(totalFarmis[0]));
    //calcProdMinRack(); //TODO possible security error this in wrappedJSObject .. and the calcProMinRack/doBuyNotePad is in unsafeWindow
}
function calcTotalPowerups(){
try{
    totalPowerups=new Object();
    if(unsafeWindow.poweruprack){
        for(var v in unsafeWindow.poweruprack){
            if(!unsafeWindow.poweruprack.hasOwnProperty(v)){continue;}
            if(unsafeWindow.poweruprack[v][5] && unsafeWindow.poweruprack[v][5][0]){ //problem in the game made this visible
                var k=parseInt(unsafeWindow.poweruprack[v][5][0][0],10);
                totalPowerups[k]=parseInt(unsafeWindow.poweruprack[v]["rack"],10)*parseInt(unsafeWindow.poweruprack[v][5][0][1],10);
            }
        }
    }
    //GM_log("calcTotalPowerups totalPowerups:"+implode(totalPowerups));
}catch(err){ GM_logError("calcTotalPowerups","","",err); }
}
function calcTotalQuest(quTyp){
    try{
        // GM_log("calcTotalQuest quTyp="+quTyp);
        totalQuest[quTyp]=new Array(new Object(),new Object());
        var questCurr;
        for(var camp in questData[quTyp]){
            if (!questData[quTyp].hasOwnProperty(camp)){ continue; }
            // GM_log("calcTotalQuest camp="+camp);
            // GM_log("questData["+quTyp+"]["+camp+"]="+implode(questData[quTyp][camp]));
            if(questData[quTyp][camp]["calcTo"]>0){
                questCurr=questData[quTyp][camp]["data"];
                // GM_log("calcTotalQuest questCurr="+implode(questCurr));
                if(questCurr&&questCurr[0]){
                    for(var j=0;j<questCurr[0].length;j++){
                        if(questCurr[0][j][3]){
                            if(!totalQuest[quTyp][questCurr[0][j][0]][questCurr[0][j][1]]){ totalQuest[quTyp][questCurr[0][j][0]][questCurr[0][j][1]]=0; }
                            totalQuest[quTyp][questCurr[0][j][0]][questCurr[0][j][1]]+=questCurr[0][j][2];
                        }
                    }
                }
                for(var pTyp in questData[quTyp][camp]["given"]){
                    if (!questData[quTyp][camp]["given"].hasOwnProperty(pTyp)){ continue; }
                    for(var p in questData[quTyp][camp]["given"][pTyp]){
                        if (!questData[quTyp][camp]["given"][pTyp].hasOwnProperty(p)){ continue; }
                        if(totalQuest[quTyp][pTyp]&&totalQuest[quTyp][pTyp][p]){
                            totalQuest[quTyp][pTyp][p]=Math.max(0,totalQuest[quTyp][pTyp][p]-questData[quTyp][camp]["given"][pTyp][p]);
                        }
                    }
                }
                for(var q=questData[quTyp][camp]["nr"]+1;q<=questData[quTyp][camp]["calcTo"];q++){
                    // GM_log("calcTotalQuest q="+q);
                    if(QUESTS[quTyp][camp][q]){
                        for(var j=0;j<QUESTS[quTyp][camp][q][0].length;j++){
                            questCurr=getQuestBestAlternative(QUESTS[quTyp][camp][q][0][j]);
                            if(!totalQuest[quTyp][questCurr[0]][questCurr[1]]){ totalQuest[quTyp][questCurr[0]][questCurr[1]]=0; }
                            totalQuest[quTyp][questCurr[0]][questCurr[1]]+=questCurr[2];
                        }
                    }
                }
            }
        }
        // GM_log("totalQuest["+quTyp+"]="+implode(totalQuest[quTyp]));
    }catch(err){ GM_logError("calcTotalQuest","quTyp="+quTyp,"camp="+camp+" q="+q,err); }
    // GM_log("calcTotalQuest END");
}
function calcTotalZones(){
try{
    totalZones=new Object();
    var zoneNrF,currZoneTyp;
    for(var i in ALL_ZONES){
        if(!ALL_ZONES.hasOwnProperty(i)){ continue; }
        for(var j=0;j<ALL_ZONES[i].length;j++){
            try{
                zoneNrF=ALL_ZONES[i][j];
                if(!zones.getBlock(zoneNrF)){
                    currZoneTyp=zones.getBuilding(zoneNrF)
                    if(!totalZones[currZoneTyp]){
                        totalZones[currZoneTyp]=0;
                    }
                    totalZones[currZoneTyp]++;
                }
            }catch(err){ GM_logError("calcTotalZones","","i="+i+" j="+j+" zoneNrF="+zoneNrF,"(loop) "+err); }
        }
    }
}catch(err){ GM_logError("calcTotalZones","","",err); }
}
function calcTotalAnimals(){
try{
    totalAnimals=[,,0,0,0,0,,,,,,0,0];
    var help;
    for(var i=0;i<ALL_ZONES["farm"].length;i++){
        help=zones.getAnimals(ALL_ZONES["farm"][i]);
        if(help>0){
            totalAnimals[zones.getBuilding(ALL_ZONES["farm"][i])]+=help;
        }
    }
}catch(err){ GM_logError("calcTotalAnimals","","",err); }
}
function calcTotalEndtime(){
    try{
        if(!zones.getBlock("megafield") && zones.getBuilding("megafield")!=0 && zoneAddToGlobalTime["megafield"]){
            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldEndtime",zones.getEndtime("megafield"));
        } else {
            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldEndtime",NEVER);
        }

        totalEndtime=NEVER;
        for(var i in ALL_ZONES){ // Object mit Keys: city[1] -> windmill, farm[30] -> Zahlen 1-30, farmersmarket[7] -> farmersmarket-0 bis 6, foodworld[5], forestry[3], megafield[1] -> megafield
            if(!ALL_ZONES.hasOwnProperty(i)){ continue; }
            for(var j=0;j<ALL_ZONES[i].length;j++){
                var zoneNrF=ALL_ZONES[i][j];
                // Nicht geblockt UND Gebäude auf Bauplatz UND (Farm ODER 'In globaler Zeit'-Flag gesetzt)
                if ( (zones.getBuilding(zoneNrF) == 23) && (!zoneAddToGlobalTime[zoneNrF])) {
                    continue;
                }
                if((!zones.getBlock(zoneNrF))&&(zones.getBuilding(zoneNrF)!=0)&&((i=="farm")||zoneAddToGlobalTime[zoneNrF])){
                    help=zones.getEndtime(zoneNrF);
                    if(help==NEVER){ // Dieses Gebäude/Farm/... ist geerntet
                        if(valGlobaltimeShowCroppedZone[i]){ // Flag 'Geerntete Gebäude/Farm beachten' gesetzt => Auf diesem Account ist was zu machen
                            totalEndtime=-1;
                            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_totalEndtime",totalEndtime);
                            return;
                        }
                    }else{ // Gebäude/Farm nicht geerntet (also in Produktion oder Produktion fertig+zu ernten). Endzeit für Produktion fertig+noch nicht geerntet liegt in Vergangenheit
                        totalEndtime=Math.min(totalEndtime,help);
                        if(valWaterNeeded[i]){ // Gießen beachten?
                            totalEndtime=Math.min(totalEndtime,zones.getWatertime(zoneNrF));
                        }
                    }
                }
            }
        }
        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_totalEndtime",totalEndtime);
    }catch(err){ GM_logError("calcTotalEndtime","","i="+i+" j="+j+" zoneNrF="+zoneNrF,err); }
}
// calcProdMinRackInit: sets base values
// -> calcProdMinRack: adds quests, farmis, growing, addons, forestry
// (calls calcTotalQuest)
// -> doBuyNotepad, doRack, TODO doFarmis!
// TODO: switch this logic to: calcTotalX -> calcProdMinRack
function calcProdMinRackInit(){
try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","calcProdMinRackInit"); }
        prodMinRackInit=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRackInit"),"calcProdMinRackInit/prodMinRackInit",[[],{},{},{}]);
        if(!(prodMinRackInit instanceof Array)){ prodMinRackInit=[]; }
        for(var type in prodName){
            if(!prodName.hasOwnProperty(type)){continue;}
            if(type==1){
                if((!prodMinRackInit[type])||(typeof prodMinRackInit[type]!="object")||(prodMinRackInit[type] instanceof Array)){ prodMinRackInit[type]={}; }
            }else{
                if((!prodMinRackInit[type])||(!(prodMinRackInit[type] instanceof Array))){ prodMinRackInit[type]=[]; }
            }
            if(!valMinRackMan){ // detail-setting option (else see buildPreise)
                for(var prod in prodName[type]){
                    //GM_log("prodName type:"+type+" prod:"+prod);
                    if(!prodName[type].hasOwnProperty(prod)){continue;}
                    if((!valMinRack[prodTyp[type][prod]])||(prodBlock[type][prod])){ // .match(/t/)
                        prodMinRackInit[type][prod]=0;
                    }else if(prodTyp[type][prod]=="v"){
                        prodMinRackInit[type][prod]=valMinRack[prodTyp[type][prod]]/(valMinRackPlantsize?prodPlantSize[type][prod]:1);
                    }else{
                        prodMinRackInit[type][prod]=valMinRack[prodTyp[type][prod]];
                    }
                }
            }
            // prodMinRackInit[type].sortObj();
        }
        GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRackInit",implode(prodMinRackInit,"calcProdMinRackInit/prodMinRackInit"));
        unsafeData.prodMinRackInit=prodMinRackInit.clone();
        calcProdMinRack();
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
}catch(err){ GM_logError("calcProdMinRackInit","","type="+type+" prod="+prod,err); }
}
function calcProdMinRack(caller){
try{
    GM_logInfo("calcProdMinRack","caller="+caller,"","Begin",1);
    prodMinRack=prodMinRackInit.clone();
    // Quest
    var err_trace="quest";
    for(var quTyp in QUESTS){
        if(!QUESTS.hasOwnProperty(quTyp)){ continue; }
        calcTotalQuest(quTyp);
        for(var type in totalQuest[quTyp]){
            if(!totalQuest[quTyp].hasOwnProperty(type)){ continue; }
            for(var prod in totalQuest[quTyp][type]){
                if(!totalQuest[quTyp][type].hasOwnProperty(prod)){ continue; }
                if(!prodMinRack[type][prod]){prodMinRack[type][prod]=0;}
                prodMinRack[type][prod] += totalQuest[quTyp][type][prod];
            }
        }
    }
    // Farmis
    err_trace="farmis";
    if(valMinRackFarmis){
        for(var prod in totalFarmis[0]){
            if(!totalFarmis[0].hasOwnProperty(prod)){ continue; }
            if(!prodMinRack[0][prod]){ prodMinRack[0][prod]=0;}
            prodMinRack[0][prod] += totalFarmis[0][prod];
        }
    }
    if(valMinRackForestryFarmis){
        for(var prod in totalFarmis[1]){
            if(!totalFarmis[1].hasOwnProperty(prod)){ continue; }
            if(!prodMinRack[1][prod]){ prodMinRack[1][prod]=0;}
            prodMinRack[1][prod] += totalFarmis[1][prod];
        }
    }
    if(valMinRackFoodworldFarmis){
        for(var prod in totalFarmis[2]){ // {pid: amount}
            if(!totalFarmis[2].hasOwnProperty(prod)){ continue; }
            if(!prodMinRack[0][prod]){ prodMinRack[0][prod]=0;}
            prodMinRack[0][prod] += totalFarmis[2][prod];
        }
    }
    if(valMinRackFarmersmarketFarmis){
        for(var prod in totalFarmis[3]){ // {pid: amount}
            if(!totalFarmis[3].hasOwnProperty(prod)){ continue; }
            if(!prodMinRack[0][prod]){ prodMinRack[0][prod]=0;}
            prodMinRack[0][prod] += totalFarmis[3][prod];
        }
    }
    // Addons
    err_trace="prodMinRackAddon";
    for(var type in prodMinRackAddon){
        if (!prodMinRackAddon.hasOwnProperty(type)){ continue; }
        for(var prod in prodMinRackAddon[type]){
            if(!prodMinRackAddon[type].hasOwnProperty(prod)){ continue; }
            if(prodMinRackAddon[type][prod]){
                for(var k in prodMinRackAddon[type][prod]){
                    if(!prodMinRackAddon[type][prod].hasOwnProperty(k)){ continue; }
                    if(!prodMinRack[type][prod]){prodMinRack[type][prod]=0;}
                    prodMinRack[type][prod] += prodMinRackAddon[type][prod][k];
                }
            }
        }
    }

    err_trace="megafield";
    if(!zones.getBlock("megafield")){
        if(megafieldJob){
            for(var prod in megafieldJob.products){
                if(!megafieldJob.products.hasOwnProperty(prod)){ continue; }
                if(!prodMinRack[0][prod]){ prodMinRack[0][prod]=0;}
                prodMinRack[0][prod] += (megafieldJob.products[prod].need-megafieldJob.products[prod].have-megafieldJob.products[prod].growing)*(megafieldJob.products[prod].amount===undefined?1:megafieldJob.products[prod].amount);
            }
        }
    }
    // Growing products
    err_trace="growing";
    if(valMinRackGrowing){
        var totalErnte=zones.getTotalCrop();
        for(var type in totalErnte){
            if (!totalErnte.hasOwnProperty(type)){ continue; }
            for(var prod in totalErnte[type]){
                if(!totalErnte[type].hasOwnProperty(prod)){ continue; }
                if(!prodMinRack[type][prod]){prodMinRack[type][prod]=0;}
                prodMinRack[type][prod] -= totalErnte[type][prod];
            }
        }
        for(var prod in totalPowerups){
            if(!totalPowerups.hasOwnProperty(prod)){ continue; }
            if(!prodMinRack[0][prod]){prodMinRack[0][prod]=0;}
            prodMinRack[0][prod] -= totalPowerups[prod];
        }
    }
    err_trace="recursive";
    if (valMinRackRecursive) {
        calcTotalRecursive(); // recursive need products calculation
        for (var type in totalRecursive) {
            if (!totalRecursive.hasOwnProperty(type)) { continue; }
            for (var prod in totalRecursive[type]) {
                if (!totalRecursive[type].hasOwnProperty(prod)) { continue; }
                if (!prodMinRack[type]) { prodMinRack[type] = []; }
                if (!prodMinRack[type][prod]) { prodMinRack[type][prod] = 0; }
                prodMinRack[type][prod] += totalRecursive[type][prod];
            }
        }
    }


    // delete wrong values
    err_trace="QA";
    for(var type in prodMinRack){
        if (!prodMinRack.hasOwnProperty(type)){ continue; }
        for(var prod in prodMinRack[type]){
            if(!prodMinRack[type].hasOwnProperty(prod)){ continue; }
            try{
                if(prodMinRack[type][prod]<0){ // delete negatives
                    prodMinRack[type][prod]=0;
                }else if((type==0)&&(prodBlock[0][prod].match(/l/))){ // delete non-availables
                    prodMinRack[type][prod]=0;
                }
            }catch(err){}
        }
    }

    err_trace="save";
    unsafeData.prodMinRack=prodMinRack.clone();
    unsafeData.prodMinRackSettings = {"valMinRackGrowing":valMinRackGrowing,"valMinRackFarmis":valMinRackFarmis,"valMinRackFarmis":valMinRackFarmis,"valMinRackRecursive":valMinRackRecursive};
    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRack",implode(prodMinRack,"calcProdMinRack/prodMinRack"));
    doBuyNotepad();
    doRack();
    doFarmis();
    raiseEvent("gameCalcProdMinRack");
    GM_logInfo("calcProdMinRack","caller="+caller,"","End",1);
}catch(err){ GM_logError("calcProdMinRack","caller="+caller,"err_trace="+err_trace+" type="+type+" prod="+prod,err); }
}

function getQuestBestAlternative(arr){
// item=[prodType,prodId,amount]. arr=item or arr=[item,item,...]
try{
    if(typeof arr[0]=="object"){
        var returnId,minPrice=null,currPrice;
        for(var k=0;k<arr.length;k++){
            if(arr[k][0]!=0){
                currPrice=0;
            }else if(isNaN(NPC[0][arr[k][1]])){
                currPrice=arr[k][2]*gut[arr[k][1]];
            }else{
                currPrice=arr[k][2]*Math.min(gut[arr[k][1]],NPC[0][arr[k][1]]);
            }
            if((minPrice==null)||(currPrice<minPrice)){
                minPrice=currPrice;
                returnId=k;
            }
        }
        return arr[returnId];
    } if(typeof arr=="object"){
        return arr;
    } else {
        GM_logWarning("getQuestBestAlternative","arr="+implode(arr,"getQuestBestAlternative/arr"),"","Wrong argument");
        return [];
    }
}catch(err){ GM_logError("getQuestBestAlternative","arr="+implode(arr,"getQuestBestAlternative/arr"),"",err); }
}
unsafeData.getQuestBestAlternative=getQuestBestAlternative;
function setCalcToQuest(type,campaign,nr){
try{
    // GM_log("setCalcToQuest type="+type+" campaign="+campaign+" nr="+nr);
    if(QUESTS[type]&&QUESTS[type][campaign]&&questData[type][campaign]){
        questData[type][campaign]["calcTo"] = Math.min(nr,QUESTS[type][campaign].length);
        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"setCalcToQuest/questData"));
        unsafeData.questData=questData.clone();
        // if(farmiLog){ doFarmis(); } //hack bypass early call
        calcProdMinRack();
        handleQuestLine();
    }
}catch(err){ GM_logError("setCalcToQuest","","",err); }
}
unsafeData.setCalcToQuest=setCalcToQuest;

function gatherQuestData(type,campaign,nr) {
try {
    if(QUESTS[type] && QUESTS[type][campaign] && QUESTS[type][campaign][nr] && questData[type][campaign]){
        var questCurr=QUESTS[type][campaign][nr];
        // console.log("questCurr_Entry: "+implode(questCurr));
        var help = 0;
        var questCalc = new Array();
        questCalc = [["",""],""];
        // Quest Main/3/47
        // questCurr_Entry: [[[[0,144,342],[0,141,241]],[0,25,248]],null,5826402]
        // questCalc_Exit: [[[0,144,342,true,100640.34],[0,141,241,false,190609.31],[0,25,248,true]],"",5826402]
        for(var j=0;j<questCurr[0].length;j++){
            if(typeof questCurr[0][j][0]=="object"){
                // console.log("gatherQuestData_typeof object, j="+j+", help="+help);
                for(var k=0;k<questCurr[0][j].length;k++){
                    // console.log("gatherQuestData_typeof object, length="+questCurr[0][j].length+", k="+k);
                    if(isNaN(NPC[questCurr[0][j][k][0]][questCurr[0][j][k][1]])){
                        questCurr[0][j][k][4]=Math.round(questCurr[0][j][k][2]*gut[questCurr[0][j][k][1]]*100)/100;
                    } else {
                        questCurr[0][j][k][4]=Math.round(questCurr[0][j][k][2]*Math.min(gut[questCurr[0][j][k][1]],NPC[questCurr[0][j][k][0]][questCurr[0][j][k][1]])*100)/100;
                    }
                    questCurr[0][j][k][3]=true; // Default: every alternative gets status true
                    for(var l=0;l<k;l++){ // works only, if there are never more than 2 alternatives
                        if(questCurr[0][j][l][4]>questCurr[0][j][k][4]){
                            questCurr[0][j][l][3]=false;
                        } else {
                            questCurr[0][j][k][3]=false;
                        }
                    }
                }
                for(var k=0;k<questCurr[0][j].length;k++){
                    // console.log("gatherQuestData_typeof object, length="+questCurr[0][j].length+", k="+k+", help="+help);
                    questCalc[0][help]=questCurr[0][j][k];
                    help++;
                }
            } else {
                // console.log("gatherQuestData_typeof NON-object, j="+j+", help="+help);
                questCurr[0][j][3]=true;
                questCalc[0][help]=questCurr[0][j];
                help++;
            }
        }
        if(questCurr[1]){questCalc[1]=questCurr[1];}
        if(questCurr[2]){questCalc[2]=questCurr[2];}
        if(questCurr[3]){questCalc[3]=questCurr[3];}
        // console.log("questCalc_Exit: "+implode(questCalc));
        return questCalc;
        //20170424 questCalc=null; questCurr=null;
    } else {
        GM_logWarning("gatherQuestData",(" type: "+type+", campaign: "+campaign+", Nr: "+nr),"","Wrong argument");
        return [];
    }
}catch(err){ GM_logError("gatherQuestDetails",(" type: "+type+", campaign: "+campaign+", Nr: "+nr),"",err); }
}

function handleQuestLine() {
    try {
        var div, help;
        for (var type in questData) { // Iterate over quest types
            if (!questData.hasOwnProperty(type)) { continue; }
            for (var campaign in questData[type]) { // Iterate over campaigns
                if (!questData[type].hasOwnProperty(campaign)) { continue; }
                if ((type == "foodworld")
                        && unsafeWindow.quests_status
                        && unsafeWindow.quests_status[type]
                        && unsafeWindow.quests_status[type][campaign]
                        && unsafeWindow.quests_status[type][campaign]["data"]) {
                    // Bugfix: Write Foodworld-QuestId to quests_status[type][campaign]
                    unsafeWindow.quests_status[type][campaign]["questid"] = unsafeWindow.quests_status[type][campaign]["data"]["questid"];
                }
                if (unsafeWindow.quests_status
                        && unsafeWindow.quests_status[type]
                        && unsafeWindow.quests_status[type][campaign]) {
                    if (type == "foodworld") {
                        help = unsafeWindow.quests_status[type][campaign]["data"]["questid"];
                    } else if (type == "forestry" && campaign == "2" && typeof unsafeWindow.quests_status[type][campaign]["questid"] === 'string') {
                        // QuestId from forestry/2 might come as a string of last finished quest
                        // We need to parse and increment it!
                        help = parseInt(unsafeWindow.quests_status[type][campaign]["questid"], 10) + 1;
                    } else {
                        help = unsafeWindow.quests_status[type][campaign]["questid"];
                    }

                    if (isNaN(help)) { help = 1; };
                    switch (implode([type, campaign], "handleQuestLine/typeCampaign")) {
                        case implode(["main", "2"], "handleQuestLine/main2"):
                            {
                                if (USERLEVEL < 31) { help = -1; }
                                break;
                            }
                        case implode(["main", "3"], "handleQuestLine/main3"):
                            {
                                //if ((USERLEVEL < 40) || (speedlink_farm5.style.display == "none")) { help = -1; }
                                if (USERLEVEL < 40 || unsafeWindow.farms_data.blocked[5]) { help = -1; }
                                break;
                            }
                        case implode(["main", "4"], "handleQuestLine/main4"):
                            {
                                if (USERLEVEL < 42 || unsafeWindow.farms_data.blocked[6]) {
                                    help = -1; }
                                break;
                            }
                        case implode(["main", "5"], "handleQuestLine/main5"):
                            {
                                if (USERLEVEL < 47 || unsafeWindow.farms_data.blocked[8]) {
                                    help = -1; }
                                break;
                            }
                        case implode(["main", "6"], "handleQuestLine/main5"):
                            {
                                if (USERLEVEL < 50 || unsafeWindow.farms_data.blocked[9]) {
                                    help = -1; }
                                break;
                            }

                        case implode(["forestry", "1"], "handleQuestLine/forestry1"):
                            {
                                if (USERLEVEL < 20) { help = -1; }
                                break;
                            }
                        case implode(["forestry", "2"], "handleQuestLine/forestry2"):
                            {
                                if (questData["forestry"]["1"]["nr"] < 35) { help = -1; }
                                break;
                            }
                        case implode(["foodworld", "1"], "handleQuestLine/foodworld1"):
                            {
                                if (USERLEVEL < 12) { help = -1; }
                                break;
                            }
                    }

                    if (questData[type][campaign]["nr"] != help) {
                        switch (type) {
                            case "main":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("pleaseOpenX").replace(/%1%/, getText("quest" + type + campaign)) + " (" + questData[type][campaign]["nr"] + "&ne;" + help + ")");
                                    break;
                                }
                            case "forestry":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("pleaseOpenX").replace(/%1%/, getText("lodge")) + " (" + questData[type][campaign]["nr"] + "&ne;" + help + ")");
                                    console.trace();
                                    break;
                                }
                            case "foodworld":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("pleaseOpenX").replace(/%1%/, getText("foodworld")) + " (" + questData[type][campaign]["nr"] + "&ne;" + help + ")");
                                    break;
                                }
                        }

                        if (!QUESTS[type][campaign][questData[type][campaign]["nr"]]) {
                            GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign + " quests_status=" + implode(unsafeWindow.quests_status, 1), getText("questSetXToNrY").replace(/%1%/, getText("quest" + type + campaign)).replace(/%2%/, help));
                            questData[type][campaign]["nr"] = help;
                            questData[type][campaign]["given"] = new Object();
                            questData[type][campaign]["time"] = 0;
                            GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_questData", implode(questData, "handleQuestLine/questData"));
                            unsafeData.questData = questData.clone();
                        }
                    }
                } else {
                    help = questData[type][campaign]["nr"];
                    switch (implode([type, campaign], "handleQuestLine/typeCampaign")) {
                        case implode(["main", "2"], "handleQuestLine/main2"):
                            {
                                if (USERLEVEL < 31) { help = -1; }
                                break;
                            }
                        case implode(["main", "3"], "handleQuestLine/main3"):
                            {
                                //if ((USERLEVEL < 40) || (speedlink_farm5.style.display == "none")) { help = -1; }
                                if (USERLEVEL < 40 || unsafeWindow.farms_data.blocked[5]) { help = -1; }
                                break;
                            }
                        case implode(["main", "4"], "handleQuestLine/main4"):
                            {
                                if (USERLEVEL < 42 || unsafeWindow.farms_data.blocked[6]) {
                                    help = -1; }
                                break;
                            }
                        case implode(["main", "5"], "handleQuestLine/main5"):
                            {
                                if (USERLEVEL < 47 || unsafeWindow.farms_data.blocked[8]) {
                                    help = -1; }
                                break;
                            }
                        case implode(["forestry", "1"], "handleQuestLine/forestry1"):
                            {
                                if (USERLEVEL < 20) { help = -1; }
                                break;
                            }
                        case implode(["forestry", "2"], "handleQuestLine/forestry2"):
                            {
                                if (questData["forestry"]["1"]["nr"] < 35) { help = -1; }
                                break;
                            }
                        case implode(["foodworld", "1"], "handleQuestLine/foodworld1"):
                            {
                                if (USERLEVEL < 12) { help = -1; }
                                break;
                            }
                    }
                    if (questData[type][campaign]["nr"] != help) {
                        GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign + " quests_status=" + implode(unsafeWindow.quests_status, 1), getText("questSetXToNrY").replace(/%1%/, getText("quest" + type + campaign)).replace(/%2%/, help));
                        questData[type][campaign]["nr"] = help;
                        questData[type][campaign]["given"] = new Object();
                        questData[type][campaign]["time"] = 0;
                        GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_questData", implode(questData, "handleQuestLine/questData"));
                        unsafeData.questData = questData.clone();
                    }
                }
                if (div = $("quests_status_bar_" + type + campaign)) {
                    if (questData[type][campaign]["nr"] == 0) {
                        div.style.display = "block"; // quest number unknown
                        switch (type) {
                            case "main":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("quest" + type + campaign)));
                                    break;
                                }
                            case "forestry":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("lodge")));
                                    break;
                                }
                            case "foodworld":
                                {
                                    GM_logInfo("handleQuestLine", "", "type=" + type + " campaign=" + campaign, getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("foodworld")));
                                    break;
                                }
                        }

                    //} else if ((questData[type][campaign]["nr"] == -1) || (questData[type][campaign]["calcTo"] == -1)) {
                    } else if (questData[type][campaign]["nr"] == -1) {
                        div.style.display = "none"; // do not show quest
                    } else if (QUESTS[type][campaign][questData[type][campaign]["nr"]]) {
                        div.style.display = "block"; // quest available
                    } else {
                        div.style.display = "none"; // all quests done
                    }
                    if (!unsafeWindow.premium) {
                        switch (type) {
                            case "forestry":
                                {
                                    div.addEventListener("click", function() {
                                        if (gameLocation.check("city", 2)) {
                                            unsafeWindow.close_page();
                                            unsafeWindow.showDiv("transp3");
                                            unsafeWindow.initCampaigns();
                                        } else {
                                            document.addEventListener("gameCity2", function() {
                                                document.removeEventListener("gameCity2", arguments.callee, false);
                                                unsafeWindow.close_page();
                                                unsafeWindow.showDiv("transp3");
                                                unsafeWindow.initCampaigns();
                                            }, false);
                                            click($("speedlink_city2"));
                                        }
                                    }, false);
                                    break;
                                }
                            case "foodworld":
                                {
                                    div.addEventListener("click", function() {
                                        if (gameLocation.check("foodworld")) {
                                            click($("foodworld_questblock"));
                                        } else {
                                            document.addEventListener("gameFoodworldOpened", function() {
                                                document.removeEventListener("gameFoodworldOpened", arguments.callee, false);
                                                click($("foodworld_questblock"));
                                            }, false);
                                            click($("speedlink_foodworld"));
                                        }
                                    }, false);
                                    break;
                                }
                        }
                    }
                }
            }
        }
        div = null;
    } catch (err) { GM_logError("handleQuestLine", "", "type=" + type + " campaign=" + campaign, err); }
};

//***********************************************************************************************************

function do_shop(){
    if(pageZusatz["s"]=="3"){
        // Decoration - Shop
        npcSaison=explode(GM_getValue(COUNTRY+"_"+SERVER+"_NpcSaison"),"do_shop/npcSaison",INIT_NPC_SAISON);
        for(var v in npcSaison){
            if(!npcSaison.hasOwnProperty(v)){ continue; }
            npcSaison[v]=(document.getElementsByClassName("s"+v).length>0);
        }
        unsafeData.npcSaison=npcSaison.clone();
        GM_setValue(COUNTRY+"_"+SERVER+"_NpcSaison",implode(npcSaison,"do_shop/npcSaison"));
    }
}

function do_stats(){
    var canddiv;
    var currStat="1";
    try{ currStat=pageZusatz["type"]; }
    catch(err){ currStat="1"; }
    if (typeof pageZusatz["search"]!="undefined"){ currStat="0"; }
    if (typeof pageZusatz["guildsearch"]!="undefined"){
        unsafeWindow.initGuildsearch();
        $("guildname").value=pageZusatz["guildsearch"];
        unsafeWindow.stats_searchGuild();
    }

    switch (currStat){
    case "0": // Einzelspieler
        try {
            loadProductData();
            var newdiv=$("spielerinfo");
            var newdiv1;
            for(var v=0;v<newdiv.childElementCount;v++){
                newdiv1=createElement("div",{"class":"hoverBgLightblue","style":"height:15px;width:100%;"});
                newdiv.insertBefore(newdiv1,newdiv.children[v]);
                newdiv1.appendChild(newdiv.children[v+1]); // left cell
                newdiv1.appendChild(newdiv.children[v+1]); // right cell
                removeElement(newdiv.children[v+1]); // br node
            }

            canddiv=$("spielerinfo").getElementsByClassName("cright3");
            var thisUser=/(.*?)&nbsp;/.exec(canddiv[0].firstElementChild.innerHTML+"&nbsp;")[1];
            canddiv[0].insertBefore(vertrag(thisUser),canddiv[0].firstElementChild);
            canddiv[0].insertBefore(stats(thisUser),canddiv[0].firstElementChild);
            canddiv[0].insertBefore(igm(thisUser),canddiv[0].firstElementChild);

            var nextQuest=parseInt(canddiv[5].innerHTML,10)+1;
            if(QUESTS["main"]["1"][nextQuest]){
                canddiv[5].parentNode.setAttribute("nextQuest",nextQuest);
                canddiv[5].parentNode.addEventListener("mouseover",function(event){
                    var nextQuest=this.getAttribute("nextQuest");
                    var str="<div style='border-bottom:1px solid black;'>"+getText("quest_farm")+"&nbsp;"+nextQuest+"</div>";
                    for(var i=0;i<QUESTS["main"]["1"][nextQuest][0].length;i++){
                        if(typeof QUESTS["main"]["1"][nextQuest][0][i][0]=="object"){
                            for(var j=0;j<QUESTS["main"]["1"][nextQuest][0][i].length;j++){
                                str += "<div>*"+numberFormat(QUESTS["main"]["1"][nextQuest][0][i][j][2])+"&nbsp;"+prodName[QUESTS["main"]["1"][nextQuest][0][i][j][0]][QUESTS["main"]["1"][nextQuest][0][i][j][1]]+"</div>";
                            }
                        }else{
                            str += "<div>"+numberFormat(QUESTS["main"]["1"][nextQuest][0][i][2])+"&nbsp;"+prodName[QUESTS["main"]["1"][nextQuest][0][i][0]][QUESTS["main"]["1"][nextQuest][0][i][1]]+"</div>";
                        }
                    }
                    toolTip.show(event,str);
                },false);
            }
            nextQuest=null;
        } catch(err){}
        break;
    // Spielerlisten
    case "1": case "2": case "3": case "4": case "5": case "6": case "7": case "8": case "10": case "11":
        if($("rankinghead")){
            canddiv=createElement("input",{"class":"text","maxlength":"5","style":"margin-left:10px;width:40px;"},$("rankinghead"));
            canddiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("goToRank")); },false);
            canddiv.addEventListener("change",function(){
                var ranksPerPage=15;
                var targetPage=parseInt(this.value,10);
                if(targetPage>0){
                    targetPage=Math.ceil(targetPage/ranksPerPage);
                    location.href="stats.php?page="+targetPage+"&type="+currStat;
                }else{
                    this.value="";
                }
            },false);
        }

        canddiv=$("rankingcontent").getElementsByClassName("stats_name");
        for(var v=0;v<canddiv.length;v++){
            thisUser=/(.*?)&nbsp;/.exec(canddiv[v].firstElementChild.innerHTML+"&nbsp;")[1];
            thisGuild=/&nbsp;\[(.*?)\]&nbsp;/.exec(canddiv[v].firstElementChild.innerHTML+"&nbsp;");
            var help=canddiv[v].firstElementChild.innerHTML.replace(thisUser,"<a href='stats.php?search=1&searchterm="+thisUser+"'>"+thisUser+"</a>");
            if(thisGuild) help=help.replace(thisGuild[0],"&nbsp;[<a href='stats.php?guildsearch="+thisGuild[1]+"'>"+thisGuild[1]+"</a>]&nbsp;");
            canddiv[v].firstElementChild.innerHTML=help;
            canddiv[v].insertBefore(igm(thisUser),canddiv[v].firstElementChild);
        }
        break;
    }
    canddiv=null;
}

function do_wettbewerb(){ // in .de not used anymore
    var candtd=document.getElementsByTagName("table")[1].getElementsByTagName("td");
    for(var v=6;v<candtd.length;v=v+3){
        var thisUser=/(.*?)&nbsp/.exec(candtd[v].firstElementChild.innerHTML+"&nbsp")[1];
        igm(thisUser,candtd[v]);
    }
    candtd=null;
}

//***********************************************************************************************************

unsafeWindow.buildInfoPanel=function(mode,mode2){
try{
    if(typeof mode2=="undefined"){ mode2=""; }
    var div,div1;
    if(!(div=$("infoPanel"))){
        if(div1=$("garten_komplett")){
            div=createElement("div",{"id":"infoPanel","mode":"","style":"z-index:100;background-color:rgba(0,0,0,0.7);position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;display:none;"},div1);
            div1=createElement("div",{"style":"position:absolute;top:50px;left:20px;width:660px;height:580px;"},div);
        }else{
            div=createElement("div",{"id":"infoPanel","mode":"","style":"z-index:100;background-color:rgba(0,0,0,0.7);position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;display:none;"},ALL);
            div1=createElement("div",{"style":"position:absolute;top:50px;left:100px;width:660px;height:580px;"},div);
        }
        createElement("img",{"src":GFX+"guild/help_back.jpg","style":"position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1;"},div1);
        createElement("div",{"id":"infoPanelInner","style":"position:absolute;top:0;left:0;width:596px;height:516px;margin:32px;overflow:none;"},div1);
        div1=createElement("img",{"id":"infoPanelClose","class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:8px;width:20px;height:20px;"},div1);
        div1.addEventListener("click",closeInfoPanel,false);
    }
    if((mode==div.getAttribute("mode"))&&(implode(mode2,"buildInfoPanel/mode2")==div.getAttribute("mode2"))){
        closeInfoPanel();
    }else{
        div.setAttribute("mode",mode);
        div.setAttribute("mode2",implode(mode2,"buildInfoPanel/mode2"));
        div.style.display="block";
        $("infoPanelInner").innerHTML="";
        if(unsafeWindow.buildInfoPanelAutomat){ unsafeWindow.buildInfoPanelAutomat(mode,mode2); }
        switch(mode){
        case "changelog": buildInfoPanelChangelog();  break;
        case "clothingDonation":    buildInfoPanelClothingDonation();     break;
        case "donkey":    buildInfoPanelDonkey();     break;
        case "farmies":   buildInfoPanelFarmies();    break;
        case "formulas":  buildInfoPanelFormulas();   break;
        case "level":     buildInfoPanelLevel();      break;
        case "lottery":   buildInfoPanelLottery();    break;
        case "megafield": buildInfoPanelMegafield();  break;
        case "menu":      unsafeWindow.buildInfoPanelMenu(mode2); break;
        case "profit":    buildInfoPanelProfit();     break;
        case "quests":    buildInfoPanelQuests();     break;
        case "messages":  buildInfoPanelMessages();   break;
        case "stock":     buildInfoPanelStock(mode2); break;
        case "upjersAds": buildInfoPanelUpjersAds();  break;
        case "zones":     buildInfoPanelZones();      break;
        }
        raiseEvent("gameInfoPanelOpen");
        div=null;div1=null;
    }
}catch(err){ GM_logError("buildInfoPanel","mode="+implode(mode,"buildInfoPanel/mode")+" mode2="+implode(mode2,"buildInfoPanel/mode2"),"",err); }
}
function closeInfoPanel(){
    try{
        var div;
        if(div=$top("infoPanel")){
            div.setAttribute("mode","");
            div.style.display="none";
        }
        if(div=$top("infoPanelInner")){
            div.innerHTML="";
        }
        div=null;
    } catch(err){ GM_logError("closeInfoPanel","","",err); }
}
function buildInfoPanelChangelog(){
    try{
        var table,tr,td,div;
        var container=$("infoPanelInner");
        container.innerHTML="";
        // Head
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:100px;"},container);
        table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
        tr=createElement("tr",{},table);
        createElement("td",{"class":"tnormal","style":"color:black;font-weight:bold;text-align:center;height:40px;"},tr,getText("adviser")+" "+VERSION);
        createElement("td",{},tr);
        // Body
        newdiv=createElement("div",{"style":"height:470px;width:100%;overflow:auto;"},container);
        table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
        tr=createElement("tr",{},table);
        createElement("th",{},tr,getText("version"));
        createElement("th",{},tr,getText("date"));
        createElement("th",{},tr,getText("change"));
        for(var i=CHANGELOG.length-1;i>-1;i--){
            tr=createElement("tr",{"class":"hoverBgCc9 borderBottom1dashedGrey"},table);
            createElement("td",{},tr,CHANGELOG[i][0]);
            createElement("td",{},tr,CHANGELOG[i][1]);
            td=createElement("td",{},tr);
            div=createElement("ul",{},td);
            for(var j=0;j<CHANGELOG[i][2].length;j++){
                createElement("li",{},div,CHANGELOG[i][2][j][LANGUAGE=="de"?0:1]);
            }
        }
        container=null;table=null;tr=null;td=null;div=null;
    }catch(err){GM_logError("buildInfoPanelChangelog","","",err);}
}
function buildInfoPanelStock(mode){
try{
    var help=mode["filterCategory"];
    var modeDefault={"filterCategories":[{"v":true},{"f1":true},{"r1":true},{"f1":true}],"filterCategory":{"v":true},"page":1,"prodType":0,"showAll":false};
    var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeStockTable"),"buildInfoPanelStock/modeOld",modeDefault);
    if(typeof modeOld!="object"){ modeOld=modeDefault; }
    if(typeof mode!="object"){ mode=modeOld; }
    for(var v in modeDefault){
        if(!modeDefault.hasOwnProperty(v)){ continue; }
        if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
    }
    if(mode["prodType"]>0){ mode["page"]=2; }
    if(help){
        mode["filterCategories"][mode["prodType"]]=mode["filterCategory"];
    }else{
        mode["filterCategory"]=mode["filterCategories"][mode["prodType"]];
    }
    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeStockTable",implode(mode,"buildInfoPanelStock/mode"));
    var container=$("infoPanelInner");
    container.innerHTML="";
    //head line
    var newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:100px;width:100%;font-color:black;overflow:none;"},container);
    var newtable=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
    var newtr=createElement("tr",{},newtable);
    // switch price / stock
    var newtd=createElement("td",{"align":"center","valign":"top"},newtr);
    if(mode["prodType"]==0){
        newdiv=createElement("div",{"class":"link naviItem"+(mode["page"]==1?"Active":"")},newtd,getText("prices"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelStock({"page":1});
        },false);
    }else{
        newdiv=createElement("div",{"class":"naviItemInactive"},newtd,getText("prices"));
    }
    newdiv=createElement("div",{"class":"link naviItem"+(mode["page"]==2?"Active":"")},newtd,getText("stock"));
    newdiv.addEventListener("click",function(){
        buildInfoPanelStock({"page":2});
    },false);
    // switch prodType
    newtd=createElement("td",{"align":"left","valign":"top"},newtr);
    newdiv = createElement("select",{},newtd);
    createElement("option",{"value":0},newdiv,getText("farm"));
    createElement("option",{"value":1},newdiv,getText("forestry"));
    createElement("option",{"value":2},newdiv,getText("recipes"));
    createElement("option",{"value":3},newdiv,getText("powerups"));
    newdiv.addEventListener("change",function(){
        buildInfoPanelStock({"prodType":parseInt(this.value,10)});
    },false);
    newdiv.value=mode["prodType"];
    // switch filterCategory
    newtd=createElement("td",{"align":"right"},newtr);

    newdiv=createElement("div",{"style":"-moz-user-select:none;float:right;"},newtd);
    newdiv.addEventListener("mouseover",function(event){
        var mouseOverText=event.target.getAttribute("mouseOverText");
        if(mouseOverText){
            mouseOverText='<div>'+getText("click")+'&nbsp;/&nbsp;'+getText("clickCtrl")+'</div><div>'+mouseOverText+'</div>';
            toolTip.show(event,mouseOverText);
        }
    },false);
    newdiv.addEventListener("click",function(filterCategory){
    return function(event){
        var thisFilter=explode(event.target.getAttribute("filter"),"buildInfoPanelStock\thisFilter");
        if(thisFilter){
            if(event.ctrlKey){
                for(var i=thisFilter.length-1;i>-1;i--){
                    if(filterCategory[thisFilter[i]]){
                        delete filterCategory[thisFilter[i]];
                    }else{
                        filterCategory[thisFilter[i]]=true;
                    }
                }
            }else{
                filterCategory={};
                for(var i=thisFilter.length-1;i>-1;i--){
                    filterCategory[thisFilter[i]]=true;
                }
            }
            buildInfoPanelStock({"filterCategory":filterCategory});
        }
    }}(mode["filterCategory"]),false);
    switch(mode["prodType"]){
    case 0:{
        createElement("div",{"class":"link rackcat1v"+(mode["filterCategory"]["v","ex","alpin","water"]?"_active":""),"filter":'["v","ex","alpin","water"]',"mouseOverText":getText("category_v"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat1e"+(mode["filterCategory"]["e","tea"]?"_active":""),"filter":'["e","tea"]',"mouseOverText":getText("category_e"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat10"+(mode["filterCategory"]["o"]?"_active":""),"filter":'["o"]',"mouseOverText":getText("category_o"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat15"+(mode["filterCategory"]["c"]||mode["filterCategory"]["z"]?"_active":""),"filter":'["c","z"]',"mouseOverText":getText("category_c")+"<br>"+getText("category_z"),"style":"float:left;"},newdiv);
        newdiv1=createElement("div",{"style":"float:left;width:53px;"},newdiv);
        for(var i=1;i<=4;i=i+2){
            createElement("div",{"class":"link rackcat2"+i+(mode["filterCategory"]["fw"+i]?"_active":""),"filter":'["fw'+i+'"]',"mouseOverText":getText("category_fw"+i),"style":"float:left;"},newdiv1);
            if(i==3){ i=0; }
        }
        createElement("div",{"class":"link rackcat30fl"+(mode["filterCategory"]["fl"]?"_active":""),"filter":'["fl"]',"mouseOverText":getText("category_fl"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat30fla"+(mode["filterCategory"]["fla"]?"_active":""),"filter":'["fla"]',"mouseOverText":getText("category_fla"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60hr"+(mode["filterCategory"]["hr"]?"_active":""),"filter":'["hr"]',"mouseOverText":getText("category_hr"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60md"+(mode["filterCategory"]["md"]?"_active":""),"filter":'["md"]',"mouseOverText":getText("category_md"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60breed"+(mode["filterCategory"]["breed"]?"_active":""),"filter":'["breed"]',"mouseOverText":getText("category_breed"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60cow"+(mode["filterCategory"]["cow"]?"_active":""),"filter":'["cow"]',"mouseOverText":getText("category_cow"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60fish"+(mode["filterCategory"]["fish"]?"_active":""),"filter":'["fish"]',"mouseOverText":getText("category_fish"),"style":"float:left;"},newdiv);
        createElement("div",{"class":"link rackcat60scouts"+(mode["filterCategory"]["scouts"]?"_active":""),"filter":'["scouts"]',"mouseOverText":getText("category_scouts"),"style":"float:left;"},newdiv);
    } break;
    case 1:{
        for(var i=1;i<=5;i++){
            newdiv1=createElement("div",{"class":"category_f"+i+(mode["filterCategory"]["f"+i]?"_active":"")+" link","filter":'["f'+i+'"]',"mouseOverText":getText("category_f"+i),"style":"display:inline-block;"},newdiv);
        }
    } break;
    case 2:{
        for(var i=0;i<=2;i++){
            newdiv1=createElement("div",{"class":"category_r"+i+(mode["filterCategory"]["r"+i]?"_active":"")+" link","filter":'["r'+i+'"]',"mouseOverText":getText("category_r"+i),"style":"display:inline-block;"},newdiv);
        }
    } break;
    case 3:{
        for(var i=0;i<=2;i++){
            newdiv1=createElement("div",{"class":"category_r"+i+(mode["filterCategory"]["p"+i]?"_active":"")+" link","filter":'["p'+i+'"]',"mouseOverText":getText("category_p"+i),"style":"display:inline-block;"},newdiv);
        }
    } break;
    }

    //the table
    newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:430px;overflow:auto;"},container);
    newtable=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
    newtable.addEventListener("mouseover",function(event){
        var node=event.target;
        var mouseOverText=node.getAttribute("mouseOverText");
        while((node!=this)&&(!mouseOverText)){
            node=node.parentNode;
            mouseOverText=node.getAttribute("mouseOverText");
        }
        if(mouseOverText){ toolTip.show(event,mouseOverText); }
        node=null;mouseOverText=null;
    },false);

    var thead=createElement("thead",{},newtable); // sortable table
    var newtablebody=createElement("tbody",{},newtable);

    var sumwert=0, currProdBlock;
    newtr=createElement("tr",{},thead);
    switch(mode["page"]){
    case 1:{ // prices
        createElement("th",{"colspan":"2"},newtr,getText("product"));
        createElement("th",{},newtr,getText("inventory"));
        createElement("th",{},newtr,"&nbsp;"+getText("NPCprice"));
        createElement("th",{},newtr,"&nbsp;"+getText("observed"));
        createElement("th",{},newtr,getText("marketPrice"));
        createElement("th",{},newtr,getText("afterFee"));

        var prevTyp=null;
        for(var w=0;w<prodNameSort[mode["prodType"]].length;w++){
        try{
            v=prodNameSort[mode["prodType"]][w];
            currProdBlock=prodBlock[mode["prodType"]][v];
            if((!currProdBlock.match(/t/))&&(mode["showAll"]||(!currProdBlock.match(/[lqv]/)))){
                if (mode["filterCategory"][prodTyp[mode["prodType"]][v]]){
                    if(prodTyp[mode["prodType"]][v]!="c"){ sumwert += prodStock[mode["prodType"]][v]*gut[v]; }
                    if((prevTyp!=null)&&(prevTyp!=prodTyp[mode["prodType"]][v])){
                        newtr=createElement("tr",{"class":"hoverBgCc9 borderTop1dashedBlack"},newtablebody);
                    }else{
                        newtr=createElement("tr",{"class":"hoverBgCc9"},newtablebody);
                    }
                    prevTyp=prodTyp[mode["prodType"]][v];

                    newdiv=createElement("td",{},newtr);
                    produktPic(mode["prodType"],v,newdiv);

                    newdiv=createElement("td",{},newtr);
                    newa=createElement("a",{"prodId":v},newdiv,prodName[mode["prodType"]][v]);
                    if(currProdBlock.match(/l/)){
                        newtr.setAttribute("mouseOverText",getText("levelXneeded").replace(/%1%/,/l(\d+)/.exec(currProdBlock)[1]));
                        newa.style.textDecoration="none";
                    }else if(currProdBlock.match(/v/)){
                        newtr.setAttribute("mouseOverText",getText("veterinaryLevelXNeeded").replace(/%1%/,/v(\d+)/.exec(currProdBlock)[1]));
                        newa.style.textDecoration="none";
                    }else if(currProdBlock.match(/t/)){
                        newa.style.textDecoration="none";
                    }else{
                        if(mode["prodType"]==0){
                            newtr.setAttribute("mouseOverText",getText("value")+":&nbsp;"+moneyFormatInt(prodStock[mode["prodType"]][v]*gut[v]));
                            newa.setAttribute("mouseOverText",'<table class="tmenu"><tr><th colspan="2" class="lightBg">'+getText("goToMarketOfX").replace(/%1%/,prodName[mode["prodType"]][v])+'</th></tr><tr><td>'+getText("value")+'</td><td style="text-align:right;">'+moneyFormatInt(prodStock[mode["prodType"]][v]*gut[v])+'</td></table>');
                            newa.setAttribute("class","link");
                            newa.addEventListener("click",function(){showMarket(this.getAttribute("prodId"));},false);
                        }
                    }

                    createElement("td",{"style":"text-align:right;"},newtr,currProdBlock?"<span style='color:red;'>---</span>":(prodStock[mode["prodType"]][v]?numberFormat(prodStock[mode["prodType"]][v]):"-"));
                    newtd=createElement("td",{"style":"text-align:right;"},newtr);
                    if(NPC[mode["prodType"]][v]){
                        if(!isNaN(NPC[mode["prodType"]][v])){
                            newtd.innerHTML=numberFormat(NPC[mode["prodType"]][v],2);
                        }else if (NPC[mode["prodType"]][v].match(/^f/)){
                            newtd.innerHTML="("+numberFormat(parseFloat(NPC[mode["prodType"]][v].replace("f",""),10),2)+")";
                        }else if (NPC[mode["prodType"]][v].match(/^c/)){
                            coinsFormat(parseInt(NPC[mode["prodType"]][v].replace("c",""),10),newtd);
                        }
                        if((npcSaison[v]!=undefined)&&(!npcSaison[v])){
                            newtd.style.textDecoration="line-through";
                            newtd.setAttribute("class","hoverNoTextDecoration");
                        }
                    }else{
                        newtd.innerHTML="&nbsp;";
                    }

                    newtd=createElement("td",{"style":"text-align:right;"},newtr,(gutBeob[v]?numberFormat(gutBeob[v],2):"&nbsp;"));
                    if(preisBeob[v]){
                        if(preisBeob[v][4]>0){
                            newtd.setAttribute("mouseOverText",getFormattedDateStr(preisBeob[v][1])+"&nbsp;"+getDaytimeStr(preisBeob[v][1])+"<br>"+moneyFormat(preisBeob[v][2])+"&nbsp;-&nbsp;"+moneyFormat(preisBeob[v][3])+"<br>#"+numberFormat(preisBeob[v][4]));
                        }else{
                            newtd.setAttribute("mouseOverText",getFormattedDateStr(preisBeob[v][1])+"&nbsp;"+getDaytimeStr(preisBeob[v][1])+"<br>#"+numberFormat(preisBeob[v][4]));
                            newtd.style.textDecoration="line-through";
                            newtd.setAttribute("class","hoverNoTextDecoration");
                        }
                        if(now-preisBeob[v][1]>259200){ // 3 days
                            if(now-preisBeob[v][1]>604800){ // 7 days
                                newtd.style.color="red";
                            }else{
                                newtd.style.color="yellow";
                            }
                        }
                    }else if(!currProdBlock){
                        newtd.setAttribute("mouseOverText","---");
                    }

                    newtd=createElement("td",{"style":"text-align:right;"},newtr);
                    if(valNimmBeob){
                        newtd.innerHTML=numberFormat(gut[v],2);
                    }else{
                        createElement("span",{"style":"font-size:0;"},newtd,numberFormat(gut[v],2));
                        newinput=createElement("input",{"id":"inp"+v,"tabindex":parseInt(w,10)+1,"value":numberFormat(gut[v],2),"class":"text","size":"10","maxlength":"10","style":"text-align:right; background-color:transparent; color:black;"},newtd);
                        newinput.addEventListener("blur",function(){
                            this.value=numberFormat(gut[this.id.replace("inp","")],2);
                        },false);
                        newinput.addEventListener("change",function(){
                            var currId=this.id.replace("inp","");
                            var preis=Math.max(0,parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10));
                            var thisNode=this;
                            var yesFkt = function(){
                                gut[currId]=preis;
                                GM_setValue(COUNTRY+"_"+SERVER+"_gut",implode(gut,"inp.change/gut"));
                                raiseEventTop("gameChangedGut");
                                thisNode.value=numberFormat(preis,2);
                                thisNode.parentNode.nextSibling.innerHTML=numberFormat(0.9*preis,2);
                                thisNode=null;
                            };
                            var noFkt = function(){
                                thisNode.value=numberFormat(gut[currId],2);
                                thisNode=null;
                            };
                            if(preis==0){
                                alert2(getText("alertSetPriceNone").replace(/%PRODUCT%/,prodName[mode["prodType"]][currId]),getText("yes"),getText("no"),yesFkt,noFkt);
                            }else if((!isNaN(NPC[mode["prodType"]][currId]))&&(preis>NPC[mode["prodType"]][currId])){
                                alert2(getText("alertSetPriceOverNPC").replace(/%PRODUCT%/,prodName[mode["prodType"]][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%NPC%/,moneyFormat(NPC[mode["prodType"]][currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                            }else if ((gutBeob[currId]!=undefined)&&(gutBeob[currId]>0)){
                                if(preis<0.7*gutBeob[currId]){
                                    alert2(getText("alertSetPriceUnderObs").replace(/%PRODUCT%/,prodName[mode["prodType"]][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%OBS%/,moneyFormat(gutBeob[currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                                }else if (1.3*gutBeob[currId]<preis){
                                    alert2(getText("alertSetPriceOverObs").replace(/%PRODUCT%/,prodName[mode["prodType"]][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%OBS%/,moneyFormat(gutBeob[currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                                }else{
                                    yesFkt();
                                }
                            }else{
                                yesFkt();
                            }
                            this.style.backgroundColor="transparent";
                        },false);
                    }
                    createElement("td",{"style":"text-align:right;"},newtr,numberFormat(0.9*gut[v],2));
                }
            }
        }catch(err){ GM_logError("buildInfoPanelStock","mode="+implode(mode,"buildInfoPanelStock/mode"),"","v="+v,err); }
        }
    break;}
    case 2:{ // stock
        var valMinRackMan=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackMan",false);
        createElement("th",{"align":"center"},newtr,"&nbsp;");
        newtd=createElement("th",{"align":"left","class":"link hoverBgLightblue","sortdir":"Desc"},newtr,getText("product"));
        newtd=createElement("th",{"align":"right","class":"link hoverBgLightblue","sortdir":"Asc"},newtr,getText("inventory"));
        newtd=createElement("th",{"align":"right","class":"link hoverBgLightblue","sortdir":"Asc"},newtr,"&nbsp;"+getText("value"));
        createElement("th",{"align":"right","style":"padding-right:20px"},newtr,"&nbsp;"+getText("minRack"));
        new SortableTable(newtr);

        for(var w=0;w<prodNameSort[mode["prodType"]].length;w++){
        try{
            v=prodNameSort[mode["prodType"]][w];
            currProdBlock=prodBlock[mode["prodType"]][v];
            if(mode["showAll"]||(!currProdBlock.match(/[lqv]/))){
                if (mode["filterCategory"][prodTyp[mode["prodType"]][v]]){
                    if((mode["prodType"]==0)&&(prodTyp[mode["prodType"]][v]!="c")){ sumwert+=prodStock[mode["prodType"]][v]*gut[v]; }
                    newtr=createElement("tr",{"class":"hoverBgCc9","v":v},newtablebody);

                    newdiv=createElement("td",{},newtr);
                    produktPic(mode["prodType"],v,newdiv);

                    newdiv=createElement("td",{"value":w},newtr);
                    newa=createElement("a",{"prodId":v},newdiv,prodName[mode["prodType"]][v]);
                    if(currProdBlock.match(/l/)){
                        newtr.setAttribute("mouseOverText",getText("levelXneeded").replace(/%1%/,/l(\d+)/.exec(currProdBlock)[1]));
                        newa.style.textDecoration="none";
                    }else if(currProdBlock.match(/v/)){
                        newtr.setAttribute("mouseOverText",getText("veterinaryLevelXNeeded").replace(/%1%/,/v(\d+)/.exec(currProdBlock)[1]));
                        newa.style.textDecoration="none";
                    }else if(currProdBlock.match(/t/)){
                        newa.style.textDecoration="none";
                    }else if(mode["prodType"]==0){
                        newtr.setAttribute("mouseOverText",getText("marketPrice")+":&nbsp;"+moneyFormat(gut[v]));
                        newa.setAttribute("mouseOverText",'<table class="tmenu"><tr><th colspan="2" class="lightBg">'+getText("goToMarketOfX").replace(/%1%/,prodName[mode["prodType"]][v])+'</th></tr><tr><td>'+getText("marketPrice")+'</td><td style="text-align:right;">'+moneyFormat(gut[v])+'</td></table>');
                        newa.setAttribute("class","link");
                        newa.addEventListener("click",function(){showMarket(this.getAttribute("prodId"));},false);
                    }

                    if(currProdBlock.match(/[lv]/)){
                        createElement("td",{"align":"right","value":0},newtr,"<span style='color:red;'>---</span>");
                        createElement("td",{"align":"right","value":0},newtr,"<span style='color:red;'>---</span>");
                    }else if(prodStock[mode["prodType"]][v]){
                        createElement("td",{"align":"right","value":prodStock[mode["prodType"]][v]},newtr,numberFormat(prodStock[mode["prodType"]][v]));
                        if(mode["prodType"]==0&&(!currProdBlock.match(/t/))){
                            createElement("td",{"align":"right","value":prodStock[mode["prodType"]][v]*gut[v]},newtr,numberFormat(prodStock[mode["prodType"]][v]*gut[v]));
                        }else{
                            createElement("td",{"align":"right","value":0},newtr,"-");
                        }
                    }else{
                        createElement("td",{"align":"right","value":0},newtr,"-");
                        createElement("td",{"align":"right","value":0},newtr,"-");
                    }

                    newtd=createElement("td",{"align":"right","style":"padding-right:20px"},newtr);
                    if(valMinRackMan){
                        newinput=createElement("input",{"tabindex":parseInt(w,10)+1,"value":numberFormat(prodMinRackInit[mode["prodType"]][v]),"class":"text","size":"10","maxlength":"10","style":"text-align:right; background-color:transparent; color:black;"},newtd);
                        newinput.addEventListener("blur",function(){
                            this.value=numberFormat(parseInt(this.value.replace(regDelimThou,""),10));
                        },false);
                        newinput.addEventListener("change",function(prodType,currId){ return function(){
                            prodMinRackInit[prodType][currId]=parseInt(this.value.replace(regDelimThou,""),10);
                            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodMinRackInit",implode(prodMinRackInit,"buildInfoPanelStock/prodMinRackInit"));
                            raiseEventTop("gameChangedProdMinRackInit");
                        }}(mode["prodType"],v),false);
                    }else{
                        createElement("span",{},newtd,numberFormat(prodMinRackInit[mode["prodType"]][v]));
                    }
                }
            }
        }catch(err){ GM_logError("buildInfoPanelStock","mode="+implode(mode,"buildInfoPanelStock/mode"),"v="+v,err); }
        }
    break;}
    }
    newtablebody.setAttribute("height",Math.min(361,19*newtablebody.childElementCount)+"px");

    //foot line
    newdiv=createElement("div",{},container);
    newtable=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
    newtr=createElement("tr",{},newtable);
    newtd=createElement("td",{"align":"center"},newtr);
    newdiv=createElement("input",{"type":"checkbox","class":"link","checked":mode["showAll"]},newtd);
    newdiv.addEventListener("click",function(){
        buildInfoPanelStock({"showAll":this.checked});
    },false);
    createElement("span",{},newtd,getText("showAll"));
    newtd=createElement("td",{"align":"center"},newtr);
    if((mode["prodType"]==0)&&(mode["page"]==1)&&(!valNimmBeob)){
        newdiv=createElement("button",{"class":"link button_new","style":"margin-right:10px;"},newtd,getText("takeObservedPrices"));
        newdiv.addEventListener("click",function(){
            alert2(getText("confirmUseObservedPrices"),getText("yes"),getText("no"),function(){
                for(var v=0;v<gutBeob.length;v++){
                    gut[v]=gutBeob[v];
                    if(!isNaN(NPC[0][v])){ gut[v]=Math.min(gut[v],NPC[0][v]); }
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_gut",implode(gut,"buildInfoPanelStock/gut"));
                raiseEventTop("gameChangedGut");
                buildInfoPanelStock();
            });
        },false);
    }
    newtd=createElement("td",{"align":"center","style":"font-weight:bold;"},newtr,getText("stockValue")+":&nbsp;"+moneyFormatInt(sumwert));
    newtable=null;thead=null;newtablebody=null;newtr=null;newtd=null;newdiv=null;newdiv1=null;
}catch(err){ GM_logError("buildInfoPanelStock","mode="+implode(mode,"buildInfoPanelStock/mode"),"",err); }
}
function buildInfoPanelProfit(mode){
try{
    var err_trace="init";
    //GM_log("buildInfoPanelProfit "+implode(mode));
    var modeDefault={"perc":0.9,"showAll":false,"sort":"gut","buildingLevel":{},"feed":{},"filterCategory":{"v":true}};
    var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeProfittable"),"buildInfoPanelProfit/modeOld",modeDefault);
    if(typeof modeOld!="object"){ modeOld=modeDefault; }
    if(typeof mode!="object"){ mode=modeOld; }
    for(var v in modeDefault){
        if(!modeDefault.hasOwnProperty(v)){ continue; }
        if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
    }
    if(!mode["buildingLevel"]["1"]){ mode["buildingLevel"]["1"]=1; }
    // [alternative, fully fed(0/1)]
    err_trace="calc array";
    var profit=new Array();
    var c=-1;
    var help, currBuilding, preis, preisBeob, menge, bonus, currInput;
    for(var v=0;v<prodName[0].length;v++){
        try{
            if((mode["showAll"]||(!prodBlock[0][v]))&&(prodGrowTime[0][v])){
                if(mode["filterCategory"][prodTyp[0][v]]){
                    profit[++c]=new Object();
                    profit[c]["id"]=v;
                    currBuilding=PRODUCT2BUILDING[0][v];
                    if(!mode["buildingLevel"][currBuilding]){ mode["buildingLevel"][currBuilding]=1; }
                    profit[c]["level"]=mode["buildingLevel"][currBuilding];
                    profit[c]["maxlevel"]=BUILDING_UPGRADES[currBuilding].length;
                    if(!mode["showAll"]){
                        while((profit[c]["maxlevel"]>1)&&(USERLEVEL<BUILDING_UPGRADES[currBuilding][profit[c]["maxlevel"]-1][0])){ profit[c]["maxlevel"]--; }
                        profit[c]["level"]=Math.min(profit[c]["level"],profit[c]["maxlevel"]);
                    }
                    bonus=BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][2];
                    switch(BUILDINGTYPE[currBuilding]){
                    case 1:{ // Fields
                        if(questData["main"]["1"]["nr"]>170){ bonus-=0.05; }
                        profit[c]["input"]=[];
                        profit[c]["input"][0]=[[]];
                        profit[c]["dauer"] = calcProductionTime(1,0,v,bonus);
                        profit[c]["runs"]  = 86400/profit[c]["dauer"];
                        preis=gut[v];
                        preisBeob=(gutBeob[v]?gutBeob[v]:0);
                        if(!isNaN(NPC[0][v])){
                            preis=Math.min(NPC[0][v],preis);
                            preisBeob=Math.min(NPC[0][v],preisBeob);
                        }
                        menge=profit[c]["runs"]*(BUILDING_SIZE[currBuilding]/prodPlantSize[0][v]);
                        profit[c]["input"][0][0][0]=[v,menge,preis,preisBeob];
                        profit[c]["menge"] = menge*prodYield[0][v];
                        profit[c]["punkte"]= menge*prodPoints[0][v];
                        help=profit[c]["input"][0][0];
                    break;}
                    case 2:{ // Stable
                        if(!mode["feed"][v]){ mode["feed"][v]=[0,0]; }
                        if(typeof mode["feed"][v][0]!="number"){ mode["feed"][v][0]=0; }
                        if(typeof mode["feed"][v][1]!="number"){ mode["feed"][v][1]=0; }
                        profit[c]["input"]=[];
                        help=[];
                        for(var alt=0;alt<BUILDING_INPUT[currBuilding][v].length;alt++){
                            profit[c]["input"][alt]=[[],[]];
                            help[alt]=[[],[]];
                            help[alt][0]=calcProductionTime(2,0,v,bonus,BUILDING_INPUT[currBuilding][v][alt][0][1]/BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][3]);
                            help[alt][1]=calcProductionTime(2,0,v,bonus,BUILDING_INPUT[currBuilding][v][alt][0][1]/BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][3],1);
                            for(var i=0;i<BUILDING_INPUT[currBuilding][v][alt].length;i++){
                                currInput=BUILDING_INPUT[currBuilding][v][alt][i];
                                preis=gut[currInput[0]];
                                preisBeob=(gutBeob[currInput[0]]?gutBeob[currInput[0]]:0);
                                if(!isNaN(NPC[0][currInput[0]])){
                                    preis=Math.min(NPC[0][currInput[0]],preis);
                                    preisBeob=Math.min(NPC[0][currInput[0]],preisBeob);
                                }
                                menge=help[alt][1][1]*86400/help[alt][1][0];
                                profit[c]["input"][alt][1][i]=[currInput[0],menge,preis,preisBeob];
                                menge=help[alt][0][1]*86400/help[alt][0][0];
                                profit[c]["input"][alt][0][i]=[currInput[0],menge,preis,preisBeob];
                            }
                        }
                        if(!help[mode["feed"][v][0]]){ mode["feed"][v][0]=0; }
                        if(!help[mode["feed"][v][0]][mode["feed"][v][1]]){ mode["feed"][v][1]=0; }
                        profit[c]["dauer"] = help[mode["feed"][v][0]][mode["feed"][v][1]][0];
                        profit[c]["runs"]  = 86400/profit[c]["dauer"];
                        profit[c]["menge"] = profit[c]["runs"]*BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][3]*prodYield[0][v];
                        profit[c]["punkte"]= profit[c]["menge"]*prodPoints[0][v];
                        help=profit[c]["input"][mode["feed"][v][0]][mode["feed"][v][1]];
                    break;}
                    case 3:{ // Factory
                        if(!mode["feed"][v]){ mode["feed"][v]=[0,0]; }
                        if(typeof mode["feed"][v][0]!="number"){ mode["feed"][v][0]=0; }
                        if(typeof mode["feed"][v][1]!="number"){ mode["feed"][v][1]=0; }
                        profit[c]["input"]=[];
                        help=[];
                        for(var alt=0;alt<BUILDING_INPUT[currBuilding][v].length;alt++){
                            profit[c]["input"][alt]=[[]];
                            help[alt]=[[]];
                            help[alt][0][0]=calcProductionTime(3,0,v,bonus);
                            for(var i=0;i<BUILDING_INPUT[currBuilding][v][alt].length;i++){
                                currInput=BUILDING_INPUT[currBuilding][v][alt][i];
                                preis=gut[currInput[0]];
                                preisBeob=(gutBeob[currInput[0]]?gutBeob[currInput[0]]:0);
                                if(!isNaN(NPC[0][currInput[0]])){
                                    preis=Math.min(NPC[0][currInput[0]],preis);
                                    preisBeob=Math.min(NPC[0][currInput[0]],preisBeob);
                                }
                                menge=currInput[1]*86400/help[alt][0][0];
                                profit[c]["input"][alt][0][i]=[currInput[0],menge,preis,preisBeob];
                            }
                        }
                        if(!help[mode["feed"][v][0]]){ mode["feed"][v][0]=0; }
                        if(!help[mode["feed"][v][0]][mode["feed"][v][1]]){ mode["feed"][v][1]=0; }
                        profit[c]["dauer"] = help[mode["feed"][v][0]][mode["feed"][v][1]][0];
                        profit[c]["runs"]  = 86400/profit[c]["dauer"];
                        profit[c]["menge"] = profit[c]["runs"]*BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][3]*prodYield[0][v];
                        profit[c]["punkte"]= profit[c]["menge"]*prodPoints[0][v];
                        help=profit[c]["input"][mode["feed"][v][0]][mode["feed"][v][1]];
                    break;}
                    case 4:{ // Foodworld, flowers
                        profit[c]["input"]=[];
                        profit[c]["input"][0]=[[]];
                        profit[c]["dauer"]=calcProductionTime(BUILDINGTYPE[currBuilding],0,v,bonus);
                        profit[c]["runs"]  = 86400/profit[c]["dauer"];
                        for(var i=0;i<prodRequire[0][v].length;i++){
                            currInput=prodRequire[0][v][i];
                            switch(currInput[0]){
                            case -1:{
                                preis=1;
                                preisBeob=1;
                                menge=currInput[1]*profit[c]["runs"];
                                profit[c]["input"][0][0][i]=[-1,menge,preis,preisBeob];
                            break;}
                            case 0:{
                                preis=gut[currInput[1]];
                                preisBeob=(gutBeob[currInput[1]]?gutBeob[currInput[1]]:0);
                                if(!isNaN(NPC[0][currInput[1]])){
                                    preis=Math.min(NPC[0][currInput[1]],preis);
                                    preisBeob=Math.min(NPC[0][currInput[1]],preisBeob);
                                }
                                menge=currInput[2]*profit[c]["runs"];
                                profit[c]["input"][0][0][i]=[currInput[1],menge,preis,preisBeob];
                            break;}
                            }
                        }
                        profit[c]["menge"] = profit[c]["runs"]*BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][3]*prodYield[0][v];
                        profit[c]["punkte"]= profit[c]["menge"]*prodPoints[0][v];
                        help=profit[c]["input"][0][0];
                    break;}
                    case 6:{ // Fuelstation
                        //BUILDING_UPGRADES : [needed level,buildcost,bonus: nA,animalamount: nA,yield per slot,duration in min]
                        //FUELSTATION_INPUT : [Slotlevel][[Product-Id_1,Points per product],[Product-Id_2,Points per product], ...]
                        profit[c]["input"]=[];
                        profit[c]["input"][0]=[[]];
                        profit[c]["dauer"] = 60*parseInt(BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][5],10); // Value in seconds
                        profit[c]["runs"]  = 86400/profit[c]["dauer"];
                        profit[c]["menge"] = profit[c]["runs"]*BUILDING_UPGRADES[currBuilding][profit[c]["level"]-1][4];
                        profit[c]["punkte"]= profit[c]["menge"]*prodPoints[0][v];
                        help=profit[c]["input"][0][0];
                    break;}
                    default:
                        profit[c]["input"]=[];
                        profit[c]["input"][0]=[[]];
                        profit[c]["dauer"] =24*60*60;
                        profit[c]["runs"]  = 1;
                        profit[c]["menge"] = 1;
                        profit[c]["punkte"]= 0;
                        help=profit[c]["input"][0][0];
                    }
                    menge=profit[c]["menge"];
                    preis=mode["perc"]*gut[v];
                    preisBeob=mode["perc"]*(gutBeob[v]?gutBeob[v]:0);
                    profit[c]["output"]=[v,menge,preis,preisBeob];
                    profit[c]["gut"]=menge*preis
                    profit[c]["gutBeob"]=menge*preisBeob;
                    for(var i=0;i<help.length;i++){
                        profit[c]["gut"]-=help[i][1]*help[i][2];
                        profit[c]["gutBeob"]-=help[i][1]*help[i][3];
                    }

                    // GM_log(prodName[0][v]+":"+implode(profit[c]));
                }
            }
        }catch(err){ GM_logError("buildInfoPanelProfit.calcArray","",'err_trace="'+err_trace+'" v='+v,"Error at calculating data of '"+prodName[0][v]+"': '"+err+"'"); }
    }
    profit.sort(function (a,b){return b[mode["sort"]] - a[mode["sort"]];});
    // console.log("variable:\n"+print_r(profit,"",true,"\n"));

    //head line
    err_trace="head line";
    var table,newtr,newtd,newspan,newdiv,newtable1,newtr1,newtd1;
    var container=$("infoPanelInner");
    container.innerHTML="";
    newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:100px;"},container);
    table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
    newtr=createElement("tr",{},table);
    createElement("td",{"class":"tnormal","style":"color:black;font-weight:bold;text-align:center;position:absolute;top:5px"},newtr,getText("profitTable"));
    // switch bar to filter category
    newtd=createElement("td",{"align":"right"},newtr);
    newdiv=createElement("div",{"style":"-moz-user-select:none;width:375px;"},newtd);
    newdiv.addEventListener("mouseover",function(event){
        var mouseOverText=event.target.getAttribute("mouseOverText");
        if(mouseOverText){
            mouseOverText='<div>'+getText("click")+'&nbsp;/&nbsp;'+getText("clickCtrl")+'</div><div>'+mouseOverText+'</div>';
            toolTip.show(event,mouseOverText);
        }
    },false);
    newdiv.addEventListener("click",function(filterCategory){
    return function(event){
        var thisFilter=explode(event.target.getAttribute("filter"),"buildInfoPanelProfit\thisFilter");
        if(thisFilter){
            if(event.ctrlKey){
                for(var i=thisFilter.length-1;i>-1;i--){
                    if(filterCategory[thisFilter[i]]){
                        delete filterCategory[thisFilter[i]];
                    }else{
                        filterCategory[thisFilter[i]]=true;
                    }
                }
            }else{
                filterCategory={};
                for(var i=thisFilter.length-1;i>-1;i--){
                    filterCategory[thisFilter[i]]=true;
                }
            }
            buildInfoPanelProfit({"filterCategory":filterCategory});
        }
    }}(mode["filterCategory"]),false);
    createElement("div",{"class":"link rackcat1v"+(mode["filterCategory"]["v","ex","alpin","water"]?"_active":""),"filter":'["v","ex","alpin","water"]',"mouseOverText":getText("category_v"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat1e"+(mode["filterCategory"]["e","tea"]?"_active":""),"filter":'["e","tea"]',"mouseOverText":getText("category_e"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat10"+(mode["filterCategory"]["o"]?"_active":""),"filter":'["o"]',"mouseOverText":getText("category_o"),"style":"float:left;"},newdiv);
    newdiv1=createElement("div",{"style":"float:left;width:53px;"},newdiv);
    for(var i=1;i<=4;i=i+2){
        createElement("div",{"class":"link rackcat2"+i+(mode["filterCategory"]["fw"+i]?"_active":""),"filter":'["fw'+i+'"]',"mouseOverText":getText("category_fw"+i),"style":"float:left;"},newdiv1);
        if(i==3){ i=0; }
    }
    createElement("div",{"class":"link rackcat30fl"+(mode["filterCategory"]["fl"]?"_active":""),"filter":'["fl"]',"mouseOverText":getText("category_fl"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat30fla"+(mode["filterCategory"]["fla"]?"_active":""),"filter":'["fla"]',"mouseOverText":getText("category_fla"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60hr"+(mode["filterCategory"]["hr"]?"_active":""),"filter":'["hr"]',"mouseOverText":getText("category_hr"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60md"+(mode["filterCategory"]["md"]?"_active":""),"filter":'["md"]',"mouseOverText":getText("category_md"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60breed"+(mode["filterCategory"]["breed"]?"_active":""),"filter":'["breed"]',"mouseOverText":getText("category_breed"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60cow"+(mode["filterCategory"]["cow"]?"_active":""),"filter":'["cow"]',"mouseOverText":getText("category_cow"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60fish"+(mode["filterCategory"]["fish"]?"_active":""),"filter":'["fish"]',"mouseOverText":getText("category_fish"),"style":"float:left;"},newdiv);
    createElement("div",{"class":"link rackcat60scouts"+(mode["filterCategory"]["scouts"]?"_active":""),"filter":'["scouts"]',"mouseOverText":getText("category_scouts"),"style":"float:left;"},newdiv);

    // the table
        err_trace="table";
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:440px;width:100%;overflow:auto;"},container);
        table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
        table.addEventListener("mouseover",function(event){
            var node=event.target;
            var mouseOverText=node.getAttribute("mouseOverText");
            while((node!=this)&&(!mouseOverText)){
                node=node.parentNode;
                mouseOverText=node.getAttribute("mouseOverText");
            }
            if(mouseOverText){ toolTip.show(event,mouseOverText); }
            node=null;mouseOverText=null;
        },false);

        err_trace="tablehead";
        newtr=createElement("tr",{"style":"color:black;"},table);
        newtd=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="product"?" sortableColDesc":"")},newtr,getText("product"));
        newtd.addEventListener("click",function(){
            buildInfoPanelProfit({"sort":"product"});
        },false);
        newtd=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="dauer"?" sortableColDesc":"")},newtr,getText("duration"));
        newtd.addEventListener("click",function(){
            buildInfoPanelProfit({"sort":"dauer"});
        },false);
        newtd=createElement("th",{"style":"border-bottom:1px dashed black;"},newtr);
        newtd=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="punkte"?" sortableColDesc":"")},newtr,getText("points"));
        newtd.addEventListener("click",function(){
            buildInfoPanelProfit({"sort":"punkte"});
        },false);
        newtd=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="gut"?" sortableColDesc":"")},newtr,getText("prices"));
        newtd.addEventListener("click",function(){
            buildInfoPanelProfit({"sort":"gut"});
        },false);
        newtd=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="gutBeob"?" sortableColDesc":"")},newtr,getText("observed"));
        newtd.addEventListener("click",function(){
            buildInfoPanelProfit({"sort":"gutBeob"});
        },false);

        err_trace="tablebody";
        for(var v=0;v<profit.length;v++){
            try{
                var buildingNr=PRODUCT2BUILDING[0][profit[v]["id"]];
                var buildingName=getBuildingName(buildingNr);
                newtr=createElement("tr",{"nr":v,"prod":profit[v]["id"],"class":"hoverBgCc9","style":"color:black;"},table);
                newtd=createElement("td",{},newtr);
                newtd=createElement("div",{"style":"position:relative;height:100%;"},newtd);
                produktPic(0,profit[v]["id"],newtd);
                    newtable1=createElement("table");
                    newtr1=createElement("tr",{},newtable1);
                    createElement("td",{},newtr1,getText("dailyYield"));
                    createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,numberFormat(profit[v]["menge"],1));
                    newtr1=createElement("tr",{},newtable1);
                    createElement("td",{},newtr1,getText("yield"));
                    createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,numberFormat(profit[v]["menge"]/profit[v]["runs"]));
                    newtr1=createElement("tr",{},newtable1);
                    createElement("td",{},newtr1,getText("dailyRuns"));
                    createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,numberFormat(profit[v]["runs"],3));
                newspan=createElement("span",{"class":"link","data":newtable1.innerHTML},newtd,prodName[0][profit[v]["id"]]);
                newspan.addEventListener("mouseover",function(event){
                    showGoToMarketToolTip(event,this.parentNode.parentNode.parentNode.getAttribute("prod"),this.getAttribute("data"));
                },false);
                newspan.addEventListener("click",function(){
                    showMarket(this.parentNode.parentNode.parentNode.getAttribute("prod"));
                },false);
                if(typeof profit[v]["level"]=="number"){
                    help=mode["buildingLevel"].clone();
                    help[buildingNr]=(profit[v]["level"]+1)%(profit[v]["maxlevel"]+1);
                    newspan=createElement("span",{"mouseOverText":"<table cellspacing=0><tr><th class='lightBg'>"+buildingName+"</th></tr><tr><td>"+getText("upgradeLevel")+"</td></tr><tr><td>("+getText("clickToChange")+")</td></tr></table>","class":"link","nextLevel":implode(help,"nextLevel")},newtd); // ,"mouseOverText":"max "+profit[v]["maxlevel"]
                    for(var w=1;w<=profit[v]["maxlevel"];w++){ createElement("img",{"src":w<=profit[v]["level"]?GFX+"star.png":IMAGES["starGrey"]},newspan); }
                    newspan.addEventListener("click",function(){
                        var prod=this.parentNode.parentNode.parentNode.getAttribute("prod");
                        var nextLevel=explode(this.getAttribute("nextLevel"),"nextLevel.click",{});
                        buildInfoPanelProfit({"jumpTo":prod,"buildingLevel":nextLevel});
                    },false);
                }
                if(profit[v]["input"]&&(profit[v]["input"].length>1)){
                    newspan=produktPic(0,profit[v]["input"][mode["feed"][profit[v]["id"]][0]][mode["feed"][profit[v]["id"]][1]][0][0],newtd);
                    newdiv=createElement("div");
                    newtable1=createElement("table",{"cellspacing":0},newdiv);
                    newtr1=createElement("tr",{},newtable1);
                    createElement("th",{"colspan":2,"class":"lightBg"},newtr1,buildingName);
                    newtr1=createElement("tr",{},newtable1);
                    createElement("td",{"colspan":2},newtr1,getText("feed")+":");
                    for(var i=0;i<profit[v]["input"].length;i++){
                        for(var j=0;j<profit[v]["input"][i].length;j++){
                            newtr1=createElement("tr",{},newtable1);
                            var help=((profit[v]["input"].length>1)&&(mode["feed"][profit[v]["id"]][0]==i)&&(mode["feed"][profit[v]["id"]][1]==j))?"background-color:#BB6600;":"";
                            createElement("td",{"style":"text-align:right;"+help},newtr1,numberFormat(profit[v]["input"][i][j][0][1],1));
                            createElement("td",{"style":help},newtr1,prodName[0][profit[v]["input"][i][j][0][0]]);
                        }
                    }
                    newtr1=createElement("tr",{},newtable1);
                    createElement("td",{"colspan":2},newtr1,"("+getText("clickToChange")+")");
                    newspan.setAttribute("class",newspan.getAttribute("class")+" link");
                    help=mode["feed"].clone();
                    if(1+mode["feed"][profit[v]["id"]][1]<profit[v]["input"][mode["feed"][profit[v]["id"]][0]].length){
                        help[profit[v]["id"]]=[help[profit[v]["id"]][0],1+help[profit[v]["id"]][1]];
                    }else if(1+mode["feed"][profit[v]["id"]][0]<profit[v]["input"].length){
                        help[profit[v]["id"]]=[1+help[profit[v]["id"]][0],0];
                    }else{
                        help[profit[v]["id"]]=[0,0];
                    }
                    newspan.setAttribute("nextFeed",implode(help,"nextFeed.click"));
                    profit[v]["input"][mode["feed"][profit[v]["id"]][0]][mode["feed"][profit[v]["id"]][1]]
                    newspan.addEventListener("click",function(){
                        var prod=this.parentNode.parentNode.parentNode.getAttribute("prod");
                        var nextFeed=explode(this.getAttribute("nextFeed"),"nextFeed.click",{});
                        buildInfoPanelProfit({"jumpTo":prod,"feed":nextFeed});
                    },false);
                    newspan.setAttribute("mouseOverText",newdiv.innerHTML);
                }
                createElement("td",{"style":"text-align:right;"},newtr,getTimeStr(profit[v]["dauer"],1));

                createElement("td",{"style":"text-align:right;"},newtr,getDaytimeStr(now+profit[v]["dauer"],1)+"&nbsp;"+getText("shortOClock"));
                newdiv=createElement("div");
                newtable1=createElement("table",{"cellspacing":0},newdiv);
                newtr1=createElement("tr",{},newtable1);
                createElement("th",{"colspan":2,"class":"lightBg"},newtr1,buildingName);
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{},newtr1,getText("points"));
                createElement("td",{"style":"padding-left:10px;"},newtr1,numberFormat(profit[v]["punkte"]/profit[v]["runs"]));
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{},newtr1,getText("dailyRuns"));
                createElement("td",{},newtr1,numberFormat(profit[v]["runs"],3));
                createElement("td",{"style":"text-align:right;padding-left:10px;","mouseOverText":newdiv.innerHTML},newtr,numberFormat(profit[v]["punkte"]));

                newdiv=createElement("div");
                newtable1=createElement("table",{"cellspacing":0},newdiv);
                newtr1=createElement("tr",{},newtable1);
                createElement("th",{"colspan":6,"class":"lightBg"},newtr1,buildingName);
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{"colspan":4},newtr1);
                createElement("td",{"colspan":2,"style":"text-align:center;"},newtr1,getText("observed"));
                if(profit[v]["input"]){
                    if(profit[v]["input"].length>1){
                        help=profit[v]["input"][mode["feed"][profit[v]["id"]][0]][mode["feed"][profit[v]["id"]][1]];
                    }else{
                        help=profit[v]["input"][0][0];
                    }
                    for(var j=0;j<help.length;j++){
                        newtr1=createElement("tr",{},newtable1);
                        if(prodName[0][help[j][0]]){
                            createElement("td",{"style":"text-align:right;"},newtr1,numberFormat(help[j][1]/profit[v]["runs"]));
                            createElement("td",{},newtr1,prodName[0][help[j][0]]);
                            createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,"("+moneyFormat(help[j][2])+")");
                            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormatInt(-help[j][1]*help[j][2]/profit[v]["runs"]));
                            createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,"("+moneyFormat(help[j][3])+")");
                            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormatInt(-help[j][1]*help[j][3]/profit[v]["runs"]));
                        }else{
                            createElement("td",{"colspan":3},newtr1);
                            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormatInt(-help[j][1]*help[j][2]/profit[v]["runs"]));
                            createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1);
                            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormatInt(-help[j][1]*help[j][3]/profit[v]["runs"]));
                        }
                    }
                }
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{"style":"text-align:right;"},newtr1,numberFormat(profit[v]["output"][1]/profit[v]["runs"]));
                createElement("td",{},newtr1,prodName[0][profit[v]["output"][0]]);
                createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,"("+moneyFormat(profit[v]["output"][2])+")");
                createElement("td",{"style":"border-bottom:1px solid black;text-align:right;"},newtr1,moneyFormatInt(profit[v]["output"][1]*profit[v]["output"][2]/profit[v]["runs"]));
                createElement("td",{"style":"text-align:right;padding-left:10px;"},newtr1,"("+moneyFormat(profit[v]["output"][3])+")");
                createElement("td",{"style":"border-bottom:1px solid black;text-align:right;"},newtr1,moneyFormatInt(profit[v]["output"][1]*profit[v]["output"][3]/profit[v]["runs"]));
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{"style":"border-bottom:1px solid black;","colspan":3},newtr1);
                createElement("td",{"style":"border-bottom:1px solid black;text-align:right;"},newtr1,moneyFormatInt(profit[v]["gut"]/profit[v]["runs"]));
                createElement("td",{"style":"border-bottom:1px solid black;padding-left:10px;"},newtr1);
                createElement("td",{"style":"border-bottom:1px solid black;text-align:right;"},newtr1,moneyFormatInt(profit[v]["gutBeob"]/profit[v]["runs"]));
                newtr1=createElement("tr",{},newtable1);
                createElement("td",{"colspan":2},newtr1,getText("dailyRuns"));
                createElement("td",{"colspan":4,"style":"padding-left:10px;"},newtr1,numberFormat(profit[v]["runs"],3));
                createElement("td",{"style":"text-align:right;","mouseOverText":newdiv.innerHTML},newtr,moneyFormatInt(profit[v]["gut"]));
                createElement("td",{"style":"text-align:right;","mouseOverText":newdiv.innerHTML},newtr,moneyFormatInt(profit[v]["gutBeob"]));

                if(mode["jumpTo"]&&(mode["jumpTo"]==profit[v]["id"])){
                    delete mode["jumpTo"];
                    table.scrollTop=newtr.offsetTop;
                    newspan=createElement("div",{"id":"vanishDiv","style":"position:absolute;top:0;left:0;height:15px;width:100%;background-color:blue;opacity:0.7;"},newtr.firstElementChild.firstElementChild);
                    var intervalVanishDiv=window.setInterval(function(){
                        try{
                            var div=$("vanishDiv");
                            if(div){
                                var opac=parseFloat(div.style.opacity,10)-0.05;
                                if(opac>0){ div.style.opacity=opac; }
                                else{
                                    removeElement(div);
                                    window.clearInterval(intervalVanishDiv);
                                }
                            }else{ window.clearInterval(intervalVanishDiv); }
                        }catch(err){}
                    },100);
                }
            }catch(err){ GM_logError("buildInfoPanelProfit.tablebody","",'err_trace="'+err_trace+'" v='+v,"Error at displaying data of '"+prodName[0][profit[v]["id"]]+"': '"+err+"'"); }
        }

        // foot line
        err_trace="foot line";
        newdiv=createElement("div",{},container);
        table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},newdiv);
        newtr=createElement("tr",{},table);
        newtd=createElement("td",{"align":"center"},newtr);
        newspan=createElement("input",{"type":"checkbox","class":"link","checked":mode["showAll"]},newtd);
        newspan.addEventListener("click",function(){
            buildInfoPanelProfit({"showAll":this.checked});
        },false);
        createElement("span",{},newtd,getText("showAll"));

        newtd=createElement("td",{"align":"center"},newtr);
        newspan=createElement("input",{"type":"checkbox","class":"link","checked":(mode["perc"]==0.9)},newtd);
        newspan.addEventListener("click",function(){
            buildInfoPanelProfit({"perc":this.checked?0.9:1});
        },false);
        createElement("span",{},newtd,"90%");

        err_trace="saving";
        container=null;table=null;newtr=null;newtd=null;newspan=null;newdiv=null;newtable1=null;newtr1=null;newtd1=null;
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeProfittable",implode(mode,"buildInfoPanelProfit/modeProfittable"));
    }catch(err){ GM_logError("buildInfoPanelProfit","",'err_trace="'+err_trace+'" v='+v,err); }
}
function buildInfoPanelQuests(mode){
try{
    var err_trace="init";
    var modeDefault={"type":"main","campaign":"1","sort":"product"};
    var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeQuestsTable"),"buildInfoPanelQuests/modeOld",modeDefault);
    if(typeof modeOld!="object"){ modeOld=modeDefault; }
    if(typeof mode!="object"){ mode=modeOld; }
    for(var v in modeDefault){
        if(!modeDefault.hasOwnProperty(v)){ continue; }
        if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
    }
    if(QUESTS[mode["type"]]===undefined){ mode["type"]="main"; }
    if(QUESTS[mode["type"]][mode["campaign"]]===undefined){ mode["campaign"]="1"; }

    //head line
    err_trace="head line";
    var help;
    var table,tr,td,span,div,div1,table1,tr1,td1,tr2,td2;
    var container=$("infoPanelInner");
    container.innerHTML="";
    table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%;"},container);
    tr=createElement("tr",{},table);
    createElement("td",{"class":"tnormal","style":"color:black;font-weight:bold;text-align:center;"},tr,getText("quests"));
    // switch bar
    td=createElement("td",{},tr);
    td=createElement("div",{"style":"float:right"},td);
    for(var type in QUESTS){
        if(!QUESTS.hasOwnProperty(type)){ continue; }
        for(var campaign in QUESTS[type]){
            if(!QUESTS[type].hasOwnProperty(campaign)){ continue; }
            // createElement("td",{"class":"link hoverBgLightbrown","style":""+((type==mode["type"])&&(campaign==mode["campaign"])?"background-color:lightblue;":"")},tr2,campaign);
            div=createElement("div",{"class":"link quests_status_bar_item quests_status_bar_"+type+campaign+(((type==mode["type"])&&(campaign==mode["campaign"]))?"_active":""),"style":"-moz-user-select:none;display:block;","next":implode({"type":type,"campaign":campaign},"buildInfoPanelQuests/next")},td);
            div.addEventListener("mouseover",function(event){
                var help=explode(this.getAttribute("next"),"buildInfoPanelQuests/next");
                toolTip.show(event,getText("quest"+help["type"]+help["campaign"]));
            },false);
            div.addEventListener("click",function(event){
                buildInfoPanelQuests(explode(this.getAttribute("next"),"buildInfoPanelQuests/next"));
            },false);
            if(questData[type]&&questData[type][campaign]&&(questData[type][campaign]["nr"]==-1)){
                createElement("div",{"class":"rack_lock_page","style":"transform:scale(0.7);"},div);
            }
        }
        // createElement("td",{"style":"width:100px;","colspan":help},tr1,getText(type=="main"?"farm":type));
    }
    // quest table
    err_trace="table";
    div=createElement("div",{"style":"height:300px;width:100%;font-color:black;overflow:auto;border-top:1px solid black;","id":"questTable"},container);
    table=createElement("table",{"border":"0","cellspacing":"0","style":"width:100%; table-layout: fixed","class":"black"},div);

    err_trace="table.head";
    tr=createElement("tr",{},table);
    td=createElement("th",{"style":"width:5%"},tr,getText("nr"));
    td=createElement("th",{"style":"width:40%"},tr,getText("demand"));
    td=createElement("th",{"style":"width:30%","colspan":"2"},tr,getText("value"));
    td=createElement("th",{},tr,getText("reward"));

    err_trace="table.body";
    var questCurr,item,str,mouseOver;
    var questDone,questTotal={};
    for(var v=1;v<QUESTS[mode["type"]][mode["campaign"]].length;v++){
        if(questCurr=QUESTS[mode["type"]][mode["campaign"]][v]){
            tr=createElement("tr",{"class":"hoverBgCc9 borderBottom1dashedGrey"},table); // white-space:nowrap;
            if((!questData[mode["type"]])||(!questData[mode["type"]][mode["campaign"]])){
                questDone = true;
            }else if(questData[mode["type"]][mode["campaign"]]["nr"]>v){
                questDone = true;
                tr.style.opacity=0.6;
            }else if(questData[mode["type"]][mode["campaign"]]["nr"]==v){
                questDone = false;
                tr.style.backgroundColor="lightblue";
            }else{
                questDone = false;
            }
            createElement("td",{},tr,v);
            td=createElement("td",{},tr); // icon, name
            td1=createElement("td",{"style":"padding-right:10px;text-align:right;"},tr); // amount
            td2=createElement("td",{"style":"padding-right:10px;text-align:right;"},tr); // value
            for(var i=0;i<questCurr[0].length;i++){
                if(questCurr[0][i]){
                    if(typeof questCurr[0][i][0]=="object"){
                        help=[null,null,];
                        for(var j=0;j<questCurr[0][i].length;j++){
                            item=questCurr[0][i][j];
                            if((item[0]==0)&&(!prodBlock[0][item[1]].match(/t/))){
                                help[2]=(item[2]*gut[item[1]]);
                            }else{
                                help[2]=0;
                            }
                            if((help[1]==null)||(help[2]<help[1])){
                                help[0]=j;
                                help[1]=help[2];
                            }
                        }
                        for(var j=0;j<questCurr[0][i].length;j++){
                            item=questCurr[0][i][j];
                            str="font-style:italic;"
                            if(j!=help[0]){
                                str+="text-decoration:line-through;";
                                mouseOver=false;
                            }else if(questDone){
                                mouseOver=false;
                            }else{
                                if(!questTotal[item[0]]){ questTotal[item[0]]={}; }
                                if(!questTotal[item[0]][item[1]]){ questTotal[item[0]][item[1]]=0; }
                                questTotal[item[0]][item[1]]+=item[2];
                                mouseOver=true;
                            }
                            div=createElement("div",{"prod":item[1],"style":str},td);
                            if(prodBlock[item[0]][item[1]].match(/[lq]/)){
                                div.classList.add("red");
                                div.addEventListener("mouseover",function(event){ toolTip.show(event,getText("levelTooLow")); },false); // TODO: correct text if blocked by quest
                            }else if((item[0]==0)&&(!prodBlock[0][item[1]].match(/t/))){
                                div.classList.add("link");
                                div.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                                div.addEventListener("click",function(){ showMarket(this.getAttribute("prod")); },false);
                            }
                            produktPic(item[0],item[1],div);
                            createElement("span",{"style":str},div,prodName[item[0]][item[1]]);
                            div=createElement("div",{"style":str},td1,numberFormat(item[2]));
                            if(mouseOver){
                                div.style.color=(prodStock[item[0]][item[1]]<questTotal[item[0]][item[1]]?"red":"green");
                                div.setAttribute("data",implode([item,questTotal[item[0]][item[1]]],"buildInfoPanelQuests/data"));
                                div.addEventListener("mouseover",function(event){
                                    var data=explode(this.getAttribute("data"),"buildInfoPanelQuests/data");
                                    var container,table,tr;
                                    container=createElement("div");
                                    table=createElement("table",{},container);
                                    tr=createElement("tr",{},table);
                                    createElement("td",{},tr,getText("inventory"));
                                    createElement("td",{"style":"text-align:right;"},tr,numberFormat(prodStock[data[0][0]][data[0][1]]));
                                    tr=createElement("tr",{"class":"borderBottom1Black"},table);
                                    createElement("td",{},tr,getText("total"));
                                    createElement("td",{"style":"text-align:right;"},tr,numberFormat(data[1]));
                                    tr=createElement("tr",{},table);
                                    createElement("td",{},tr);
                                    createElement("td",{"style":"text-align:right;"},tr,numberFormat(prodStock[data[0][0]][data[0][1]]-data[1]));
                                    toolTip.show(event,container.innerHTML);
                                    data=null;
                                    container=null;table=null;tr=null;
                                },false);
                            }
                            createElement("div",{"style":str},td2,item[0]==0?moneyFormatInt(item[2]*gut[item[1]]):"--");
                        }
                    }else{
                        item=questCurr[0][i];
                        if(questDone){
                            mouseOver=false;
                        }else{
                            if(!questTotal[item[0]]){ questTotal[item[0]]={}; }
                            if(!questTotal[item[0]][item[1]]){ questTotal[item[0]][item[1]]=0; }
                            questTotal[item[0]][item[1]]+=item[2];
                            mouseOver=true;
                        }
                        div=createElement("div",{"prod":item[1]},td);
                        if(prodBlock[item[0]][item[1]].match(/[lq]/)){
                            div.classList.add("red");
                            div.addEventListener("mouseover",function(event){ toolTip.show(event,getText("levelTooLow")); },false); // TODO: correct text if blocked by quest
                        }else if((item[0]==0)&&(!prodBlock[0][item[1]].match(/t/))){
                            div.classList.add("link");
                            div.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                            div.addEventListener("click",function(){ showMarket(this.getAttribute("prod")); },false);
                        }
                        produktPic(item[0],item[1],div);
                        createElement("span",{},div,prodName[item[0]][item[1]]);
                        div=createElement("div",{},td1,numberFormat(item[2]));
                        if(mouseOver){
                            div.style.color=(prodStock[item[0]][item[1]]<questTotal[item[0]][item[1]]?"red":"green");
                            div.setAttribute("data",implode([item,questTotal[item[0]][item[1]]],"buildInfoPanelQuests/data"));
                            div.addEventListener("mouseover",function(event){
                                var data=explode(this.getAttribute("data"),"buildInfoPanelQuests/data");
                                var container,table,tr;
                                container=createElement("div");
                                table=createElement("table",{},container);
                                tr=createElement("tr",{},table);
                                createElement("td",{},tr,getText("inventory"));
                                createElement("td",{"style":"text-align:right;"},tr,numberFormat(prodStock[data[0][0]][data[0][1]]));
                                tr=createElement("tr",{"class":"borderBottom1Black"},table);
                                createElement("td",{},tr,getText("total"));
                                createElement("td",{"style":"text-align:right;"},tr,numberFormat(data[1]));
                                tr=createElement("tr",{},table);
                                createElement("td",{},tr);
                                createElement("td",{"style":"text-align:right;"},tr,numberFormat(prodStock[data[0][0]][data[0][1]]-data[1]));
                                toolTip.show(event,container.innerHTML);
                                data=null;
                                container=null;table=null;tr=null;
                            },false);
                        }
                        createElement("div",{},td2,item[0]==0?moneyFormatInt(item[2]*gut[item[1]]):"--");
                    }
                }
            }
            td=createElement("td",{"style":"white-space:nowrap;"},tr);
            if(questCurr[2]>0){
                div=createElement("div",{},td);
                pointsFormat(questCurr[2],"div",div);  // 70ms
            }
            if(questCurr[3]){
                for(var w=0;w<questCurr[3].length;w++){
                    switch(questCurr[3][w][0]){
                    case 0:{
                        createElement("div",{},td,moneyFormat(questCurr[3][w][1]));
                    break;}
                    case 1:{
                        div=createElement("div",{},td);
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,numberFormat(questCurr[3][w][3])+"&nbsp;"+prodName[questCurr[3][w][1]][questCurr[3][w][2]]);
                    break;}
                    case 2:{
                        createElement("div",{},td,getText("activation")+": "+getText("rackX").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 3:{
                        createElement("div",{},td,getText("activation")+": "+getText("farmX").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 4:{
                        div=createElement("div",{},td);
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,getText("productTimeSaving").replace(/%1%/,questCurr[3][w][3]).replace(/%2%/,prodName[questCurr[3][w][1]][questCurr[3][w][2]]));
                    break;}
                    case 5:{
                        div=createElement("div",{},td);
                        createElement("img",{"src":GFX+"adbonus.gif","style":"border:0;height:15px;"},div);
                        createElement("span",{},div,getText("additionalFarmi").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 6:{
                        createElement("div",{},td,getText("additionalLogCapacity").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 7:{
                        createElement("div",{},td,getText("waterBonus").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 8:{
                        if(DATA_zones[questCurr[3][w][1]]["location"]=="farm"){
                            createElement("div",{},td,getText("activation")+": "+getText("farmzone").replace(/%1%/,1+((questCurr[3][w][1]-1)%6)).replace(/%2%/,Math.ceil(questCurr[3][w][1]/6)));
                        }else{
                            createElement("div",{},td,getText("activation")+": "+zones.getBuildingName(questCurr[3][w][1]));
                        }
                    break;}
                    case 9:{
                        div=createElement("div",{},td);
                        createElement("span",{},div,getText("activation")+": ");
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,prodName[questCurr[3][w][1]][questCurr[3][w][2]]);
                    break;}
                    case 10:{
                        createElement("div",{},td,getText("activation")+": "+getText("wateringFeature"));
                    break;}
                    case 11:{
                        div=createElement("div",{},td);
                        createElement("img",{"src":GFX+"adbonus.gif","style":"border:0;height:15px;"},div);
                        createElement("span",{},div,getText("additionalForestFarmiSlot").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 12:{
                        div=createElement("div",{},td);
                        createElement("span",{},div,unsafeWindow.quest_reward_6+": ");
                        createElement("img",{"src":GFX+"farmhouse/thumbs/"+questCurr[3][w][1]+".jpg","style":"border:0;height:30px;width:30px;"},div);
                    break;}
                    case 13:{
                        div=createElement("div",{},td);
                        createElement("span",{},div,getText("shadowboxitem")+": ");
                        createElement("img",{"src":GFX+"gifts/"+questCurr[3][w][1]+".gif","style":"border:0;height:30px;width:30px;"},div);
                    break;}
                    case 14:{
                        createElement("div",{},td,unsafeWindow.t_vet_quest_bonus["treatment_reduce"].replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 15:{
                        createElement("div",{},td,unsafeWindow.t_vet_quest_bonus["prod_time_reduce"].replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 16:{
                        createElement("div",{},td,unsafeWindow.t_vet_quest_bonus["pat_bandage"].replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 17:{
                        createElement("div",{},td,unsafeWindow.t_vet_quest_bonus["pat_money"].replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 18:{
                        createElement("div",{},td,unsafeWindow.t_vet_quest_bonus["pat_points"].replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 19:{
                        createElement("div",{},td,unsafeWindow.t_foodworld_reward_bonus.replace(/%PERCENT%/,questCurr[3][w][1]));
                    break;}
                    case 20:{
                        createElement("div",{"class":"pets_package"+questCurr[3][w][1],"style":"width:30px; height:30px; background-size:100%;"},td);
                    break;}
                    case 21:{
                        createElement("div",{},td,getText("activation")+": "+getText("buildingNameX").replace(/%1%/,getBuildingName(questCurr[3][w][1])));
                    break;}
                    case 22:{
                        createElement("div",{},td,getText("terrarium").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 23:{
                        createElement("div",{},td,getText("cowracing").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 24:{
                        var keysFish = Object.keys(unsafeWindow.fishing_quest_reward_name);
                        if (questCurr[3][w][1]==3) {
                            createElement("div",{},td,unsafeWindow.fishing_quest_reward_name[keysFish[questCurr[3][w][1]]].replace(/%SLOT%/,questCurr[3][w][2]));
                        } else if(questCurr[3][w][1]==4){
                            createElement("div",{},td,unsafeWindow.fishing_quest_reward_name[keysFish[questCurr[3][w][1]]].replace(/%NAME%/,unsafeWindow.fishing.data.config.items[questCurr[3][w][2]].name));
                        } else {
                            createElement("div",{},td,unsafeWindow.fishing_quest_reward_name[keysFish[questCurr[3][w][1]]].replace(/%PERCENT%/,questCurr[3][w][2]));
                        }
                    break;}
                    case 25:{
                        var keysScouts = Object.keys(unsafeWindow.scouts_quest_reward_name);
                        if (questCurr[3][w][1]==1) {
                            createElement("div",{},td,unsafeWindow.scouts_quest_reward_name[keysScouts[questCurr[3][w][1]]].replace(/%SLOT%/,questCurr[3][w][2]));
                        } else if(questCurr[3][w][1]==2){
                            createElement("div",{},td,unsafeWindow.scouts_quest_reward_name[keysScouts[questCurr[3][w][1]]].replace(/%NAME%/,unsafeWindow.fishing.data.config.items[questCurr[3][w][2]].name));
                        } else {
                            createElement("div",{},td,unsafeWindow.scouts_quest_reward_name[keysScouts[questCurr[3][w][1]]].replace(/%PERCENT%/,questCurr[3][w][2]));
                        }
                    break;}
                    default:{
                        createElement("div",{},td,implode(questCurr[3][w],"buildInfoPanelQuests/selectQuestCalcTo"));
                    }
                    }
                }
            }
        }
    }
    if(questData[mode["type"]]&&questData[mode["type"]][mode["campaign"]]){
        // all quests done
        if(questData[mode["type"]][mode["campaign"]]["nr"]>=QUESTS[mode["type"]][mode["campaign"]].length){
            tr=createElement("tr",{"class":"hoverBgCc9 borderBottom1dashedGrey","style":"color:black;"},table);
            tr.style.backgroundColor="lightblue";
            createElement("td",{},tr,questData[mode["type"]][mode["campaign"]]["nr"]);
            createElement("td",{},tr);
            createElement("td",{},tr);
            createElement("td",{},tr);
        }
        // scroll to current quest
        if(questData[mode["type"]][mode["campaign"]]["nr"]>1){
            window.setTimeout(function(scr){
                $("questTable").scrollTop=scr;
            },0,table.children[Math.min(table.childElementCount,questData[mode["type"]][mode["campaign"]]["nr"])].offsetTop);
        }
    }
    err_trace="select calcTo";
    div=createElement("div",{"style":"height:20px;width:100%;font-color:black;overflow:auto;border-top:1px solid black;"},container);
    createElement("span",{},div,getText("calcTo")+":");
    span = createElement("select",{"id":"selectQuestCalcTo","style":"width:auto;height:18px;margin-left:5px;","mode":implode(mode,"buildInfoPanelQuests/selectQuestCalcTo")},div);
    createElement("option",{"value":-1},span,getText("hide"));
    createElement("option",{"value":0},span,"--");
    for(var i=questData[mode["type"]][mode["campaign"]]["nr"];i<QUESTS[mode["type"]][mode["campaign"]].length;i++){
        createElement("option",{"value":i},span,i);
    }
    span.addEventListener("change",function(){
        if(isNaN(this.value)){return false;}
        var mode=explode(this.getAttribute("mode"),"buildInfoPanelQuests/selectQuestCalcTo");
        setCalcToQuest(mode["type"],mode["campaign"],this.value);
        buildInfoPanelQuestsTotal(mode);
    },false);
    span.value = questData[mode["type"]][mode["campaign"]]["calcTo"];

    err_trace="total table";
    div=createElement("div",{"style":"height:155px;width:100%;overflow:auto;","id":"questTableTotal"},container);
    function buildInfoPanelQuestsTotal(mode){
    try{
        var err_trace="init";
        var modeDefault={"type":"main","campaign":"1","sort":"product"};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeQuestsTable"),"buildInfoPanelQuestsTotal/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        err_trace="calc object";
        var obj=new Object();
        var questCurr,item,help;
        for(var v=questData[mode["type"]][mode["campaign"]]["nr"];v<=questData[mode["type"]][mode["campaign"]]["calcTo"];v++){
            questCurr=QUESTS[mode["type"]][mode["campaign"]][v];
            if(questCurr){
                for(var i=0;i<questCurr[0].length;i++){
                    if(questCurr[0][i]){
                        if(typeof questCurr[0][i][0]=="object"){
                            help=[null,null,];
                            for(var j=0;j<questCurr[0][i].length;j++){
                                item=questCurr[0][i][j];
                                if((item[0]==0)&&(!prodBlock[0][item[1]].match(/t/))){
                                    help[2]=(item[2]*gut[item[1]]);
                                }else{
                                    help[2]=0;
                                }
                                if((help[1]==null)||(help[2]<help[1])){
                                    help[0]=j;
                                    help[1]=help[2];
                                }
                            }
                            item=questCurr[0][i][help[0]];
                        }else{
                            item=questCurr[0][i];
                        }
                        if(!obj[item[0]]){ obj[item[0]]={}; }
                        if(!obj[item[0]][item[1]]){ obj[item[0]][item[1]]=0; }
                        obj[item[0]][item[1]] += item[2];
                    }
                }
            }
        }
        err_trace="calc array";
        var arr=new Array(); // [type,prodId,amount,amountValue,missing,missingValue]
        for(var type in obj){
            if(!obj.hasOwnProperty(type)){continue;}
            for(var prod in obj[type]){
                if(!obj[type].hasOwnProperty(prod)){continue;}
                help=(prodStock[type][prod]?prodStock[type][prod]:0);
                if(obj[type][prod]>help) {
                    help_Menge=obj[type][prod]-help;
                } else {
                    help_Menge=0;
                }
                if((item[0]==0)&&(gut[prod])){
                    arr.push([type,prod,obj[type][prod],obj[type][prod]*gut[prod],help_Menge,help_Menge*gut[prod]]);
                }else{
                    arr.push([type,prod,obj[type][prod],0,help_Menge,0]);
                }
            }
        }
        err_trace="sort array";
        switch(mode["sort"]){
        case "product": arr.sort(function (a,b){ if(a[0]==b[0]){ return(a[1]-b[1]); }else{ return(a[0]-b[0]); } }); break;
        case "absolute": arr.sort(function (a,b){ return(b[2]-a[2]); }); break;
        case "absoluteValue": arr.sort(function (a,b){ return(b[3]-a[3]); }); break;
        case "relative": arr.sort(function (a,b){ if(parseInt(b[4]-a[4],10)>0){ return(b[4]-a[4]); }else{ return(0); }; }); break;
        case "relativeValue": arr.sort(function (a,b){ if(parseInt(b[5]-a[5],10)>0){ return(b[5]-a[5]); }else{ return(0); }; }); break;
        }

        // table
        err_trace="table";
        var container,table,tr,td,div;
        container=$("questTableTotal");
        container.innerHTML="";
        table=createElement("table",{"class":"black","border":"0","cellspacing":"0","style":"width:100%;"},container);
        table.addEventListener("mouseover",function(event){
            var node=event.target;
            var mouseOverText=node.getAttribute("mouseOverText");
            while((node!=this)&&(!mouseOverText)){
                node=node.parentNode;
                mouseOverText=node.getAttribute("mouseOverText");
            }
            if(mouseOverText){ toolTip.show(event,mouseOverText); }
            node=null;mouseOverText=null;
        },false);

        err_trace="table.head";
        tr=createElement("tr",{"class":"borderBottom1dashedBlack"},table);
        td=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="product"?" sortableColDesc":"")},tr,getText("product"));
        td.addEventListener("click",function(){
            buildInfoPanelQuestsTotal({"sort":"product"});
        },false);
        td=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="absolute"?" sortableColDesc":"")},tr,getText("absolute"));
        td.addEventListener("click",function(){
            buildInfoPanelQuestsTotal({"sort":"absolute"});
        },false);
        td=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="absoluteValue"?" sortableColDesc":"")},tr,getText("value"));
        td.addEventListener("click",function(){
            buildInfoPanelQuestsTotal({"sort":"absoluteValue"});
        },false);
        td=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="relative"?" sortableColDesc":"")},tr,getText("relative"));
        td.addEventListener("click",function(){
            buildInfoPanelQuestsTotal({"sort":"relative"});
        },false);
        td=createElement("th",{"class":"link hoverBgCc9"+(mode["sort"]=="relativeValue"?" sortableColDesc":"")},tr,getText("value"));
        td.addEventListener("click",function(){
            buildInfoPanelQuestsTotal({"sort":"relativeValue"});
        },false);

        err_trace="table.body";
        help=null;
        for(var i=0;i<arr.length;i++){
            item=arr[i];
            tr=createElement("tr",{"class":"hoverBgCc9","prod":item[1]},table);
            if(mode["sort"]=="product"){
                if(help==null){
                    help=item[0];
                } else if(help!=item[0]){
                    tr.classList.add("borderTop1dashedBlack");
                    help=item[0];
                }
            }
            if(prodBlock[item[0]][item[1]].match(/[lq]/)){
                tr.classList.add("red");
                tr.addEventListener("mouseover",function(event){ toolTip.show(event,getText("levelTooLow")); },false); // TODO: correct text if blocked by quest
            }else if((item[0]==0)&&(!prodBlock[0][item[1]].match(/t/))){
                tr.classList.add("link");
                tr.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                tr.addEventListener("click",function(){ showMarket(this.getAttribute("prod")); },false);
            }
            td=createElement("td",{"style":"white-space:nowrap;"},tr);
            div=createElement("div",{},td);
            produktPic(item[0],item[1],div);
            createElement("span",{},div,prodName[item[0]][item[1]]);
            createElement("td",{"style":"text-align:right;"},tr,numberFormat(item[2]));
            createElement("td",{"style":"text-align:right;"},tr,item[3]==0?"--":moneyFormatInt(item[3]));
            createElement("td",{"style":"text-align:right;"},tr,numberFormat(item[4]));
            createElement("td",{"style":"text-align:right;"},tr,item[5]==0?"--":moneyFormatInt(item[5]));
        }

        err_trace="saving";
        container=null;table=null;thead=null;tbody=null;tr=null;td=null;span=null;div=null;table1=null;tr1=null;td1=null;tr2=null;td2=null;
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeQuestsTable",implode(mode,"buildInfoPanelQuestsTotal/modeQuestsTable"));
        }catch(err){ GM_logError("buildInfoPanelQuestsTotal","","err_trace="+err_trace,err); }
    }
    buildInfoPanelQuestsTotal(mode);

    err_trace="saving";
    container=null;table=null;thead=null;tbody=null;tr=null;td=null;span=null;div=null;table1=null;tr1=null;td1=null;tr2=null;td2=null;
    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeQuestsTable",implode(mode,"buildInfoPanelQuests/modeQuestsTable"));
    }catch(err){ GM_logError("buildInfoPanelQuests","","err_trace="+err_trace,err); }
}
function buildInfoPanelZones(){
    try{
        var container=$("infoPanelInner");
        container.innerHTML="";
        var c,totalPunkte=0,zoneNrF,points,endDay,help;
        createElement("div",{"class":"tnormal borderBottom1Black","align":"center","style":"line-height:30px;font-weight:bold;"},container,getText("overview"));
        container=createElement("div",{"style":"width:595px;height:485px;overflow:auto;"},container);
        // Zones
        newtable=createElement("table",{"style":"width:100%;","border":"1"},container);
        for(var i in ALL_ZONES){
            if(!ALL_ZONES.hasOwnProperty(i)){ continue; }
            c=0;
            newtr=createElement("tr",{},newtable);
            createElement("th",{"colspan":"6"},newtr,getText(i));
            for(var j=0;j<ALL_ZONES[i].length;j++){
                zoneNrF=ALL_ZONES[i][j];
                if(zones.isProductional(zoneNrF)&&(!zones.getBlock(zoneNrF))){
                    if(c%3==0){
                        newtr=createElement("tr",{"style":"width:100%;"},newtable);
                    }
                    newtd=createElement("td",{"style":"width:33%;","colspan":"2","zoneNrF":zoneNrF,"class":"link hoverBgCc9"},newtr);
                    newtd.addEventListener("mouseover",function(event){
                        toolTip.show(event,toolTipZoneProduction(this.getAttribute("zoneNrF")));
                    },false);
                    newtd.addEventListener("click",function(){
                        closeInfoPanel();
                        goToZone(this.getAttribute("zoneNrF"));
                    },false);
                    newdiv=createElement("div",{"style":"position:relative;top:0;height:70px;overflow:hidden;"},newtd);
                    createElement("div",{"class":"zoneBg70_"+zones.getBuilding(zoneNrF),"style":"position:absolute;opacity:0.3;"},newdiv);
                    newdiv1=createElement("div",{"style":"position:absolute;top:0;height:61px;width:100%;overflow:auto;"},newdiv);
                    newdiv=createElement("div",{},newdiv1);
                    help=zones.getEndtime(zoneNrF);
                    if (help!=NEVER){
                        endDay=countDays(now,help);
                        if(endDay==0){
                            newdiv.innerHTML=getDaytimeStr(help,1)+"&nbsp;"+getText("shortOClock");
                        }else if(getText("day"+endDay,true)){
                            newdiv.innerHTML=getText("day"+endDay)+" "+getDaytimeStr(help,1)+"&nbsp;"+getText("shortOClock");
                        }else{
                            newdiv.innerHTML=new Date(1000*help).toLocaleString();
                        }
                    }else{
                        newdiv.innerHTML=getText("idle");
                    }
                    if (help<now){
                        newdiv.style.textDecoration="blink";
                        newdiv.style.fontWeight="bold";
                    }
                    points=0;
                    if(help=zones.getCrop(zoneNrF)){
                        for(var k=0;k<help.length;k++){
                            newdiv=createElement("div",{"style":"line-height:16px;"},newdiv1);
                            produktPic(help[k][0],help[k][1],newdiv);
                            createElement("div",{"style":"display:inline-block;"},newdiv,numberFormat(help[k][2])+" "+prodName[help[k][0]][help[k][1]]);
                            points += help[k][3];
                        }
                    }else{
                        newdiv=createElement("div",{"style":"line-height:16px;"},newdiv1);
                        createElement("div",{"style":"display:inline-block;"},newdiv,"???");
                    }
                    pointsFormat(points,"div",newdiv1);
                    totalPunkte += points;
                    c++;
                }
            }
        }
        // Total production
        newtable=createElement("table",{"style":"width:100%;margin-top:10px;","border":"1"},container);
        newtr=createElement("tr",{},newtable);
        createElement("th",{},newtr,getText("total"));
        newtd=createElement("th",{"class":"link hoverBgCc9"},newtr,getText("missing"));
        newtd.addEventListener("mouseover",function(event){ toolTip.show(event,getText("toSeedVendor")); },false);
        newtd.addEventListener("click",function(event){
            closeInfoPanel();
            showSeedVendor();
        },false);
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{},newtr);
        var totalErnte=zones.getTotalCrop();
        for(var i in totalErnte){
            if(!totalErnte.hasOwnProperty(i)){ continue; }
            for(var k in totalErnte[i]){
                if(!totalErnte[i].hasOwnProperty(k)){ continue; }
                newdiv=createElement("div",{},newtd);
                produktPic(i,k,newdiv);
                createElement("div",{"style":"display:inline-block;"},newdiv,numberFormat(totalErnte[i][k])+" "+prodName[i][k]);
            }
        }
        pointsFormat(totalPunkte,"div",newtd);
        var newtdfehlt=createElement("td",{},newtr);

        // Farmi overview
        newtable=createElement("table",{"style":"width:100%;margin-top:10px;","border":"1"},container);
        newtr=createElement("tr",{},newtable);
        createElement("th",{},newtr,getText("farmi"));
        createElement("th",{},newtr,getText("products"));
        createElement("th",{},newtr,getText("money"));
        createElement("th",{"colspan":"2"},newtr,getText("value"));
        var farmiNr=-1;
        var farmiCount=0;
        var farmiSum=new Object;
        var farmiCash=0;
        var farmiWert=0;
        while (top.window.wrappedJSObject.farmisinfo[0][++farmiNr]){
            if (!top.window.wrappedJSObject.farmisaway[farmiNr]){
            farmiCount++;
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{"class":"link hoverBgCc9","name":farmiNr},newtr);
            var farmiGfxNr=top.window.wrappedJSObject.farmisinfo[0][farmiNr]["pic"];
            createElement("img",{"src":GFX+"verkauf/kunde_"+farmiGfxNr+"_still.gif","style":"width:"+FARMISIZE[farmiGfxNr][0]+"px;height:"+FARMISIZE[farmiGfxNr][1]+"px;"},newtd);
            newtd.addEventListener("click",function(){
                closeInfoPanel();
                if ($("citymaincontainer").style.display=="block"){
                    unsafeWindow.initZones(1);
                    unsafeWindow.showMain();
                }
                unsafeWindow.showCart(parseInt(this.getAttribute("name"),10));
            },false);
            newtd=createElement("td",{},newtr);
            var cash=parseFloat(top.window.wrappedJSObject.farmisinfo[0][farmiNr]["price"],10);
            var wert=0;
            for(var i=1 ; i <= 7 ; i++){ // 7=maxanzahl produkte pro farmi
                var pid=parseInt(top.window.wrappedJSObject.farmisinfo[0][farmiNr]["p"+i],10);
                var amount=parseInt(top.window.wrappedJSObject.farmisinfo[0][farmiNr]["a"+i],10);
                if((pid > 0) && (amount > 0)){
                    newdiv=createElement("div",{},newtd);
                    produktPic(0,pid,newdiv);
                    newdiv1=createElement("div",{"class":"link hoverBgCc9","style":"display:inline-block;"+(prodStock[0][pid]<amount?"color:red;":""),"prod":pid},newdiv,numberFormat(amount)+"&nbsp;"+prodName[0][pid]);
                    newdiv1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                    newdiv1.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                    if (farmiSum[pid]) farmiSum[pid] += amount;
                    else farmiSum[pid]=amount;
                    wert += amount*gut[pid];
                }
            }
            farmiCash += cash;
            farmiWert += wert;
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{},newtd,moneyFormat(cash));
                createElement("div",{},newtd,numberFormat(100*cash/wert,1)+"%");
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                newdiv=createElement("div",{},newtd,moneyFormat(wert));
                newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"100%"); },false);
                newdiv=createElement("div",{},newtd,moneyFormat(0.9*wert));
                newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"90%"); },false);
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                newdiv=createElement("div",{},newtd,(cash>wert?"+":"")+moneyFormatInt(cash-wert));
                newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"100%"); },false);
                newdiv=createElement("div",{},newtd,(cash>0.9*wert?"+":"")+moneyFormatInt(cash-0.9*wert));
                newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"90%"); },false);
            }
        }
        if (farmiCount>0){
            newtr.setAttribute("class","borderBottom2");
            newtr=createElement("tr",{"class":"borderTop2"},newtable);
            createElement("td",{},newtr);
            newtd=createElement("td",{},newtr);
            for(var v in farmiSum){
                if(!farmiSum.hasOwnProperty(v)){ continue; }
                newdiv=createElement("div",{},newtd);
                produktPic(0,v,newdiv);
                createElement("div",{"style":"display:inline-block;"},newdiv,numberFormat(farmiSum[v])+"&nbsp;"+prodName[0][v]);
            }
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
            createElement("div",{},newtd,moneyFormat(farmiCash));
            createElement("div",{},newtd,numberFormat(100*farmiCash/farmiWert,1)+"%");
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
            newdiv=createElement("div",{},newtd,moneyFormat(farmiWert));
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"100%"); },false);
            newdiv=createElement("div",{},newtd,moneyFormat(0.9*farmiWert));
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"90%"); },false);
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
            newdiv=createElement("div",{},newtd,(farmiCash>farmiWert?"+":"")+moneyFormatInt(farmiCash-farmiWert));
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"100%"); },false);
            newdiv=createElement("div",{},newtd,(farmiCash>0.9*farmiWert?"+":"")+moneyFormatInt(farmiCash-0.9*farmiWert));
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"90%"); },false);
        }else{
            newtr=createElement("tr",{},newtable);
            createElement("td",{"colspan":"6"},newtr,"---");
        }
        for(var w=0;w<prodNameSort[0].length;w++){
            var v=prodNameSort[0][w];
            if((!prodBlock[0][v].match(/t/))&&(!prodBlock[0][v].match(/l/))){
                var amount1=(farmiSum[v]?farmiSum[v]:0)-prodStock[0][v];
                var amount=amount1+prodMinRack[0][v];
                if (amount>0){
                    newdiv=createElement("div",{},newtdfehlt);
                    produktPic(0,v,newdiv);
                    newdiv1=createElement("div",{"style":"display:inline-block;","class":"link hoverBgCc9","name":v},newdiv,numberFormat(amount)+(amount1>0?"&nbsp;("+numberFormat(amount1)+")":"")+"&nbsp;"+prodName[0][v]);
                    newdiv1.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,this.getAttribute("name"));},false);
                    newdiv1.addEventListener("click",function(){showMarket(this.getAttribute("name"));},false);
                }
            }
        }
        newtdfehlt=null;

    }catch(err){GM_logError("buildInfoPanelZones","","",err);}
}
function buildInfoPanelUpjersAds(){
    try{
        var container=$("infoPanelInner");
        container.innerHTML="";
        createElement("div",{"align":"center","style":"font-weight:bold;line-height:30px;"},container,getText("upjersAdvertising"));
        for(var v=0;v<upjersAds.length;v++){
            createElement("div",{"style":"padding:5px;margin:5px;border:1px solid black;"},container,upjersAds[v]);
        }
    }catch(err){GM_logError("buildInfoPanelUpjersAds","","",err);}
}
function buildInfoPanelLottery(mode){
    try{
        var modeDefault={"total":false};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelLottery"),"buildInfoPanelLottery/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelLottery",implode(mode,"buildInfoPanelLottery/mode"));
        // implode data older than last month
        var stichtag=new Date();
        stichtag=Math.round(((new Date(stichtag.getFullYear(),stichtag.getMonth()-1,1)).getTime())/1000);
        var month;
        for(var v=lotteryLog.length-1;v>=0;v--){
            if(lotteryLog[v][0].match(/\d+\.\d+\.\d+/)){
                if(getTime(lotteryLog[v][0])<stichtag){
                    month=/\d+\.(\d+)\.(\d+)/.exec(lotteryLog[v][0]);
                    if(month[1].length==1){
                        month=month[2]+"-0"+month[1];
                    }else{
                        month=month[2]+"-"+month[1];
                    }
                    for(var w=0;w<lotteryLog.length;w++){
                        if(lotteryLog[w][0]==month){ break; }
                    }
                    if(!lotteryLog[w]){
                        lotteryLog[w]=[month,[],[],{},[]];
                    }
                    if(lotteryLog[v][1]>0){
                        if(lotteryLog[v][2]&&(!lotteryLog[v][2].isEmpty())){
                            if(!lotteryLog[w][2][lotteryLog[v][1]]){ lotteryLog[w][2][lotteryLog[v][1]]=0; }
                            lotteryLog[w][2][lotteryLog[v][1]]++;
                            for(var p in lotteryLog[v][2]){
                                if(!lotteryLog[v][2].hasOwnProperty(p)){ continue; }
                                if(!lotteryLog[w][3][p]){ lotteryLog[w][3][p]=0; }
                                lotteryLog[w][3][p] += lotteryLog[v][2][p];
                            }
                        }else{
                            if(!lotteryLog[w][1][lotteryLog[v][1]]){ lotteryLog[w][1][lotteryLog[v][1]]=0; }
                            lotteryLog[w][1][lotteryLog[v][1]]++;
                        }
                    }
                    // lotteryLog[w][2].sortObj(sortObjFunctions["productId"]);
                    if(lotteryLog[v][3]){
                        for(var p=0;p<lotteryLog[v][3].length;p++){
                            if(!lotteryLog[w][4][lotteryLog[v][3][p]]){ lotteryLog[w][4][lotteryLog[v][3][p]]=0; }
                            lotteryLog[w][4][lotteryLog[v][3][p]]++;
                        }
                    }
                    lotteryLog.splice(v,1);
                }
            }
        }
        lotteryLog.sort(sortObjFunctions["date"]);
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog",implode(lotteryLog,"buildInfoPanelLottery/lotteryLog"));

        var container,newdiv,newtable,newtable1,newtr,newtr1,newtd,newinput;
        container=$("infoPanelInner");
        container.innerHTML="";
        // Head
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:30px;"},container);
        newtable=createElement("table",{"class":"tnormal","style":"font-weight:bold;width:100%;"},newdiv);
        newtr=createElement("tr",{},newtable);
        createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},newtr,getText("lotteryLog"));
        newtd=createElement("td",{},newtr);
        newdiv=createElement("div",{"class":"link naviItem"+(!mode["total"]?"Active":"")},newtd,getText("detail"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelLottery({"total":false});
        },false);
        newdiv=createElement("div",{"class":"link naviItem"+(mode["total"]?"Active":"")},newtd,getText("total"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelLottery({"total":true});
        },false);
        // Content
        newdiv=createElement("div",{"style":"height:485px;overflow:auto;"},container);
        newtable=createElement("table",{"style":"line-height:16px;width:100%","border":"1"},newdiv);
        newtr=createElement("tr",{},newtable);
        if(mode["total"]){
            // prepare data
            var lotteryLogTotal=[[],[],{},[]];
            for(var v=lotteryLog.length-1;v>=0;v--){
                if(lotteryLog[v][0].match(/\d+\.\d+\.\d+/)){
                    if(lotteryLog[v][1]>0){
                        if(lotteryLog[v][2]&&(!lotteryLog[v][2].isEmpty())){
                            if(!lotteryLogTotal[1][lotteryLog[v][1]]){ lotteryLogTotal[1][lotteryLog[v][1]]=0; }
                            lotteryLogTotal[1][lotteryLog[v][1]]++;
                            for(var p in lotteryLog[v][2]){
                                if(!lotteryLog[v][2].hasOwnProperty(p)){ continue; }
                                if(!lotteryLogTotal[2][p]){ lotteryLogTotal[2][p]=0; }
                                lotteryLogTotal[2][p] += lotteryLog[v][2][p];
                            }
                        }else{
                            if(!lotteryLogTotal[0][lotteryLog[v][1]]){ lotteryLogTotal[0][lotteryLog[v][1]]=0; }
                            lotteryLogTotal[0][lotteryLog[v][1]]++;
                        }
                    }
                    // lotteryLogTotal[2].sortObj(sortObjFunctions["productId"]);
                    if(lotteryLog[v][3]){
                        for(var p=0;p<lotteryLog[v][3].length;p++){
                            if(!lotteryLogTotal[3][lotteryLog[v][3][p]]){ lotteryLogTotal[3][lotteryLog[v][3][p]]=0; }
                            lotteryLogTotal[3][lotteryLog[v][3][p]]++;
                        }
                    }
                }else{
                    for(var j=0;j<4;j++){
                    if(j==2){ continue; }
                        for(var i=0;i<lotteryLog[v][j+1].length;i++){
                            if(lotteryLog[v][j+1][i]>0){
                                if(!lotteryLogTotal[j][i]){ lotteryLogTotal[j][i]=0; }
                                lotteryLogTotal[j][i] += lotteryLog[v][j+1][i];
                            }
                        }
                    }

                    for(var prod in lotteryLog[v][3]){
                        if(!lotteryLog[v][3].hasOwnProperty(prod)){ continue; }
                        if(!lotteryLogTotal[2][prod]){ lotteryLogTotal[2][prod]=0; }
                        lotteryLogTotal[2][prod] += lotteryLog[v][3][prod];
                    }
                }
            }
            // plot table
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("dailyTicket"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("boughtTickets"));

            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{},newtr);
            newdiv=createElement("div",{"style":"margin-bottom:3px;"},newtd);
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("keptLots")); },false);
            var c=0;
            for(var i=0;i<lotteryLogTotal[0].length;i++){
                if(lotteryLogTotal[0][i]>0){
                    c += lotteryLogTotal[0][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[0][i]);
                }
            }
            if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }

            var changedLots=0;
            newdiv=createElement("div",{"style":""},newtd);
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("exchangedLots")); },false);
            for(var i=0;i<lotteryLogTotal[1].length;i++){
                if(lotteryLogTotal[1][i]>0){
                    changedLots += lotteryLogTotal[1][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[1][i]);
                }
            }
            if(changedLots>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+changedLots+"×"); }

            var c,sum=0;
            newtable1=createElement("table",{"style":"display:inline-block;padding-right:5px;margin-right:5px;","border":"0","cellspacing":"0"},newtd);
            for(var prod in lotteryLogTotal[2]){
                if(!lotteryLogTotal[2].hasOwnProperty(prod)){ continue; }
                newtr1=createElement("tr",{"class":"link hoverBgLightblue","prod":prod},newtable1);
                newtr1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                newtr1.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                produktPic(0,prod,createElement("td",{},newtr1));
                createElement("td",{"style":"text-align:right;"},newtr1,numberFormat(lotteryLogTotal[2][prod]));
                createElement("td",{"style":"padding-right:5px;"},newtr1,prodName[0][prod]);
                c=lotteryLogTotal[2][prod]*gut[prod];
                sum += c;
                createElement("td",{"style":"text-align:right;"},newtr1,moneyFormat(c));
            }
            newtr1=createElement("tr",{},newtable1);
            createElement("td",{"colspan":"2"},newtr1);
            createElement("td",{"style":"border-top:1px solid black;"},newtr1,"∑");
            createElement("td",{"style":"border-top:1px solid black;text-align:right;"},newtr1,moneyFormat(sum));
            newtr1=createElement("tr",{},newtable1);
            createElement("td",{"colspan":"2"},newtr1);
            createElement("td",{},newtr1,"Ø");
            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormat(sum/changedLots));

            c=0;
            newtd=createElement("td",{},newtr);
            for(var i=0;i<lotteryLogTotal[3].length;i++){
                if(lotteryLogTotal[3][i]>0){
                    c += lotteryLogTotal[3][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[3][i]);
                }
            }
            if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }
        }else{
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("day"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("dailyTicket"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("boughtTickets"));

            for(var v=lotteryLog.length-1;v>=0;v--){
                newtr=createElement("tr",{},newtable);
                createElement("td",{},newtr,lotteryLog[v][0]);

                if(lotteryLog[v][0].match(/\d+\.\d+\.\d+/)){
                    newtd=createElement("td",{},newtr);
                    newdiv=createElement("div",{"style":"display:inline-block;margin-right:3px;vertical-align:top;"},newtd);
                    if(lotteryLog[v][1]>0){ createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+lotteryLog[v][1]+".jpg"},newdiv); }
                    if(lotteryLog[v][2]){
                        var c,sum=0;
                        newtable1=createElement("table",{"style":"display:inline-block;border-right:1px solid black;padding-right:5px;margin-right:5px;","border":"0","cellspacing":"0"},newtd);
                        for(var prod in lotteryLog[v][2]){
                            if(!lotteryLog[v][2].hasOwnProperty(prod)){ continue; }
                            newtr1=createElement("tr",{"class":"link hoverBgLightblue","prod":prod},newtable1);
                            newtr1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                            newtr1.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                            produktPic(0,prod,createElement("td",{},newtr1));
                            createElement("td",{"style":"text-align:right;"},newtr1,numberFormat(lotteryLog[v][2][prod]));
                            createElement("td",{"style":"padding-right:5px;"},newtr1,prodName[0][prod]);
                            c=lotteryLog[v][2][prod]*gut[prod];
                            sum += c;
                            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormat(c));
                        }
                        createElement("div",{"style":"display:inline-block;vertical-align:bottom;"},newtd,moneyFormat(sum));
                    }

                    newtd=createElement("td",{},newtr);
                    if(lotteryLog[v][3]){
                        for(var w=0;w<lotteryLog[v][3].length;w++){
                            createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+lotteryLog[v][3][w]+".jpg"},newtd);
                        }
                    }
                }else{
                    newtd=createElement("td",{},newtr);
                    newdiv=createElement("div",{"style":"margin-bottom:3px;"},newtd);
                    newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("keptLots")); },false);
                    var c=0;
                    for(var i=0;i<lotteryLog[v][1].length;i++){
                        if(lotteryLog[v][1][i]>0){
                            c += lotteryLog[v][1][i];
                            newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                            createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                            createElement("span",{},newdiv1,lotteryLog[v][1][i]);
                        }
                    }
                    if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }

                    var changedLots=0;
                    newdiv=createElement("div",{"style":""},newtd);
                    newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("exchangedLots")); },false);
                    for(var i=0;i<lotteryLog[v][2].length;i++){
                        if(lotteryLog[v][2][i]>0){
                            changedLots += lotteryLog[v][2][i];
                            newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                            createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                            createElement("span",{},newdiv1,lotteryLog[v][2][i]);
                        }
                    }
                    if(changedLots>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+changedLots+"×"); }

                    var sum=0;
                    for(var prod in lotteryLog[v][3]){
                        if(!lotteryLog[v][3].hasOwnProperty(prod)){ continue; }
                        newdiv=createElement("div",{"class":"link hoverBgLightblue","prod":prod,"style":"position:relative;display:inline-block;margin-right:3px;"},newtd);
                        newdiv.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                        newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                        produktPic(0,prod,newdiv);
                        createElement("span",{"style":"text-align:right;"},newdiv,numberFormat(lotteryLog[v][3][prod]));
                        c=lotteryLog[v][3][prod]*gut[prod];
                        sum += c;
                    }
                    createElement("div",{},newtd,moneyFormat(sum)+"&nbsp;(Ø"+moneyFormat(sum/changedLots)+")");

                    c=0;
                    newtd=createElement("td",{},newtr);
                    for(var i=0;i<lotteryLog[v][4].length;i++){
                        if(lotteryLog[v][4][i]>0){
                            c += lotteryLog[v][4][i];
                            newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                            createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                            createElement("span",{},newdiv1,lotteryLog[v][4][i]);
                        }
                    }
                    if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }
                }
            }
        }
        container=null;newdiv=null;newtable=null;newtable1=null;newtr=null;newtr1=null;newtd=null;newinput=null;
    }catch(err){GM_logError("buildInfoPanelLottery","","",err);}
}
function buildInfoPanelDonkey(mode){
    try{
        var modeDefault={"total":false};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelDonkey"),"buildInfoPanelDonkey/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelDonkey",implode(mode,"buildInfoPanelDonkey/mode"));
        // implode data older than last month
    try{
        var stichtag=new Date();
        stichtag=Math.round(((new Date(stichtag.getFullYear(),stichtag.getMonth()-1,1)).getTime())/1000);
        var month;
        for(var v=logDonkey.length-1;v>=0;v--){
            for(var w=logDonkey[v][2].length-1;w>=0;w--){
                if(!logDonkey[v][2][w][3]){ logDonkey[v][2][w][3]=1; }
            }
        }
        for(var v=logDonkey.length-1;v>=0;v--){
            if(logDonkey[v][0].match(/\d+\.\d+\.\d+/)){
                if(getTime(logDonkey[v][0])<stichtag){
                    month=/\d+\.(\d+)\.(\d+)/.exec(logDonkey[v][0]);
                    if(month[1].length==1){
                        month=month[2]+"-0"+month[1];
                    }else{
                        month=month[2]+"-"+month[1];
                    }
                    for(var w=0;w<logDonkey.length;w++){
                        if(logDonkey[w][0]==month){ break; }
                    }
                    if(!logDonkey[w]){
                        logDonkey[w]=[month,0,[]];
                    }
                    logDonkey[w][1]+=logDonkey[v][1];
                    for(var i=logDonkey[v][2].length-1;i>=0;i--){
                        for(var j=logDonkey[w][2].length-1;j>=0;j--){
                            if((logDonkey[v][2][i][0]==logDonkey[w][2][j][0])&&(logDonkey[v][2][i][1]==logDonkey[w][2][j][1])&&(logDonkey[v][2][i][2]==logDonkey[w][2][j][2])){
                                logDonkey[w][2][j][3]+=logDonkey[v][2][i][3];
                                break;
                            }
                        }
                        if(j<0){
                            logDonkey[w][2].push(logDonkey[v][2][i]);
                        }
                    }
                    logDonkey.splice(v,1);
                }
            }
        }
        logDonkey.sort(sortObjFunctions["date"]);
        logDonkeyId={};
        for(var v=logDonkey.length-1;v>=0;v--){
            logDonkeyId[logDonkey[v][0]]=v;
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logDonkey",implode(logDonkey,"buildInfoPanelWaltraud/logDonkey"));
    }catch(err){GM_logError("buildInfoPanelWaltraud","","v="+v,"(old data) "+err);}

        var container,newdiv,newtable,newtr,newtd;
        container=$("infoPanelInner");
        container.innerHTML="";
        // Head
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:30px;"},container);
        newtable=createElement("table",{"class":"tnormal","style":"font-weight:bold;width:100%;"},newdiv);
        newtr=createElement("tr",{},newtable);
        createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},newtr,getText("logDonkey"));
        newtd=createElement("td",{},newtr);
        newdiv=createElement("div",{"class":"link naviItem"+(!mode["total"]?"Active":"")},newtd,getText("detail"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelDonkey({"total":false});
        },false);
        newdiv=createElement("div",{"class":"link naviItem"+(mode["total"]?"Active":"")},newtd,getText("total"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelDonkey({"total":true});
        },false);
        // Content
        newdiv=createElement("div",{"style":"height:485px;overflow:auto;"},container);
        newtable=createElement("table",{"style":"line-height:16px;width:100%","border":"1"},newdiv);
        newtr=createElement("tr",{},newtable);
        if(mode["total"]){
        /*
            // prepare data
            var lotteryLogTotal=[[],[],{},[]];
            for(var v=lotteryLog.length-1;v>=0;v--){
                if(lotteryLog[v][0].match(/\d+\.\d+\.\d+/)){
                    if(lotteryLog[v][1]>0){
                        if(lotteryLog[v][2]&&(!lotteryLog[v][2].isEmpty())){
                            if(!lotteryLogTotal[1][lotteryLog[v][1]]){ lotteryLogTotal[1][lotteryLog[v][1]]=0; }
                            lotteryLogTotal[1][lotteryLog[v][1]]++;
                            for(var p in lotteryLog[v][2]){
                                if(!lotteryLog[v][2].hasOwnProperty(p)){ continue; }
                                if(!lotteryLogTotal[2][p]){ lotteryLogTotal[2][p]=0; }
                                lotteryLogTotal[2][p] += lotteryLog[v][2][p];
                            }
                        }else{
                            if(!lotteryLogTotal[0][lotteryLog[v][1]]){ lotteryLogTotal[0][lotteryLog[v][1]]=0; }
                            lotteryLogTotal[0][lotteryLog[v][1]]++;
                        }
                    }
                    // lotteryLogTotal[2].sortObj(sortObjFunctions["productId"]);
                    if(lotteryLog[v][3]){
                        for(var p=0;p<lotteryLog[v][3].length;p++){
                            if(!lotteryLogTotal[3][lotteryLog[v][3][p]]){ lotteryLogTotal[3][lotteryLog[v][3][p]]=0; }
                            lotteryLogTotal[3][lotteryLog[v][3][p]]++;
                        }
                    }
                }else{
                    for(var j=0;j<4;j++){
                    if(j==2){ continue; }
                        for(var i=0;i<lotteryLog[v][j+1].length;i++){
                            if(lotteryLog[v][j+1][i]>0){
                                if(!lotteryLogTotal[j][i]){ lotteryLogTotal[j][i]=0; }
                                lotteryLogTotal[j][i] += lotteryLog[v][j+1][i];
                            }
                        }
                    }

                    for(var prod in lotteryLog[v][3]){
                        if(!lotteryLog[v][3].hasOwnProperty(prod)){ continue; }
                        if(!lotteryLogTotal[2][prod]){ lotteryLogTotal[2][prod]=0; }
                        lotteryLogTotal[2][prod] += lotteryLog[v][3][prod];
                    }
                }
            }
            // plot table
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("dailyTicket"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("boughtTickets"));

            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{},newtr);
            newdiv=createElement("div",{"style":"margin-bottom:3px;"},newtd);
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("keptLots")); },false);
            var c=0;
            for(var i=0;i<lotteryLogTotal[0].length;i++){
                if(lotteryLogTotal[0][i]>0){
                    c += lotteryLogTotal[0][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[0][i]);
                }
            }
            if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }

            var changedLots=0;
            newdiv=createElement("div",{"style":""},newtd);
            newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("exchangedLots")); },false);
            for(var i=0;i<lotteryLogTotal[1].length;i++){
                if(lotteryLogTotal[1][i]>0){
                    changedLots += lotteryLogTotal[1][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[1][i]);
                }
            }
            if(changedLots>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+changedLots+"×"); }

            var c,sum=0;
            newtable1=createElement("table",{"style":"display:inline-block;padding-right:5px;margin-right:5px;","border":"0","cellspacing":"0"},newtd);
            for(var prod in lotteryLogTotal[2]){
                if(!lotteryLogTotal[2].hasOwnProperty(prod)){ continue; }
                newtr1=createElement("tr",{"class":"link hoverBgLightblue","prod":prod},newtable1);
                newtr1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                newtr1.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                produktPic(0,prod,createElement("td",{},newtr1));
                createElement("td",{"style":"text-align:right;"},newtr1,numberFormat(lotteryLogTotal[2][prod]));
                createElement("td",{"style":"padding-right:5px;"},newtr1,prodName[0][prod]);
                c=lotteryLogTotal[2][prod]*gut[prod];
                sum += c;
                createElement("td",{"style":"text-align:right;"},newtr1,moneyFormat(c));
            }
            newtr1=createElement("tr",{},newtable1);
            createElement("td",{"colspan":"2"},newtr1);
            createElement("td",{"style":"border-top:1px solid black;"},newtr1,"∑");
            createElement("td",{"style":"border-top:1px solid black;text-align:right;"},newtr1,moneyFormat(sum));
            newtr1=createElement("tr",{},newtable1);
            createElement("td",{"colspan":"2"},newtr1);
            createElement("td",{},newtr1,"Ø");
            createElement("td",{"style":"text-align:right;"},newtr1,moneyFormat(sum/changedLots));

            c=0;
            newtd=createElement("td",{},newtr);
            for(var i=0;i<lotteryLogTotal[3].length;i++){
                if(lotteryLogTotal[3][i]>0){
                    c += lotteryLogTotal[3][i];
                    newdiv1=createElement("div",{"style":"position:relative;display:inline-block;margin-right:2px;"},newdiv);
                    createElement("img",{"style":"width:20px;border:0;","src":GFX+"city/"+i+".jpg"},newdiv1);
                    createElement("span",{},newdiv1,lotteryLogTotal[3][i]);
                }
            }
            if(c>0){ createElement("div",{"style":"position:relative;display:inline-block;"},newdiv,"&nbsp;=&nbsp;"+c+"×"); }
        */
        }else{
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("day"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("points"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("goods"));

            for(var v=logDonkey.length-1;v>=0;v--){
                newtr=createElement("tr",{},newtable);
                createElement("td",{},newtr,logDonkey[v][0]);
                newtd=createElement("td",{},newtr);
                pointsFormat(logDonkey[v][1],"span",newtd);
                newtd=createElement("td",{},newtr);
                if(logDonkey[v][2]){
                    for(var w=0;w<logDonkey[v][2].length;w++){
                        switch(logDonkey[v][2][w][0]){
                        case 1:{
                            newdiv=createElement("div",{"class":"hoverBgLightblue","prod":logDonkey[v][2][w][2]},newtd);
                            if(logDonkey[v][2][w][1]==0){
                                newdiv.classList.add("link");
                                newdiv.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                                newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                            }
                            produktPic(logDonkey[v][2][w][1],logDonkey[v][2][w][2],newdiv);
                            createElement("span",{},newdiv,numberFormat(logDonkey[v][2][w][3])+"&nbsp;"+prodName[logDonkey[v][2][w][1]][logDonkey[v][2][w][2]]);
                            if((logDonkey[v][2][w][1]==0)&&(gut[logDonkey[v][2][w][2]])){
                                createElement("span",{"style":"padding-left:5px;"},newdiv,"("+moneyFormat(logDonkey[v][2][w][3]*gut[logDonkey[v][2][w][2]])+")");
                            }
                        break;}
                        case 5:{
                            newdiv=createElement("div",{},newtd);
                            createElement("img",{"src":GFX+"adbonus.gif","style":"border:0;height:15px;"},newdiv);
                            createElement("span",{},newdiv,unsafeWindow.t_donkey_farmiadd);
                            if(logDonkey[v][2][w][3]>1){
                                createElement("span",{},newdiv," ("+logDonkey[v][2][w][3]+"x)");
                            }
                        break;}
                        case 12:{
                            newdiv=createElement("div",{},newtd);
                            createElement("span",{},newdiv,unsafeWindow.quest_reward_6+": ");
                            createElement("img",{"src":GFX+"farmhouse/thumbs/"+logDonkey[v][2][w][1]+".jpg","style":"border:0;height:50px;width:50px;"},newdiv);
                            if(logDonkey[v][2][w][3]>1){
                                createElement("span",{},newdiv," ("+logDonkey[v][2][w][3]+"x)");
                            }
                        break;}
                        case 13:{
                            newdiv=createElement("div",{},newtd);
                            createElement("span",{},newdiv,getText("shadowboxitem")+": ");
                            createElement("img",{"src":GFX+"gifts/"+logDonkey[v][2][w][1]+".gif","style":"border:0;height:50px;width:50px;"},newdiv);
                            if(logDonkey[v][2][w][3]>1){
                                createElement("span",{},newdiv," ("+logDonkey[v][2][w][3]+"x)");
                            }
                        break;}
                        }
                    }
                }
            }
        }
        container=null;newdiv=null;newtable=null;newtr=null;newtd=null;
    }catch(err){GM_logError("buildInfoPanelWaltraud","","",err);}
}
function buildInfoPanelClothingDonation(mode){
    try{
        var modeDefault={"total":false};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelClothingDonation"),"buildInfoPanelClothingDonation/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelClothingDonation",implode(mode,"buildInfoPanelClothingDonation/mode"));

        var container,newdiv,newtable,newtr,newtd;
        container=$("infoPanelInner");
        container.innerHTML="";
        // Head
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:30px;"},container);
        newtable=createElement("table",{"class":"tnormal","style":"font-weight:bold;width:100%;"},newdiv);
        newtr=createElement("tr",{},newtable);
        createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},newtr,getText("logClothingDonation"));
        newtd=createElement("td",{},newtr);
        newdiv=createElement("div",{"class":"link naviItem"+(!mode["total"]?"Active":"")},newtd,getText("detail"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelClothingDonation({"total":false});
        },false);
        newdiv=createElement("div",{"class":"link naviItem"+(mode["total"]?"Active":"")},newtd,getText("total"));
        newdiv.addEventListener("click",function(){
            buildInfoPanelClothingDonation({"total":true});
        },false);
        // Content
        newdiv=createElement("div",{"style":"height:485px;overflow:auto;"},container);
        newtable=createElement("table",{"style":"line-height:16px;width:100%","border":"1"},newdiv);
        newtr=createElement("tr",{},newtable);
        if(mode["total"]){
            // Not yet supported
        }else{
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("day"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("donation"));
            createElement("th",{"style":"white-space:nowrap;"},newtr,getText("reward"));

            for(var i=0;i<logClothingDonation.length;i++){
                var v=logClothingDonation[i];
                newtr=createElement("tr",{},newtable);
                createElement("td",{},newtr,
                        getFormattedDateStr(v.createdate)+" ("+getDaytimeStr(v.createdate,true,true)+"h)");
                newtd=createElement("td",{},newtr);
                for (var j in v.in) {
                    if (!v.in.hasOwnProperty(j)) {continue;}

                    newdiv=createElement("div",{"class":"hoverBgLightblue","prod":j},newtd);
                    newdiv.classList.add("link");
                    newdiv.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                    newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                    produktPic(0,j,newdiv);
                    createElement("span",{},newdiv,numberFormat(v.in[j]["amount"])+"&nbsp;"+prodName[0][j]);
                }

                newtd=createElement("td",{},newtr);

                for(var j=0;j<v.gambleInfo.length;j++) {
                    newdiv=createElement("div",{},newtd);
                    var prefixDate=v.gambleInfo[j]["gambledate"]==0?v.createdate:v.gambleInfo[j]["gambledate"];
                    createElement("span",{},newdiv,getFormattedDateStr(prefixDate)+" ("+getDaytimeStr(prefixDate,true,true)+"h): ");
                    var color=v.gambleInfo[j]["gain"]>0?"green":"red";
                    createElement("span",{"style":"color:"+color+";"},newdiv,moneyFormat(v.gambleInfo[j]["gain"]));
                    if(v.gambleInfo[j]["gain"]>0) { // Print products of donation (only)
                        var w=v.gambleInfo[j]["out"]
                        for (var k in w) {
                            if (!w.hasOwnProperty(k)) {continue;}

                            newdiv=createElement("div",{"class":"hoverBgLightblue","prod":k},newtd);
                            newdiv.classList.add("link");
                            newdiv.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                            newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                            produktPic(0,k,newdiv);
                            createElement("span",{},newdiv,numberFormat(w[k]["amount"])+"&nbsp;"+prodName[0][k]);
                        }
                    }
                }
            }
        }
        container=null;newdiv=null;newtable=null;newtr=null;newtd=null;
    }catch(err){GM_logError("buildInfoPanelClothingDonation","","",err);}
}
function buildInfoPanelFarmies(mode){
    try{
        var modeDefault={"limit":95};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelFarmies"),"buildInfoPanelFarmies/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelFarmies",implode(mode,"buildInfoPanelFarmies/mode"));
        var newFarmiumsatz=new Object();
        var totalPrice=0;
        var totalWert=0;
        var totalPriceOk=0;
        var totalWertOk=0;
        var countFarmisOk=0;
        var countFarmisAll=0;
        var totalProducts=new Object();

        var container,newdiv,newtable,newtr,newtd;
        container=$("infoPanelInner");
        container.innerHTML="";
        newdiv=createElement("div",{"style":"height:100%;width:565px;overflow:auto;"},container);
        newtable=createElement("table",{"style":"width:100%","border":"1"},newdiv);
        newtable.addEventListener("mouseover",function(event){
            var node=event.target;
            var mouseOverText=node.getAttribute("mouseOverText");
            while((node!=this)&&(!mouseOverText)){
                node=node.parentNode;
                mouseOverText=node.getAttribute("mouseOverText");
            }
            if(mouseOverText){ toolTip.show(event,mouseOverText); }
            node=null;mouseOverText=null;
        },false);

        // selection bar on the right side
        newdiv1=createElement("div",{"class":"link","style":"position:absolute;top:0;right:0;border:1px solid black;"},container);
        newdiv1.addEventListener("mouseover",function(event){
            var node=event.target;
            var mouseOverText=node.getAttribute("mouseOverText");
            while((node!=this)&&(!mouseOverText)){
                node=node.parentNode;
                mouseOverText=node.getAttribute("mouseOverText");
            }
            if(mouseOverText){ toolTip.show(event,mouseOverText); }
            node=null;mouseOverText=null;
        },false);
        for(var v=200;v>-1;v--){
            newdiv=createElement("div",{"class":"hoverBgRed","style":"width:20px;height:2.5px;","mouseOverText":v+"%"},newdiv1);
            if (v<=mode["limit"]){ newdiv.style.backgroundColor="blue"; }
            if (v==90||v==100) newdiv.style.borderTop="1px solid black";
            newdiv.addEventListener("click",function(){
                buildInfoPanelFarmies({"limit":parseInt(this.getAttribute("mouseOverText"),10)});
            },false);
        }

        // Farmi table
        newtr=createElement("tr",{},newtable);
        createElement("th",{"style":"border-bottom:2px solid black;"},newtr,"");
        createElement("th",{"style":"border-bottom:2px solid black;"},newtr,getText("products"));
        createElement("th",{"style":"border-bottom:2px solid black;"},newtr,getText("money"));
        createElement("th",{"style":"border-bottom:2px solid black;","colspan":"2"},newtr,getText("value"));

        var borderTop;
        var c=0;
        var prev=null;
        for(var v=0;v<farmiLog.length;v++){
            countFarmisAll++;
            newtr=createElement("tr",{"class":"hoverBgCc9"},newtable);
            if (prev==null){
                borderTop="2px solid black;";
                newtd1=createElement("td",{"style":"border-top:"+borderTop},newtr,farmiLog[v][1]);
                c=1;
            }else if (farmiLog[v][1]!=farmiLog[prev][1]){
                borderTop="2px solid black;";
                newtd1.innerHTML += "<br>("+c+")";
                newtd1=createElement("td",{"style":"border-top:"+borderTop},newtr,farmiLog[v][1]);
                c=1;
            }else{
                borderTop="1px solid black;";
                newtd1.rowSpan=++c;
            }
            newtd=createElement("td",{"style":"border-top:"+borderTop},newtr);
            var wert=0;
            for(var w in farmiLog[v][3]){
                if(!farmiLog[v][3].hasOwnProperty(w)){ continue; }
                newdiv=createElement("div",{"style":"line-height:16px;"},newtd);
                produktPic(0,w,newdiv);
                createElement("div",{"style":"display:inline-block;"},newdiv,numberFormat(farmiLog[v][3][w])+"&nbsp;"+prodName[0][w]);
                wert += farmiLog[v][3][w]*gut[w];
            }
            totalPrice += farmiLog[v][2];
            totalWert += wert;
            newtd=createElement("td",{"style":"text-align:right;border-top:"+borderTop},newtr);
                createElement("div",{},newtd,moneyFormatInt(farmiLog[v][2]));
                newdiv=createElement("div",{},newtd,numberFormat(100*farmiLog[v][2]/wert,1)+"%");
                if (100*farmiLog[v][2]>mode["limit"]*wert){
                    countFarmisOk++;
                    for(var w in farmiLog[v][3]){
                        if(!farmiLog[v][3].hasOwnProperty(w)){ continue; }
                        if(totalProducts[w]===undefined){ totalProducts[w]=[0,0]; }
                        totalProducts[w][0]++;
                        totalProducts[w][1]+=farmiLog[v][3][w];
                    }
                    totalPriceOk += farmiLog[v][2];
                    totalWertOk += wert;

                }else{ newdiv.style.backgroundColor="red"; }
            newtd=createElement("td",{"style":"text-align:right;border-top:"+borderTop},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,moneyFormatInt(wert));
                createElement("div",{"mouseOverText":"90%"},newtd,moneyFormatInt(0.9*wert));
            newtd=createElement("td",{"style":"text-align:right;border-top:"+borderTop},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,(farmiLog[v][2]>wert?"+":"")+moneyFormatInt(farmiLog[v][2]-wert));
                createElement("div",{"mouseOverText":"90%"},newtd,(farmiLog[v][2]>0.9*wert?"+":"")+moneyFormatInt(farmiLog[v][2]-0.9*wert));
            if(!newFarmiumsatz[farmiLog[v][1]]){ newFarmiumsatz[farmiLog[v][1]]=0; }
            newFarmiumsatz[farmiLog[v][1]] += farmiLog[v][2];
            prev=v;
        }
        if(countFarmisAll>0){ newtd1.innerHTML += "<br>("+c+")"; }
        for(var v in newFarmiumsatz){
            if(!newFarmiumsatz.hasOwnProperty(v)){ continue; }
            newFarmiumsatz[v]=Math.round(100*newFarmiumsatz[v])/100;
            for(var w=0;w<levelLog.length;w++){
                if(levelLog[w][0]==v){ levelLog[w][5]=newFarmiumsatz[v]; break; } //dont override all because data could be joined to monthly
            }
        }
        GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(levelLog,"buildInfoPanelFarmies/levelLog"),70);
        for(var v in totalProducts){
            if(!totalProducts.hasOwnProperty(v)){ continue; }
            totalProducts[v][2]=totalProducts[v][1]/totalProducts[v][0];
        }

        if(countFarmisAll>0){
            newtr=createElement("tr");
            newtable.insertBefore(newtr,newtable.children[1]);
            createElement("td",{},newtr,getText("total")+"<br>("+countFarmisOk+")");
            newtd=createElement("td",{"id":"tdTotalProducts"},newtr);
            function buildTotalProducts(mode){
                $("tdTotalProducts").innerHTML="";
                var newtable=createElement("table",{cellspacing:"0",cellpadding:"0"},$("tdTotalProducts"));
                var newtr=createElement("tr",{},newtable);
                var newtd=createElement("td",{"class":"link hoverBgLightblue","style":"text-align:center;padding-right:3px;border-bottom:1px solid black;"},newtr,getText("product"));
                if (mode==0){
                    newtd.style.backgroundColor="lightblue";
                    totalProducts.sortObj(sortObjFunctions["int"],true);
                }else{
                    newtd.addEventListener("click",function(){buildTotalProducts(0);},false);
                    totalProducts.sortObj(function(mode){return function(a,b){return (a[1][mode-1]-b[1][mode-1]);}}(mode),true);
                }
                newtd=createElement("td",{"class":"link hoverBgLightblue","style":"text-align:center;border-left:1px solid black;border-bottom:1px solid black;padding-left:3px;padding-right:3px;"},newtr,"×");
                if (mode==1){ newtd.style.backgroundColor="lightblue"; }
                else{
                    newtd.addEventListener("click",function(){buildTotalProducts(1);},false);
                }
                newtd=createElement("td",{"class":"link hoverBgLightblue","style":"text-align:center;border-left:1px solid black;border-bottom:1px solid black;padding-left:3px;padding-right:3px;"},newtr,"∑");
                if (mode==2){ newtd.style.backgroundColor="lightblue"; }
                else{
                    newtd.addEventListener("click",function(){buildTotalProducts(2);},false);
                }
                newtd=createElement("td",{"class":"link hoverBgLightblue","style":"text-align:center;border-left:1px solid black;border-bottom:1px solid black;padding-left:3px;padding-right:3px;"},newtr,"∑/×");
                if (mode==3){ newtd.style.backgroundColor="lightblue"; }
                else{
                    newtd.addEventListener("click",function(){buildTotalProducts(3);},false);
                }
                for(var i=0;i<totalProducts.order.length;i++){
                    var v=totalProducts.order[i];
                    //newdiv=createElement("div",{"style":"line-height:16px;"},newtd);
                    newtr=createElement("tr",{"class":"hoverBgCc9"},newtable);
                    newtd=createElement("td",{"style":"padding-right:3px;"},newtr);
                    produktPic(0,v,newtd);
                    createElement("div",{"style":"display:inline-block;"},newtd,prodName[0][v]);
                    createElement("td",{"style":"text-align:right;border-left:1px solid black;padding-left:3px;padding-right:3px;"},newtr,numberFormat(totalProducts[v][0]));
                    createElement("td",{"style":"text-align:right;border-left:1px solid black;padding-left:3px;padding-right:3px;"},newtr,numberFormat(totalProducts[v][1]));
                    createElement("td",{"style":"text-align:right;border-left:1px solid black;padding-left:3px;padding-right:3px;"},newtr,numberFormat(totalProducts[v][2]));
                }
                newtable=null;newtr=null;newtd=null;
            }
            buildTotalProducts(0);
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{},newtd,moneyFormatInt(totalPriceOk));
                createElement("div",{},newtd,numberFormat(100*totalPriceOk/totalWertOk,1)+"%");
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,moneyFormatInt(totalWertOk));
                createElement("div",{"mouseOverText":"90%"},newtd,moneyFormatInt(0.9*totalWertOk));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,(totalPriceOk>totalWertOk?"+":"")+moneyFormatInt(totalPriceOk-totalWertOk));
                createElement("div",{"mouseOverText":"90%"},newtd,(totalPriceOk>0.9*totalWertOk?"+":"")+moneyFormatInt(totalPriceOk-0.9*totalWertOk));

            newtr=createElement("tr",{"class":"hoverBgCc9"});
            newtable.insertBefore(newtr,newtable.children[2]);
            newtd=createElement("td",{},newtr);
                createElement("div",{},newtd,"Ø ("+countFarmisOk+")");
            newtd=createElement("td",{},newtr,"");
                createElement("div",{},newtd,">"+numberFormat(mode["limit"])+"%");
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{},newtd,moneyFormatInt(totalPriceOk/countFarmisOk));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%<br>Ø[>"+numberFormat(mode["limit"])+"%]"},newtd,moneyFormatInt(totalWertOk/countFarmisOk));
                createElement("div",{"mouseOverText":" 90%<br>Ø[>"+numberFormat(mode["limit"])+"%]"},newtd,moneyFormatInt(0.9*totalWertOk/countFarmisOk));
                createElement("div",{"mouseOverText":"100%<br>∑[>"+numberFormat(mode["limit"])+"%]/"+getText("all"),"style":"border-top:1px solid black;"},newtd,moneyFormatInt(totalWertOk/countFarmisAll));
                createElement("div",{"mouseOverText":" 90%<br>∑[>"+numberFormat(mode["limit"])+"%]/"+getText("all")},newtd,moneyFormatInt(0.9*totalWertOk/countFarmisAll));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,(totalPriceOk>totalWertOk?"+":"")+moneyFormatInt((totalPriceOk-totalWertOk)/countFarmisOk));
                createElement("div",{"mouseOverText":" 90%"},newtd,(totalPriceOk>0.9*totalWertOk?"+":"")+moneyFormatInt((totalPriceOk-0.9*totalWertOk)/countFarmisOk));
                createElement("div",{"mouseOverText":"100%","style":"border-top:1px solid black;"},newtd,(totalPriceOk>totalWertOk?"+":"")+moneyFormatInt((totalPriceOk-totalWertOk)/countFarmisAll));
                createElement("div",{"mouseOverText":" 90%"},newtd,(totalPriceOk>0.9*totalWertOk?"+":"")+moneyFormatInt((totalPriceOk-0.9*totalWertOk)/countFarmisAll));

            newtr=createElement("tr",{"class":"hoverBgCc9"});
            newtable.insertBefore(newtr,newtable.children[3]);
            newtd=createElement("td",{},newtr);
                createElement("div",{},newtd,"Ø ("+countFarmisAll+")");
            newtd=createElement("td",{},newtr);
                createElement("div",{},newtd,getText("all"));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{},newtd,moneyFormatInt(totalPrice/countFarmisAll));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,moneyFormatInt(totalWert/countFarmisAll));
                createElement("div",{"mouseOverText":"90%"},newtd,moneyFormatInt(0.9*totalWert/countFarmisAll));
            newtd=createElement("td",{"style":"text-align:right;"},newtr);
                createElement("div",{"mouseOverText":"100%"},newtd,(totalPrice>totalWert?"+":"")+moneyFormatInt((totalPrice-totalWert)/countFarmisAll));
                createElement("div",{"mouseOverText":"90%"},newtd,(totalPrice>0.9*totalWert?"+":"")+moneyFormatInt((totalPrice-0.9*totalWert)/countFarmisAll));
        }
        container=null;newdiv=null;newtable=null;newtr=null;newtd=null;
    }catch(err){GM_logError("buildInfoPanelFarmies","","",err);}
}
function buildInfoPanelFormulas(mode){
    try{
        // unsafeWindow.formulas[0][id]:
        // 0: id
        // 1: needed level
        // 2: name
        // 3: ingredients [[id,amount],[id,amount],[id,amount]]
        // 4: baking time in sek
        // 5: gain [0|[prod,amount],0|[prod,+val,time in sek],0|[prod,+pts,time in sek]]
        // 6: price money
        // 7: price coins
        // 8: points for baking
        // 9: [0,1,2,3,4,5,6]
        //10: ?
        //endremain: time to end
        //end: date until recipe is buyable
        var modeDefault={"showAll":false,"filterType":"0,1,2,"};
        var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelFormulas"),"buildInfoPanelFormulas/modeOld",modeDefault);
        if(typeof modeOld!="object"){ modeOld=modeDefault; }
        if(typeof mode!="object"){ mode=modeOld; }
        for(var v in modeDefault){
            if(!modeDefault.hasOwnProperty(v)){ continue; }
            if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelFormulas",implode(mode,"buildInfoPanelFormulas/mode"));
        var container=$("infoPanelInner");
        container.innerHTML="";
        var newdiv,newdiv1,newtable,newtr,newtd,newtd1,newinput;
        newdiv=createElement("div",{"class":"borderBottom1Black","style":"height:50px;"},container);
        newtable=createElement("table",{"style":"width:100%;","border":0,"cellspacing":0},newdiv);
        newtr=createElement("tr",{},newtable);
        createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},newtr,getText("recipes"));
        newtd=createElement("td",{},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":mode["showAll"]},newtd);
        newinput.addEventListener("click",function(){
            buildInfoPanelFormulas({"showAll":this.checked});
        },false);
        createElement("span",{"style":"margin-right:10px;"},newtd,getText("showAll"));
        newtd=createElement("td",{"align":"right"},newtr);
        newtd.addEventListener("click",function(filterType){
        return function(event){
            var thisFilter=event.target.getAttribute("filter");
            if(thisFilter){
                if(!event.ctrlKey){
                    filterType=thisFilter;
                }else if(filterType.search(thisFilter)!=-1){
                    filterType.replace(thisFilter,"")
                }else{
                    filterType+=thisFilter;
                }
                buildInfoPanelFormulas({"filterType":filterType});
            }
        }}(mode["filterType"]),false);
        newtd.addEventListener("mouseover",function(event){
            var mouseOverText=event.target.getAttribute("mouseOverText");
            if(mouseOverText){
                mouseOverText='<div>'+getText("click")+'&nbsp;/&nbsp;'+getText("clickCtrl")+'</div><div>'+mouseOverText+'</div>';
                toolTip.show(event,mouseOverText);
            }
        },false);
        for(var v=0;v<=2;v++){
            createElement("div",{"class":"link category_r"+v+(mode["filterType"].search(v+",")!=-1?"_active":""),"filter":v+",","style":"display:inline-block;","mouseOverText":getText("category_r"+v)},newtd);
        }

        newdiv=createElement("div",{"style":"height:465px;width:100%;overflow:auto;"},container);
        newtable=createElement("table",{"style":"line-height:16px;width:100%","border":"1","cellspacing":0},newdiv);
        var thead=createElement("thead",{},newtable); // sortable table
        var newtbody=createElement("tbody",{},newtable);

        newtr=createElement("tr",{"class":"borderBottom2"},thead);
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("nr"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("lvl"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("title"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("ingredients"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("time"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("gain"));
        createElement("th",{"sortdir":"Asc","class":"link"},newtr,getText("price"));
        new SortableTable(newtr);

        for(var v in unsafeWindow.formulas[0]){
            if(!unsafeWindow.formulas[0].hasOwnProperty(v)){ continue; }
            if(mode["showAll"]||((USERLEVEL>=unsafeWindow.formulas[0][v][1])&&(unsafeWindow.formulas[0][v]["endremain"]>=0))){
                if(((mode["filterType"].search("0,")!=-1)&&(unsafeWindow.formulas[0][v][5][0]!=0))||((mode["filterType"].search("1,")!=-1)&&(unsafeWindow.formulas[0][v][5][1]!=0))||((mode["filterType"].search("2,")!=-1)&&(unsafeWindow.formulas[0][v][5][2]!=0))){
                    newtr=createElement("tr",{"class":"hoverBgCc9"},newtbody);
                    createElement("td",{"value":unsafeWindow.formulas[0][v][0],"style":(unsafeWindow.formulas[0][v]["endremain"]>=0?"":"background-color:red;")},newtr,unsafeWindow.formulas[0][v][0]);
                    createElement("td",{"value":unsafeWindow.formulas[0][v][1],"style":(USERLEVEL>=unsafeWindow.formulas[0][v][1]?"":"background-color:red;")},newtr,unsafeWindow.formulas[0][v][1]);
                    // Title
                    newtd1=createElement("td",{},newtr,unsafeWindow.formulas[0][v][2]);
                    // Ingredients
                    newtd=createElement("td",{},newtr);
                    var sum1=0;
                    var sumPts=0;
                    var preis=0;
                    for(var w=0;w<unsafeWindow.formulas[0][v][3].length;w++){
                        preis=!isNaN(NPC[0][unsafeWindow.formulas[0][v][3][w][0]])?Math.min(NPC[0][unsafeWindow.formulas[0][v][3][w][0]],gut[unsafeWindow.formulas[0][v][3][w][0]]):gut[unsafeWindow.formulas[0][v][3][w][0]];
                        sum1 += unsafeWindow.formulas[0][v][3][w][1]*preis;
                        newdiv=createElement("div",{"class":"link hoverBgLightblue","prod":unsafeWindow.formulas[0][v][3][w][0],"value":preis*unsafeWindow.formulas[0][v][3][w][1]},newtd);
                        newdiv.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,this.getAttribute("prod"),null,'<tr><td>'+"∑"+'</td><td style="text-align:right;">'+moneyFormatInt(parseInt(this.getAttribute("value"),10))+'</td></tr>');},false);
                        newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                        produktPic(0,unsafeWindow.formulas[0][v][3][w][0],newdiv);
                        newdiv=createElement("span",{},newdiv,numberFormat(unsafeWindow.formulas[0][v][3][w][1]));
                    }
                    newtd.setAttribute("value",sum1);
                    createElement("div",{},newtd,"("+moneyFormatInt(sum1)+")");
                    var sum=-sum1;
                    // Time
                    createElement("td",{"value":unsafeWindow.formulas[0][v][4]},newtr,getTimeStr(unsafeWindow.formulas[0][v][4],1)+getText("shortHours"));
                    // Gain
                    newtd=createElement("td",{"style":"width:80px;"},newtr);
                    if(unsafeWindow.formulas[0][v][5][0]!=0){
                        // Products
                        preis=!isNaN(NPC[0][unsafeWindow.formulas[0][v][5][0][0]])?Math.min(NPC[0][unsafeWindow.formulas[0][v][5][0][0]],gut[unsafeWindow.formulas[0][v][5][0][0]]):gut[unsafeWindow.formulas[0][v][5][0][0]];
                        sum1=unsafeWindow.formulas[0][v][5][0][1]*preis;
                        sum += sum1;
                        newdiv=createElement("div",{"class":"link hoverBgLightblue","prod":unsafeWindow.formulas[0][v][5][0][0],"value":sum1},newtd);
                        newdiv.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,this.getAttribute("prod"));},false);
                        newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                        produktPic(0,unsafeWindow.formulas[0][v][5][0][0],newdiv);
                        createElement("span",{},newdiv,unsafeWindow.formulas[0][v][5][0][1]);
                        createElement("div",{},newtd,"("+moneyFormatInt(sum1)+")");
                    }else if(unsafeWindow.formulas[0][v][5][1]!=0){
                        // Crop amount boost
                        createElement("div",{},newtd,getTimeStr(unsafeWindow.formulas[0][v][5][1][2],1)+getText("shortHours"));
                        newdiv=createElement("div",{"class":"link hoverBgLightblue","prod":unsafeWindow.formulas[0][v][5][1][0],"style":"white-space:nowrap;"},newtd);
                        newdiv.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,this.getAttribute("prod"));},false);
                        newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                        produktPic(0,unsafeWindow.formulas[0][v][5][1][0],newdiv);
                        createElement("span",{},newdiv,+unsafeWindow.formulas[0][v][5][1][1]+"val&nbsp;(+"+numberFormat(100*unsafeWindow.formulas[0][v][5][1][1]/(prodYield[0][unsafeWindow.formulas[0][v][5][1][0]]-1))+"%)");
                        preis=!isNaN(NPC[0][unsafeWindow.formulas[0][v][5][1][0]])?Math.min(NPC[0][unsafeWindow.formulas[0][v][5][1][0]],gut[unsafeWindow.formulas[0][v][5][1][0]]):gut[unsafeWindow.formulas[0][v][5][1][0]];
                        sum1=0;
                        for(var i=0;i<ALL_ZONES["farm"].length;i++){
                            if((zones.getBuilding(ALL_ZONES["farm"][i])==1)&&(!zones.getBlock(ALL_ZONES["farm"][i]))){
                                sum1 += preis*unsafeWindow.formulas[0][v][5][1][1]*Math.ceil(calcGrowTimes(60*prodGrowTime[0][unsafeWindow.formulas[0][v][5][1][0]],unsafeWindow.formulas[0][v][5][1][2],1-(zones.getBonus(ALL_ZONES["farm"][i])/100)))*BUILDING_SIZE["1"]/prodPlantSize[0][unsafeWindow.formulas[0][v][5][1][0]];
                            }
                        }
                        sum += sum1;
                        createElement("div",{},newtd,"("+moneyFormatInt(sum1)+")");
                        newtd.setAttribute("value",sum1);
                    }else if(unsafeWindow.formulas[0][v][5][2]!=0){
                        // Crop points boost
                        createElement("div",{},newtd,getTimeStr(unsafeWindow.formulas[0][v][5][2][2],1)+getText("shortHours"));
                        newdiv=createElement("div",{"class":"link hoverBgLightblue","prod":unsafeWindow.formulas[0][v][5][2][0],"style":"white-space:nowrap;"},newtd);
                        newdiv.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,this.getAttribute("prod"));},false);
                        newdiv.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                        produktPic(0,unsafeWindow.formulas[0][v][5][2][0],newdiv);
                        createElement("span",{},newdiv,"+");
                        pointsFormat(unsafeWindow.formulas[0][v][5][2][1],"span",newdiv);
                        createElement("span",{},newdiv,"&nbsp;(+"+numberFormat(100*unsafeWindow.formulas[0][v][5][2][1]/prodPoints[0][unsafeWindow.formulas[0][v][5][2][0]])+"%)");
                        sum1=0;
                        for(var i=0;i<ALL_ZONES["farm"].length;i++){
                            if((zones.getBuilding(ALL_ZONES["farm"][i])==1)&&(!zones.getBlock(ALL_ZONES["farm"][i]))){
                                sum1 += unsafeWindow.formulas[0][v][5][2][1]*Math.ceil(calcGrowTimes(60*prodGrowTime[0][unsafeWindow.formulas[0][v][5][2][0]],unsafeWindow.formulas[0][v][5][2][2],1-(zones.getBonus(ALL_ZONES["farm"][i])/100)))*BUILDING_SIZE["1"]/prodPlantSize[0][unsafeWindow.formulas[0][v][5][2][0]];
                            }
                        }
                        sumPts=sum1;
                        newdiv=createElement("div",{},newtd);
                        createElement("span",{},newdiv,"(");
                        pointsFormat(sum1,"span",newdiv);
                        createElement("span",{},newdiv,")");
                        newtd.setAttribute("value",0);
                    }
                    pointsFormat(unsafeWindow.formulas[0][v][8],"div",newtd);
                    sumPts += unsafeWindow.formulas[0][v][8];
                    // Price
                    newtd=createElement("td",{},newtr);
                    if(unsafeWindow.formulas[0][v][6]>0){
                        sum1=unsafeWindow.formulas[0][v][6];
                        sum -= sum1;
                        newspan=createElement("div",{},newtd,moneyFormatInt(sum1));
                        newtd.setAttribute("value",sum1);
                    }
                    if(unsafeWindow.formulas[0][v][7]>0){
                        sum1=unsafeWindow.formulas[0][v][7]*gut[0];
                        sum -= sum1;
                        newspan=createElement("div",{"class":"link hoverBgLightblue"},newtd,coinsFormat(unsafeWindow.formulas[0][v][7],createElement("div")).parentNode.innerHTML);
                        newspan.addEventListener("mouseover",function(event){showGoToMarketToolTip(event,"0");},false);
                        newspan.addEventListener("click",function(){showMarket("0");},false);
                        createElement("div",{"style":"clear:both;"},newtd,"("+moneyFormatInt(sum1)+")");
                        newtd.setAttribute("value",sum1);
                    }
                    //createElement("td",{},newtr,unsafeWindow.formulas[0][v][8]);
                    //createElement("td",{},newtr,unsafeWindow.formulas[0][v][9]);
                    // Title
                    createElement("div",{},newtd1,moneyFormatInt(sum));
                    newtd1.setAttribute("value",sum);
                    pointsFormat(sumPts,"div",newtd1);
                }
            }
        }
        container=null;
        newtable=null;thead=null;newtbody=null;newtr=null;newtd=null;newtd1=null;newdiv=null;newinput=null;
    }catch(err){GM_logError("buildInfoPanelFormulas","","",err);}
}
function buildInfoPanelMegafield(){
    try{
        var container,div,table,tr,td;
        var help;
        container=$("infoPanelInner");
        container.innerHTML="";
        // Head
        div=createElement("div",{"class":"borderBottom1Black","style":"height:30px;"},container);
        table=createElement("table",{"class":"tnormal","style":"font-weight:bold;width:100%;"},div);
        tr=createElement("tr",{},table);
        createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},tr,getText("megafield"));
        td=createElement("td",{},tr);
        // Content
        div=createElement("div",{"style":"height:485px;overflow:auto;"},container);
        table=createElement("table",{"style":"line-height:16px;width:100%","border":"1","class":"hoverRowBgCc9"},div);
        tr=createElement("tr",{},table);

        createElement("th",{},tr,getText("start"));
        createElement("th",{},tr,getText("end"));
        createElement("th",{},tr,getText("difficulty"));
        createElement("th",{},tr,getText("products"));
        createElement("th",{},tr,getText("reward"));
        createElement("th",{},tr,getText("bonus")+" "+getText("difficulty"));
        createElement("th",{},tr,getText("bonus")+" "+getText("time"));

        for(var v=logMegafieldJob.length-1;v>=0;v--){
            tr=createElement("tr",{"v":v},table);
            createElement("td",{},tr,getFormattedDateStr(logMegafieldJob[v][0])+" "+getDaytimeStr(logMegafieldJob[v][0]));
            help=(logMegafieldJob[v][1]?logMegafieldJob[v][1]:logMegafieldJob[v][0]+168*60*60);
            td=createElement("td",{},tr,getFormattedDateStr(help)+" "+getDaytimeStr(help));
            td.addEventListener("mouseover",function(event){
            try{
                var v=this.parentNode.getAttribute("v");
                if(!logMegafieldJob[v][1]){
                    toolTip.show(event,getText("jobCurrent")+"<br>"+getText("remaining")+": "+getTimeStr(logMegafieldJob[v][0]+168*60*60-unsafeWindow.Zeit.Server));
                }else if(logMegafieldJob[v][3]){
                    toolTip.show(event,getText("jobComplete")+"<br>"+getText("remaining")+": "+getTimeStr(logMegafieldJob[v][0]+168*60*60-logMegafieldJob[v][1]));
                }else{
                    toolTip.show(event,getText("jobIncomplete"));
                }
                container=null;div=null;table=null;tr=null;td=null;
            }catch(err){GM_logError("buildInfoPanelMegafield.endtime.mouseover","","v="+v,err);}
            },false);
            td=createElement("td",{},tr);
            for(var i=3;1<=i;i--){ createElement("img",{"src":(logMegafieldJob[v][2]<=i)?GFX+"star.png":IMAGES["starGrey"]},td); }
            td=createElement("td",{},tr);
            td.addEventListener("mouseover",function(event){
            try{
                var v=this.parentNode.getAttribute("v");
                var container,div,table,tr=[],td;
                var amountEach,amount,price,help,sum=[0,0];
                container=createElement("div");
                table=createElement("table",{"border":"1"},container);
                for(var i=0;i<6;i++){
                    tr.push(createElement("tr",{},table));
                }
                createElement("th",{},tr[0]);
                createElement("td",{},tr[1],getText("time"));
                createElement("td",{},tr[2],getText("seedPerField"));
                createElement("td",{},tr[3],getText("price"));
                td=createElement("td",{},tr[4]);
                createElement("div",{},td,getText("fields"));
                createElement("div",{},td,getText("seed"));
                createElement("div",{},td,getText("value"));
                if(!logMegafieldJob[v][3]){
                    td=createElement("td",{},tr[5]);
                    createElement("div",{},td,getText("missing"));
                    createElement("div",{},td,getText("fields"));
                    createElement("div",{},td,getText("seed"));
                    createElement("div",{},td,getText("value"));
                }
                for(var i=0;i<logMegafieldJob[v][4].length;i++){
                    amountEach=(logMegafieldJob[v][4][i][3]?logMegafieldJob[v][4][i][3]:1);
                    price=gut[logMegafieldJob[v][4][i][0]];
                    createElement("th",{},tr[0],prodName[4][logMegafieldJob[v][4][i][0]]);
                    createElement("td",{},tr[1],logMegafieldJob[v][4][i][5]?getTimeStr(logMegafieldJob[v][4][i][5],true):"-");
                    createElement("td",{},tr[2],numberFormat(amountEach));
                    createElement("td",{},tr[3],moneyFormat(price));
                    td=createElement("td",{},tr[4]);
                    createElement("div",{},td,numberFormat(logMegafieldJob[v][4][i][1]));
                    createElement("div",{},td,numberFormat(logMegafieldJob[v][4][i][1]*amountEach));
                    help=logMegafieldJob[v][4][i][1]*amountEach*price;
                    createElement("div",{},td,moneyFormatInt(help));
                    sum[0]+=help;
                    if(!logMegafieldJob[v][3]){
                        amount=logMegafieldJob[v][4][i][1]-logMegafieldJob[v][4][i][2];
                        td=createElement("td",{},tr[5]);
                        if(amount>0){
                            createElement("div",{},td,"&nbsp;");
                            createElement("div",{},td,numberFormat(amount));
                            createElement("div",{},td,numberFormat(amount*amountEach));
                            help=amount*amountEach*price;
                            createElement("div",{},td,moneyFormatInt(help));
                            sum[1]+=help;
                        }
                    }
                }
                createElement("th",{},tr[0],"∑");
                td=createElement("td",{},tr[4]);
                createElement("div",{},td,"&nbsp;");
                createElement("div",{},td,"&nbsp;");
                createElement("div",{},td,moneyFormatInt(sum[0]));
                if(!logMegafieldJob[v][3]){
                    td=createElement("td",{},tr[5]);
                    createElement("div",{},td,"&nbsp;");
                    createElement("div",{},td,"&nbsp;");
                    createElement("div",{},td,"&nbsp;");
                    createElement("div",{},td,moneyFormatInt(sum[1]));
                }
                toolTip.show(event,container.innerHTML);
                container=null;div=null;table=null;tr=null;td=null;
            }catch(err){GM_logError("buildInfoPanelMegafield.products.mouseover","","v="+v+" i="+i,err);}
            },false);
            for(var i=0;i<logMegafieldJob[v][4].length;i++){
                div=createElement("div",{"style":"white-space:nowrap;"},td);
                produktPic(4,logMegafieldJob[v][4][i][0],div);
                if(numberFormat(logMegafieldJob[v][4][i][2])==numberFormat(logMegafieldJob[v][4][i][1])){
                    createElement("span",{},div,numberFormat(logMegafieldJob[v][4][i][1]));
                }else{
                    createElement("span",{},div,numberFormat(logMegafieldJob[v][4][i][2])+"/"+numberFormat(logMegafieldJob[v][4][i][1]));
                }
            }
            for(var i=5;i<=7;i++){
                td=createElement("td",{},tr);
                createElement("div",{},td,numberFormat(logMegafieldJob[v][i][0])+"&nbsp;"+getText("points"));
                createElement("div",{},td,moneyFormatInt(logMegafieldJob[v][i][1]));
                createElement("div",{},td,numberFormat(logMegafieldJob[v][i][2])+"&nbsp;"+getText("megafieldCurrency"));
            }
        }
        container=null;div=null;table=null;tr=null;td=null;
    }catch(err){GM_logError("buildInfoPanelMegafield","","",err);}
}
unsafeWindow.buildInfoPanelMenu=function(mode){
    try{
        var container,newdiv,newdiv1;
        container=$("infoPanelInner");
        container.innerHTML="";
        newdiv=createElement("div",{"id":"infoPanelL","style":"position:absolute;left:0;width:105px;overflow:auto;height:515px;border-right:2px solid #685338;padding-right:5px;"},container);
        newdiv1=createElement("div",{"style":"padding-top:5px;border-bottom:1px solid #685338;font-weight:bold;float:left;width:100%;"},newdiv,getText("adviser"));
        newdiv1.addEventListener("mouseover",function(event){
            toolTip.show(event,getText("showChangelog"));
        },false);
        newdiv1.classList.add("link");
        newdiv1.addEventListener("click",function(event){
            unsafeWindow.buildInfoPanel("changelog");
        },false);
        if(USERNAME){
            newdiv1=createElement("div",{"id":"infoPanelNaviOptions","class":"link naviItem","style":"margin-top:5px;width:95px;"},newdiv,getText("options"));
            newdiv1.addEventListener("click",function(event){ unsafeWindow.buildInfoPanelMenu("options"); },false);
        }else{
            createElement("div",{"id":"infoPanelNaviOptions","class":"naviItemInactive","style":"margin-top:5px;width:95px;"},newdiv,getText("options"));
        }
        newdiv1=createElement("div",{"id":"infoPanelNaviAccounts","class":"link naviItem","style":"margin-top:5px;width:95px;"},newdiv,getText("accounts"));
        newdiv1.addEventListener("click",function(event){ unsafeWindow.buildInfoPanelMenu("accounts"); },false);
        newdiv1=createElement("div",{"id":"infoPanelNaviHotkeys","class":"link naviItem","style":"margin-top:5px;width:95px;"},newdiv,getText("hotkeys"));
        newdiv1.addEventListener("click",function(event){ unsafeWindow.buildInfoPanelMenu("hotkeys"); },false);
        if(USERNAME){
            newdiv1=createElement("div",{"id":"infoPanelNaviCss","class":"link naviItem","style":"margin-top:5px;width:95px;"},newdiv,"CSS");
            newdiv1.addEventListener("click",function(event){ unsafeWindow.buildInfoPanelMenu("css"); },false);
            newdiv1=createElement("div",{"id":"infoPanelNaviImport","class":"link naviItem","style":"margin-top:5px;width:95px;"},newdiv,"Import/Export");
            newdiv1.addEventListener("click",function(event){ unsafeWindow.buildInfoPanelMenu("import"); },false);
        }else{
            createElement("div",{"id":"infoPanelNaviCss","class":"naviItemInactive","style":"margin-top:5px;width:95px;"},newdiv,"CSS");
            createElement("div",{"id":"infoPanelNaviImport","class":"naviItemInactive","style":"margin-top:5px;width:95px;"},newdiv,"Import/Export");
        }
        createElement("div",{"id":"infoPanelR","style":"position:absolute;left:115px;width:480px;overflow:auto;height:515px;"},container);
        // paypal
        //newdiv=createElement("div",{"style":"position:absolute;left:0;bottom:0;"},container);
        //newdiv1=createElement("form",{"id":"paypalForm","target":"_blank","action":"https://www.paypal.com/cgi-bin/webscr","method":"post"},newdiv);
        //createElement("input",{"type":"hidden","name":"cmd","value":"_donations"},newdiv1);
        //createElement("input",{"type":"hidden","name":"business","value":"jessicakanaan@web.de"},newdiv1);
        //createElement("input",{"type":"hidden","name":"lc","value":((LANGUAGE=="de")?"DE":"US")},newdiv1);
        //createElement("input",{"type":"hidden","name":"item_name","value":"MyFreeFarm Script"},newdiv1);
        //createElement("input",{"type":"hidden","name":"no_note","value":"0"},newdiv1);
        //createElement("input",{"type":"hidden","name":"currency_code","value":"EUR"},newdiv1);
        //createElement("input",{"type":"hidden","name":"bn","value":"PP-DonationsBF:btn_donate_LG.gif:NonHostedGuest"},newdiv1);
        //createElement("input",{"type":"image","style":"border:none;background:transparent;","src":"https://www.paypalobjects.com/"+((LANGUAGE=="de")?"de_DE/DE":"en_US")+"/i/btn/btn_donate_LG.gif","name":"submit","alt":"PayPal"},newdiv1);
        //createElement("img",{"alt":"","border":"0","src":"https://www.paypalobjects.com/en_US/i/scr/pixel.gif","width":"1","height":"1"},newdiv1);

        //Spenden Wikipedia
        newdiv=createElement("div",{"style":"position:absolute;left:0;bottom:0;"},container);
        newdiv1=createElement("a",{"href":"https://spenden.wikimedia.de/spenden/","target":"_blank","class":"link"},newdiv);
        createElement("img",{"style":"border:none;","src":"https://www.paypalobjects.com/"+((LANGUAGE=="de")?"de_DE/DE":"en_US")+"/i/btn/btn_donate_LG.gif"},newdiv1);

        // call automat
        if(unsafeWindow.buildInfoPanelAutomatMenu){ unsafeWindow.buildInfoPanelAutomatMenu(mode); }
        // switch call
        switch(mode){
        case "options": buildInfoPanelOptions(); break;
        case "accounts": buildInfoPanelAccounts(false); break;
        case "hotkeys": buildInfoPanelHotkeys(); break;
        case "css": buildInfoPanelCss(); break;
        case "import": buildInfoPanelImport(); break;
        }
        container=null;newdiv=null;newdiv1=null;
    }catch(err){GM_logError("buildInfoPanelMenu","","",err);}
}
function buildInfoPanelOptions(){
    try{
        var container,newdiv,newtable,newtr,newtd,newtr,newtd1,newinput;
        newdiv=$("infoPanelNaviOptions");
        newdiv.classList.remove("naviItem");
        newdiv.classList.add("naviItemActive");
        container=$("infoPanelR");
        newtable=createElement("table",{"style":"width:100%;","border":"1","class":"hoverRowBgCc9"},container);

        // ***************Farm****************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("farm"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center",},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valAutoWater["farm"]},newtd);
        newinput.addEventListener("click",function(){
            valAutoWater["farm"]=this.checked;
            unsafeData.valAutoWater=valAutoWater;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoWater",implode(valAutoWater,"buildInfoPanelOptions/valAutoWater"),9);
        },false);
        createElement("td",{},newtr,getText("settings_valAutoWater")[0]);
        createElement("td",{},newtr,getText("settings_valAutoWater")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valAutoCrop["farm"]},newtd);
        newinput.addEventListener("click",function(){
            valAutoCrop["farm"]=this.checked;
            unsafeData.valAutoCrop=valAutoCrop;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoCrop",implode(valAutoCrop,"buildInfoPanelOptions/valAutoCrop"),11);
        },false);
        createElement("td",{},newtr,getText("settings_valAutoCrop")[0]);
        createElement("td",{},newtr,getText("settings_valAutoCrop")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valAssumeWater["farm"]},newtd);
        newinput.addEventListener("click",function(){
            valAssumeWater["farm"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAssumeWater",implode(valAssumeWater,"buildInfoPanelOptions/valAssumeWater"),10);
        },false);
        createElement("td",{},newtr,getText("settings_valAssumeWater")[0]);
        createElement("td",{},newtr,getText("settings_valAssumeWater")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valWaterNeeded["farm"]},newtd);
        newinput.addEventListener("click",function(){
            valWaterNeeded["farm"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valWaterNeeded",implode(valWaterNeeded,"buildInfoPanelOptions/valWaterNeeded"),12);
        },false);
        createElement("td",{},newtr,getText("settings_valWaterNeeded")[0]);
        createElement("td",{},newtr,getText("settings_valWaterNeeded")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalErnteMsg","type":"checkbox","class":"link","checked":valErnteMsg},newtd);
        newinput.addEventListener("click",function(){
            valErnteMsg=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valErnteMsg", valErnteMsg,13);
        },false);
        createElement("td",{},newtr,getText("settings_valCropMsg")[0]);
        createElement("td",{},newtr,getText("settings_valCropMsg")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"value":valLimitEmptyFields["1"],"class":"text","maxlength":"3","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var help=parseInt(this.value,10);
            if(isNaN(help)||(help<0)) {
                this.value="";
            } else if (help>120) {
                this.value=120;
            } else {
                this.value=help;
                valLimitEmptyFields["1"]=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valLimitEmptyFields",implode(valLimitEmptyFields,"buildInfoPanelOptions/valLimitEmptyFields"),14);
                for(var v=0;v<ALL_ZONES["farm"].length;v++){
                    if(zones.getBuilding(ALL_ZONES["farm"][v])==1){
                        zones.processProduction(ALL_ZONES["farm"][v]);
                    }
                }
            }
        },false);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields")[0]);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valGlobaltimeShowCroppedZone["farm"]},newtd);
        newinput.addEventListener("click",function(){
            valGlobaltimeShowCroppedZone["farm"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);
        },false);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[0]);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[1]);

        newtr=createElement("tr",{},newtable);
        createElement("td",{"align":"center"},newtr);
        createElement("td",{},newtr,getText("settings_valMoveAnimals")[0]);
        newtd=createElement("td",{},newtr,getText("settings_valMoveAnimals")[1]);
        for(var v=0;v<ANIMAL_MOVE.length;v++){ if(ANIMAL_MOVE[v]){
            newspan=createElement("span",{"style":"display:inline-block;margin-right:15px;"},newtd);
            produktPic(0,BUILDING2PRODUCT[v][0],newspan);
            newinput=createElement("input",{"id":"inputvalMoveAnimals"+v,"type":"checkbox","class":"link","checked":valMoveAnimals[v]},newspan);
            newinput.addEventListener("click",function(){
                valMoveAnimals[this.id.replace("inputvalMoveAnimals","")]=this.checked;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMoveAnimals", implode(valMoveAnimals,"buildInfoPanelOptions/valMoveAnimals"),15);
            },false);
        }}

        // ***************Farmies*************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("farmis"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newdiv=createElement("div",{"style":"white-space:nowrap;"},newtd);
        newinput=createElement("input",{"id":"inputvalFarmiLimits0","value":valFarmiLimits[0],"class":"text","maxlength":"3","size":"3px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value="";
            }else{
                help=Math.max(0,Math.min(999,Math.min(help,valFarmiLimits[1])));
                valFarmiLimits[0]=help;
                doFarmis();
                this.value=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFarmiLimits", implode(valFarmiLimits,"buildInfoPanelOptions/valFarmiLimits"),19);
                unsafeData.valFarmiLimits=valFarmiLimits.clone();
            }
        },false);
        createElement("span",{},newdiv,"%");
        newdiv=createElement("div",{"style":"white-space:nowrap;"},newtd);
        newinput=createElement("input",{"id":"inputvalFarmiLimits1","value":valFarmiLimits[1],"class":"text","maxlength":"3","size":"3px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value="";
            }else{
                help=Math.max(0,Math.min(999,Math.max(help,valFarmiLimits[0])));
                valFarmiLimits[1]=help;
                doFarmis();
                this.value=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFarmiLimits", implode(valFarmiLimits,"buildInfoPanelOptions/valFarmiLimits"),20);
                unsafeData.valFarmiLimits=valFarmiLimits.clone();
            }
        },false);
        createElement("span",{},newdiv,"%");
        createElement("td",{},newtr,getText("settings_valFarmiLimits")[0]);
        createElement("td",{},newtr,getText("settings_valFarmiLimits")[1]+" ("+getText("default")+":&nbsp;90,100)");

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalFarmiMiniInfo","type":"checkbox","class":"link","checked":valFarmiMiniInfo},newtd);
        newinput.addEventListener("click",function(){
            valFarmiMiniInfo=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFarmiMiniInfo", valFarmiMiniInfo,21);
            doFarmis();
        },false);
        createElement("td",{},newtr,getText("settings_valFarmiMiniInfo")[0]);
        createElement("td",{},newtr,getText("settings_valFarmiMiniInfo")[1]);

        // ***************Farmersmarket*******************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("farmersmarket"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"value":valLimitEmptyFields["fl1"],"class":"text","maxlength":"2","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var help=parseInt(this.value,10);
            if(isNaN(help)||(help<0)){
                this.value="";
            }else{
                this.value=help;
                valLimitEmptyFields["fl1"]=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valLimitEmptyFields",implode(valLimitEmptyFields,"buildInfoPanelOptions/valLimitEmptyFields"),14);
                zones.processProduction("farmersmarket-1");
            }
        },false);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields")[0]);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields")[1]);

        newtd1=null;
        for(var j=0;j<ALL_ZONES["farmersmarket"].length;j++){
            zoneNrF=ALL_ZONES["farmersmarket"][j];
            if(zones.isProductional(zoneNrF)){
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    var zoneNrF=this.getAttribute("zoneNrF");
                    zoneAddToGlobalTime[zoneNrF]=this.checked;
                    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));
                    zones.processProduction(zoneNrF);
                },false);
                newtd=createElement("td",{},newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
                if(newtd1==null){
                    newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
                }else{
                    newtd1.rowSpan++;
                }
            }
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valGlobaltimeShowCroppedZone["farmersmarket"]},newtd);
        newinput.addEventListener("click",function(){
            valGlobaltimeShowCroppedZone["farmersmarket"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);
        },false);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[0]);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[1]);

        // ***************Veterinary (Treatment of sick animals)*****************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("settings_vet")[0]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked": valVet}, newtd);
        if (!unsafeWindow.farmersmarket_data.vet) { newinput.disabled = true; }
        newinput.addEventListener("click",function(){
            valVet = this.checked;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVet", valVet);
        }, false);
        createElement("td",{},newtr,getText("veterinary") + "<br/>" + getText("reloadRequired"));
        createElement("td",{},newtr,getText("settings_vet")[1]);


        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked": vetTreatment}, newtd);
        if (!unsafeWindow.farmersmarket_data.vet) { newinput.disabled = true; }
        newinput.addEventListener("click",function(){
            vetTreatment = this.checked;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_vetTreatment", vetTreatment);
        }, false);
        createElement("td",{},newtr,getText("settings_vetTreatment")[0]);
        createElement("td",{},newtr,getText("settings_vetTreatment")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked": valVetAutoSet}, newtd);
        if (!unsafeWindow.farmersmarket_data.vet) { newinput.disabled = true; }
        newinput.addEventListener("click",function(){
            valVetAutoSet = this.checked;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetAutoSet", valVetAutoSet);
        }, false);
        createElement("td",{},newtr,getText("settings_vetAutoSet")[0]);
        createElement("td",{},newtr,getText("settings_vetAutoSet")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked": valVetNoCoinDrugs}, newtd);
        if (!unsafeWindow.farmersmarket_data.vet) { newinput.disabled = true; }
        newinput.addEventListener("click",function(){
            valVetNoCoinDrugs = this.checked;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetNoCoinDrugs", valVetNoCoinDrugs);
        }, false);
        createElement("td",{},newtr,getText("settings_valVetNoCoinDrugs")[0]);
        createElement("td",{},newtr,getText("settings_valVetNoCoinDrugs")[1]);

        // ***************Megafield***********************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("megafield"));

        newtd1=null;
        for(var j=0;j<ALL_ZONES["megafield"].length;j++){
            zoneNrF=ALL_ZONES["megafield"][j];
            if(zones.isProductional(zoneNrF)){
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    var zoneNrF=this.getAttribute("zoneNrF");
                    zoneAddToGlobalTime[zoneNrF]=this.checked;
                    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));
                    zones.processProduction(zoneNrF);
                },false);
                newtd=createElement("td",{},newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
                if(newtd1==null){
                    newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
                }else{
                    newtd1.rowSpan++;
                }

            // Smarter megafield timer
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input", {
                        "type":"checkbox",
                        "class":"link",
                        "checked": GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldSmartTimer",false)
                }, newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    megafieldSmartTimer = this.checked;
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldSmartTimer", megafieldSmartTimer);
                }, false);
                newtd=createElement("td", {}, newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span", {}, newtd, getText("settings_megafieldSmartTimer")[0]);
                createElement("td", {"rowspan":1}, newtr, getText("settings_megafieldSmartTimer")[1]);
            }
        }

        // ***************SushiBar *****************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,"Sushibar");

        if (unsafeWindow.sushibar && unsafeWindow.sushibar.data && unsafeWindow.sushibar.data.config) {
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{"align":"center"},newtr);
            newinput=createElement("input",{"type":"checkbox","class":"link","checked": sushibarFarmi}, newtd);
            //if (!unsafeWindow.sushibar) { newinput.disabled = true; }
            newinput.addEventListener("click",function(){
                sushibarFarmi = this.checked;
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_sushibarFarmi", sushibarFarmi);
            }, false);
            createElement("td",{},newtr,"Sushibar Farmi");
            createElement("td",{},newtr,"Sushibar Farmi Daten einlesen");

            newtd1=null;
            var zoneNrF = (parseInt(unsafeWindow.sushibar.data.data.farm,10) -1)*6 + parseInt(unsafeWindow.sushibar.data.data.position,10);
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{"align":"center"},newtr);
            newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
            if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
            newinput.addEventListener("click",function(){
                var zoneNrF=this.getAttribute("zoneNrF");
                zoneAddToGlobalTime[zoneNrF]=this.checked;
                unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];

                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));


                valGlobaltimeShowCroppedZone[zoneNrF]=this.checked;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);

                zones.processProduction(zoneNrF);



            },false);
            newtd=createElement("td",{},newtr);
            if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
            createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
            if(newtd1==null){
                newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
            }else{
                newtd1.rowSpan++;
            }
        }

        // ***************Forestry************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("forestry"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        var newinput=createElement("input",{"id":"inputvalGiess","type":"checkbox","class":"link","checked":valAutoWater["forestry"]},newtd);
        newinput.addEventListener("click",function(){
            valAutoWater["forestry"]=this.checked;
            unsafeData.valAutoWater=valAutoWater;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoWater",implode(valAutoWater,"buildInfoPanelOptions/valAutoWater"),9);
        },false);
        createElement("td",{},newtr,getText("settings_valAutoWater")[0]);
        createElement("td",{},newtr,getText("settings_valAutoWater")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valAutoCrop["forestry"]},newtd);
        newinput.addEventListener("click",function(){
            valAutoCrop["forestry"]=this.checked;
            unsafeData.valAutoCrop=valAutoCrop;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoCrop",implode(valAutoCrop,"buildInfoPanelOptions/valAutoCrop"),11);
        },false);
        createElement("td",{},newtr,getText("settings_valAutoCrop")[0]);
        createElement("td",{},newtr,getText("settings_valAutoCrop")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valAssumeWater["forestry"]},newtd);
        newinput.addEventListener("click",function(){
            valAssumeWater["forestry"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAssumeWater",implode(valAssumeWater,"buildInfoPanelOptions/valAssumeWater"),10);
        },false);
        createElement("td",{},newtr,getText("settings_valAssumeWater")[0]);
        createElement("td",{},newtr,getText("settings_valAssumeWater")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valWaterNeeded["forestry"]},newtd);
        newinput.addEventListener("click",function(){
            valWaterNeeded["forestry"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valWaterNeeded",implode(valWaterNeeded,"buildInfoPanelOptions/valWaterNeeded"),12);
        },false);
        createElement("td",{},newtr,getText("settings_valWaterNeeded")[0]);
        createElement("td",{},newtr,getText("settings_valWaterNeeded")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"value":valLimitEmptyFields["forest"],"class":"text","maxlength":"2","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var help=parseInt(this.value,10);
            if(isNaN(help)||(help<0)){
                this.value="";
            }else{
                this.value=help;
                valLimitEmptyFields["forest"]=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valLimitEmptyFields",implode(valLimitEmptyFields,"buildInfoPanelOptions/valLimitEmptyFields"));
                zones.processProduction("forest");
            }
        },false);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields_forest")[0]);
        createElement("td",{},newtr,getText("settings_valLimitEmptyFields_forest")[1]);

        newtd1=null;
        for(var j=0;j<ALL_ZONES["forestry"].length;j++){
            zoneNrF=ALL_ZONES["forestry"][j];
            if(zones.isProductional(zoneNrF)){
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    var zoneNrF=this.getAttribute("zoneNrF");
                    zoneAddToGlobalTime[zoneNrF]=this.checked;
                    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));
                    zones.processProduction(zoneNrF);
                },false);
                newtd=createElement("td",{},newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
                if(newtd1==null){
                    newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
                }else{
                    newtd1.rowSpan++;
                }
            }
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valGlobaltimeShowCroppedZone["forestry"]},newtd);
        newinput.addEventListener("click",function(){
            valGlobaltimeShowCroppedZone["forestry"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);
        },false);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[0]);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[1]);

        // ***************Windmill************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("windmill"));

        newtd1=null;
        for(var j=0;j<ALL_ZONES["city"].length;j++){
            zoneNrF=ALL_ZONES["city"][j];
            if(zones.isProductional(zoneNrF)){
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    var zoneNrF=this.getAttribute("zoneNrF");
                    zoneAddToGlobalTime[zoneNrF]=this.checked;
                    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));
                    zones.processProduction(zoneNrF);
                },false);
                newtd=createElement("td",{},newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
                if(newtd1==null){
                    newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
                }else{
                    newtd1.rowSpan++;
                }
            }
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valGlobaltimeShowCroppedZone["windmill"]},newtd);
        newinput.addEventListener("click",function(){
            valGlobaltimeShowCroppedZone["windmill"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);
        },false);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[0]);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[1]);

        // ***************Foodworld***********************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,unsafeWindow.foodworld_title);

        newtd1=null;
        for(var j=0;j<ALL_ZONES["foodworld"].length;j++){
            zoneNrF=ALL_ZONES["foodworld"][j];
            if(zones.isProductional(zoneNrF)){
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("input",{"zoneNrF":zoneNrF,"type":"checkbox","class":"link","checked":zoneAddToGlobalTime[zoneNrF]},newtd);
                if(zones.getBlock(zoneNrF)){ newinput.disabled=true; }
                newinput.addEventListener("click",function(){
                    var zoneNrF=this.getAttribute("zoneNrF");
                    zoneAddToGlobalTime[zoneNrF]=this.checked;
                    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime[zoneNrF];
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd", implode(zoneAddToGlobalTime,"buildInfoPanelOptions/zoneAddToGlobalTime"));
                    zones.processProduction(zoneNrF);
                },false);
                newtd=createElement("td",{},newtr);
                if(zones.getBlock(zoneNrF)){ newtd.style.opacity="0.6"; }
                createElement("span",{},newtd,zones.getBuildingName(zoneNrF));
                if(newtd1==null){
                    newtd1=createElement("td",{"rowspan":1},newtr,getText("settings_valzoneAddToGlobalTime")[1]);
                }else{
                    newtd1.rowSpan++;
                }
            }
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":valGlobaltimeShowCroppedZone["foodworld"]},newtd);
        newinput.addEventListener("click",function(){
            valGlobaltimeShowCroppedZone["foodworld"]=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"buildInfoPanelOptions/valGlobaltimeShowCroppedZone"),16);
        },false);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[0]);
        createElement("td",{},newtr,getText("settings_valGlobaltimeShowCroppedZone")[1]);

        // ***************Clothing Donation***************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("settings_clothingDonation")[0]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked": valClothingDonation}, newtd);
        if (USERLEVEL < 38) { newinput.disabled = true; }
        newinput.addEventListener("click",function(){
            valClothingDonation = this.checked;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valClothingDonation", valClothingDonation);
        }, false);
        createElement("td",{},newtr,getText("settings_clothingDonation")[0]);
        createElement("td",{},newtr,getText("settings_clothingDonation")[1]);

        // ***************Minimal rackamount**************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("minRackamount"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMinRackMan","type":"checkbox","class":"link","checked":valMinRackMan},newtd);
        newinput.addEventListener("click",function(){
            valMinRackMan=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackMan",valMinRackMan,22);
            var cand=$("infoPanelR").getElementsByClassName("minRackConfig");
            if(valMinRackMan){
                for(var v=0;v<cand.length;v++){
                    cand[v].disabled=true;
                    cand[v].parentNode.parentNode.style.opacity=0.6;
                }
            }else{
                for(var v=0;v<cand.length;v++){
                    cand[v].disabled=false;
                    cand[v].parentNode.parentNode.style.opacity=1;
                }
                calcProdMinRackInit();
            }
            cand=null;
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackMan")[0]);
        newtd=createElement("td",{"class":"link"},newtr,getText("settings_valMinRackMan")[1]);
        newtd.addEventListener("click",function(){
            unsafeWindow.buildInfoPanel("stock",{"page":2});
        },false);

        newTd1=null;
        for(var v in valMinRack){
            if(!valMinRack.hasOwnProperty(v)){ continue; }
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{"align":"center"},newtr);
            newinput=createElement("input",{"id":"inputvalMinRack_"+v,"class":"text minRackConfig","value":valMinRack[v],"maxlength":"4","size":"5px","style":"background-color:transparent;text-align:center;"},newtd);
            if(valMinRackMan){
                newinput.disabled=true;
                newtr.style.opacity=0.6;
            }
            newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
            newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
            newinput.addEventListener("keyup",function(){
                var help=parseInt(this.value,10);
                if (isNaN(help)){
                    this.value="";
                }else{
                    this.value=help;
                    valMinRack[this.id.replace("inputvalMinRack_","")]=help;
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRack",implode(valMinRack,"buildInfoPanelOptions/valMinRack"));
                    calcProdMinRackInit();
                }
            },false);
            createElement("td",{},newtr,getText("category_"+v));
            if(newTd1==null){
                newTd1=createElement("td",{},newtr,getText("settings_valMinRack")[1]);
            } else {
                newTd1.rowSpan++;
            }
        }

        //Min exotic fruits on farm5
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newdiv=createElement("div",{"style":"white-space:nowrap;"},newtd);
        newinput=createElement("input",{"id":"valMinExFruitsFarms5","value":valMinExFruitsFarms5,"class":"text","maxlength":"1","size":"3px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value=1;
            }else{
                help=Math.max(0,Math.min(6,help));
                valMinExFruitsFarms5=help;
                this.value=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinExFruitsFarms5", implode(valMinExFruitsFarms5,"buildInfoPanelOptions/valMinExFruitsFarms5"),20);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valMinExFruitsFarms5")[0]);
        createElement("td",{},newtr,getText("settings_valMinExFruitsFarms5")[1]);
        //Min alpin herbs  on farm 6
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newdiv=createElement("div",{"style":"white-space:nowrap;"},newtd);
        newinput=createElement("input",{"id":"valMinAlpinFarm6","value":valMinAlpinFarm6,"class":"text","maxlength":"1","size":"3px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value=1;
            }else{
                help=Math.max(0,Math.min(6,help));
                valMinAlpinFarm6=help;
                this.value=help;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinAlpinFarm6", implode(valMinAlpinFarm6,"buildInfoPanelOptions/valMinAlpinFarm6"),20);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valMinAlpinFarm6")[0]);
        createElement("td",{},newtr,getText("settings_valMinAlpinFarm6")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"class":"text minRackConfig","type":"checkbox","checked":valMinRackPlantsize},newtd);
        if(valMinRackMan){
            newinput.disabled=true;
            newtr.style.opacity=0.6;
        }
        newinput.addEventListener("click",function(){
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackPlantsize",this.checked,24);
            calcProdMinRackInit();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackPlantsize")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackPlantsize")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMinRackGrowing","type":"checkbox","class":"link","checked":valMinRackGrowing},newtd);
        newinput.addEventListener("click",function(){
            valMinRackGrowing=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackGrowing",valMinRackGrowing,26);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackGrowing")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackGrowing")[1]);

        newTd1=null;
        for(var typ in questData){
            if(!questData.hasOwnProperty(typ)){ continue; }
            for(var camp in questData[typ]){
                if(!questData[typ].hasOwnProperty(camp)){ continue; }
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                var newsel = createElement("select",{"id":"selectQuestCalcTo_"+typ+"_"+camp,"style":"width:auto;height:18px;margin-left:5px;"},newtd);
                createElement("option",{"value":-1},newsel,getText("hide"));
                createElement("option",{"value":0},newsel,"--");
                for(var i=questData[typ][camp]["nr"];i<QUESTS[typ][camp].length;i++){
                    createElement("option",{"value":i},newsel,i);
                }
                newsel.addEventListener("change",function(){
                    if(isNaN(this.value)){return false;}
                    var help=this.id.split("_");
                    setCalcToQuest(help[1],help[2],this.value);
                },false);
                newsel.value = questData[typ][camp]["calcTo"];
                newtd=createElement("td",{},newtr,getText(typ=="main"?"farm":typ)+" "+camp);
                if(newTd1==null){
                    newTd1=createElement("td",{},newtr,getText("settings_valMinRackQuest")[1]);
                } else {
                    newTd1.rowSpan++;
                }
            }
        }
        newsel=null;i=null;

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMinRackRecursive","type":"checkbox","class":"link","checked":valMinRackRecursive},newtd);
        newinput.addEventListener("click",function(){
            valMinRackRecursive=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackRecursive",valMinRackRecursive,29);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackRecursive")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackRecursive")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMinRackFarmis","type":"checkbox","class":"link","checked":valMinRackFarmis},newtd);
        newinput.addEventListener("click",function(){
            valMinRackFarmis=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFarmis",valMinRackFarmis,30);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackFarmis")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackFarmis")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMinRackForestryFarmis","type":"checkbox","class":"link","checked":valMinRackForestryFarmis},newtd);
        newinput.addEventListener("click",function(){
            valMinRackForestryFarmis=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackForestryFarmis",valMinRackForestryFarmis,31);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackForestryFarmis")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackForestryFarmis")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputValMinRackFoodworldFarmis","type":"checkbox","class":"link","checked":valMinRackFoodworldFarmis},newtd);
        newinput.addEventListener("click",function(){
            valMinRackFoodworldFarmis=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFoodworldFarmis",valMinRackFoodworldFarmis,31);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackFoodworldFarmis")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackFoodworldFarmis")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputValMinRackFarmersmarketFarmis","type":"checkbox","class":"link","checked":valMinRackFarmersmarketFarmis},newtd);
        newinput.addEventListener("click",function(){
            valMinRackFarmersmarketFarmis=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFarmersmarketFarmis",valMinRackFarmersmarketFarmis,31);
            calcProdMinRack();
        },false);
        createElement("td",{},newtr,getText("settings_valMinRackFarmersmarketFarmis")[0]);
        createElement("td",{},newtr,getText("settings_valMinRackFarmersmarketFarmis")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalProtectMinRack","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valProtectMinRack",false)},newtd);
        newinput.addEventListener("click",function(){
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valProtectMinRack",this.checked,32);
        },false);
        createElement("td",{},newtr,getText("settings_protectMinRack")[0]);
        createElement("td",{},newtr,getText("settings_protectMinRack")[1]);

        // ***************Market**************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("market"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalKauflimit00","value":valKauflimit[0][0],"class":"text","maxlength":"3","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value="";
            }else{
                valKauflimit[0][0]=help;
                this.value=valKauflimit[0][0];
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit",implode(valKauflimit,"buildInfoPanelOptions/valKauflimit"),33);
            }
        },false);
        createElement("span",{},newtd,"%");
        createElement("td",{},newtr,getText("settings_valBuyingLimitDown")[0]);
        newtd=createElement("td",{},newtr,getText("settings_valBuyingLimitDown")[1]);
        newinput=createElement("input",{"id":"inputvalKauflimit01","value":valKauflimit[0][1],"class":"text","maxlength":"6","size":"10px","style":"background-color:#"+valKauflimit[0][1]+";color:#F0FFEF;"},newtd);
        newinput.addEventListener("keyup",function(){
            this.value=this.value.replace(/[^0-9a-f]/ig,"");
            this.style.backgroundColor="#"+this.value;
        },false);
        newinput.addEventListener("change",function(){
            var color=this.value;
            if(!color.match(/^([0-9a-f]{3}){1,2}$/i)){
                color="990000";
                this.value=color;
            }
            this.style.backgroundColor="#"+this.value;
            valKauflimit[0][1]=this.value;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit",implode(valKauflimit,"buildInfoPanelOptions/valKauflimit"),34);
        },false);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalKauflimit1","value":valKauflimit[1],"class":"text","maxlength":"3","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var help=parseInt(this.value,10);
            if (isNaN(help)){
                this.value="";
            }else{
                if(help<0){ help*=-1; }
                valKauflimit[1]=help;
                this.value=valKauflimit[1];
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit",implode(valKauflimit,"buildInfoPanelOptions/valKauflimit"),35);
            }
        },false);
        createElement("span",{},newtd,"%");
        createElement("td",{},newtr,getText("settings_valBuyingLimit")[0]);
        createElement("td",{},newtr,getText("settings_valBuyingLimit")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalKauflimitNPC","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimitNPC",true)},newtd);
        newinput.addEventListener("click",function(){
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimitNPC",this.checked,36);
        },false);
        createElement("td",{},newtr,getText("settings_valBuyingLimitNPC")[0]);
        createElement("td",{},newtr,getText("settings_valBuyingLimitNPC")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newdiv=createElement("div",{},newtd);
        newinput=createElement("input",{"id":"inputvalVerkaufLimitDown","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitDown",95),"class":"text","maxlength":"3","size":"2px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var valVerkaufLimitDown=parseInt(this.value,10);
            var valVerkaufLimitUp=parseInt($("inputvalVerkaufLimitUp").value,10);
            valVerkaufLimitDown=Math.min(valVerkaufLimitDown,valVerkaufLimitUp);
            if (isNaN(valVerkaufLimitDown)){
                this.value="";
            }else{
                this.value=valVerkaufLimitDown;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitDown", valVerkaufLimitDown,37);
            }
        },false);
        createElement("span",{},newdiv,"%");
        newdiv=createElement("div",{},newtd);
        newinput=createElement("input",{"id":"inputvalVerkaufLimitUp","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitUp",130),"class":"text","maxlength":"3","size":"2px","style":"background-color:transparent;text-align:center;"},newdiv);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("change",function(){
            var valVerkaufLimitDown=parseInt($("inputvalVerkaufLimitDown").value,10);
            var valVerkaufLimitUp=parseInt(this.value,10);
            valVerkaufLimitUp=Math.max(valVerkaufLimitDown,valVerkaufLimitUp);
            if (isNaN(valVerkaufLimitUp)){
                this.value="";
            }else{
                this.value=valVerkaufLimitUp;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitUp", valVerkaufLimitUp,38);
            }
        },false);
        createElement("span",{},newdiv,"%");
        createElement("td",{},newtr,getText("settings_valSellingLimit")[0]);
        createElement("td",{},newtr,getText("settings_valSellingLimit")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalJoinPreise","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valJoinPreise",false)},newtd);
        newinput.addEventListener("click",function(){ GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valJoinPreise", this.checked,39); },false);
        createElement("td",{},newtr,getText("settings_valJoinPrices")[0]);
        createElement("td",{},newtr,getText("settings_valJoinPrices")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalQuicklinks","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valQuicklinks",true)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valQuicklinks", this.checked,40);},false);
        createElement("td",{},newtr,getText("settings_valQuicklinks")[0]);
        createElement("td",{},newtr,getText("settings_valQuicklinks")[1]);

        function drawDivHighlightUser(name,color,parent){
            newdiv=createElement("div",{},parent);
            newinput=createElement("input",{"value":name,"class":"text","maxlength":"20","size":"25px","style":"background-color:transparent;"},newdiv);
            newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
            newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
            newinput=createElement("input",{"value":color,"class":"text","maxlength":"6","size":"10px","style":"background-color:#"+color+";color:#F0FFEF;"},newdiv);
            newinput.addEventListener("keyup",function(){
                this.value=this.value.replace(/[^0-9a-f]/ig,"");
                this.style.backgroundColor="#"+this.value;
            },false);
            newdiv.addEventListener("change",function(){
                var tableCell=this.parentNode;
                var candinput=tableCell.getElementsByTagName("input");
                var highlightUser=new Object();
                for(var v=0;v<candinput.length;v+=2){
                    var name=candinput[v].value;
                    if(highlightUser[name]){
                        // remove duplicate
                        removeElement(candinput[v].parentNode);
                        v-=2;
                    }else{
                        var color=candinput[v+1].value;
                        if(!color.match(/^([0-9a-f]{3}){1,2}$/i)){
                            color="20b2aa";
                            candinput[v+1].value=color;
                            candinput[v+1].style.backgroundColor="#"+color;
                        }
                        highlightUser[name]=color;
                    }
                }
                if(highlightUser[""]===undefined){
                    drawDivHighlightUser("","20b2aa",tableCell);
                }else{
                    delete highlightUser[""];
                }
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlight",implode(highlightUser,"buildInfoPanelOptions/highlightUser"),41);
                candinput=null;tableCell=null;
            },false);
        }
        var highlightUser=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlight"),"buildInfoPanel/options/highlightUser",{});
        highlightUser[""]="20b2aa";
        newtr=createElement("tr",{},newtable);
        createElement("td",{"align":"center"},newtr);
        createElement("td",{},newtr,getText("highlightUser"));
        newtd=createElement("td",{},newtr);
        for(var name in highlightUser){
            if(!highlightUser.hasOwnProperty(name)){ continue; }
            drawDivHighlightUser(name,highlightUser[name],newtd);
        }

        newtr=createElement("tr",{},newtable);
        createElement("td",{"align":"center"},newtr);
        createElement("td",{},newtr,getText("highlightProducts"));
        newtd=createElement("td",{},newtr);
        newdiv=createElement("div",{},newtd);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":highlightProducts[0]},newdiv);
        newinput.addEventListener("click",function(){
            highlightProducts[0]=this.checked;
            $("highlightProducts0").disabled=highlightProducts[0];
            $("highlightProducts1").disabled=highlightProducts[0];
            if(highlightProducts[0]){
                // todo calc highlightProducts[1]
                $("highlightProducts0").value=-1;
                $("highlightProducts1").value=-1;
            } else {
                var i=0;
                for(var prod in highlightProducts[1]){
                    if(!highlightProducts[1].hasOwnProperty(prod)){ continue; }
                    if(i>1){continue;}
                    $("highlightProducts"+i).value=prod;
                    i++;
                }
            }
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlightProducts",implode(highlightProducts,"buildInfoPanelOptions/highlightProducts"),42);
        },false);
        createElement("span",{},newdiv,getText("useQuestProducts"));
        for(var i=0;i<2;i++){
            newinput=createElement("select",{"id":"highlightProducts"+i,"class":"link"},newtd);
            createElement("option",{"value":"-1"},newinput,"--");
            for(var v=0;v<prodNameSort[0].length;v++){
                if((!prodBlock[0][prodNameSort[0][v]].match(/t/))&&(!prodBlock[0][prodNameSort[0][v]].match(/l/))){
                    createElement("option",{"value":prodNameSort[0][v]},newinput,prodName[0][prodNameSort[0][v]]);
                }
            }
            if(highlightProducts[0]){
                newinput.disabled=true;
                newinput.value=-1;
            }
            newinput.addEventListener("change",function(){
                highlightProducts[1]={};
                highlightProducts[1][$("highlightProducts0").value]=true;
                highlightProducts[1][$("highlightProducts1").value]=true;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlightProducts",implode(highlightProducts,"buildInfoPanelOptions/highlightProducts"),43);
            },false);
        }
        if(!highlightProducts[0]){
            var i=0;
            for(var prod in highlightProducts[1]){
                if(!highlightProducts[1].hasOwnProperty(prod)){ continue; }
                if(i>1){continue;}
                $("highlightProducts"+i).value=prod;
                i++;
            }
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalNimmBeob","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_valNimmBeob",true)},newtd);
        newinput.addEventListener("click",function(){
                GM_setValue2(COUNTRY+"_"+SERVER+"_valNimmBeob",this.checked,44);
        },false);
        createElement("td",{},newtr,getText("settings_valUseObservedPrices")[0]);
        createElement("td",{},newtr,getText("settings_valUseObservedPrices")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalPreiseBeobNum","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valPreiseBeobNum",18),"type":"text","maxlength":"2","size":"2px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var valPreiseBeobNum=parseInt(this.value,10);
            if (isNaN(valPreiseBeobNum)){
                this.value="";
            }else{
                this.value=valPreiseBeobNum;
                if (valPreiseBeobNum<1) {valPreiseBeobNum=1} // prevents calculation errors when user enters integer < 1
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valPreiseBeobNum", valPreiseBeobNum,75);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valPreiseBeobNum")[0]);
        createElement("td",{},newtr,getText("settings_valPreiseBeobNum")[1]);

        newtr = createElement("tr", {}, newtable);
        newtd = createElement("td", { "align": "center" }, newtr);
        newinput = createElement("input", { "id": "inputValUse3TimesNpcPrices", "type": "checkbox", "class": "link", "checked": GM_getValue(COUNTRY + "_" + SERVER + "_valUse3TimesNpcPrices", true) }, newtd);
        newinput.addEventListener("click", function() {
                valUse3TimesNpcPrices = this.checked;
                GM_setValue2(COUNTRY + "_" + SERVER + "_valUse3TimesNpcPrices", this.checked, 44);
        }, false);
        createElement("td", {}, newtr, getText("settings_valUse3TimesNpcPrices")[0]);
        createElement("td", {}, newtr, getText("settings_valUse3TimesNpcPrices")[1]);

        // ***************Messages************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("messages"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalNachr","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valPrivNachr",100),"class":"text","maxlength":"5","size":"5px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var valPrivNachr=parseInt(this.value,10);
            if (isNaN(valPrivNachr)){
                this.value="";
            }else{
                this.value=valPrivNachr;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valPrivNachr", valPrivNachr,45);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valPrivateMessages")[0]);
        createElement("td",{},newtr,getText("settings_valPrivateMessages")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalNachr","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valNachr",100),"class":"text","maxlength":"5","size":"5px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var valNachr=parseInt(this.value,10);
            if (isNaN(valNachr)){
                this.value="";
            }else{
                this.value=valNachr;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valNachr", valNachr,46);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valMarketMessages")[0]);
        createElement("td",{},newtr,getText("settings_valMarketMessages")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalMessageRe","type":"checkbox","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMessageRe",true),"class":"link"},newtd);
        newinput.addEventListener("click",function(){ GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMessageRe", this.checked,47); },false);
        createElement("td",{},newtr,getText("settings_valMessageRe")[0]);
        createElement("td",{},newtr,getText("settings_valMessageRe")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalContractLogAmount","value":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valContractLogAmount",200),"class":"text","maxlength":"5","size":"5px","style":"background-color:transparent;text-align:center;"},newtd);
        newinput.addEventListener("focus",function(){this.style.backgroundColor="lightblue";},false);
        newinput.addEventListener("blur",function(){this.style.backgroundColor="transparent";},false);
        newinput.addEventListener("keyup",function(){
            var valContractLogAmount=parseInt(this.value,10);
            if (isNaN(valContractLogAmount)){
                this.value="";
            }else{
                this.value=valContractLogAmount;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valContractLogAmount", valContractLogAmount,17);
            }
        },false);
        createElement("td",{},newtr,getText("settings_valContractLogAmount")[0]);
        createElement("td",{},newtr,getText("settings_valContractLogAmount")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"type":"checkbox","checked":valMessagesSystemMarkRead,"class":"link"},newtd);
        newinput.addEventListener("click",function(){ GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMessagesSystemMarkRead", this.checked,47); },false);
        createElement("td",{},newtr,getText("settings_valMessagesSystemMarkRead")[0]);
        createElement("td",{},newtr,getText("settings_valMessagesSystemMarkRead")[1]);

        // ***************General*************************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,getText("general"));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalAnimateStartscreen","type":"checkbox","class":"link","checked":GM_getValue("valAnimateStartscreen",false)},newtd);
        newinput.addEventListener("click",function(){GM_setValue("valAnimateStartscreen", this.checked);},false);
        createElement("td",{},newtr,getText("settings_valAnimateStartscreen")[0]);
        createElement("td",{},newtr,getText("settings_valAnimateStartscreen")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalTurnOffUpjersNews","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valTurnOffUpjersNews",true)},newtd);
        newinput.addEventListener("click",function(){
          GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valTurnOffUpjersNews", this.checked,100);
        },false);
        createElement("td",{},newtr,getText("settings_valTurnOffUpjersNews")[0]);
        createElement("td",{},newtr,getText("settings_valTurnOffUpjersNews")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalAutoLogin","type":"checkbox","class":"link","checked":GM_getValue("valAutoLogin",true)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("valAutoLogin", this.checked,48);},false);
        createElement("td",{},newtr,getText("settings_valAutoLogin")[0]);
        createElement("td",{},newtr,getText("settings_valAutoLogin")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalUpdate","type":"checkbox","class":"link","checked":GM_getValue("valUpdate",true)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("valUpdate", this.checked,49);},false);
        createElement("td",{},newtr,getText("settings_valUpdate")[0]);
        createElement("td",{},newtr,getText("settings_valUpdate")[1]);

        if (STAT_SERVER[COUNTRY]){
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{"align":"center"},newtr);
            newinput=createElement("input",{"id":"inputvalStatistik","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valStatistik",false)},newtd);
            newinput.addEventListener("click",function(){
                valStatistik=this.checked;
                GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valStatistik", valStatistik,50);
            },false);
            createElement("td",{},newtr,getText("settings_valSendStatistics")[0]);
            createElement("td",{},newtr,getText("settings_valSendStatistics")[1]);
        }

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{},newtr);
        createElement("td",{},newtr,getText("settings_valServerTimeOffset")[0]);
        newtd=createElement("td",{},newtr);
        newinput=createElement("button",{"type":"button","class":"link"},newtd,"-");
        newinput.addEventListener("click",function(){
            valServerTimeOffset=Math.max(-86400,valServerTimeOffset-3600);
            GM_setValue(COUNTRY+"_valServerTimeOffset",valServerTimeOffset);
            nowServerOff=unsafeWindow.Zeit.Server+valServerTimeOffset;
            this.parentNode.children[1].innerHTML=(valServerTimeOffset<0?"":"+")+Math.round(valServerTimeOffset/3600)+getText("shortHours");
            this.parentNode.children[3].innerHTML=getFormattedDateStr(nowServerOff)+"&nbsp;"+getDaytimeStr(nowServerOff);
        },false);
        createElement("span",{"style":"margin-right:5px;"},newtd,(valServerTimeOffset<0?"":"+")+Math.round(valServerTimeOffset/3600)+getText("shortHours"));
        newinput=createElement("button",{"type":"button","class":"link"},newtd,"+");
        newinput.addEventListener("click",function(){
            valServerTimeOffset=Math.min(86400,valServerTimeOffset+3600);
            GM_setValue(COUNTRY+"_valServerTimeOffset",valServerTimeOffset);
            nowServerOff=unsafeWindow.Zeit.Server+valServerTimeOffset;
            this.parentNode.children[1].innerHTML=(valServerTimeOffset<0?"":"+")+Math.round(valServerTimeOffset/3600)+getText("shortHours");
            this.parentNode.children[3].innerHTML=getFormattedDateStr(nowServerOff)+"&nbsp;"+getDaytimeStr(nowServerOff);
        },false);
        createElement("span",{"style":"margin-left:10px;"},newtd,getFormattedDateStr(nowServerOff)+"&nbsp;"+getDaytimeStr(nowServerOff));

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalGamecursor","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGamecursor",true)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGamecursor", this.checked,51);},false);
        createElement("td",{},newtr,getText("settings_valGamecursor")[0]);
        createElement("td",{},newtr,getText("settings_valGamecursor")[1]);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalDrag","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valDrag",false)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valDrag", this.checked,52);},false);
        createElement("td",{},newtr,getText("settings_valDrag")[0]);
        createElement("td",{},newtr,getText("settings_valDrag")[1]);

        /*
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalClickErrorbox","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valClickErrorbox",false)},newtd);
        newinput.addEventListener("click",function(){
            valClickErrorbox=this.checked;
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valClickErrorbox", valClickErrorbox,53);
        },false);
        createElement("td",{},newtr,getText("settings_valClickErrorbox")[0]);
        createElement("td",{},newtr,getText("settings_valClickErrorbox")[1]);
        */

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputvalHotkey","type":"checkbox","class":"link","checked":GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valHotkey",true)},newtd);
        newinput.addEventListener("click",function(){GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valHotkey", this.checked,54);},false);
        createElement("td",{},newtr,getText("settings_valHotkeys")[0]);
        createElement("td",{},newtr,getText("settings_valHotkeys")[1]);

/*  georgvr - replaced by next Option
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"colspan":"2","align":"center"},newtr);
        newinput=createElement("button",{"type":"button","class":"link"},newtd,getText("settings_cacheReset")[0]);
        newinput.addEventListener("click",function(){
            alert2(getText("settings_cacheReset")[1],getText("yes"),getText("no"),function(){
                for(var i=1000; i >=0; --i){unsafeWindow.clearInterval(i);}
                window.setTimeout(function(){
                    var protect={"kauf":1,"farmiLog":1,"vertraegeIn":1,"vertraegeOut":1,"levelLog":1,"nachrichten":1};
                    var help=cloneInto(GM_listValues(), unsafeWindow);
                    for(var v=help.length-1;v>-1;v--){
                        if(help[v].match(COUNTRY+"_"+SERVER+"_"+USERNAME+"_")){
                            var curr=help[v].replace(COUNTRY+"_"+SERVER+"_"+USERNAME+"_","");
                            if(!protect[curr]){ GM_deleteValue(help[v]); }
                        }
                    }
                    top.location.href=top.location.href;
                },500);
            });
        },false);
        createElement("td",{},newtr,getText("settings_cacheReset")[1]);
*/

        /*
         *    Option added by georgvr
         *    Option deletes all zones-related settings.
         *    Option is needed in case that buildings have been teared down and new building isn't recognized properly
         */
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"colspan":"2","align":"center"},newtr);
        newinput=createElement("button",{"type":"button","class":"link"},newtd,getText("settings_zoneReset")[0]);
        newinput.addEventListener("click",function(){
            alert2(getText("settings_zoneReset")[1],getText("yes"),getText("no"),function(){
                GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones"); // Berater
                GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zoneList"); // Automat
                GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zoneSettings"); // Automat
                GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zoneToList"); // Automat
                GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_autoMillStorage"); // Automat
            });
        },false);
        createElement("td",{},newtr,getText("settings_zoneReset")[1]);


        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"colspan":"2","align":"center"},newtr);
        newinput=createElement("button",{"type":"button","class":"link"},newtd,"Geisterzonen löschen");
        newinput.addEventListener("click",function(){
            alert2("Geisterzonen löschen",getText("yes"),getText("no"),function(){
                try {
                    for(var j=0;j<ALL_ZONES["farm"].length;j++){
                        if(!unsafeWindow.farms_data.farms[DATA_zones[ALL_ZONES["farm"][j]]["farmNr"]+1]) {
                            if ( zones.delete(ALL_ZONES["farm"][j]) ) {
                                GM_logInfo("do_main","","","Geisterzone: "+ALL_ZONES["farm"][j]);
                                continue;
                            }
                        }
                    }
                }catch(err){ GM_logError("Error ","","",err); }
            });
        },false);
        createElement("td",{},newtr,"Geisterzonen löschen");

        /*
         *    Option added by georgvr
         *    This option sets the quest-number of main-questseries and forestry-questseries to either the mff-questnumber, or to the max quest-number of each line
         *    This releases products which are related to progression of quests.
         *    This function is needed:
         *    -  After new installation of scripts or clearing zones-info and main-questseries are accomplished (var "quest_status" has no properties)
         *    -  Or cooldown-time of remaining questseries is active and values are not accessible for been automatically gathered by the bot.
         */
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"colspan":"2","align":"center"},newtr);
        newinput=createElement("button",{"type":"button","class":"link"},newtd,getText("settings_setQuestAll")[0]);
        newinput.addEventListener("click",function(){
            alert2(getText("settings_setQuestAll")[1],getText("yes"),getText("no"),function(){
                // Data are taken from ingame var quests_status (questseries for veterinary are not in the same var)
                /* structure of ingame-var quests_status
                 *     "main":
                 *          "1" , "2" , "3"
                 *              "cooldown" // total waiting time between two quests
                 *              "remain"   // remaining waiting time until release of next quest
                 *              "questid"  // questnumber
                 *              "data"     // quest related information (products needed, rewards and text)
                 *     "forestry"
                 *          "1" , "2"
                 *     "foodworld"
                 *          "1"
                 *
                 * Conditions to release Quest-Series
                 *     main 1:     ???
                 *     main 2:     Level 31
                 *     main 3:     Level 40 and Farm 5 exists
                 *     forestry 1: Level 20 and "unsafeWindow.forestry_unlock" is "1" (and not "undefined")
                 *     forestry 2: quest 35 of forestry 1 completed
                 *
                 */
                var help = "setQuestAll "
                var help = help + "MAIN ";
                if (USERLEVEL >= 47
                    && unsafeWindow.quests_status.hasOwnProperty("main")
                    && unsafeWindow.quests_status["main"].hasOwnProperty("5")
                    && speedlink_farm6.style.display=="block" ) {
                    // main questseries 5 exists and is not accomplished
                    var help = help + "5_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["main"][5]["remain"],10))) {
                        // cooldown-time is active - quest is not accessible
                        questData["main"][5] = INIT_questData["main"][5].clone();
                        questData["main"][5]["nr"] = unsafeWindow.quests_status["main"][5]["questid"];
                        questData["main"][5]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["main"][5]["remain"],10));
                        questData["main"][5]["given"] = new Object();
                        questData["main"][5]["data"] = gatherQuestData("main","5",questData["main"][5]["nr"]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["main"][5]["nr"] + " ";
                    } else {
                        // main questseries 5 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL >= 47
                    && speedlink_farm5.style.display=="block"
                    && (!unsafeWindow.quests_status.hasOwnProperty("main")
                        || !unsafeWindow.quests_status["main"].hasOwnProperty("5"))) {
                    // no main questseries - or main questseries 5 has no properties: questseries must be accomplished
                    questData["main"][5] = INIT_questData["main"][5].clone();
                    questData["main"][5]["nr"] = QUESTS["main"][5].length;
                    questData["main"][5]["given"] = new Object();
                    questData["main"][5]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "5_Accomplished: SetLastQuestNumber_QuestNumber_" + questData["main"][5]["nr"] + " ";
                } else if (USERLEVEL >= 40
                    && speedlink_farm5.style.display!="block"){
                    // Farm 5 is not released - main questseries 3 is not accessible - do nothing
                    var help = help + "4_NoFarm6:_DoNothing ";
                }

                if (USERLEVEL >= 42
                    && unsafeWindow.quests_status.hasOwnProperty("main")
                    && unsafeWindow.quests_status["main"].hasOwnProperty("4")
                    && speedlink_farm6.style.display=="block" ) {
                    // main questseries 4 exists and is not accomplished
                    var help = help + "4_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["main"][4]["remain"],10))) {
                        // cooldown-time is active - quest is not accessible
                        questData["main"][4] = INIT_questData["main"][4].clone();
                        questData["main"][4]["nr"] = unsafeWindow.quests_status["main"][4]["questid"];
                        questData["main"][4]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["main"][4]["remain"],10));
                        questData["main"][4]["given"] = new Object();
                        questData["main"][4]["data"] = gatherQuestData("main","4",questData["main"][4]["nr"]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["main"][4]["nr"] + " ";
                    } else {
                        // main questseries 4 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL >= 42
                    && speedlink_farm5.style.display=="block"
                    && (!unsafeWindow.quests_status.hasOwnProperty("main")
                        || !unsafeWindow.quests_status["main"].hasOwnProperty("4"))) {
                    // no main questseries - or main questseries 4 has no properties: questseries must be accomplished
                    questData["main"][4] = INIT_questData["main"][4].clone();
                    questData["main"][4]["nr"] = QUESTS["main"][4].length;
                    questData["main"][4]["given"] = new Object();
                    questData["main"][4]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "4_Accomplished: SetLastQuestNumber_QuestNumber_" + questData["main"][4]["nr"] + " ";
                } else if (USERLEVEL >= 40
                    && speedlink_farm5.style.display!="block"){
                    // Farm 5 is not released - main questseries 3 is not accessible - do nothing
                    var help = help + "4_NoFarm6:_DoNothing ";
                }

                if (USERLEVEL >= 40
                    && unsafeWindow.quests_status.hasOwnProperty("main")
                    && unsafeWindow.quests_status["main"].hasOwnProperty("3")
                    && speedlink_farm5.style.display=="block" ) {
                    // main questseries 3 exists and is not accomplished
                    var help = help + "3_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["main"][3]["remain"],10))) {
                        // cooldown-time is active - quest is not accessible
                        questData["main"][3] = INIT_questData["main"][3].clone();
                        questData["main"][3]["nr"] = unsafeWindow.quests_status["main"][3]["questid"];
                        questData["main"][3]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["main"][3]["remain"],10));
                        questData["main"][3]["given"] = new Object();
                        questData["main"][3]["data"] = gatherQuestData("main","3",questData["main"][3]["nr"]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["main"][3]["nr"] + " ";
                    } else {
                        // main questseries 3 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL >= 40
                    && speedlink_farm5.style.display=="block"
                    && (!unsafeWindow.quests_status.hasOwnProperty("main")
                        || !unsafeWindow.quests_status["main"].hasOwnProperty("3"))) {
                    // no main questseries - or main questseries 3 has no properties: questseries must be accomplished
                    questData["main"][3] = INIT_questData["main"][3].clone();
                    questData["main"][3]["nr"] = QUESTS["main"][3].length;
                    questData["main"][3]["given"] = new Object();
                    questData["main"][3]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "3_Accomplished: SetLastQuestNumber_QuestNumber_" + questData["main"][3]["nr"] + " ";
                } else if (USERLEVEL >= 40
                    && speedlink_farm5.style.display!="block"){
                    // Farm 5 is not released - main questseries 3 is not accessible - do nothing
                    var help = help + "3_NoFarm5:_DoNothing ";
                }
                if (USERLEVEL >= 31
                    && unsafeWindow.quests_status.hasOwnProperty("main")
                    && unsafeWindow.quests_status["main"].hasOwnProperty("2")){
                    // main questseries 2 exists and is not accomplished
                    var help = help + "2_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["main"][2]["remain"],10))){
                        // cooldown-time is active - quest is not accessible
                        questData["main"][2] = INIT_questData["main"][2].clone();
                        questData["main"][2]["nr"] = unsafeWindow.quests_status["main"][2]["questid"];
                        questData["main"][2]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["main"][2]["remain"],10));
                        questData["main"][2]["given"] = new Object();
                        questData["main"][2]["data"] = gatherQuestData("main","2",questData["main"][2]["nr"]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["main"][2]["nr"] + " ";
                    } else {
                        // main questseries 2 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL >= 31
                    && (!unsafeWindow.quests_status.hasOwnProperty("main")
                        || !unsafeWindow.quests_status["main"].hasOwnProperty("2"))) {
                    // no main questseries - or main questseries 2 has no properties: questseries must be accomplished
                    questData["main"][2] = INIT_questData["main"][2].clone();
                    questData["main"][2]["nr"] = QUESTS["main"][2].length;
                    questData["main"][2]["given"] = new Object();
                    questData["main"][2]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "2_Accomplished:_SetLastQuestNumber_" + questData["main"][2]["nr"] + " ";
                }
                if (USERLEVEL >= 10
                    && unsafeWindow.quests_status.hasOwnProperty("main")
                    && unsafeWindow.quests_status["main"].hasOwnProperty("1")) {
                    // main questseries 1 exists and is not accomplished
                    var help = help + "1_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["main"][1]["remain"],10))) {
                        // cooldown-time is active - quest is not accessible
                        questData["main"][1] = INIT_questData["main"][1].clone();
                        questData["main"][1]["nr"] = unsafeWindow.quests_status["main"][1]["questid"];
                        questData["main"][1]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["main"][1]["remain"],10));
                        questData["main"][1]["given"] = new Object();
                        questData["main"][1]["data"] = gatherQuestData("main","1",questData["main"][1]["nr"]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["main"][1]["nr"] + " ";
                    } else {
                        // main questseries 1 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL >= 10
                    && (!unsafeWindow.quests_status.hasOwnProperty("main")
                        || !unsafeWindow.quests_status["main"].hasOwnProperty("1"))) {
                    // no main questseries - or main questseries 1 has no properties: questseries must be accomplished
                    questData["main"][1] = INIT_questData["main"][1].clone();
                    questData["main"][1]["nr"] = QUESTS["main"][1].length;
                    questData["main"][1]["given"] = new Object();
                    questData["main"][1]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "1_Accomplished:_SetLastQuestNumber_" + questData["main"][1]["nr"] + " ";
                }
                var help = help + "FORESTRY ";
                if (USERLEVEL>20
                    && unsafeWindow.quests_status.hasOwnProperty("forestry")
                    && unsafeWindow.quests_status["forestry"].hasOwnProperty("1")) {
                    // forestry questseries 1 exists and is not accomplished
                    var help = help + "1_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["forestry"][1]["remain"],10))){
                        // cooldown-time is active - quest is not accessible
                        questData["forestry"][1] = INIT_questData["forestry"][1].clone();
                        questData["forestry"][1]["nr"] = 1+parseInt(unsafeWindow.quests_status["forestry"][1]["questid"],10);
                        questData["forestry"][1]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["forestry"][1]["remain"],10));
                        questData["forestry"][1]["given"] = new Object();
                        questData["forestry"][1]["data"] = QUESTS["forestry"][1][(questData["forestry"][1]["nr"])];
                        for (var v=0; v<(questData["forestry"][1]["data"][0].length); v++){
                            questData["forestry"][1]["data"][0][v][3]=true;
                        }
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["forestry"][1]["nr"] + " ";
                    } else {
                        // forestry questseries 1 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL>20
                    && (!unsafeWindow.quests_status.hasOwnProperty("forestry")
                        || !unsafeWindow.quests_status["forestry"].hasOwnProperty("1"))) {
                    // no forestry questseries - or forestry questseries 1 has no properties: questseries must be accomplished
                    questData["forestry"][1] = INIT_questData["forestry"][1].clone();
                    questData["forestry"][1]["nr"] = QUESTS["forestry"][1].length;
                    questData["forestry"][1]["given"] = new Object();
                    questData["forestry"][1]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "1_Accomplished:_SetLastQuestNumber_" + questData["forestry"][1]["nr"] + " ";
                }
                if (USERLEVEL>20
                    && unsafeWindow.quests_status.hasOwnProperty("forestry")
                    && unsafeWindow.quests_status["forestry"].hasOwnProperty("2")) {
                    var help = help + "2_NotAccomplished";
                    if (!isNaN(parseInt(unsafeWindow.quests_status["forestry"][2]["remain"],10))){
                        // cooldown-time is active - quest is not accessible
                        questData["forestry"][2] = INIT_questData["forestry"][2].clone();
                        questData["forestry"][2]["nr"] = 1+parseInt(unsafeWindow.quests_status["forestry"][2]["questid"],10);
                        questData["forestry"][2]["time"] = (parseInt(unsafeWindow.Zeit.Server,10) + parseInt(unsafeWindow.quests_status["forestry"][2]["remain"],10));
                        questData["forestry"][2]["given"] = new Object();
                        questData["forestry"][2]["data"] = QUESTS["forestry"][2][(questData["forestry"][2]["nr"])];
                        for (var v=0; v<(questData["forestry"][2]["data"][0].length); v++){
                            questData["forestry"][2]["data"][0][v][3]=true;
                        }
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        //unsafeData.questData=questData.clone();
                        unsafeData.questData=Object.assign({}, questData);
                        var help = help + "_cooldown:_SetValues_QuestNumber_" + questData["forestry"][2]["nr"] + " ";
                    } else {
                        // forestry questseries 2 is accessible - do nothing
                        var help = help + "_accessible:_DoNothing ";
                    }
                } else if (USERLEVEL>20
                    && (!unsafeWindow.quests_status.hasOwnProperty("forestry")
                        || !unsafeWindow.quests_status["forestry"].hasOwnProperty("2"))) {
                    // no forestry questseries - or forestry questseries 2 has no properties: questseries must be accomplished
                    questData["forestry"][2] = INIT_questData["forestry"][2].clone();
                    questData["forestry"][2]["nr"] = QUESTS["forestry"][2].length;
                    questData["forestry"][2]["given"] = new Object();
                    questData["forestry"][2]["time"] = 0;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                    //unsafeData.questData=questData.clone();
                    unsafeData.questData=Object.assign({}, questData);
                    var help = help + "2_Accomplished:_SetLastQuestNumber_" + questData["forestry"][2]["nr"] + " ";
                }
                console.log(help);
                //console.log(implode(unsafeData.questData));
                help=null;
            });
        },false);
        createElement("td",{},newtr,getText("settings_setQuestAll")[1]);
        // Option added by georgvr - free choice of quest-number for testing purpose
        if(DEVMODE){
            if(unsafeWindow.quests_status.hasOwnProperty("main")
            && unsafeWindow.quests_status["main"].hasOwnProperty("3")
            && speedlink_farm5.style.display=="block") {
                newtr=createElement("tr",{},newtable);
                newtd=createElement("td",{"align":"center"},newtr);
                var newsel = createElement("select",{"id":"SetQuestMain3To","style":"width:auto;height:18px;margin-left:5px;"},newtd);
                    createElement("option",{"value":-1},newsel,getText("hide"));
                    for(var i=1;i<QUESTS["main"][3].length;i++){
                        createElement("option",{"value":i},newsel,i);
                    }
                    createElement("option",{"value":(QUESTS["main"][3].length)++},newsel,getText("lastQuest"));
                newsel.selectedIndex = questData["main"][3]["nr"];
                var help_q=parseInt(questData["main"][3]["nr"],10);
                newsel.addEventListener("change",function(){
                    if(isNaN(this.value)){return false;}
                    help_q=parseInt(this.value,10);
                },false);
                newtd=createElement("td",{"align":"center"},newtr);
                newinput=createElement("button",{"type":"button","class":"link"},newtd,"Execute (Main 3)");
                newinput.addEventListener("click",function(){
                    alert2("Sets the quest-number to the selected value - regardless whether the value is reasonable or not!",getText("yes"),getText("no"),function(){
                        questData["main"][3]["nr"] = help_q;
                        questData["main"][3]["time"] = now;
                        questData["main"][3]["given"] = new Object();
                        questData["main"][3]["data"] = gatherQuestData("main","3",help_q);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                        unsafeData.questData=questData.clone();
                    });
                },false);
                createElement("td",{},newtr,"Sets the quest-number to the selected value - regardless whether the value is reasonable or not.");
                newsel=null;i=null;
            }
        }

        // ***************Developing**********************************************
        newtr=createElement("tr",{},newtable);
        newtd=createElement("th",{"colspan":"3"},newtr,"Developing");

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputDevmode","type":"checkbox","class":"link","checked":DEVMODE},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("devmode",DEVMODE=this.checked,55);},false);
        createElement("td",{},newtr,"Developer Mode");
        createElement("td",{},newtr);

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputDevmodeEvents","type":"checkbox","class":"link","checked":DEVMODE_EVENTS},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("devmode_events",DEVMODE_EVENTS=this.checked,56);},false);
        createElement("td",{},newtr,"Developer Mode");
        createElement("td",{},newtr,"Show events (reload page)");

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputDevmodeFunctions","type":"checkbox","class":"link","checked":DEVMODE_FUNCTION},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("devmode_function",DEVMODE_FUNCTION=this.checked);},false);
        createElement("td",{},newtr,"Developer Function");
        createElement("td",{},newtr,"Show function calls");

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputDevmodeLogWarning","type":"checkbox","class":"link","checked":DEVMODE_LOG_WARNING},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("devmode_log_warning",DEVMODE_LOG_WARNING=this.checked);},false);
        createElement("td",{"rowspan":"2"},newtr,"Logging");
        createElement("td",{},newtr,"Show warnings in screen");

        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"align":"center"},newtr);
        newinput=createElement("input",{"id":"inputDevmodeLogWarning","type":"checkbox","class":"link","checked":DEVMODE_LOG_ERROR},newtd);
        newinput.addEventListener("click",function(){GM_setValue2("devmode_log_error",DEVMODE_LOG_ERROR=this.checked);},false);
        createElement("td",{},newtr,"Show errors in screen");

        newtable=null;newtr=null;newtd=null;newdiv=null;newinput=null;

    }catch(err){GM_logError("buildInfoPanelOptions","","",err);}
}
function buildInfoPanelAccounts(showPW){
    try{
        var container,newtable,newtr,newtd,newinput,newselect,newdiv;
        newdiv=$("infoPanelNaviAccounts");
        newdiv.classList.remove("naviItem");
        newdiv.classList.add("naviItemActive");
        var logindata=explode(GM_getValue("logindata"),"buildInfoPanelAccounts/logindata",[]);
        container=$("infoPanelR");
        container.innerHTML="";
        newtable=createElement("table",{"align":"center"},container);
        newtr=createElement("tr",{},newtable);
        createElement("th",{},newtr);
        createElement("th",{},newtr,getText("server"));
        createElement("th",{},newtr,getText("name"));
        createElement("th",{},newtr,getText("password"));
        createElement("th",{"colspan":2},newtr);
        for(var v=0;v<logindata.length;v++){
            newtr=createElement("tr",{"v":v},newtable);
            newtd=createElement("td",{},newtr);
            newinput=createElement("input",{"type":"checkbox","class":"link","checked":logindata[v][4]},newtd);
            newinput.addEventListener("mouseover",function(event){ toolTip.show(event,getText("accountActive")); },false);
            newinput.addEventListener("change",function(){
                logindata[this.parentNode.parentNode.getAttribute("v")][4]=this.checked;
                GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
            },false);
            newtd=createElement("td",{},newtr);
            newinput=createElement("input",{"class":"text","style":"width:20px","maxlength":"2"},newtd);
            if (isNaN(logindata[v][1])){ logindata[v][1]="0";}
            if (logindata[v][1]!="0"){ newinput.value=logindata[v][1]; }
            newinput.addEventListener("change",function(){
                var readin=parseInt(this.value,10);
                if (isNaN(readin) || (readin<1)){
                    alert2(getText("invalidServer"),getText("ok")); this.value="";
                }else{
                    this.value=readin;
                    logindata[this.parentNode.parentNode.getAttribute("v")][1]=readin;
                    GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
                }
            },false);
            newselect=createElement("select",{},newtd);
            for(var w in GAMEPAGES){
                if(!GAMEPAGES.hasOwnProperty(w)){ continue; }
                createElement("option",{"value":w},newselect,w);
            }
            newselect.value=logindata[v][0];
            newselect.addEventListener("change",function(){
                logindata[this.parentNode.parentNode.getAttribute("v")][0]=this.value;
                GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
            },false);

            newtd=createElement("td",{},newtr);
            newinput=createElement("input",{"value":logindata[v][2],"class":"text","style":"width:140px","maxlength":"20"},newtd);
            newinput.addEventListener("change",function(){
                logindata[this.parentNode.parentNode.getAttribute("v")][2]=this.value;
                GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
            },false);

            newtd=createElement("td",{},newtr);
            newinput=createElement("input",{"value":enc(logindata[v][3],-4242),"class":"text","style":"width:140px","maxlength":"20"},newtd);
            if (!showPW){ newinput.type="password"; }
            newinput.addEventListener("change",function(){
                logindata[this.parentNode.parentNode.getAttribute("v")][3]=enc(this.value,4242);
                GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
            },false);

            newtd=createElement("td",{},newtr);
            if (v>0){
                newdiv=createElement("div",{"class":"link","style":"width:14px;height:10px;"},newtd);
                createElement("img",{"src":GFX+"quest_up.gif","style":"width:14px;height:10px;"},newdiv);
                newdiv.addEventListener("mouseover",function(){this.style.backgroundColor="blue";},false);
                newdiv.addEventListener("mouseout",function(){this.style.backgroundColor="transparent";},false);
                newdiv.addEventListener("click",function(showPW){ return function(){
                    var currLine=parseInt(this.parentNode.parentNode.getAttribute("v"),10);
                    logindata.splice(currLine-1,2,logindata[currLine],logindata[currLine-1]);
                    GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
                    buildInfoPanelAccounts(showPW);
                }}(showPW),false);
            }
            if (v<logindata.length-1){
                newdiv=createElement("div",{"class":"link","style":"width:14px;height:10px;"},newtd);
                createElement("img",{"src":GFX+"quest_down.gif","style":"width:14px;height:10px;"},newdiv);
                newdiv.addEventListener("mouseover",function(){this.style.backgroundColor="blue";},false);
                newdiv.addEventListener("mouseout",function(){this.style.backgroundColor="transparent";},false);
                newdiv.addEventListener("click",function(showPW){ return function(){
                    var currLine=parseInt(this.parentNode.parentNode.getAttribute("v"),10);
                    logindata.splice(currLine,2,logindata[currLine+1],logindata[currLine]);
                    GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
                    buildInfoPanelAccounts(showPW);
                }}(showPW),false);
            }

            newtd=createElement("td",{},newtr);
            createElement("img",{"src":GFX+"popin/contracts/anullieren.gif","class":"link","style":"width: 16px;height: 16px;"},newtd);
            newtd.addEventListener("mouseover",function(event){
                toolTip.show(event,getText("delete"));
                this.style.backgroundColor="blue";
            },false);
            newtd.addEventListener("mouseout",function(){this.style.backgroundColor="transparent";},false);
            newtd.addEventListener("click",function(showPW){ return function(){
                var currLine=parseInt(this.parentNode.getAttribute("v"),10);
                logindata.splice(currLine,1);
                GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
                buildInfoPanelAccounts(showPW);
            }}(showPW),false);
        }
        newtr=createElement("tr",{},newtable);
        newtd=createElement("td",{"colspan":"5","class":"link","style":"font-weight:bold;font-size:16px;text-align:right;"},newtr,"+");
        newtd.addEventListener("mouseover",function(){this.style.backgroundColor="blue";},false);
        newtd.addEventListener("mouseout",function(){this.style.backgroundColor="transparent";},false);
        newtd.addEventListener("click",function(showPW){ return function(){
            logindata.push([COUNTRY,"0","","",false]); // new empty line
            GM_setValueCache("logindata",implode(logindata,"buildInfoPanelAccounts/logindata"),57);
            buildInfoPanelAccounts(showPW);
        }}(showPW),false);
        newdiv=createElement("div",{"align":"center"},container);
        newinput=createElement("input",{"type":"checkbox","class":"link","checked":showPW},newdiv);
        newinput.addEventListener("click",function(){buildInfoPanelAccounts(this.checked);},false);
        createElement("span",{},newdiv,getText("showPasswords"));
        container=null;newtable=null;newtr=null;newtd=null;newinput=null;newselect=null;newdiv=null;
    }catch(err){GM_logError("buildInfoPanelAccounts","","",err);}
}
function buildInfoPanelHotkeys(){
    try{
        var container,newtable,newtr,newtd,newinput,newdiv;
        newdiv=$("infoPanelNaviHotkeys");
        newdiv.classList.remove("naviItem");
        newdiv.classList.add("naviItemActive");
        container=$("infoPanelR");
        newtable=createElement("table",{"align":"center","border":"1","class":"hoverRowBgCc9"},container);
        for(var tr in getText("settings_hotkeymap")){
            if(!getText("settings_hotkeymap").hasOwnProperty(tr)){ continue; }
            newtr=createElement("tr",{},newtable);
            newtd=createElement("td",{},newtr);
            newinput=createElement("input",{"id":"hotkey"+tr,"value":getKeySymbol(hotkeymap[tr]),"class":"text","style":"width:80px;"},newtd);
            newinput.addEventListener("keyup",function(event){
                this.value=getKeySymbol(event.keyCode);
                hotkeymap[this.id.replace("hotkey","")]=event.keyCode;
                GM_setValue2("hotkeymap",implode(hotkeymap,"buildInfoPanelHotkeys/hotkeymap"),58);
            },false);
            createElement("td",{},newtr,getText("settings_hotkeymap")[tr]);
        }
        container=null;newtable=null;newtr=null;newtd=null;newinput=null;newdiv=null;
    }catch(err){GM_logError("buildInfoPanelHotkeys","","",err);}
}
function buildInfoPanelCss(){
    try{
        var container,newtable,newtr,newtd,newinput,newdiv;
        newdiv=$("infoPanelNaviCss");
        newdiv.classList.remove("naviItem");
        newdiv.classList.add("naviItemActive");
        container=$("infoPanelR");
        newtable=createElement("table",{"align":"center"},container);
        for(var v in css_styles){
            if(!css_styles.hasOwnProperty(v)){ continue; }
            newtr=createElement("tr",{},newtable);
            createElement("td",{},newtr,v);
            newtd=createElement("td",{},newtr);
            var help=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_"+v,css_styles[v][1]);
            newinput=createElement("input",{"name":v,"value":help,"class":"text","style":"width:250px;"},newtd);
            newinput.addEventListener("keyup",function(){
                var v=this.getAttribute("name");
                if(this.value==""){ this.value=INIT_CSS_STYLES[v][1]; }
                css_styles[v][1]=this.value;
                var help=css_styles[v][1];
                for(var w=0;w<css_styles[v][0].length;w++){
                    help=css_styles[css_styles[v][0][w]][1]+help;
                }
                this.parentNode.nextSibling.firstElementChild.setAttribute("style",help);
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"buildInfoPanelCss/css_styles"));
            },false);
            newtd=createElement("td",{},newtr);
            for(var w=0;w<css_styles[v][0].length;w++){
                help=css_styles[css_styles[v][0][w]][1]+help;
            }
            newdiv=createElement("div",{"style":help},newtd,"test");
        }
        container=null;newtable=null;newtr=null;newtd=null;newinput=null;newdiv=null;
    }catch(err){GM_logError("buildInfoPanelCss","","",err);}
}
function buildInfoPanelImport(mode,showData,onlyThisAccount){
    try{
        var container,newtable,newtr,newtd,newinput,newdiv;
        newdiv=$("infoPanelNaviImport");
        newdiv.classList.remove("naviItem");
        newdiv.classList.add("naviItemActive");
        container=$("infoPanelR");
        container.innerHTML="";
        newdiv=createElement("div",{"style":"left:0px;position:absolute;width:450px;"},container);
        newinput=createElement("div",{"class":"link naviItem"+(mode=="export"?"Active":""),"style":"width:40%;"},newdiv,"Export");
        newinput.addEventListener("click",function(){
            buildInfoPanelImport("export",false,true);
        },false);
        newinput=createElement("div",{"class":"link naviItem"+(mode=="import"?"Active":""),"style":"width:40%;"},newdiv,"Import");
        newinput.addEventListener("click",function(){
            buildInfoPanelImport("import",false,true);
        },false);
        container=createElement("div",{"id":"beraterDataImportContainer","style":"position:absolute;top:30px;left:5px;height:485px;width:475px;overflow:auto;"},container);
        switch(mode){
        case "export":{
            // if (showData&&(!onlyThisAccount)){
            //  if(!confirm("Attention! Showing all data of all accounts can slow down your browser. Continue?")){
            //      showData=false;
            //  }
            // }
            createElement("div",{},container,"Click the lines to remove them.");

            var newdiv=createElement("div",{},container);
            var newinput=createElement("input",{"type":"checkbox","checked":showData},newdiv);
            newinput.addEventListener("click",function(){
                showExportData(this.checked,onlyThisAccount);
            },false);
            createElement("span",{},newdiv,"Show the data");

            newdiv=createElement("div",{},container);
            newinput=createElement("input",{"type":"checkbox","checked":onlyThisAccount},newdiv);
            newinput.addEventListener("click",function(){
                showExportData(showData,this.checked);
            },false);
            createElement("span",{},newdiv,"Only this account");

            newinput=createElement("button",{"class":"link"},container,"Create string!");
            newinput.addEventListener("click",function(){
                var save="";
                var help=$("beraterDataImportContainer").getElementsByTagName("tr");
                for(var v=0;v<help.length;v++){
                    var help2=help[v].getElementsByTagName("td");
                    save += help2[0].innerHTML+":"+help2[1].innerHTML+":"+help2[2].firstElementChild.innerHTML+"::";
                }
                prompt("Copy this string to a text-file", save.slice(0,save.length-2));
            },false);
            var newtable=createElement("table",{"border":"1","class":"hoverRowBgCc9","style":"width:100%"},container);
            var newtr,newtd;
            var help=cloneInto(GM_listValues(), unsafeWindow);
            help.sort();
            if(onlyThisAccount){
                for(var v=0;v<help.length;v++){
                    if(help[v].search(COUNTRY+"_"+SERVER+"_"+USERNAME)!=-1){
                        var help2=GM_getValue(help[v]);
                        var help3="s";
                        if(help2==""){ help2=" "; }
                        if(typeof help2=="number"){ help3="n"; }
                        else if(typeof help2=="boolean"){ help3="b"; }
                        else{ help2=help2.replace(/(:+)/g,":"); }
                        newtr=createElement("tr",{},newtable);
                        newtr.addEventListener("click",function(){ removeElement(this); },false);
                        createElement("td",{},newtr,help[v].replace(COUNTRY+"_"+SERVER+"_"+USERNAME+"_",""));
                        createElement("td",{},newtr,help3);
                        newtd=createElement("td",{"style":(showData?"":"display:none;")},newtr);
                        createElement("div",{"style":"max-height:100px;width:270px;overflow:auto;"},newtd,help2);
                    }
                }
            }else{
                for(var v=0;v<help.length;v++){
                    var help2=GM_getValue(help[v]);
                    var help3="s";
                    if(help2==""){ help2=" "; }
                    if(typeof help2=="number"){ help3="n"; }
                    else if(typeof help2=="boolean"){ help3="b"; }
                    else{ help2=help2.replace(/(:+)/g,":"); }
                    newtr=createElement("tr",{},newtable);
                    newtr.addEventListener("click",function(){ removeElement(this); },false);
                    createElement("td",{},newtr,help[v]);
                    createElement("td",{},newtr,help3);
                    newtd=createElement("td",{"style":(showData?"":"display:none;")},newtr);
                    createElement("div",{"style":"max-height:100px;width:270px;overflow:auto;"},newtd,help2);
                }
            }
            container=null;newdiv=null;newtable=null;newtr=null;newtd=null;newinput=null;
        break;}
        case "import":{
            createElement("div",{},container,"Click the lines to remove them.");

            var newdiv=createElement("div",{},container);
            var newinput=createElement("input",{"type":"checkbox","checked":showData},newdiv);
            newinput.addEventListener("click",function(){
                showImportData(this.checked,onlyThisAccount);
            },false);
            createElement("span",{},newdiv,"Show the data");

            newdiv=createElement("div",{},container);
            newinput=createElement("input",{"type":"checkbox","checked":onlyThisAccount},newdiv);
            newinput.addEventListener("click",function(){
                showImportData(showData,this.checked);
            },false);
            createElement("span",{},newdiv,"Only this account");

            newinput=createElement("button",{"class":"link"},container,"Enter data-string");
            newinput.addEventListener("click",function(){
                var promptdata=prompt("Please enter the data-string","");
                if(promptdata){
                    var container=$("beraterDataImportContainer");
                    var newtable=container.getElementsByTagName("table");
                    if(newtable[0]){ removeElement(newtable[0]); }
                    newtable=createElement("table",{"border":"1","class":"hoverRowBgCc9","style":"width:100%"},container);
                    var newtr,newtd;
                    var help=promptdata.split("::");
                    for(var v=0;v<help.length;v++){
                        var help2=help[v].split(":");
                        var impName=(onlyThisAccount?COUNTRY+"_"+SERVER+"_"+USERNAME+"_":"")+help2.splice(0,1)[0];
                        var impType=help2.splice(0,1)[0];
                        var impContent=help2.join(":");
                        if(impContent==" "){ impContent=""; }
                        if((impType=="n")||(impType=="b")||(impType=="s")){
                            newtr=createElement("tr",{},newtable);
                            newtr.addEventListener("click",function(){ removeElement(this); },false);
                            createElement("td",{},newtr,impName);
                            createElement("td",{},newtr,impType);
                            newtd=createElement("td",{"style":(showData?"":"display:none;")},newtr);
                            createElement("div",{"style":"max-height:100px;width:280px;overflow:auto;"},newtd,impContent);
                        }
                    }
                    container=null;newtable=null;newtr=null;newtd=null;
                }
            },false);
            newinput=createElement("button",{"class":"link"},container,"Import this!");
            newinput.addEventListener("click",function(){
                var help=$("beraterDataImportContainer").getElementsByTagName("tr");
                for(var v=0;v<help.length;v++){
                    var help2=help[v].getElementsByTagName("td");
                    switch(help2[1].innerHTML){
                    case "n": GM_setValue2(help2[0].innerHTML,parseInt(help2[2].getElementsByTagName("div")[0].innerHTML,10),59);break;
                    case "b": GM_setValue2(help2[0].innerHTML,help2[2].getElementsByTagName("div")[0].innerHTML=="true",60);break;
                    case "s": GM_setValue2(help2[0].innerHTML,help2[2].getElementsByTagName("div")[0].innerHTML,61);break;
                    }
                }
                alert2("done",getText("ok"));
            },false);
        break;}
        }
        container=null;newtable=null;newtr=null;newtd=null;newinput=null;newdiv=null;
    }catch(err){GM_logError("buildInfoPanelImport","","",err);}
}
function buildInfoPanelLevel(){
    try{
        var container=$("infoPanelInner");
        container.innerHTML="";
        // GM_log("levelLog:\n"+print_r(levelLog,"",true,"\n"));
        newdiv=createElement("div",{"style":"height:400px;overflow:auto;color:black;"},container);
        // todayStr=getDateStr(now,2,false);
        levelLog[levelLogId][1]=parseInt($("pkt").innerHTML.replace(/\D/g,""),10);
        var totalumsatz=[0,0,[0,0]];
        var day,days;

        newtable=createElement("table",{"border":"1","style":"width:100%;"},newdiv);
        thead=createElement("thead",{},newtable); // sortable table
        newtbody=createElement("tbody",{"class":"hoverRowBgCc9"},newtable);
        newtfoot=createElement("tfoot",{},newtable);

        newtr=createElement("tr",{"class":"borderBottom2"},thead);
        createElement("th",{"class":"link","sortdir":"Asc","style":"border-right:2px solid black;"},newtr,getText("day"));
        createElement("th",{"class":"link","sortdir":"Asc"},newtr,getText("points"));
        createElement("th",{"class":"link","sortdir":"Asc"},newtr,"+");
        createElement("th",{"class":"link","sortdir":"Asc","style":"border-right:2px solid black;"},newtr,getText("rank"));
        createElement("th",{"class":"link","sortdir":"Asc"},newtr,getText("market"));
        createElement("th",{"class":"link","sortdir":"Asc"},newtr,getText("contract"));
        createElement("th",{"class":"link","sortdir":"Asc"},newtr,unsafeWindow.customerarecalled.replace(/%FARMI%/,""));
        new SortableTable(newtr);

        for(var v=levelLog.length-1;v>=0;v--){
            if(levelLog[v][0].match(/^\d+-\d+$/)){
                day=/^(\d+)-(\d+)$/.exec(levelLog[v][0]);
                day.swap(2,3);
                day[0]=1;
                day[1]=parseInt(day[1],10);
                day[2]=parseInt(day[2],10);
                days=(new Date(day[2],day[1],0)).getDate();
            }else{
                day=levelLog[v][0].split(/\./);
                day[0]=parseInt(day[0],10);
                day[1]=parseInt(day[1],10);
                day[2]=parseInt(day[2],10);
                days=1;
                // doubling with month-entry
                day[3]=day[2]+(day[1]<10?"0":"")+day[1];
                for(var w=levelLog.length-1;w>=0;w--){
                    if(levelLog[w][0]==day[3]){ days=0;break; }
                }
            }
            day=(new Date(day[2],day[1]-1,day[0]));

            newtr=createElement("tr",{"align":"right"},newtbody);

            // Sundays
            if (day.getDay()==0){
                newtr.setAttribute("class","borderBottom2");
            }

            createElement("td",{"value":day.getTime(),"style":"text-align:right;border-right:2px solid black;"},newtr,levelLog[v][0]==todayServerStr?getText("day0"):levelLog[v][0]);
            createElement("td",{"value":levelLog[v][1]},newtr,numberFormat(levelLog[v][1]));
            if(v==0){
                createElement("td",{"value":0},newtr);
            }else{
                createElement("td",{"value":(levelLog[v][1]-levelLog[v-1][1])},newtr,numberFormat(levelLog[v][1]-levelLog[v-1][1]));
            }
            createElement("td",{"value":levelLog[v][2],"style":"border-right:2px solid black;"},newtr,levelLog[v][2]?numberFormat(levelLog[v][2]):"");
            for(var w=0;w<=1;w++){
                createElement("td",{"value":levelLog[v][w+3]},newtr,numberFormat(levelLog[v][w+3]));
                totalumsatz[w] += levelLog[v][w+3];
            }
            if(levelLog[v][5]>0){
                createElement("td",{"value":levelLog[v][5]},newtr,numberFormat(levelLog[v][5]));
                totalumsatz[2][0] += days;
                totalumsatz[2][1] += levelLog[v][5];
            }else{
                createElement("td",{"value":0},newtr,"-");
            }
        }
        newtbody.scrollTop=newtbody.scrollHeight;
        //if (newdiv.scrollTop ==0) newdiv.scrollTop=(newdiv.scrollHeight < newdiv.clientHeight)?0:newdiv.scrollHeight - newdiv.clientHeight;

        newtr=createElement("tr",{"class":"borderTop2","align":"right"},newtfoot);
        createElement("td",{"style":"border-right:2px solid black;"},newtr,"Ø");
        createElement("td",{},newtr);
        if(v>1){
            var daycount=1+Math.round((now-getTime(levelLog[1][0]))/86400);
            createElement("td",{},newtr,numberFormat((levelLog[v-1][1]-levelLog[0][1])/daycount));
        }else{
            createElement("td",{},newtr);
        }
        createElement("td",{"style":"border-right:2px solid black;"},newtr);
        var daycount=1+Math.round((now-getTime(levelLog[0][0]))/86400);
        for(var w=0;w<2;w++){
            createElement("td",{},newtr,numberFormat(totalumsatz[w]/daycount));
        }
        createElement("td",{},newtr,numberFormat(totalumsatz[2][1]/totalumsatz[2][0]));

        newdiv=createElement("div",{"style":"height:106px;margin-top:10px;overflow:auto;color:black;"},container);
        for(var w=0;w<prodNameSort[0].length;w++){
            var v=prodNameSort[0][w];
            if((!prodBlock[0][v].match(/t/))&&(buyNotePadShowBlocked||(!prodBlock[0][v].match(/[vlq]/)))){
                if(0<prodMinRack[0][v]){
                    if (prodStock[0][v]==0){
                        newdiv1=createElement("div",{"class":"link hoverBgCc9","prod":v,"style":"line-height:16px;"},newdiv);
                        newdiv1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                        newdiv1.addEventListener("click",function(){ showMarket(this.getAttribute("prod")); },false);
                        produktPic(0,v,newdiv1);
                        createElement("span",{"style":"font-weight:bold;"},newdiv1,getText("stockXmissing").replace(/%1%/,prodName[0][v]));
                    }else if(prodStock[0][v]<prodMinRack[0][v]){
                        newdiv1=createElement("div",{"class":"link hoverBgCc9","prod":v,"style":"line-height:16px;"},newdiv);
                        newdiv1.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                        newdiv1.addEventListener("click",function(){ showMarket(this.getAttribute("prod")); },false);
                        produktPic(0,v,newdiv1);
                        createElement("span",{"style":"font-weight:bold;"},newdiv1,getText("stockXlow").replace(/%1%/,prodName[0][v])+" ("+numberFormat(prodStock[0][v])+")");
                    }
                }
            }
        }
    }catch(err){GM_logError("buildInfoPanelLevel","","",err);}
}
function buildInfoPanelMessages(mode){
try{
    var modeDefault={"type":1,"filterProduct":-1,"filterPlayer":""};
    var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelMessages"),"buildInfoPanelMessages/modeOld",modeDefault);
    if(typeof modeOld!="object"){ modeOld=modeDefault; }
    if(typeof mode!="object"){ mode=modeOld; }
    for(var v in modeDefault){
        if(!modeDefault.hasOwnProperty(v)){ continue; }
        if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
    }
    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeInfoPanelMessages",implode(mode,"buildInfoPanelMessages/mode"));
    if(!logSales){
        logSales=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logSales"),"buildInfoPanelMessages/logSales",[]);
        logSales.sort(sortObjFunctions["int"],true);
        logSalesId=new Object();
        for(var v=logSales.length-1;v>=0;v--){
            logSalesId[logSales[v][0]]=v;
        }
    }
    var plotLogSales=new Array();
    var soldProducts=new Array();
    var sumTurnover=0,sumProfit=0,help,help1;
    if(mode["filterPlayer"]){
        var regFilterPlayer=new RegExp("^"+mode["filterPlayer"].replace(/\./g,"\\.").replace(/\*/g,".*")+"$","i");
    }else{
        var regFilterPlayer=/./;
    }
    var container,newtable,newtr,newtd,cell,div;
    container=$("infoPanelInner");
    container.innerHTML="";
    // head
    div=createElement("div",{"class":"borderBottom1Black","style":"height:45px;"},container);
    newtable=createElement("table",{"style":"width:100%;"},div);
    newtr=createElement("tr",{},newtable);
    newtd=createElement("td",{"class":"tnormal","style":"font-weight:bold;text-align:center;"},newtr,getText("salesLog"));
    newtd=createElement("td",{},newtr);
    div=createElement("div",{"class":"link naviItem"+(mode["type"]==1?"Active":"")},newtd,getText("detail"));
    div.addEventListener("click",function(){
        buildInfoPanelMessages({"type":1});
    },false);
    div=createElement("div",{"class":"link naviItem"+(mode["type"]==2?"Active":"")},newtd,getText("goods"));
    div.addEventListener("click",function(){
        buildInfoPanelMessages({"type":2});
    },false);
    div=createElement("div",{"class":"link naviItem"+(mode["type"]==3?"Active":"")},newtd,getText("buyers"));
    div.addEventListener("click",function(){
        buildInfoPanelMessages({"type":3});
    },false);
    // content
    div=createElement("div",{"class":"borderBottom1Black","style":"overflow-y:scroll;overflow-x:hidden;height:425px;"},container);
    newtable=createElement("table",{"style":"width:100%;","cellspacing":0},div);
    newtr=createElement("tr",{},newtable);

    switch(mode["type"]){
    case 1:{
        for(var v=logSales.length-1;v>-1;v--){
            if(logSales[v][2].match(regFilterPlayer)){
                help=false;
                if(typeof logSales[v][3][0]!="object"){
                    soldProducts[logSales[v][3][0]]=true;
                    if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][0])){
                        sumTurnover+=logSales[v][4];
                        sumProfit+=0.9*logSales[v][4];
                        plotLogSales.push([v,Math.round(100*logSales[v][4]/logSales[v][3][1])/100]);
                    }
                }else if(logSales[v][3].length==1){
                    soldProducts[logSales[v][3][0][0]]=true;
                    if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][0][0])){
                        sumTurnover+=logSales[v][4];
                        sumProfit+=logSales[v][4];
                        plotLogSales.push([v,[Math.round(100*logSales[v][4]/logSales[v][3][0][1])/100]]);
                    }
                }else{
                    help=false;help1=0;
                    for(var i=logSales[v][3].length-1;i>-1;i--){
                        soldProducts[logSales[v][3][i][0]]=true;
                        help1+=logSales[v][3][i][1]*gut[logSales[v][3][i][0]];
                        if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][i][0])){ help=true; }
                    }
                    if(help){
                        help=[v,[]];
                        for(var i=logSales[v][3].length-1;i>-1;i--){
                            help[1][i]=Math.round(100*logSales[v][4]*gut[logSales[v][3][i][0]]/help1)/100;
                            if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][i][0])){
                                sumTurnover+=logSales[v][3][i][1]*help[1][i];
                                sumProfit+=logSales[v][3][i][1]*help[1][i];
                            }
                        }
                        plotLogSales.push(help);
                    }
                }
            }
        }
        createElement("th",{},newtr,getText("buyers"));
        createElement("th",{},newtr,getText("products"));
        createElement("th",{},newtr,getText("price"));
        createElement("th",{},newtr,getText("turnover"));
        createElement("th",{},newtr,getText("profit"));
        eventListenerScroll=function(){
            if((parseInt(this.scrollTop,10)+parseInt(this.style.height,10))>0.95*parseInt(this.scrollHeight,10)){
                plot();
            }
        }
        div.addEventListener("scroll",eventListenerScroll,false);
        function plot(){
        try{
            var newtable=$("infoPanelInner").getElementsByTagName("table")[1];
            var start=newtable.childElementCount-1;
            var end=start+100;
            if(plotLogSales.length<=end){
                end=plotLogSales.length;
                newtable.parentNode.removeEventListener("scroll",eventListenerScroll,false);
            }
            var newtr,newtd,newtd1,newtd2,newtd3,newdiv;
            var help;
            for(var w=start;w<end;w++){
                var v=plotLogSales[w][0];
                newtr=createElement("tr",{"class":"hoverBgCc9","v":v},newtable);
                if(typeof logSales[v][3][0]=="object"){ newtr.style.fontStyle="italic"; }
                newtr.addEventListener("mouseover",function(event){
                    toolTip.show(event,toolTipSales(this.getAttribute("v")));
                },false);
                newtd=createElement("td",{"class":"link"},newtr,logSales[v][2]);
                newtd.addEventListener("click",function(){
                    buildInfoPanelMessages({"filterPlayer":logSales[this.parentNode.getAttribute("v")][2]});
                },false);
                newtd=createElement("td",{"style":"height:16px"},newtr);
                newtd1=createElement("td",{"style":"height:16px;padding-left:20px;"},newtr);
                newtd2=createElement("td",{"style":"height:16px;padding-left:20px;"},newtr);
                newtd3=createElement("td",{"style":"height:16px;padding-left:20px;"},newtr);
                if(typeof logSales[v][3][0]!="object"){
                    newdiv=createElement("div",{"class":"link","prod":logSales[v][3][0]},newtd);
                    newdiv.addEventListener("click",function(){
                        buildInfoPanelMessages({"filterProduct":this.getAttribute("prod")});
                    },false);
                    produktPic(0,logSales[v][3][0],newdiv);
                    createElement("span",{},newdiv,numberFormat(logSales[v][3][1])+" "+prodName[0][logSales[v][3][0]]);
                    createElement("div",{"style":"text-align:right;"},newtd1,moneyFormat(plotLogSales[w][1]));
                    createElement("div",{"style":"text-align:right;"},newtd2,moneyFormat(logSales[v][4]));
                    createElement("div",{"style":"text-align:right;"},newtd3,moneyFormat(0.9*logSales[v][4]));
                }else if(logSales[v][3].length==1){
                    newdiv=createElement("div",{"class":"link","prod":logSales[v][3][0][0]},newtd);
                    newdiv.addEventListener("click",function(){
                        buildInfoPanelMessages({"filterProduct":this.getAttribute("prod")});
                    },false);
                    produktPic(0,logSales[v][3][0][0],newdiv);
                    createElement("span",{},newdiv,numberFormat(logSales[v][3][0][1])+" "+prodName[0][logSales[v][3][0][0]]);
                    createElement("div",{"style":"text-align:right;"},newtd1,moneyFormat(plotLogSales[w][1][0]));
                    createElement("div",{"style":"text-align:right;"},newtd2,moneyFormat(logSales[v][4]));
                    createElement("div",{"style":"text-align:right;"},newtd3,moneyFormat(logSales[v][4]));
                }else{
                    help=[0,0];
                    for(var i=logSales[v][3].length-1;i>-1;i--){
                        if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][i][0])){
                            newdiv=createElement("div",{"class":"link","prod":logSales[v][3][i][0]},newtd);
                            newdiv.addEventListener("click",function(){
                                buildInfoPanelMessages({"filterProduct":this.getAttribute("prod")});
                            },false);
                            produktPic(0,logSales[v][3][i][0],newdiv);
                            createElement("span",{},newdiv,numberFormat(logSales[v][3][i][1])+" "+prodName[0][logSales[v][3][i][0]]);
                            createElement("div",{"style":"text-align:right;"},newtd1,"* "+moneyFormat(plotLogSales[w][1][i]));
                            createElement("div",{"style":"text-align:right;"},newtd2,"* "+moneyFormat(plotLogSales[w][1][i]*logSales[v][3][i][1]));
                            createElement("div",{"style":"text-align:right;"},newtd3,"* "+moneyFormat(plotLogSales[w][1][i]*logSales[v][3][i][1]));
                            help[0]++;
                            help[1]+=plotLogSales[w][1][i]*logSales[v][3][i][1];
                        }
                    }
                    if(help[0]>1){
                        createElement("div",{},newtd,"&nbsp;");
                        createElement("div",{},newtd1,"&nbsp;");
                        createElement("div",{"style":"text-align:right;border-top:1px solid black;"},newtd2,moneyFormat(help[1]));
                        createElement("div",{"style":"text-align:right;border-top:1px solid black;"},newtd3,moneyFormat(help[1]));
                    }
                }
            }
            $("kaufDataCount").innerHTML=numberFormat(end)+"/"+numberFormat(plotLogSales.length);
            newtable=null;newtr=null;newtd=null;newdiv=null;
        }catch(err){GM_logError("buildInfoPanelMessages","","","(plot) "+err);}
        }
    break;}
    case 2:{
        for(var v=logSales.length-1;v>-1;v--){
            if(logSales[v][2].match(regFilterPlayer)){
                if(typeof logSales[v][3][0]!="object"){
                    if(!plotLogSales[logSales[v][3][0]]){ plotLogSales[logSales[v][3][0]]=[logSales[v][3][0],0,0,0]; }
                    plotLogSales[logSales[v][3][0]][1]+=logSales[v][3][1];
                    plotLogSales[logSales[v][3][0]][2]+=logSales[v][4];
                    plotLogSales[logSales[v][3][0]][3]+=0.9*logSales[v][4];
                }else if(logSales[v][3].length==1){
                    if(!plotLogSales[logSales[v][3][0][0]]){ plotLogSales[logSales[v][3][0][0]]=[logSales[v][3][0][0],0,0,0]; }
                    plotLogSales[logSales[v][3][0][0]][1]+=logSales[v][3][0][1];
                    plotLogSales[logSales[v][3][0][0]][2]+=logSales[v][4];
                    plotLogSales[logSales[v][3][0][0]][3]+=logSales[v][4];
                }else{
                    help1=0;
                    for(var i=logSales[v][3].length-1;i>-1;i--){
                        help1+=logSales[v][3][i][1]*gut[logSales[v][3][i][0]];
                    }
                    for(var i=logSales[v][3].length-1;i>-1;i--){
                        help=Math.round(100*logSales[v][3][i][1]*logSales[v][4]*gut[logSales[v][3][i][0]]/help1)/100;
                        if(!plotLogSales[logSales[v][3][i][0]]){ plotLogSales[logSales[v][3][i][0]]=[logSales[v][3][i][0],0,0,0]; }
                        plotLogSales[logSales[v][3][i][0]][1]+=logSales[v][3][i][1];
                        plotLogSales[logSales[v][3][i][0]][2]+=help;
                        plotLogSales[logSales[v][3][i][0]][3]+=help;
                    }
                }
            }
        }
        plotLogSales.sort(function(a,b){return a[3]-b[3];});
        createElement("th",{},newtr,getText("product"));
        createElement("th",{},newtr,getText("quantity"));
        createElement("th",{},newtr,getText("turnover"));
        createElement("th",{},newtr,"Ø");
        createElement("th",{},newtr,getText("profit"));
        createElement("th",{},newtr,"Ø");
        for(var v=plotLogSales.length-1;v>-1;v--){
            if(!plotLogSales[v]){ continue; }
            sumTurnover+=plotLogSales[v][2];
            sumProfit+=plotLogSales[v][3];
            newtr=createElement("tr",{"class":"hoverBgCc9 link","prod":plotLogSales[v][0]},newtable);
            newtr.addEventListener("click",function(){
                buildInfoPanelMessages({"type":1,"filterProduct":this.getAttribute("prod")});
            },false);
            newtd=createElement("td",{},newtr);
            produktPic(0,plotLogSales[v][0],newtd);
            createElement("span",{},newtd,prodName[0][plotLogSales[v][0]]);
            createElement("td",{"align":"right","style":"padding-right:3px;border-right:1px solid black"},newtr,numberFormat(plotLogSales[v][1],0));
            createElement("td",{"align":"right"},newtr,moneyFormat(plotLogSales[v][2]));
            createElement("td",{"align":"right","style":"padding-right:3px;border-right:1px solid black"},newtr,moneyFormat(plotLogSales[v][2]/plotLogSales[v][1],2));
            createElement("td",{"align":"right"},newtr,moneyFormat(plotLogSales[v][3]));
            createElement("td",{"align":"right","style":"padding-right:20px;"},newtr,moneyFormat(plotLogSales[v][3]/plotLogSales[v][1],2));
        }
    break;}
    case 3:{
        plotLogSales=new Object();
        for(var v=logSales.length-1;v>-1;v--){
            if(typeof logSales[v][3][0]!="object"){
                soldProducts[logSales[v][3][0]]=true;
                if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][0])){
                    if(!plotLogSales[logSales[v][2]]){ plotLogSales[logSales[v][2]]=[logSales[v][2],{},0,0]; }
                    if(!plotLogSales[logSales[v][2]][1][logSales[v][3][0]]){ plotLogSales[logSales[v][2]][1][logSales[v][3][0]]=0; }
                    plotLogSales[logSales[v][2]][1][logSales[v][3][0]]+=logSales[v][3][1];
                    plotLogSales[logSales[v][2]][2]+=logSales[v][4];
                    plotLogSales[logSales[v][2]][3]+=0.9*logSales[v][4];
                }
            }else if(logSales[v][3].length==1){
                soldProducts[logSales[v][3][0][0]]=true;
                if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][0][0])){
                    if(!plotLogSales[logSales[v][2]]){ plotLogSales[logSales[v][2]]=[logSales[v][2],{},0,0]; }
                    if(!plotLogSales[logSales[v][2]][1][logSales[v][3][0][0]]){ plotLogSales[logSales[v][2]][1][logSales[v][3][0][0]]=0; }
                    plotLogSales[logSales[v][2]][1][logSales[v][3][0][0]]+=logSales[v][3][0][1];
                    plotLogSales[logSales[v][2]][2]+=logSales[v][4];
                    plotLogSales[logSales[v][2]][3]+=logSales[v][4];
                }
            }else{
                help1=0;
                for(var i=logSales[v][3].length-1;i>-1;i--){
                    help1+=logSales[v][3][i][1]*gut[logSales[v][3][i][0]];
                }
                for(var i=logSales[v][3].length-1;i>-1;i--){
                    soldProducts[logSales[v][3][i][0]]=true;
                    if((mode["filterProduct"]==-1)||(mode["filterProduct"]==logSales[v][3][i][0])){
                        help=Math.round(100*logSales[v][3][i][1]*logSales[v][4]*gut[logSales[v][3][i][0]]/help1)/100;
                        if(!plotLogSales[logSales[v][2]]){ plotLogSales[logSales[v][2]]=[logSales[v][2],{},0,0]; }
                        if(!plotLogSales[logSales[v][2]][1][logSales[v][3][i][0]]){ plotLogSales[logSales[v][2]][1][logSales[v][3][i][0]]=0; }
                        plotLogSales[logSales[v][2]][1][logSales[v][3][i][0]]+=logSales[v][3][i][1];
                        plotLogSales[logSales[v][2]][2]+=help;
                        plotLogSales[logSales[v][2]][3]+=help;
                    }
                }
            }
        }
        help=[];
        for(var i in plotLogSales){
            if(!plotLogSales.hasOwnProperty(i)){ continue; }
            help.push(plotLogSales[i]);
        }
        plotLogSales=help.clone();
        plotLogSales.sort(function(a,b){return a[3]-b[3];});
        createElement("th",{},newtr,getText("buyers"));
        createElement("th",{},newtr,getText("products"));
        createElement("th",{},newtr,getText("turnover"));
        createElement("th",{},newtr,getText("profit"));
        for(var v=plotLogSales.length-1;v>-1;v--){
            if(!plotLogSales[v]){ continue; }
            sumTurnover+=plotLogSales[v][2];
            sumProfit+=plotLogSales[v][3];
            newtr=createElement("tr",{"class":"hoverBgCc9 link","player":plotLogSales[v][0]},newtable);
            newtr.addEventListener("click",function(){
                buildInfoPanelMessages({"type":1,"filterPlayer":this.getAttribute("player")});
            },false);
            createElement("td",{},newtr,plotLogSales[v][0]);
            newtd=createElement("td",{},newtr);
            for(var i in plotLogSales[v][1]){
                if(!plotLogSales[v][1].hasOwnProperty(i)){ continue; }
                div=createElement("div",{},newtd);
                produktPic(0,i,div);
                createElement("span",{},div,numberFormat(plotLogSales[v][1][i])+" "+prodName[0][i]);
            }
            createElement("td",{"align":"right"},newtr,moneyFormat(plotLogSales[v][2]));
            createElement("td",{"align":"right"},newtr,moneyFormat(plotLogSales[v][3]));
        }
    break;}
    }
    // foot
    div=createElement("div",{"style":"height:45px;"},container);
    newtable=createElement("table",{"style":"width:100%;"},div);
    newtr=createElement("tr",{},newtable);
    createElement("td",{"id":"kaufDataCount"},newtr);
    newtd=createElement("td",{},newtr);
    if((mode["type"]==1)||(mode["type"]==3)){
        createElement("span",{"style":"padding-left:10px;"},newtd,getText("goods")+":");
        cell=createElement("div",{"class":"clearFilter link","style":"display:inline-block;"},newtd);
        cell.addEventListener("mouseover",function(event){ toolTip.show(event,getText("clearFilter")); },false);
        cell.addEventListener("click",function(){
            buildInfoPanelMessages({"filterProduct":-1});
        },false);
        cell=createElement("select",{"class":"link"},newtd);
        createElement("option",{"value":-1},cell,"---");
        for(var v=0;v<prodNameSort[0].length;v++){
            if(soldProducts[prodNameSort[0][v]]){
                createElement("option",{"value":prodNameSort[0][v]},cell,prodName[0][prodNameSort[0][v]]);
            }
        }
        cell.value=mode["filterProduct"];
        cell.addEventListener("change",function(){
            buildInfoPanelMessages({"filterProduct":this.value});
        },false);
    }
    createElement("td",{},newtr,getText("turnover")+": ");
    createElement("td",{"align":"right"},newtr,moneyFormat(sumTurnover));
    newtr=createElement("tr",{},newtable);
    newtd=createElement("td",{},newtr);
    newtd=createElement("td",{},newtr);
    if((mode["type"]==1)||(mode["type"]==2)){
        createElement("span",{"style":"padding-left:10px;"},newtd,getText("buyers")+":");
        cell=createElement("div",{"class":"clearFilter link","style":"display:inline-block;"},newtd);
        cell.addEventListener("mouseover",function(event){ toolTip.show(event,getText("clearFilter")); },false);
        cell.addEventListener("click",function(){
            buildInfoPanelMessages({"filterPlayer":""});
        },false);
        cell=createElement("input",{"value":mode["filterPlayer"],"class":"link","style":"width:100px;","maxlength":"20"},newtd);
        cell.addEventListener("mouseover",function(event){ toolTip.show(event,getText("useWildcard")); },false);
        cell.addEventListener("change",function(){
            buildInfoPanelMessages({"filterPlayer":this.value});
        },false);
    }
    createElement("td",{},newtr,getText("profit")+": ");
    createElement("td",{"align":"right"},newtr,moneyFormat(sumProfit));
    if(mode["type"]==1){ plot(); }
    container=null;newtable=null;newtr=null;newtd=null;cell=null;div=null;
    }catch(err){GM_logError("buildInfoPanelMessages","","",err);}
}

function goToZone(zoneNrF){
    try{
        var currLocation=zones.getLocation(zoneNrF);
        var div;
        switch(currLocation.location){
        case "farm":{
            if((gameLocation.check(currLocation.location,currLocation.farmNr))&&(unsafeWindow.farm==1+currLocation.farmNr)){
                if(div=$("farm"+(1+currLocation.farmNr)+"_pos"+currLocation.zoneNr+"_click")){
                    click(div);
                }
            }else if(div=$("speedlink_farm"+(1+currLocation.farmNr))){
                document.addEventListener("gameFarmOpened",function(zoneNrF){
                return function(){
                    document.removeEventListener("gameFarmOpened",arguments.callee,false);
                    window.setTimeout(goToZone,100,zoneNrF);
                }
                }(zoneNrF),false);
                click(div);
            }
        break;}
        case "city":{
            if(gameLocation.check(currLocation.location,currLocation.cityNr)){
                if((currLocation.zoneNr!=undefined)&&(div=$("cityzone_"+currLocation.cityNr+"_"+currLocation.zoneNr))){
                    click(div);
                }
            }else if(div=$("speedlink_city"+currLocation.cityNr)){
                document.addEventListener("gameCity"+currLocation.cityNr,function(zoneNrF,currLocation){
                return function(){
                    document.removeEventListener("gameCity"+currLocation.cityNr,arguments.callee,false);
                    window.setTimeout(goToZone,100,zoneNrF);
                }
                }(zoneNrF,currLocation),false);
                click(div);
            }
        break;}
        case "forestry":{
            if(gameLocation.check(currLocation.location)){
                if((currLocation.zoneNr!=undefined)&&(div=$("forestry_building_click"+currLocation.zoneNr))){
                    click(div);
                }
            }else if(div=$("speedlink_forestry")){
                document.addEventListener("gameOpenForestry",function(zoneNrF){
                return function(){
                    document.removeEventListener("gameOpenForestry",arguments.callee,false);
                    window.setTimeout(goToZone,100,zoneNrF);
                }
                }(zoneNrF),false);
                click(div);
            }
        break;}
        case "foodworld":{
            if(gameLocation.check(currLocation.location)){
                if((currLocation.zoneNr!=undefined)&&(div=$("food_pos"+currLocation.zoneNr))){
                    click(div);
                }
            }else if(div=$("speedlink_foodworld")){
                document.addEventListener("gameFoodworldOpened",function(zoneNrF){
                return function(){
                    document.removeEventListener("gameFoodworldOpened",arguments.callee,false);
                    window.setTimeout(goToZone,100,zoneNrF);
                }
                }(zoneNrF),false);
                click(div);
            }
        break;}
        case "farmersmarket":{
            if(gameLocation.check(currLocation.location)){
                if((currLocation.zoneNr!=undefined)&&(div=$("farmersmarket_pos"+currLocation.zoneNr+"_click"))){
                    click(div);
                }
            }else if(div=$("speedlink_farmersmarket")){
                document.addEventListener("gameFarmersmarketOpened",function(zoneNrF){
                return function(){
                    document.removeEventListener("gameFarmersmarketOpened",arguments.callee,false);
                    window.setTimeout(goToZone,100,zoneNrF);
                }
                }(zoneNrF),false);
                click(div);
            }
        break;}
        }
        div=null;
    }catch(err){GM_logError("goToZone","zoneNrF="+zoneNrF,"",err);}
}
function calcAllSlots() {
  try {
    var help;
    ALL_SLOTS = {};
    for (var i in ALL_ZONES) { // i = farm, farmersmarket, forestry, city, foodworld, megafield
      if (!ALL_ZONES.hasOwnProperty(i)) {
        continue;
      }
      for (var j = 0; j < ALL_ZONES[i].length; j++) { // j iterates over length of array
        if (("megafield" != ALL_ZONES[i][j]) && (help = zones.isMultiSlot(ALL_ZONES[i][j]))) { // Multislot buildings get a '.slot' ending
          for (var slot = 1; slot <= help; slot++) {
            ALL_SLOTS[ALL_ZONES[i][j] + "." + slot] = i;
          }
        } else {
          ALL_SLOTS[ALL_ZONES[i][j]] = i;
        }
      }
    }

    unsafeData.ALL_SLOTS = ALL_SLOTS.clone(); // for Automat
    //todo: Look for a better solution
    //this extra is for checkReady
    //Animal Treatment of Veterinary

    //vetTreatment = GM_getValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_vetTreatment", true);
/*    if (vetTreatment) {
      for (var i = 5; i <= 7; i++) {
        ALL_SLOTS["farmersmarket-5." + i] = "farmersmarket";
      }
    }

    unsafeData.ALL_SLOTS = ALL_SLOTS.clone(); // for Automat
    */
  } catch (err) { GM_logError("calcAllSlots", "", "", err); }
}
function toolTipZoneProduction(zoneNrS){
    try{
        var currLocation=zones.getLocation(zoneNrS);
        var content=createElement("div");
        var time,endDay,table,tr,td;
        var help;
        table=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},content);
        // part: head
        tr=createElement("tr",{},table);
        td=createElement("th",{"class":"lightBg","colspan":2},tr);
        if(currLocation.location=="farm"){
            td.innerHTML=zones.getName(zoneNrS)+" ("+zones.getBuildingName(zoneNrS)+")";
        }else{
            td.innerHTML=zones.getName(zoneNrS);
        }
        // part: time
        time=zones.getEndtime(zoneNrS);
        tr=createElement("tr",{},table);
        if(time==NEVER){
            createElement("td",{"colspan":2},tr,getText("idle"));
        }else{
            time+=unsafeWindow.Zeit.Verschiebung;
            if (time<now){
                if(time+20*60*60<now){
                    createElement("td",{"colspan":2},tr,getText("readySinceX").replace(/%1%/,getFormattedDateStr(time)));
                }else{
                    createElement("td",{"colspan":2},tr,getText("readySinceX").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock")));
                }
            } else if ((endDay=countDays(now,time))==0){
                createElement("td",{"colspan":2},tr,getText("readyAtX").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock")));
            } else if (getText("readyAtX_day"+endDay,true)){
                createElement("td",{"colspan":2},tr,getText("readyAtX_day"+endDay).replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock")));
            } else{
                createElement("td",{"colspan":2},tr,getText("readyAtX").replace(/%1%/,new Date(1000*time).toLocaleString()));
            }
        }
        // part: production
        tr=createElement("tr",{"style":"border-top:1px solid black;"},table);
        createElement("td",{"style":"border-top:1px solid black;","colspan":2},tr,getText("yield")+":");
        if(help=zones.getCrop(zoneNrS)){
            if(help.length==0){
                tr=createElement("tr",{},table);
                td=createElement("td",{"colspan":2},tr,"---");
            }else{
                for(var k=0;k<help.length;k++){
                    if(zones.getBuilding(zoneNrS)=="fl5"&&help[k][1]>=1001&&help[k][1]<=1003){
                        //Tooltip lft timebox for animal treatment
                        tr=createElement("tr",{},table);
                        td=createElement("td",{},tr);
                        createElement("img",{"src":GFX+"vet_cow_head_queue.gif","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;"},td);
                        createElement("span",{},td,moneyFormat(help[k][2]));
                        td=createElement("td",{"style":"padding-left:5px;"},tr);
                        if(help[k][3]>0){ pointsFormat(help[k][3],"div",td); }
                    } else if (zones.getBuilding(zoneNrS)=="fl4"&&help[k][1]==0){
                        //Tieraufzucht
                        var item = unsafeWindow.pets.data.breed;
                        tr=createElement("tr",{},table);
                        td=createElement("td",{},tr);
                        createElement("img",{"src":GFX+"/breed/Paw_00.png","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;"},td);
                        createElement("span",{},td,moneyFormat(item.money));
                        td=createElement("td",{"style":"padding-left:5px;"},tr);
                        pointsFormat(item.points,"span",td);
                        createElement("img",{"src":GFX+"/breed/Heart_00.png","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;padding-left:5px;"},td);
                        createElement("span",{},td,numberFormat(item.breedpoints));
                      } else if (zones.getBuilding(zoneNrS)=="fl3"){
                        //monster fruit culture
                        item = unsafeWindow.farmersmarket_data.megafruit;

                        tr=createElement("tr",{},table);
                        td=createElement("td",{"colspan":2},tr);
                        //createElement("img",{"src":GFX+"/monsterfruit_"+item.current.pid+".png","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;"},td);
                        createElement("span",{},td,"Fruchtsamen: "+ item.current.points);

                        tr=createElement("tr",{"colspan":2},table);
                        createElement("td",{"colspan":2},tr,moneyFormat(item.current.rewards.money));
                        tr=createElement("tr",{},table);
                        td=createElement("td",{"colspan":2},tr);
                        pointsFormat(item.current.rewards.points,"span",td);

                        tr=createElement("tr",{},table);
                        td=createElement("td",{},tr);
                        createElement("img",{"src":GFX+"/megafruit_seed.png","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;"},td);
                        createElement("span",{"style":"padding-left:2px"},td,item.current.rewards.fruits);
                        td=createElement("td",{},tr);
                        createElement("img",{"src":GFX+"/megafruitparts"+item.current.pid+".png","style":"height:15px;width:15px;border:none;top:0px;vertical-align:bottom;"},td);
                        createElement("span",{"style":"padding-left:2px"},td,item.current.rewards.parts);
                        break;
                    } else {
                        tr=createElement("tr",{},table);
                        td=createElement("td",{},tr);
                        produktPic(help[k][0],help[k][1],td);
                        createElement("span",{},td,numberFormat(help[k][2])+"&nbsp;"+prodName[help[k][0]][help[k][1]]);
                        td=createElement("td",{"style":"padding-left:5px;"},tr);
                        if(help[k][3]>0){ pointsFormat(help[k][3],"div",td); }
                    }
                }
            }
        }else{
            tr=createElement("tr",{},table);
            td=createElement("td",{"colspan":2},tr,"???");
        }
        table=null;tr=null;td=null;time=null;endDay=null;
        return content.innerHTML;
    }catch(err){GM_logError("toolTipZoneProduction","","",err);}
}
function toolTipSales(nr){
    try{
        var content=createElement("div");
        var table,tr,td;
        var time;
        if(logSales[nr]){
            time=logSales[nr][1]-valServerTimeOffset;
            table=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},content);
            if(typeof logSales[nr][3][0]=="object"){
                // contract
                tr=createElement("tr",{},table);
                createElement("th",{"class":"lightBg","colspan":3},tr,getText("contract"));
                tr=createElement("tr",{},table);
                createElement("td",{"colspan":3},tr,getFormattedDateStr(time,1)+",&nbsp;"+getDaytimeStr(time,1)+"&nbsp;"+getText("shortOClock"));
                tr=createElement("tr",{},table);
                createElement("td",{"colspan":3},tr,logSales[nr][2]);
                tr=createElement("tr",{"class":"borderBottom1Black"},table);
                createElement("td",{"colspan":3},tr,moneyFormat(logSales[nr][4]));
                for(var v=0;v<logSales[nr][3].length;v++){
                    tr=createElement("tr",{},table);
                    createElement("td",{},table,numberFormat(logSales[nr][3][v][1]));
                    createElement("td",{},table,prodName[0][logSales[nr][3][v][0]]);
                    td=createElement("td",{},table);
                    if(logSales[nr][3].length==1){
                        td.innerHTML="("+moneyFormat(logSales[nr][4]/logSales[nr][3][v][1])+")"
                    }
                }
            }else{
                // marketplace
                tr=createElement("tr",{},table);
                createElement("th",{"class":"lightBg","colspan":3},tr,getText("marketplace"));
                tr=createElement("tr",{},table);
                createElement("td",{"colspan":3},tr,getFormattedDateStr(time,1)+",&nbsp;"+getDaytimeStr(time,1)+"&nbsp;"+getText("shortOClock"));
                tr=createElement("tr",{},table);
                createElement("td",{"colspan":3},tr,logSales[nr][2]);
                tr=createElement("tr",{"class":"borderBottom1Black"},table);
                createElement("td",{"colspan":3},tr,moneyFormat(logSales[nr][4]));
                tr=createElement("tr",{},table);
                createElement("td",{},table,numberFormat(logSales[nr][3][1]));
                createElement("td",{},table,prodName[0][logSales[nr][3][0]]);
                createElement("td",{},table,"("+moneyFormat(logSales[nr][4]/logSales[nr][3][1])+")");
            }
        }

        table=null;tr=null;td=null;
        return content.innerHTML;
    }catch(err){GM_logError("toolTipSales","","",err);}
}

/*
  <div style="position:absolute; top:7px; left:8px;" class="tt7">  <div style="z-index: 100; display: none; position: absolute; top: 60px; right: 0px; white-space: nowrap;" class="ttbox" id="market_catitem7">Sonnenblumen (6.061)</div>  </div>
*/

function showMarket(pid){
    try{
        if(!gameLocation.check("city",1)){
            document.addEventListener("gameCity1",function(pid){ return function(){
                document.removeEventListener("gameCity1",arguments.callee,false);
                showMarket(pid);
            };}(pid),false);
            click($("speedlink_city1"));
        }else if($("market").style.display!="block"){
            document.addEventListener("gameOpenMarket",function(pid){ return function(){
                document.removeEventListener("gameOpenMarket",arguments.callee,false);
                showMarket(pid);
            };}(pid),false);
            unsafeWindow.close_page();
            unsafeWindow.hideDiv("shop");
            unsafeWindow.hideDiv("wbwcontainer");
            unsafeWindow.hideDiv("adcolumn");
            $("transp3").style.visibility = "visible";
            unsafeWindow.showDiv("transp3");
            unsafeWindow.marketAction("marketinit");
        }else{
            closeInfoPanel();
            unsafeWindow.market_filter_pid=parseInt(pid,10);
            //13102016
            var help={"v":1,"ex":1,"e":2,"o":3,"fw1":4,"fw2":4,"fw3":4,"fw4":4,"z":5,"fl":7,"fla":7,"hr":1,"md":7,"breed":7,"alpin":1,"tea":1,"cow":8,"fish":9,"water":1,"sushi":8,"scouts":10,"c":0};
            unsafeWindow.market_nav=help[prodTyp[0][parseInt(pid,10)]];
            unsafeWindow.filterMarket();
        }
    }catch(err){ GM_logError("showMarket","pid="+pid,"",err); }
}
function showMarketStall(){
    try{
        if(!gameLocation.check("city",1)){
            document.addEventListener("gameCity1",function(){
                document.removeEventListener("gameCity1",arguments.callee,false);
                showMarketStall();
            },false);
            click($("speedlink_city1"));
        }else if($("market").style.display!="block"){
            document.addEventListener("gameOpenMarket",function(){
                document.removeEventListener("gameOpenMarket",arguments.callee,false);
                showMarketStall();
            },false);
            unsafeWindow.close_page();
            unsafeWindow.showDiv("transp3");
            unsafeWindow.$("transp3").style.visibility = "visible";
            unsafeWindow.marketAction("marketinit");
        }else{
            unsafeWindow.setMarketNavi(3);
            unsafeWindow.market_guild_filter = 0;
            unsafeWindow.market_filter_pid = -1;
            unsafeWindow.market_filter_own = 1;
            unsafeWindow.showOffers();
        }
    }catch(err){ GM_logError("showMarketStall","","",err); }
}
function quicklinks(){
    try{
        if (GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valQuicklinks",true)){
            var newdiv=$("market_navi5");
            if(newdiv){
                if(!newdiv.getAttribute("listener_mouseover")){
                    newdiv.setAttribute("listener_mouseover",true)
                    newdiv.addEventListener("mouseover",function(event){
                        $("quicklinks").style.display="block";
                    },false);
                }
                if(!newdiv.getAttribute("listener_mouseout")){
                    newdiv.setAttribute("listener_mouseout",true)
                    newdiv.addEventListener("mouseout",function(event){
                        $("quicklinks").style.display="none";
                    },false);
                }

                var divquick=$("quicklinks");
                if(divquick){
                    divquick.innerHTML="";
                }else{
                    divquick=createElement("div",{"id":"quicklinks","style":"display:none;position:absolute;right:-82px;top:15px;width:633px;height:525px;background-color:white;z-index:10;overflow-y: auto;"},newdiv);
                }
                var newdiv1;
                var newtable=createElement("table",{"border":"3px solid black;"},divquick);
                var newtr=createElement("tr",{},newtable);
                var newtd=createElement("td",{},newtr);

                createElement("div",{"id":"quicklinksName","style":"color:black;font-weight:bold;float:right;line-height:24px;margin-right:170px;"},newtd);

                var prodTypOld="c";
                for(var w=0;w<prodNameSort[0].length;w++){
                    var v=prodNameSort[0][w];
                    if(!prodBlock[0][v].match(/[ltv]/)){
                        if (prodTypOld!=prodTyp[0][v]){
                            newtr=createElement("tr",{},newtable);
                            newtd=createElement("td",{},newtr);
                            prodTypOld=prodTyp[0][v];
                        }
                        newdiv=createElement("div",{"style":"float:left;width:24px;height:24px;padding:0px 1px 1px 0px;"},newtd);
                        newdiv1=createElement("div",{"style":"position:relative;top:-3px;left:-3px;width:24px;height:24px;"},newdiv);
                        createElement("div",{"class":"trasnformScale80 v"+v},newdiv1);
                        if(highlightProducts[1][v]){
                            createElement("div",{"style":"position:relative;top:-24px;width:20px;height:20px;border:2px solid blue;border-radius:8px;"},newdiv);
                            newdiv1=createElement("div",{"prodId":v,"style":"position:relative;top:-48px;width:24px;height:24px;background-color:blue;border-radius:8px;opacity:0;"},newdiv);
                        }else{
                            newdiv1=createElement("div",{"prodId":v,"style":"position:relative;top:-24px;width:24px;height:24px;background-color:blue;border-radius:8px;opacity:0;"},newdiv);
                        }
                        newdiv1.addEventListener("click",function(event){
                            event.stopPropagation ? event.stopPropagation() : (event.cancelBubble=true); // stop bubbling
                            showMarket(this.getAttribute("prodId"));
                            $("quicklinks").style.display="none";
                        },false);
                        newdiv1.addEventListener("mouseover",function(){this.style.opacity="0.3";$("quicklinksName").innerHTML=prodName[0][this.getAttribute("prodId")];},false);
                        newdiv1.addEventListener("mouseout",function(){this.style.opacity="0";$("quicklinksName").innerHTML="&nbsp;";},false);
                    }
                }
                divquick=null;newtable=null;newtr=null;newtd=null;newa=null;newdiv1=null;
            }
            newdiv=null;
        }
    }catch(err){ GM_logError("quicklinks","","",err); }
}
var timer=new function(){
    var running=[];
    this.add=function(name,node,endtime,callback){
        try{
            timer.remove(name);
            running.push([name,node,endtime,callback]);
            timer.run(name);
        }catch(err){GM_logError("timer.add","name="+name,"",err);}
    }
    this.remove=function(name){
        try{
            for(var i=running.length-1;i>=0;i--){
                if(running[i][0]==name){
                    running.splice(i,1);
                }
            }
        }catch(err){GM_logError("timer.remove","","",err);}
    }
    this.run=function(){
        try{
            for(var i=running.length-1;i>=0;i--){
                if(unsafeWindow.Zeit.Server<running[i][2]){
                    running[i][1].innerHTML=getTimeStr(running[i][2]-unsafeWindow.Zeit.Server);
                }else{
                    running[i][3]();
                    running.splice(i,1);
                }
            }
        }catch(err){GM_logError("timer.run","","",err);}
    }
};
var clocks=new function(){
    var running=[];
    this.add=function(name,node,time){
        try{
            clocks.remove(name);
            running.push([name,node,time]);
            clocks.run(name);
        }catch(err){GM_logError("clocks.add","name="+name,"",err);}
    }
    this.remove=function(name){
        try{
            for(var i=running.length-1;i>=0;i--){
                if(running[i][0]==name){
                    running.splice(i,1);
                }
            }
        }catch(err){GM_logError("clocks.remove","","",err);}
    }
    this.run=function(){
        try{
            for(var i=running.length-1;i>=0;i--){
                if(running[i][1]){
                    running[i][1].innerHTML=getDaytimeStr(running[i][2]+now);
                }else{
                    running.splice(i,1);
                }
            }
        }catch(err){GM_logError("clocks.run","","",err);}
    }
};
//createZoneTimer("globalZoneTimer_farmersmarket-"+v,"farmersmarket-"+v,"zonetimer","position:relative;",$("timeHolder"));
function createZoneTimer(name,zoneNrS,type,style,append){ // type="zonetimer" || "zonetimerWater"
    try{
        if(!$(name)){
            var div=createElement("div",{"id":name,"zoneNrS":zoneNrS,"type":type,"style":style},append);
            div.addEventListener("mouseover",function(event){
            try{
                var zoneNrS=this.getAttribute("zoneNrS");
                var type=this.getAttribute("type");
                showBlase(zoneNrS);
                if(type=="zonetimer"){
                    toolTip.show(event,toolTipZoneProduction(zoneNrS));
                }else{ // zonetimerWater
                    var newDiv1=createElement("div");
                    var newTable=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},newDiv1);
                    var newTr=createElement("tr",{},newTable);
                    var newTd=createElement("th",{"class":"lightBg","colspan":2},newTr,zones.getBuildingName(zoneNrS));
                    var time = zones.getWatertime(zoneNrS);
                    if(time!=NEVER){ time+=unsafeWindow.Zeit.Verschiebung; }
                    var endDay=countDays(now,time);
                    newTr=createElement("tr",{},newTable);
                    if(time==NEVER){
                        createElement("td",{"colspan":2},newTr,"---");
                    } else if(time<now){
                        createElement("td",{"colspan":2},newTr,getText("waterNeeded"));
                    } else if (endDay==0){
                        createElement("td",{},newTr,getText("waterNeededAtX").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock")));
                    } else if ((endDay==1)&&(getText("waterNeededAtX_day1"))){
                        createElement("td",{},newTr,getText("waterNeededAtX_day1").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock")));
                    } else{
                        createElement("td",{},newTr,getText("waterNeededAtX").replace(/%1%/,new Date(1000*time).toLocaleString()));
                    }
                    toolTip.show(event,newDiv1.innerHTML);
                    newDiv1=null;newTable=null;newTr=null;newTd=null;
                    time=null;endDay=null;
                }
                zoneNrS=null;type=null;
            }catch(err){GM_logError("createTimer.mouseover","","zoneNrS="+zoneNrS,err);}
            },false);
            div.addEventListener("mouseout",hideBlase,false);
            div=null;
        }
        updateZoneTimer(name,zoneNrS,type)
    }catch(err){GM_logError("createZoneTimer","name="+name+" zoneNrS="+zoneNrS,"",err);}
}
function updateZoneTimer(name,zoneNrS,type){
    try{
        var div;
        if(div=$(name)){
            if(zones.getBlock(zoneNrS)){
                removeZoneTimer(name,type);
            }else if(type=="zonetimer"){
                var time=zones.getEndtime(zoneNrS);
                if (time==NEVER){ // empty
                    div.setAttribute("class","zoneTimer");
                    timer.remove(name);
                    div.innerHTML="---";
                }else if(time<=unsafeWindow.Zeit.Server){ // ready
                    div.setAttribute("class","zoneTimerReady blinking");
                    timer.remove(name);
                    div.innerHTML=getText("finished").toUpperCase()+"!";
                }else{ // running
                    div.setAttribute("class","zoneTimer");
                    timer.add(name,div,time,function(name,zoneNrS,type){ return function(){ updateZoneTimer(name,zoneNrS,type); }}(name,zoneNrS,type));
                }
            }else{
                var time=zones.getWatertime(zoneNrS);
                if ((time==NEVER)||(time<=unsafeWindow.Zeit.Server)){ // watering not possible or needed
                    removeZoneTimer(name,type);
                }else{ // wait for watering
                    div.setAttribute("class","zoneTimerWater");
                    timer.add(name,div,time,function(name,zoneNrS,type){ return function(){ updateZoneTimer(name,zoneNrS,type); }}(name,zoneNrS,type));
                }
            }
            div=null;
        }
    }catch(err){GM_logError("updateZoneTimer","name="+name+" zoneNrS="+zoneNrS,"",err);}
}
function removeZoneTimer(name){
    try{
        timer.remove(name);
        var div;
        if(div=$(name)){
            removeElement(div);
            div=null;
        }
    }catch(err){GM_logError("removeZoneTimer","name="+name,"",err);}
}
function showBlase(zoneNrF){
    try{
        $("sprcontent").style.display="none";
        var bubble=$("sprcontent2");
        bubble.style.display="";
        bubble.innerHTML="";
        if (zones.getBlock(zoneNrF).match(/p/)){
            createElement("div",{"class":"tnormal"},bubble,unsafeWindow.inforequirepremium);
        }else if (zones.getBlock(zoneNrF).match(/q/)){
            createElement("div",{"class":"tnormal"},bubble,unsafeWindow.questblock);
        }else if(!zones.getBuilding(zoneNrF)){
            // blocked
        }else if(BUILDINGTYPE[zones.getBuilding(zoneNrF)]==0){
            createElement("div",{"class":"tnormal","style":"font-weight:bold;"},bubble,unsafeWindow.buildinginfos[0][zones.getBuilding(zoneNrF)][10]);
        }else{
            var time=zones.getEndtime(zoneNrF);
            if(time==NEVER){
                createElement("font",{"class":"tmenu","style":"font-weight:bold;"},bubble,zones.getBuildingName(zoneNrF)+" "+getText("idle"));
                // createElement("font",{"class":"tnormal","style":"font-weight:bold;"},bubble,getText("emptyField"));
            }else{
                time+=unsafeWindow.Zeit.Verschiebung;
                var prod = zones.getEndproduct(zoneNrF);
                if(prod){
                    createElement("div",{"class":["tt","f_symbol","fm","fm","tt"][prod[0]]+prod[1],"style":"position:absolute;top:5px;left:0;"},bubble);
                    newdiv=createElement("div",{"style":"position:absolute;top:5px;left:55px;"},bubble);
                    createElement("font",{"class":"tmenu","style":"font-weight:bold;"},createElement("div",{},newdiv),prodName[prod[0]][prod[1]]);
                }

                var newfont=createElement("font",{"class":"tmenu"},createElement("div",{},newdiv));
                if (time<now){
                    if(time+20*60*60<now){
                        newfont.innerHTML=getText("readySinceX").replace(/%1%/,getFormattedDateStr(time));
                    }else{
                        newfont.innerHTML=getText("readySinceX").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock"));
                    }
                }else if (time<NEVER){
                    var endDay=countDays(now,time);
                    if (endDay==0){
                        newfont.innerHTML=getText("readyAtX").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock"));
                    }else if ((endDay==1)&&(getText("readyAtX_day1",true))){
                        newfont.innerHTML=getText("readyAtX_day1").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock"));
                    }else if ((endDay==2)&&(getText("readyAtX_day2",true))){
                        newfont.innerHTML=getText("readyAtX_day2").replace(/%1%/,getDaytimeStr(time)+"&nbsp;"+getText("shortOClock"));
                    }else{
                        newfont.innerHTML=new Date(1000*time).toLocaleString();
                    }
                }
                newfont=null;
            }
        }
        bubble=null;newdiv=null;
    }catch(err){ GM_logError("showBlase","zoneNrF="+zoneNrF,"",err); }
}
function hideBlase(){
    try{
        $("sprcontent").style.display="";
        $("sprcontent2").style.display="none";
    }catch(err){ GM_logError("hideBlase","","",err); }
}

var modeBuyNotepad=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeBuyNotepad",0);
function doBuyNotepad(){
try{
    var err_trace="init";
    if(!show["buyNotepad"]){ return false; } // no calculation if table is hidden
    var newdiv=$("buyNotepad");
    if(newdiv){
    /* rack type 0 (farm) */
        err_trace="type 0";
        var prodMissing=new Array();
        var drawProductLines=false;
        if(valMinRackGrowing){
            var totalErnte=zones.getTotalCrop()
        }
        err_trace="type 0, missing products";
        for(var v=0;v<prodNameSort[0].length;v++){
            var prod=prodNameSort[0][v];
            if((!prodBlock[0][prod].match(/t/))&&(!prodBlock[0][prod].match(/[vlq]/))){
                var amount=prodMinRack[0][prod]-prodStock[0][prod];
                if (amount>0){
                    prodMissing.push([prod,amount,amount*(gut[prod]?gut[prod]:0)]);
                }
            }
        }
        // sorting
        err_trace="type 0, sorting";
        switch(modeBuyNotepad){
        case 0: drawProductLines=true;
        prodMissing.sort(sortObjFunctions["productId"]);
        break;
        case 1: drawProductLines=true;
        prodMissing.sort(function(a,b){
            if(prodTyp[0][a[0]]==prodTyp[0][b[0]]){
                return(b[1][0]-a[1][0]);
            }else{
                return({"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[0][a[0]]]-{"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[0][b[0]]]);
            }
        }); break;
        case 2: drawProductLines=true;
        prodMissing.sort(function(a,b){
            if(prodTyp[0][a[0]]==prodTyp[0][b[0]]){
                return(a[1][0]-b[1][0]);
            }else{
                return({"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[0][a[0]]]-{"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[0][b[0]]]);
            }
        }); break;
        case 3: prodMissing.sort(function(a,b){return (a[1][0]-b[1][0]);}); break;
        case 4: prodMissing.sort(function(a,b){return (a[1][0]-b[1][0]);},true); break;
        case 5: prodMissing.sort(function(a,b){return (a[1][1]-b[1][1]);}); break;
        case 6: prodMissing.sort(function(a,b){return (a[1][1]-b[1][1]);},true); break;
        case 7: prodMissing.sort(function(a,b){return (a[0]-b[0]);},true); break;
        }
        // creating table
        err_trace="type 0, table";
        newdiv.innerHTML="";
        var newtable=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},newdiv);
        var newtr=createElement("tr",{"class":"link"},newtable);
        newtr.addEventListener("click",function(){
            modeBuyNotepad=(modeBuyNotepad+1)%7;
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeBuyNotepad",modeBuyNotepad);
            doBuyNotepad();
        },false);
        newtr.addEventListener("mouseover",function(event){toolTip.show(event,"Sortingmode: "+["Producttype, id","Producttype, amount","Producttype, amount descending","amount","amount descending","value","value descending","id"][modeBuyNotepad]+"<br>Click to change");},false);
        var newtd=createElement("td",{"colspan":"4","style":"border-bottom:1px solid black;text-align:center;"},newtr,getText("missing"));

        var oldType=null;
        var newType=null;
        var help=0; //TODO review

        for(var i=0;i<prodMissing.length;i++){
            var prod=prodMissing[i][0];
            var amountForFarmis=valMinRackFarmis?((totalFarmis[0]&&totalFarmis[0][prod]?totalFarmis[0][prod]:0)-(prodStock[0]&&prodStock[0][prod]?prodStock[0][prod]:0)):0;
            var str='<table>';
            str += '<tr><th colspan="3" class="lightBg">'+getText("goToMarketOfX").replace(/%1%/,prodName[0][prod])+'</th></tr>';
            str += '<tr><td>'+getText("minRack")+'</td><td></td><td style="text-align:right;">'+numberFormat(prodMinRackInit[0][prod])+'</td></tr>';
            if(megafieldJob&&megafieldJob.products&&megafieldJob.products[prod]&&(megafieldJob.products[prod].have+megafieldJob.products[prod].growing<megafieldJob.products[prod].need)){
                str += '<tr><td>'+getText("megafield")+'</td><td>+</td><td style="text-align:right;">'+numberFormat((megafieldJob.products[prod].need-megafieldJob.products[prod].have-megafieldJob.products[prod].growing)*(megafieldJob.products[prod].amount===undefined?1:megafieldJob.products[prod].amount))+'</td></tr>';
            }
            for(var k in totalQuest){
                if(!totalQuest.hasOwnProperty(k)){ continue; }
                if(totalQuest[k][0][prod]){
                    str += '<tr><td>'+getText("quest_"+k)+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalQuest[k][0][prod])+'</td></tr>';
                }
            }
            if(valMinRackRecursive&&totalRecursive[0]&&totalRecursive[0][prod]){
                str += '<tr><td>'+getText("recursive")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalRecursive[0][prod])+'</td></tr>';
            }
            if(valMinRackFarmis&&totalFarmis[0]&&totalFarmis[0][prod]){
                str += '<tr><td>'+unsafeWindow.customerarecalled.replace(/%FARMI%/,"")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalFarmis[0][prod])+'</td></tr>';
            }
            str += '<tr><td>'+getText("inventory")+'</td><td>-</td><td style="text-align:right;">'+numberFormat(prodStock[0][prod])+'</td></tr>';
            if(valMinRackGrowing){
                if(totalErnte[0][prod]){
                    amountForFarmis -= totalErnte[0][prod];
                    str += '<tr><td>'+getText("production")+'</td><td>-</td><td style="text-align:right;">'+numberFormat(totalErnte[0][prod])+'</td></tr>';
                }
                if(totalPowerups[prod]){
                    amountForFarmis -= totalPowerups[prod];
                    str += '<tr><td>'+getText("powerups")+'</td><td>-</td><td style="text-align:right;">'+numberFormat(totalPowerups[prod])+'</td></tr>';
                }
            }
            if(prodMinRackAddon[0][prod]){
                for(var k in prodMinRackAddon[0][prod]){
                    if(!prodMinRackAddon[0][prod].hasOwnProperty(k)){ continue; }
                    str += '<tr><td>'+k+'</td><td>'+(prodMinRackAddon[0][prod][k]>0?'+':'-')+'</td><td style="text-align:right;">'+numberFormat(prodMinRackAddon[0][prod][k])+'</td></tr>';
                }
            }
            str += '<tr><td colspan="3" style="border-bottom:1px solid black;"></td></tr>';
            str += '<tr><td>'+getText("marketPrice")+'</td><td></td><td style="text-align:right;">'+moneyFormat(gut[prod])+'</td></tr>';
            str += '<tr><td>'+getText("value")+'</td><td></td><td style="text-align:right;">'+moneyFormatInt(prodMissing[i][2])+'</td></tr>';
            if(prodRequire[0][prod]){
                str += '<tr><th colspan="3" class="lightBg">'+getText("requirementPerProduction")+'</th></tr>';
                for(j in prodRequire[0][prod]){
                    if(!prodRequire[0][prod].hasOwnProperty(j)){continue;}
                    if(prodRequire[0][prod][j][0]>-1){
                        str += '<tr><td>';
                        str += prodName[prodRequire[0][prod][j][0]][prodRequire[0][prod][j][1]];
                        str += '</td><td></td><td style="text-align:right;">'+numberFormat(prodRequire[0][prod][j][2])+'</td></tr>';
                    }
                }
                if(prodYield[0][prod]){
                    str += '<tr><th colspan="3" class="lightBg">'+getText("yieldPerProduction")+'</th></tr>';
                    str += '<tr><td>'+prodName[0][prod]+'</td><td></td><td style="text-align:right;">'+numberFormat(prodYield[0][prod])+'</td></tr>';
                }
            }
            str += '</table>';
            newType=prodTyp[0][prod];
            newtr=createElement("tr",{"class":"link hoverBgCc9"+((drawProductLines&&(oldType!=null)&&(oldType!=newType))?" borderTop1dashedBlack":""),"prod":prod,"mouseOverText":str},newtable);
            oldType=newType;
            newtr.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
            newtr.addEventListener("mouseover",function(event){toolTip.show(event,this.getAttribute("mouseOverText"));},false);
            newtd=createElement("td",{},newtr);
            produktPic(0,prod,newtd);
            createElement("td",{"style":"text-align:right;"},newtr,numberFormat(prodMissing[i][1]));
            if(amountForFarmis>0){
                createElement("td",{"style":"padding-left:3px;text-align:right;"},newtr,"("+numberFormat(amountForFarmis)+")");
            }else{
                createElement("td",{},newtr);
            }
            createElement("td",{"style":"padding-left:3px;"},newtr,prodName[0][prod]);
        }
        help=null;

        if(newtable.childElementCount==1){
            newtr=createElement("tr",{},newtable);
            createElement("td",{"colspan":"3","style":"text-align:center;"},newtr,"---");
        }

    /* rack type 1 (forestry) */
        err_trace="type 1";
        var newtr=createElement("tr",{},newtable);
        var newtd=createElement("td",{"colspan":"4","style":"border-bottom:1px solid black;text-align:center;width:100%;"},newtr);
        drawProductLines=false;
        prodMissing=new Array();
        // calculate missing products
        err_trace="type 1, missing products";
        for(var prod in prodMinRack[1]){
            if(!prodMinRack[1].hasOwnProperty(prod)){ continue; }
            var amount=prodMinRack[1][prod]-(prodStock[1][prod]?prodStock[1][prod]:0);
            if (amount>0){
                prodMissing.push([prod,amount,0]); //'0'==price
            }
        }
        // sorting
        err_trace="type 1, sorting";
        switch(modeBuyNotepad){
        case 0: drawProductLines=true;
        prodMissing.sort(function(a,b){
            if(prodTyp[1][a[0]]==prodTyp[1][b[0]]){
                return(a[0]-b[0]);
            }else{
                return({"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[1][a[0]]]-{"c":0,"v":1,"ex":2,"e":3,"o":4,"fw1":5,"fw2":6,"fw3":7,"fw4":8,"z":9,"water":10,"sushi":11}[prodTyp[1][b[0]]]);
            }
        }); break;
        case 1: drawProductLines=true;
        prodMissing.sort(function(a,b){
            if(prodTyp[1][a[0]]==prodTyp[1][b[0]]){
                return(b[1][0]-a[1][0]);
            }else{
                return({"f1":0,"f2":1,"f3":2,"f4":3,"f5":4}[prodTyp[1][a[0]]]-{"f1":0,"f2":1,"f3":2,"f4":3,"f5":4}[prodTyp[1][b[0]]]);
            }
        }); break;
        case 2: drawProductLines=true;
        prodMissing.sort(function(a,b){
            if(prodTyp[1][a[0]]==prodTyp[1][b[0]]){
                return(a[1][0]-b[1][0]);
            }else{
                return({"f1":0,"f2":1,"f3":2,"f4":3,"f5":4}[prodTyp[1][a[0]]]-{"f1":0,"f2":1,"f3":2,"f4":3,"f5":4}[prodTyp[1][b[0]]]);
            }
        }); break;
        case 3: prodMissing.sort(function(a,b){return (a[1][0]-b[1][0]);}); break;
        case 4: prodMissing.sort(function(a,b){return (a[1][0]-b[1][0]);},true); break;
        case 5: prodMissing.sort(function(a,b){return (a[1][1]-b[1][1]);}); break;
        case 6: prodMissing.sort(function(a,b){return (a[1][1]-b[1][1]);},true); break;
        case 7: prodMissing.sort(function(a,b){return (a[0]-b[0]);},true); break;
        }
        //prodMissing.sortObj();
        err_trace="type 1, table";
        oldType=null;
        newType=null;
        for(var i=0;i<prodMissing.length;i++){
            var prod=prodMissing[i][0];
            var amountForForestryFarmis=valMinRackForestryFarmis?((totalFarmis[1]&&totalFarmis[1][prod]?totalFarmis[1][prod]:0)-(prodStock[1]&&prodStock[1][prod]?prodStock[1][prod]:0)):0;

            var str='<table>';
            str += '<tr><th colspan="3" class="lightBg">'+prodName[1][prod]+'</th></tr>';
            str += '<tr><td>'+getText("minRack")+'</td><td></td><td style="text-align:right;">'+numberFormat(prodMinRackInit[1][prod])+'</td></tr>';
            if(totalQuest["main"]&&totalQuest["main"][1][prod]){
                str += '<tr><td>'+getText("quest_farm")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalQuest["main"][1][prod])+'</td></tr>';
            }
            if(totalQuest["forestry"]&&totalQuest["forestry"][1][prod]){
                str += '<tr><td>'+getText("quest_forestry")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalQuest["forestry"][1][prod])+'</td></tr>';
            }
            if(valMinRackRecursive&&totalRecursive[1]&&totalRecursive[1][prod]){ str += '<tr><td>'+getText("recursive")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalRecursive[1][prod])+'</td></tr>'; }
            if(valMinRackForestryFarmis&&totalFarmis[1]&&totalFarmis[1][prod]){ str += '<tr><td>'+unsafeWindow.customerarecalled.replace(/%FARMI%/,"")+'</td><td>+</td><td style="text-align:right;">'+numberFormat(totalFarmis[1][prod])+'</td></tr>'; }
            str += '<tr><td>'+getText("inventory")+'</td><td>-</td><td style="text-align:right;">'+numberFormat(prodStock[1][prod])+'</td></tr>';

            if(valMinRackGrowing){
                if(totalErnte[1][prod]){
                    amountForForestryFarmis -= totalErnte[1][prod];
                    str += '<tr><td>'+getText("production")+'</td><td>-</td><td style="text-align:right;">'+numberFormat(totalErnte[1][prod])+'</td></tr>';
                }
            }
            if(prodMinRackAddon[1][prod]){
                for(var k in prodMinRackAddon[1][prod]){
                    if(!prodMinRackAddon[1][prod].hasOwnProperty(k)){ continue; }
                    str += '<tr><td>'+k+'</td><td>'+(prodMinRackAddon[1][prod][k]>0?'+':'-')+'</td><td style="text-align:right;">'+numberFormat(prodMinRackAddon[1][prod][k])+'</td></tr>';
                }
            }
            if(prodRequire[1][prod]){
                str += '<tr><th colspan="3" class="lightBg">'+getText("requirementPerProduction")+'</th></tr>';
                for(j in prodRequire[1][prod]){
                    if(!prodRequire[1][prod].hasOwnProperty(j)){continue;}
                    if(prodRequire[1][prod][j][0]>-1){
                        str += '<tr><td>';
                        str += prodName[prodRequire[1][prod][j][0]][prodRequire[1][prod][j][1]];
                        str += '</td><td></td><td style="text-align:right;">'+numberFormat(prodRequire[1][prod][j][2])+'</td></tr>';
                    }
                }
            }
            if(prodYield[1][prod]){
                str += '<tr><th colspan="3" class="lightBg">'+getText("yieldPerProduction")+'</th></tr>';
                str += '<tr><td>'+prodName[1][prod]+'</td><td></td><td style="text-align:right;">'+numberFormat(prodYield[1][prod])+'</td></tr>';
            }
            str += '</table>';

            newType=prodTyp[1][prod];
            newtr=createElement("tr",{"class":"hoverBgCc9"+((drawProductLines&&(oldType!=null)&&(oldType!=newType))?" borderTop1dashedBlack":""),"iProd":prod,"mouseOverText":str,"style":(prodBlock[1][prod].match(/b/)?"color:red;":"")},newtable);//TODO color
            oldType=newType;
            newtr.addEventListener("mouseover",function(event){toolTip.show(event,this.getAttribute("mouseOverText"));},false);
            newtd=createElement("td",{},newtr);
            produktPic(1,prod,newtd);
            createElement("td",{"style":"text-align:right;"+(prodBlock[1][prod].match(/[lq]/)&&prodBlock[1][prod].match(/t/)?"color:red;":"")},newtr,numberFormat(prodMissing[i][1]));
            if(amountForForestryFarmis>0){
                createElement("td",{"style":"padding-left:3px;text-align:right;"+(prodBlock[1][prod].match(/[lq]/)&&prodBlock[1][prod].match(/t/)?"color:red;":"")},newtr,"("+numberFormat(amountForForestryFarmis)+")");
            }else{
                createElement("td",{},newtr);
            }
            createElement("td",{"style":"padding-left:3px;"+(prodBlock[1][prod].match(/[lq]/)&&prodBlock[1][prod].match(/t/)?"color:red;":"")},newtr,prodName[1][prod]);
        }

        if(newtable.childElementCount==2){
            newtr=createElement("tr",{},newtable);
            createElement("td",{"colspan":"4","style":"text-align:center;"},newtr,"---");
        }
        newtable=null;newtr=null;newtd=null;
    }
    newdiv=null;
}catch(err){ GM_logError("doBuyNotepad","","err_trace='"+err_trace+"' prod="+prod,err); }
}
function doMarketoffersNotepad(){
    try{
        if(!show["marketoffersNotepad"]){ return false; } // no calculation if table is hidden
        var newdiv=$("marketoffersNotepad");
        if(newdiv){
            newdiv.innerHTML="";
            var newtable=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},newdiv);
            var newtr=createElement("tr",{"class":"link"},newtable);
            var newtd=createElement("td",{"colspan":"5","style":"border-bottom:1px solid black;text-align:center;"},newtr,getText("marketstall"));
            newtr.addEventListener("mouseover",function(event){
                var str='<table>';
                str += '<tr><th colspan="2" class="lightBg">'+getText("goToMarketstall")+'</th></tr>';
                str += '<tr><td>'+"∑"+'</td><td style="text-align:right;">'+moneyFormatInt(parseInt(this.getAttribute("value"),10))+'</td></tr>';
                str += '</table>';
                toolTip.show(event,str);
            },false);
            newtr.addEventListener("click",function(){showMarketStall();},false);

            var sumTotal=0;
            var oldType=null;
            var newType=null;
            for(var i=0;i<ownMarketOffers.length;i++){
                var prod=ownMarketOffers[i][0];
                var price=ownMarketOffers[i][1];
                var amount=ownMarketOffers[i][2];
                newType=prodTyp[0][prod];
                sumTotal += amount*price;
                newtr=createElement("tr",{"class":"link hoverBgCc9"+(((oldType!=null)&&(oldType!=newType))?" borderTop1dashedBlack":""),"prod":prod,"value":(amount*price)},newtable);
                oldType=newType;
                newtr.addEventListener("mouseover",function(event){
                    showGoToMarketToolTip(event,this.getAttribute("prod"),null,'<tr><td>'+"∑"+'</td><td style="text-align:right;">'+moneyFormatInt(parseInt(this.getAttribute("value"),10))+'</td></tr>');
                },false);
                newtr.addEventListener("click",function(){showMarket(this.getAttribute("prod"));},false);
                newtd=createElement("td",{},newtr);
                produktPic(0,prod,newtd);
                createElement("td",{"style":"text-align:right;"},newtr,numberFormat(amount));
                createElement("td",{"style":"padding-left:3px;"},newtr,prodName[0][prod]);
                createElement("td",{"style":"padding-left:3px;text-align:right;"},newtr,numberFormat(Math.floor(price)));
                createElement("td",{"style":""},newtr,numberFormat(price,2).slice(-3).replace("00","--"));
            }

            newtable.firstElementChild.setAttribute("value",sumTotal);
            if(newtable.childElementCount==1){
                newtr=createElement("tr",{},newtable);
                createElement("td",{"colspan":"5","style":"text-align:center;"},newtr,"---");
            }
            newtable=null;newtr=null;newtd=null;
        }
        newdiv=null;
    }catch(err){ GM_logError("doMarketoffersNotepad","","prod="+prod,err); }
    }
function doRack(){
    try{
        var cand=$("rackItems").getElementsByClassName("tklein2");
        if(unsafeWindow.farm!=5 && unsafeWindow.farm!=6 && unsafeWindow.farm!=7 && unsafeWindow.farm!=8 && unsafeWindow.farm!=9){
            for(var v=0;v<cand.length;v++){
                var currProd=parseInt(cand[v].parentNode.id.replace("rackitem",""),10);
                var cell=$(cand[v].parentNode.id+"format");
                if(!cell){
                    cell=cand[v].parentNode.parentNode;
                    cell.setAttribute("class",(cell.getAttribute("class")+" link").replace(/(^|\s+)link\s+/g," ").replace(/^\s+/,""));
                    cand[v].style.display="none";
                    cell=createElement("div",{"id":"rackitem"+currProd+"format"},cand[v].parentNode);
                }
                var str=numberFormatPrefixed(prodStock[0][currProd]);
                if(cell.innerHTML!=str){ cell.innerHTML=str; }
                str=cand[v].getAttribute("class")+(prodStock[0][currProd]<prodMinRack[0][currProd]?" lowrack":""); // .replace("tklein2","formattedRackItem")
                if(cell.getAttribute("class")!=str){ cell.setAttribute("class",str); }
                cell=null;
            }
        }
        cand=null;
    }catch(err){ GM_logError("doRack","","v="+v,err);}
}
function doFarmis(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","doFarmis"); }
        var err_trace="init";
        // GM_log("farmiLog=\n"+print_r(farmiLog,"",true,"\n"));
        // TODO: Questproduct is not calculated in at first run. Fixed now I believe
        // this can't go in the above loop because the amountMinRack are needed to be calculated first
        var cell,customerline,str;
        var missing,belowMinRack,belowMinRackInit;
        if(customerline=$("customerline2")){
            for(var farmiNr=0;farmiNr<customerline.childElementCount;farmiNr++){
                err_trace="farmisinfo";
                missing=0;belowMinRack=0;belowMinRackInit=false;
                for(var i=1;i<=7;i++){ // 7=max-amount of products per farmi
                    var pid=unsafeWindow.farmisinfo[0][farmiNr]["p"+i];
                    var amount=parseInt(unsafeWindow.farmisinfo[0][farmiNr]["a"+i],10);
                    if((pid > 0) && (amount > 0)){
                        if(prodStock[0][pid]<amount){ missing++; }
                        if((prodStock[0][pid]-amount)<prodMinRack[0][pid]-((valMinRackFarmis&&totalFarmis[0]&&totalFarmis[0][pid])?totalFarmis[0][pid]:0)){ belowMinRack++; }
                        if((prodStock[0][pid]-amount)<prodMinRackInit[0][pid]){ belowMinRackInit++; }
                    }
                }
                unsafeWindow.farmisinfo[0][farmiNr]["missing"]=missing;
                unsafeWindow.farmisinfo[0][farmiNr]["belowMinRack"]=belowMinRack;
                unsafeWindow.farmisinfo[0][farmiNr]["belowMinRackInit"]=belowMinRackInit;
                err_trace="farmiInfo create";
                if (!$("farmiInfo"+farmiNr)){ // assure that this code is run only once per farmi. else eventlisteners are stacked
                    // prepare the additional farmi-info-bubble
                    createElement("div",{"id":"farmiInfo"+farmiNr,"class":"farmiInfo"},$(customerline.children[farmiNr].id+"_bubble"));
                    createElement("div",{"id":"farmiMiniInfo"+farmiNr,"class":"farmiMiniInfo"},customerline.children[farmiNr]);

                    customerline.children[farmiNr].addEventListener("mouseover",function(farmiNr){
                        return function(){
                            //toolTip.show(event,print_r(unsafeWindow.farmisinfo[0][farmiNr],"",true));
                            var cash;
                            // Obststandbonus
                            var stallMilestone = (unsafeWindow.stall.data.milestones)?unsafeWindow.stall.data.milestones.farmis:0;
                            if (unsafeWindow.specialbonus&&unsafeWindow.specialbonus.data[0]&&unsafeWindow.specialbonus.data[0].farmis&&unsafeWindow.specialbonus.data[0].farmis.money&&unsafeWindow.specialbonus.data[0].remain>0) {
                                cash = parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)*(stallMilestone+unsafeWindow.specialbonus.data[0].farmis.money);
                            } else {
                                cash = parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)*(stallMilestone);
                            }

                            var wert = parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["marketValue"],10);
                            var cell = $(this.id+"_bubble").firstElementChild;

                            var ppid, amount;
                            for(var i=1;i<=7;i++){ // 7=maxanzahl produkte pro farmi
                                if(cell.style.clear=="both"){ // line break after 4 products
                                    cell=cell.nextElementSibling;
                                    if(!cell){ break; }
                                }
                                pid=unsafeWindow.farmisinfo[0][farmiNr]["p"+i];
                                amount=parseInt(unsafeWindow.farmisinfo[0][farmiNr]["a"+i],10);
                                if((pid>0)&&(amount>0)){
                                    if(prodStock[0][pid]<amount){
                                        // not enough in rack
                                        cell.setAttribute("style",css_styles["prod_border_missing"][1]+"overflow:hidden; margin-right:2px; marign-bottom:2px; float:left; width:15px; height:15px;border-radius:4px;");
                                    }else if(prodStock[0][pid]-amount<prodMinRack[0][pid]-((valMinRackFarmis&&totalFarmis[0]&&totalFarmis[0][pid])?totalFarmis[0][pid]:0)){
                                        // selling this farmi will push the rack below the min-value
                                        cell.setAttribute("style",css_styles["prod_border_lowamount"][1]+"overflow:hidden; margin-right:2px; marign-bottom:2px; float:left; width:15px; height:15px;border-radius:4px;");
                                    }else{
                                        cell.style.border="1px solid white";
                                        //css_styles["prod_border_none"][[],"1px solid white","1px solid white"];
                                        //cell.setAttribute("style",css_styles["prod_border_none"][1]+"overflow:hidden; margin-right:2px; marign-bottom:2px; float:left; width:15px; height:15px;border-radius:4px;");
                                    }
                                }
                                cell=cell.nextElementSibling;
                                if(!cell){ break; }
                            }
                            cell=$("farmiInfo"+farmiNr);
                            if(!unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]){
                                // a price is missing. can't calculate, so display white
                                cell.innerHTML=moneyFormatInt(cash);
                                cell.setAttribute("style",css_styles["cloud_back_noprice"][1]+css_styles["cloud_border_noprice"][1]);
                            }else if(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]<valFarmiLimits[0]){
                                // low case
                                cell.innerHTML=moneyFormatInt(cash)+"<br>"+numberFormat(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"],1)+"&nbsp;%<br>"+moneyFormatInt(cash-wert)+"&nbsp;|&nbsp;"+moneyFormatInt(cash-0.9*wert);
                                cell.setAttribute("style",css_styles["cloud_back_below"][1]+css_styles["cloud_border_below"][1]);
                            }else if(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]<valFarmiLimits[1]){
                                // middle case
                                cell.innerHTML=moneyFormatInt(cash)+"<br>"+numberFormat(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"],1)+"&nbsp;%<br>"+moneyFormatInt(cash-wert)+"&nbsp;|&nbsp;+"+moneyFormatInt(cash-0.9*wert);
                                cell.setAttribute("style",css_styles["cloud_back_between"][1]+css_styles["cloud_border_between"][1]);
                            }else{
                                // high case
                                cell.innerHTML=moneyFormatInt(cash)+"<br>"+numberFormat(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"],1)+"&nbsp;%<br>+"+moneyFormatInt(cash-wert)+"&nbsp;|&nbsp;+"+moneyFormatInt(cash-0.9*wert);
                                cell.setAttribute("style",css_styles["cloud_back_above"][1]+css_styles["cloud_border_above"][1]);
                            }
                            cell=null;
                        }

                    }(farmiNr),false);
                    // farmi is new=not in the FarmiLog
                    var farmi_id=parseInt(unsafeWindow.farmisinfo[0][farmiNr]["id"],10);
                    var farmiLog_id=farmiLog.length;
                    for(var v=0;v<farmiLog.length;v++){
                        if (farmiLog[v][0]==farmi_id){
                            farmiLog_id=v;
                            break;
                        }
                    }
                    if (farmiLog_id==farmiLog.length){
                        raiseEvent("gameFarmiNew");
                        //todayStr=getDateStr(now,2,false);
                        // add this new farmi
                        farmiLog.push([farmi_id,todayStr,parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10),{}]);
                        for(var w=1;w<8;w++){
                            if (unsafeWindow.farmisinfo[0][farmiNr]["p"+w]!="0"){
                                farmiLog[farmiLog_id][3][unsafeWindow.farmisinfo[0][farmiNr]["p"+w]]=parseInt(unsafeWindow.farmisinfo[0][farmiNr]["a"+w],10);
                            }
                        }
                        levelLog[levelLogId][5]+=farmiLog[farmiLog_id][2];
                        levelLog[levelLogId][5]=Math.round(100*levelLog[levelLogId][5])/100;
                        // sorting
                        farmiLog.sort(function(a,b){return (getTime(b[1])-getTime(a[1]));});
                        // saving
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmiLog",implode(farmiLog,"doFarmis/farmiLog"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(levelLog,"doFarmis/levelLog"));
                        window.setTimeout(doBuyNotepad,0);
                    }
                }
                err_trace="farmiInfo";
                if(valFarmiMiniInfo){
                    // Price
                    if(!unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]){ // unknown case
                        str = css_styles["farmi_price_unknown"][1];
                    }else if(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]<valFarmiLimits[0]){ // low case
                        str = css_styles["farmi_price_low"][1];
                    }else if(unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]<valFarmiLimits[1]){ // middle case
                        str = css_styles["farmi_price_between"][1];
                    }else{ // high case
                        str = css_styles["farmi_price_above"][1];
                    }
                    // Rackamount
                    if(unsafeWindow.farmisinfo[0][farmiNr]["missing"]>0){
                        str += ' '+ css_styles["farmi_amount_missing"][1];
                    }else if(unsafeWindow.farmisinfo[0][farmiNr]["belowminvalue"]>0){
                        str += ' '+ css_styles["farmi_amount_low"][1];
                    }else{
                        str += ' '+ css_styles["farmi_amount_above"][1];
                    }

                    cell=$("farmiMiniInfo"+farmiNr);
                    if(cell.getAttribute("style")!=str){ cell.setAttribute("style",str); }
                }
            }
            err_trace="alertAdvertEnd";
            if((unsafeWindow.customerstats)&&(unsafeWindow.customerstats["adstart"])&&(unsafeWindow.adrun)){
               var endDay = getDateStr(getTime(unsafeWindow.customerstats["adstart"])+4*86400-1);
                if((unsafeWindow.customerstats[endDay])&&(parseInt(unsafeWindow.customerstats[endDay]["count"],10)>=(farmiDailyCount+2*unsafeWindow.adrun))){
                    if(!(cell=$("alertAdvertEnd"))){
                        createElement("div",{"id":"alertAdvertEnd","style":"position:absolute;top:65px;left:0;color:white;font-weight:bold;background-color:red;padding:2px;white-space:nowrap;"},$("customerstats"),getText("advertisingEnds"));
                        window.setTimeout(function(){
                            var newdiv;
                            if(newdiv=$("alertAdvertEnd")){ removeElement(newdiv); }
                            newdiv=null;
                        },1000*(getTime(getDateStr(now,2,false))+86400-now)); // time till midnight
                    }
                }else{
                    if(cell=$("alertAdvertEnd")){ removeElement(cell); }
                }
                endDay = null;
            }else{
                if(cell=$("alertAdvertEnd")){ removeElement(cell); }
            }
        }else{
            err_trace="no customerline";
            if(cell=$("alertAdvertEnd")){ removeElement(cell); }
        }
        missing=null;belowMinRack=null;belowMinRackInit=null;
        cell=null;str=null;
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("doFarmis","","err_trace=\""+err_trace+"\"",err); }
}

function do_main(){
try{
    function calcObservedPrice(mode,data){
        // data=[[amount1,price1],[amount2,price2],...]
        switch(mode){
        case 1:{ // normal mode. fast market
            data=data.clone();
            // kick upper 20% quantile
            var sum=0;
            for(var v=0;v<data.length;v++){
                sum += data[v][0];
            }
            sum=Math.floor(0.2*sum);
            for(var v=data.length-1;0<=v;v--){
                if(data[v][0]<sum){
                    sum -= data[v][0];
                    data.splice(v,1);
                }else{
                    data[v][0] -= sum;
                    sum=0;
                    break;
                }
            }

            // calc weighted mean
            var weights=[3,3,3,3,2,2,2,2,1,1,1,1];
            var count1=0;
            var count2=0;
            for(var v=0;v<data.length;v++){
                if (weights[v]!=undefined){
                    count1 += weights[v]*data[v][0]*data[v][1];
                    count2 += weights[v]*data[v][0];
                }
            }
            if(count2>0){
                return (Math.round(100*count1/count2)/100);
            }else{
                return 0;
            }
        break;}
        case 2:{ // decorations. slow market
            if(data.length>1){
                return data[1][1];
            }else if(data.length==1){
                return data[0][1];
            }else{
                return 0;
            }
        break;}
        }
    }

    var err_trace="Session";
    GM_logInfo("do_main","","","Berater started",1);
    // Check if username is known
    if (!USERNAME){
        GM_logWarning("do_main","","","Username is not known. Login again with running script.")
        location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
        return false;
    }
    // Check if browser is uptodate
    var newdiv,newdiv1,container,help;
    if(!createElement("div").children){
        newdiv=createElement("div",{"class":"alertbubble tbig link"},ALL,"Your browser could be too old.<br>This script uses functions which need Gecko&nbsp;1.9.1 (Firefox&nbsp;3.5).<br>You will get errors.");
        newdiv.addEventListener("click",function(){ removeElement(this); },false);
    }
    // Save session-id
    if (unsafeWindow.rid){  GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_session",unsafeWindow.rid); }
    // Show changelog of new version
    err_trace="Changelog of new version";
    if(CHANGELOG[CHANGELOG.length-1][0]!=GM_getValue("changelogShownVersion","")){
        container=createElement("div");
        createElement("div",{},container,getText("confirmChangelogVersion").replace("%1%",CHANGELOG[CHANGELOG.length-1][0]));
        newdiv=createElement("ul",{},container);
        for(var i=0;i<CHANGELOG[CHANGELOG.length-1][2].length;i++){
            createElement("li",{},newdiv,CHANGELOG[CHANGELOG.length-1][2][i][LANGUAGE=="de"?0:1]);
        }
        alert2(container.innerHTML,getText("ok"),getText("showChangelog"),
        function(){
            GM_setValueCache("changelogShownVersion",CHANGELOG[CHANGELOG.length-1][0]);
        },
        function(){
            GM_setValueCache("changelogShownVersion",CHANGELOG[CHANGELOG.length-1][0]);
            unsafeWindow.buildInfoPanel("changelog");
        });
    }

    // Container Divs
    err_trace="Container";
    var nodes=new Object();
    ALL.style.margin="5px";
    var upjersToolbarHeight=($("uptoolbar")&&$("uptoolbar").style.display!="none")?30:0;
    var content_table=document.getElementsByClassName("content_table")[0];
    container=createElement("div",{"id":"gameArea","align":"center","style":"margin-top:"+upjersToolbarHeight+"px;"},ALL);
    newdiv=createElement("div",{"id":"divBeraterButtons","style":"position:fixed;left:0;top:"+(upjersToolbarHeight+50)+"px;width:40px;border:1px groove #4D240E;border-radius:0 10px 10px 0;z-index:500;background:url(\""+GFX+"guild/help_back.jpg\") -25px -25px;"},container);
    newdiv.addEventListener("mouseover",function(event){
        var node=event.target;
        var mouseOverText=node.getAttribute("mouseOverText");
        while((node!=this)&&(!mouseOverText)){
            node=node.parentNode;
            mouseOverText=node.getAttribute("mouseOverText");
        }
        if(mouseOverText){ toolTip.show(event,mouseOverText); }
        node=null;mouseOverText=null;
    },false);
    newdiv1=createElement("div",{"id":"divBeraterButtonsOptionen","class":"link beraterButtonIcon hoverBgGreen","mouseOverText":getText("options")},newdiv);
    createElement("img",{"src":IMAGES["settings"],"style":"position:relative;top:-3px;left:-1px;;width:32px;height:32px;"},newdiv1);
    newdiv1.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("menu","options"); },false);
    newdiv1=createElement("div",{"id":"divGame","style":"position:relative;top:0;margin-left:45px;"},container);
    newdiv1.appendChild(content_table);
    if(newdiv=document.querySelector('a[href="https://de.upjers.com/imprint"]')){
        newdiv=newdiv.parentNode;
        container.appendChild(newdiv);
        newdiv.style.position="relative";
        newdiv.style.top=0;
        newdiv.style.left=0;
        newdiv.style.margin=0;
    }
    content_table.style.position = "relative";
    createElement("div",{"id":"statisticArea","align":"center","style":"margin-top:"+upjersToolbarHeight+"px;display:none;"},ALL);
    if (window.innerWidth<1180){ content_table.style.paddingRight="176px"; }
    if (window.innerHeight>830){ ALL.style.overflowY="hidden"; }
    if(newdiv=$("errorboxgarden")){
        newdiv.style.left="600px";
        newdiv.style.top="105px";
    }else{
        GM_logWarning("do_main","","","#errorboxgarden not found",0);
    }

    err_trace="Container - divRightBorder";
    newdiv1=content_table.getElementsByTagName("tr")[1];
    // $("questbarcontrol").parentNode;
    // removeElement(newdiv1.firstElementChild);
    newdiv=createElement("td",{"id":"divRightBorder","style":"padding:0px 100px 0px 20px;"},newdiv1);

    err_trace="Container - divMiddleBorder";
    /*
    if(container=$("gamearea_spacer")){
        container.innerHTML="";
        container=createElement("div",{"id":"divMiddleBorder","style":"position:relative;height:100%;"},container);
        for(var i=0;i+1<newdiv1.childElementCount;){
            if(newdiv1.children[i].id.match(/questbarcontrol|farm_production_checker_icon/)){
                newdiv.appendChild(newdiv1.children[i]);
            }else{
                container.appendChild(newdiv1.children[i]);
            }
        }
    }
    */

    err_trace="Container - fixedDivRight";
    newdiv=createElement("div",{"id":"fixedDivRight","style":"position:fixed;right:0;top:"+(upjersToolbarHeight)+"px;z-index:500;"},$("divGame"));
    createElement("div",{"id":"timeHolder"},newdiv);
    nodes["containerPowerupSymbols"]=new Object();
    nodes["containerPowerupSymbols"]["node"]=createElement("div",{"id":"containerPowerupSymbols"},newdiv);

    err_trace="Container - headercontainer";
    newdiv=createElement("div",{"style":"position:absolute;top:2px;left:210px;color:#f7bb87;z-index:10;"},$("headercontainer"));
    nodes["serverTime"]=new Object();
    nodes["serverTime"]["node"]=createElement("div",{"id":"serverTime","style":"float:left;margin-left:2px;"},newdiv);
    nodes["serverTime"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("serverTime")); },false);
    function do_relogin(){
        window.setTimeout(function(){
            var help=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"clickListener@divSessionEnd/pagedataLogin",{});
            if(!(help["doserver"]&&(typeof help["doserver"]=="object"))){
                help["doserver"]=new Object();
            }
            help["doserver"][SERVER]=true;
            GM_setValue(COUNTRY+"_pagedataLogin",implode(help,"do_relogin/help"));
            if($("logoutbutton")){
                click($("logoutbutton"));
            } else {
                location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
            }
        },0);
    }
    nodes["sessionTimeLeft"]=new Object();
    nodes["sessionTimeLeft"]["node"]=createElement("div",{"id":"sessionTimeLeft","class":"link","style":"float:left;margin-left:2px;"},newdiv);
    nodes["sessionTimeLeft"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("sessionEnd").replace(/%1%/,getDaytimeStr(valSessionEndtime))); },false);
    nodes["sessionTimeLeft"]["node"].addEventListener("click",do_relogin,false);
    nodes["sessionTimeNow"]=new Object();
    nodes["sessionTimeNow"]["node"]=createElement("div",{"id":"sessionTimeNow","style":"float:left;margin-left:2px;"},newdiv);
    nodes["sessionTimeNow"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("localTime")); },false);

    USERLEVEL=parseInt(unsafeWindow.currentuserlevel,10);
    /*
    var new_PRODUCT2BUILDING=PRODUCT2BUILDING.clone();
    new_PRODUCT2BUILDING[0][154]=1;
    GM_log(implode(new_PRODUCT2BUILDING));
    */
    show=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_show"),"do_main/show",{}); // buyNotepad,marketoffersNotepad
    if((typeof show!="object")||(show instanceof Array)){ show = new Object(); }
    questData=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData"),"questData",INIT_questData);
    if((typeof questData!="object")||(questData instanceof Array)){ questData = INIT_questData.clone(); }
    // Check structure of questData
    for(var t in questData){
        if(!questData.hasOwnProperty(t)){continue;}
        if(INIT_questData[t]){
            for(var c in questData[t]){
                if(!questData[t].hasOwnProperty(c)){continue;}
                if(!INIT_questData[t][c]){ delete questData[t][c]; }
            }
        }else{
            delete questData[t];
        }
    }
    for(var t in INIT_questData){
        if(!INIT_questData.hasOwnProperty(t)){continue;}
        if(questData[t]){
            for(var c in INIT_questData[t]){
                if(!INIT_questData[t].hasOwnProperty(c)){continue;}
                if(!questData[t][c]){ questData[t]=INIT_questData[t]; }
            }
        }else{
            questData[t]=INIT_questData[t];
        }
    }
    // Check quest requirements
    if((USERLEVEL<42)||(speedlink_farm6.style.display=="none")){questData["main"]["4"]["nr"]=-1; }
    if((USERLEVEL<40)||(speedlink_farm5.style.display=="none")){questData["main"]["3"]["nr"]=-1; }
    if(USERLEVEL<31){ questData["main"]["2"]["nr"]=-1; }
    if(USERLEVEL<20){ questData["forestry"]["1"]["nr"]=-1; }
    if(questData["forestry"]["1"]["nr"]<35){ questData["forestry"]["2"]["nr"]=-1; }
    if(USERLEVEL<12){ questData["foodworld"]["1"]["nr"]=-1; }
    unsafeData.questData=questData.clone();

    for(var t in questData){
        if(!questData.hasOwnProperty(t)){continue;}
        for(var c in questData[t]){
            if(!questData[t].hasOwnProperty(c)){continue;}
            if((0<questData[t][c]["calcTo"])&&(questData[t][c]["calcTo"]<questData[t][c]["nr"])){
                setCalcToQuest(t,c,questData[t][c]["nr"]);
            }
        }
    }
    valServerTimeOffset=GM_getValue(COUNTRY+"_valServerTimeOffset",0);
    todayStr=getDateStr(now,2,false);
    nowServerOff=unsafeWindow.Zeit.Server+valServerTimeOffset;
    todayServerStr=getDateStr(nowServerOff,2,false);

    buyNotePadShowBlocked=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_buyNotePadShowBlocked",false);//TODO make option
    loadProductData();
    updateProductDataFarm();
    updateProductDataForestry();
    updateProductDataWindmill();
    updateProductDataPowerup();

    valMinRackMan=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackMan",false);
    valMinRack=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRack"),"do_main/valMinRack",INIT_valMinRack.clone());
    bChanged=false;
    if((typeof valMinRack=="object")&&!(valMinRack instanceof Array)){
        for(var v in valMinRack){
            if(!valMinRack.hasOwnProperty(v)){continue;}
            if(INIT_valMinRack[v]===undefined){ delete valMinRack[v];bChanged=true; }
            else if(typeof valMinRack[v]!="number"){ valMinRack[v]=INIT_valMinRack[v];bChanged=true; }
        }
        for(var v in INIT_valMinRack){
            if(!INIT_valMinRack.hasOwnProperty(v)){continue;}
            if(valMinRack[v]===undefined){ valMinRack[v]=INIT_valMinRack[v];bChanged=true; }
        }
    }else{
        valMinRack=INIT_valMinRack.clone();bChanged=true;
    }
    if(bChanged){ GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRack",implode(valMinRack,"valMinRack")); }
    valMinRackPlantsize=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackPlantsize",false); //Use plant ratio
    valMinRackFarmis=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFarmis",true);
    valMinRackForestryFarmis=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackForestryFarmis",true);
    valMinRackFoodworldFarmis=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFoodworldFarmis",true);
    valMinRackFarmersmarketFarmis=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackFarmersmarketFarmis",true);
    valMinRackGrowing=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackGrowing",true);
    valMinRackRecursive=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinRackRecursive",false);
    valFarmiLimits=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFarmiLimits"),"do_main/valFarmiLimits",[90,100]);
    unsafeData.valFarmiLimits=valFarmiLimits.clone();
    valMinExFruitsFarms5=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinExFruitsFarms5",implode(valMinExFruitsFarms5,"buildInfoPanelOptions/valMinExFruitsFarms5"));
    if (isNaN(valMinExFruitsFarms5)){
    valMinExFruitsFarms5=VARIABLES["USER"]["valMinExFruitsFarms5"][2];
    }

    valMinAlpinFarm6=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMinAlpinFarm6",implode(valMinAlpinFarm6,"buildInfoPanelOptions/valMinAlpinFarm6"));

    valFarmiMiniInfo=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFarmiMiniInfo",true);

    unsafeOverwriteFunction("createAdvancedProductResponse",function(response,e,c){
        try{
            unsafeWindow._createAdvancedProductResponse(response,e,c);
        }catch(err){GM_logError("_createAdvancedProductResponse","","",err);}
        try{
            raiseEvent("gameStartFactory");
        }catch(err){GM_logError("createAdvancedProductResponse","","",err);}
    });
    // Farmis
    err_trace="farmis";
    if(newdiv=$("customerstats")){
        newdiv.setAttribute("class","link");
        newdiv.addEventListener("click",function(){unsafeWindow.buildInfoPanel("farmies");},false);
        newdiv.addEventListener("mouseover",function(){raiseEvent("gameMegafieldDataDone");},false);
    } else {
        setTimeout(function(){
            newdiv=$("customerstats");
            newdiv.setAttribute("class","link");
            newdiv.addEventListener("click",function(){unsafeWindow.buildInfoPanel("farmies");},false);
            newdiv.addEventListener("mouseover",function(){raiseEvent("gameMegafieldDataDone");},false);
        }, 3000);
    }
    // farmiLog[farmiId]=[date,money,{prod1:amount,...}]
    farmiLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmiLog"),"do_main/farmiLog",[]);
    if(!(farmiLog instanceof Array)){ farmiLog=[]; }
    // kick farmis older than 1 month, set this value optional?
    var dayLastMonth=new Date();
    dayLastMonth=Math.round(((new Date(dayLastMonth.getFullYear(),dayLastMonth.getMonth()-1,dayLastMonth.getDate())).getTime())/1000);
    for(var v=farmiLog.length-1;v>=0;v--){
        if (getTime(farmiLog[v][1])<=dayLastMonth){
            farmiLog.splice(v,1);
        }
    }

    function calcFarmiCost(){ //done on price change, on load and on a new farmi
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","calcFarmiCost"); }
        // calculate costs of the farmis
        for(var farmiNr in unsafeWindow.farmisinfo[0]){
            if(!unsafeWindow.farmisinfo[0].hasOwnProperty(farmiNr)){ continue; }
            var wert=0;
            var priceMissing=0;
            for(var i=1;i<=7;i++){ // 7=max-amount of products per farmi
                var pid=unsafeWindow.farmisinfo[0][farmiNr]["p"+i];
                var amount=parseInt(unsafeWindow.farmisinfo[0][farmiNr]["a"+i],10);
                if((pid>0)&&(amount>0)){
                    if(gut[pid]>0){
                        wert += amount*gut[pid];
                    }else{
                        priceMissing++;
                    }
                }
            }
            // Obststandbonus
            var stallMilestone = (unsafeWindow.stall.data.milestones)?unsafeWindow.stall.data.milestones.farmis:0;
            if (unsafeWindow.specialbonus&&unsafeWindow.specialbonus.data[0]&&unsafeWindow.specialbonus.data[0].farmis&&unsafeWindow.specialbonus.data[0].farmis.money&&unsafeWindow.specialbonus.data[0].remain>0) {
                unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]=(priceMissing>0?null:(100*(parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)*(stallMilestone+unsafeWindow.specialbonus.data[0].farmis.money))/wert));

            } else {
                unsafeWindow.farmisinfo[0][farmiNr]["costQuotient"]=(priceMissing>0?null:(100*(parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmiNr]["price"],10)*(stallMilestone))/wert));
            }
            unsafeWindow.farmisinfo[0][farmiNr]["marketValue"]=(priceMissing>0?0:wert);
        }
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("calcFarmiCost","","",err); }
    }
    // Foodworld
    err_trace="Foodworld";
    // Foodworld-Farmi
    unsafeOverwriteFunction("showFoodworldFarmiCart",function(farmi){
    try{
        unsafeWindow._showFoodworldFarmiCart(farmi);
    }catch(err){GM_logError("_showFoodworldFarmiCart","","",err);}
    try{
        // get farmi data
        var prod,menge;
        var thisFarmiData=new Object();
        thisFarmiData["cart"]=new Array();
        thisFarmiData["money"]=parseFloat(unsafeWindow.foodworldfarmis[farmi]["price"],10);
        thisFarmiData["money"]=thisFarmiData["money"]+(thisFarmiData["money"]*(unsafeWindow.foodworld_bonus.bonus?unsafeWindow.foodworld_bonus.bonus:1)/100);
        for(var i in unsafeWindow.foodworldfarmis[farmi]["products"]){
            if(!unsafeWindow.foodworldfarmis[farmi]["products"].hasOwnProperty(i)){ continue; }
            prod=parseInt(i,10);
            menge=unsafeWindow.foodworldfarmis[farmi]["products"][i];
            thisFarmiData["cart"].push([prod,menge,menge*gut[prod]]);
        }
        // (re-)build the table
        function buildTable(){
        try{
            var cartContent,newtable,newtr,newtd,span;
            cartContent=$("food_cart_products");
            cartContent.innerHTML="";
            var prod,menge,wert,sum=0,priceMissing=false;
            thisFarmiData["cart"].sort(function(a,b){return (b[2]-a[2]);});
            newtable=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"2","style":"margin:0 auto;"},cartContent);
            for(var v=0;v<thisFarmiData["cart"].length;v++){
                prod=thisFarmiData["cart"][v][0];
                menge=thisFarmiData["cart"][v][1];
                wert=thisFarmiData["cart"][v][2];
                sum += wert;
                newtr=createElement("tr",{"class":((prodStock[0][prod]<menge)?("farmicart_missing"):((prodStock[0][prod]-menge<prodMinRack[0][prod]-((valMinRackFarmis&&totalFarmis[0]&&totalFarmis[0][prod])?totalFarmis[0][prod]:0))?"farmicart_lowrack":"")),"prod":prod},newtable);
                produktPic(0,prod,createElement("td",{},newtr));
                createElement("td",{"style":"text-align:right;font-size:16px;font-weight:bold;"},newtr,numberFormat(menge));
                newtd=createElement("td",{"class":"link","style":"width:170px;"},newtr);
                newtd.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.parentNode.getAttribute("prod")); },false);
                newtd.addEventListener("click",function(){showMarket(this.parentNode.getAttribute("prod"));},false);
                span=createElement("span",{"style":"font-size:16px;font-weight:bold;white-space:nowrap;"},newtd,prodName[0][prod]);
                span.style.fontSize=16*Math.min(1,170/span.offsetWidth)+"px";
                newtd=createElement("td",{"class":"link","nr":v,"style":"width:82px;text-align:right;font-size:14px;"},newtr);
                if(wert>0){
                    newtd=createElement("div",{"style":"position:relative;height:100%;padding-left:5px;padding-right:5px;"},newtd);
                    createElement("div",{"style":"position:absolute;left:0;height:100%;width:"+Math.ceil(100*wert/thisFarmiData["cart"][0][2])+"%;background-color:grey;opacity:0.6;z-index:-1;"},newtd);
                    createElement("span",{"style":"width:100%;"},newtd,moneyFormatInt(wert));
                }else{
                    newtd.style.backgroundColor="red";
                    priceMissing=true;
                }
                newtd.addEventListener("mouseover",function(event){ toolTip.show(event,getText("editPrice")); },false);
                newtd.addEventListener("click",function(){
                    var cell,newtable,newt,newtdr
                    cell=this;
                    while(cell.nodeName!="TD"){ cell=cell.parentNode; }
                    var v=cell.getAttribute("nr");
                    cell=$("cartcontentEditPrice");
                    if(cell){ removeElement(cell); }
                    newtable=createElement("div",{"id":"cartcontentEditPrice","style":"z-index:10;position:absolute;right:0;top:0;display:block;border-radius:5px;","class":"blackbox"},$("food_cart_products"));
                    newtable=createElement("table",{"cellspacing":"0","cellpadding":"0","border":"0","nr":v},newtable);
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"colspan":"2","style":"color:black;text-align:center;padding-bottom:2px;white-space:nowrap;"},newtr,getText("editPrice"));
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"colspan":"2","style":"color:black;border-bottom:1px solid black;text-align:center;padding-bottom:2px;white-space:nowrap;"},newtr,numberFormat(thisFarmiData["cart"][v][1])+"&nbsp;"+prodName[0][thisFarmiData["cart"][v][0]]);
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-top:2px;padding-right:10px;"},newtr,getText("marketPrice"));
                    createElement("td",{"style":"color:black;text-align:right;padding-top:2px;"},newtr,moneyFormat(gut[thisFarmiData["cart"][v][0]]));
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("NPCprice"));
                    createElement("td",{"style":"color:black;text-align:right;"},newtr,isNaN(NPC[0][thisFarmiData["cart"][v][0]])?"-":moneyFormat(NPC[0][thisFarmiData["cart"][v][0]]));
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("single"));
                    newtd=createElement("td",{},newtr);
                    cell=createElement("input",{"class":"text","type":"text","style":"color:black;text-align:right;width:60px;","value":numberFormat(thisFarmiData["cart"][v][2]/thisFarmiData["cart"][v][1],2),"maxlength":"8"},newtd);
                    cell.addEventListener("change",function(){
                        var help=parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                        if(!isNaN(help)){
                            if(help<0){ help*=-1; }
                            help=Math.round(100*help)/100;
                            this.value=numberFormat(help,2);
                            var v=this.parentNode.parentNode.parentNode.getAttribute("nr");
                            thisFarmiData["cart"][v][2]=help*thisFarmiData["cart"][v][1];
                            this.parentNode.parentNode.nextElementSibling.children[1].firstElementChild.value=numberFormat(thisFarmiData["cart"][v][2],2);
                        }
                    },false);
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("total"));
                    newtd=createElement("td",{},newtr);
                    cell=createElement("input",{"class":"text","type":"text","style":"color:black;text-align:right;width:60px;","value":numberFormat(thisFarmiData["cart"][v][2],2),"maxlength":"9"},newtd);
                    cell.addEventListener("change",function(){
                        var help=parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                        if(!isNaN(help)){
                            if(help<0){ help*=-1; }
                            help=Math.round(100*help)/100;
                            this.value=numberFormat(help,2);
                            var v=this.parentNode.parentNode.parentNode.getAttribute("nr");
                            thisFarmiData["cart"][v][2]=help;
                            this.parentNode.parentNode.previousElementSibling.children[1].firstElementChild.value=numberFormat(thisFarmiData["cart"][v][2]/thisFarmiData["cart"][v][1],2);
                        }
                    },false);
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    newtd=createElement("td",{"colspan":"2","style":"color:black;border-top:1px solid black;text-align:center;padding-top:2px;"},newtr);
                    cell=createElement("button",{"class":"link","type":"button","style":"color:black;"},newtd,getText("ok"));
                    cell.addEventListener("click",function(){
                        removeElement(this.parentNode.parentNode.parentNode.parentNode);
                        buildTable();
                    },false);
                    cell=null;newtable=null;newtr=null;newtd=null;
                },false);
            }

            newtr=createElement("tr",{},newtable);
            createElement("td",{"colspan":"3"},newtr);
            newtd=createElement("td",{"style":"padding-left:5px;padding-right:5px;border-top:1px solid #336;text-align:right;color:#336;font-size:14px;","mouseOverText":"90%: "+moneyFormatInt(0.9*sum)},newtr,moneyFormatInt(sum));
            newtd.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);

            newtd=$("food_cart_perc");
            if(priceMissing){
                newtd.style.border="4px inset #336";
                newtd.style.color="#336";
                newtd.style.backgroundColor="transparent";
                newtd.innerHTML="--%";
            }else{
                if(100*thisFarmiData["money"]<valFarmiLimits[0]*sum){ var col="red";var col2="#fcc"; }
                else if(100*thisFarmiData["money"]<valFarmiLimits[1]*sum){ var col="#d80";var col2="#ff9"; }
                else{ var col="green";var col2="#80ff80"; }
                newtd.style.border="4px inset "+col;
                newtd.style.color=col;
                newtd.style.backgroundColor=col2;
                newtd.innerHTML=Math.round(100*thisFarmiData["money"]/sum)+"%";
            }
            cartContent=null;newtable=null;newtr=null;newtd=null;span=null;
        }catch(err){GM_logError("showCart.buildTable","","",err);}
        }
        buildTable();
    }catch(err){GM_logError("showFoodworldFarmiCart","","",err);}
    });
    unsafeOverwriteFunction("createFoodworldFarmis",function(){
        try{
            unsafeWindow._createFoodworldFarmis();
        }catch(err){GM_logError("_createFoodworldFarmis","","",err);}
        try{
            var div,input;
            if(div=$("food_farmis")){
                div=createElement("div",{"style":"position:absolute;bottom:-20px;"},div);
                input=createElement("input",{"type":"checkbox","checked":valFoodworldFarmiPlacing,"class":"link"},div);
                input.addEventListener("click",function(){
                    valFoodworldFarmiPlacing=this.checked;
                    GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFoodworldFarmiPlacing",valFoodworldFarmiPlacing);
                },false);
                div.addEventListener("mouseover",function(event){
                    toolTip.show(event,getText("settings_valFoodworldFarmiPlacing")[1]);
                },false);
            }
        }catch(err){GM_logError("createFoodworldFarmis","","",err);}
    });
    unsafeOverwriteFunction("dragFoodworldFarmiTouch", function(id) {
        try {
            unsafeWindow._dragFoodworldFarmiTouch(id);
        } catch (err) { GM_logError("_dragFoodworldFarmiTouch", "", "", err); }
        try {
            if (valFoodworldFarmiPlacing) {
                loop: for (var b = 0; b <= 4; b++) {
                    if (unsafeWindow.foodworldtables[b] && (!unsafeWindow.foodworldtables[b]["block"]) && (!unsafeWindow.foodworldtables[b]["locked"])) {
                        for (var a = 1; a <= 2; a++) {
                            if (!(unsafeWindow.foodworldtables[b]["chairs"] && unsafeWindow.foodworldtables[b]["chairs"][a] && unsafeWindow.foodworldtables[b]["chairs"][a]["id"])) {
                                if (div = $("foodworldchair" + b + "_" + a + "_touch")) {
                                    click(div);
                                    div = null;
                                    break loop;
                                }
                            }
                        }
                    }
                }
            }
        } catch (err) { GM_logError("dragFoodworldFarmiTouch", "", "", err); }
    });
    if(newdiv=$("food_cart")){
        createElement("div",{"id":"food_cart_cost","style":"position:absolute;bottom:130px;left:135px;font-size:12px;color:#463824;"},newdiv);
        createElement("div",{"id":"food_cart_perc","style":"position:absolute;bottom:105px;left:375px;width:70px;padding:2px;text-align:right;font-size:20px;font-weight:bold;"},newdiv);
    }
    // Foodworld-Zones
    function doFoodworld() {
        try {
            gameLocation.set("foodworld");
            var nowServer = unsafeWindow.Zeit.Server;
            var zoneNrF, zoneNrS, tempZoneProductionData, tempZoneProductionDataSlot, currBlock;
            // Buildings
            var err_trace = "Buildings";
            if (unsafeWindow.foodworldbuildings) {
                var res, iProd, iTime, iAmount, iPoints, iSlotCount;
                for (var building in unsafeWindow.foodworldbuildings) {
                    if (!unsafeWindow.foodworldbuildings.hasOwnProperty(building)) { continue; }
                    res = unsafeWindow.foodworldbuildings[building];
                    zoneNrF = "foodworld-" + building;
                    currBlock = (unsafeWindow.foodworldbuildings[building]["cost"] ? "b" : ""); // foodworld building locked due to missing payment
                    currBlock += (unsafeWindow.foodworldbuildings[building]["block"] ? "l" : ""); // foodworld building locked due to level requirement
                    zones.setBlock(zoneNrF, currBlock);
                    if (iSlotCount = zones.isMultiSlot(zoneNrF)) {
                        if (!currBlock) {
                            for (var slot = 1; slot <= iSlotCount; slot++) {
                                zoneNrS = zoneNrF + "." + slot;
                                zones.setBlock(zoneNrS, res["slots"] && res["slots"][slot] && res["slots"][slot]["block"] ? "b" : "");
                            }
                        }
                    } else {
                        iSlotCount = 0;
                    }
                    if (!currBlock) {
                        zones.setBonus(zoneNrF, 0);
                        // TODO: Implement Bonus
                        // unsafeWindow.forestry_user_buildings[building]["boni"]?unsafeWindow.forestry_user_buildings[building]["boni"]:0;

                        res = (unsafeWindow.foodworldbuildings[building] && unsafeWindow.foodworldbuildings[building]["slots"]) ? unsafeWindow.foodworldbuildings[building]["slots"] : {};
                        tempZoneProductionData = [[{}, {}], 0, 0, true];
                        for (var slot = 1; slot <= (iSlotCount == 0 ? 1 : iSlotCount); slot++) {
                            GM_logInfo("doFoodworld", "", "zoneNrF=" + zoneNrF + " slot=" + slot + " res[" + slot + "]=" + implode(res[slot], "res"), "Loop", 0);
                            if (iSlotCount > 0) {
                                zoneNrS = zoneNrF + "." + slot;
                            } else {
                                zoneNrS = zoneNrF;
                            }
                            if (!zones.getBlock(zoneNrS)) {
                                tempZoneProductionDataSlot = [[{}, {}], 0, 0, true];
                                if (res[slot]) {
                                    iProd = (res[slot]["pid"] ? parseInt(res[slot]["pid"], 10) : null);
                                    if (isNaN(iProd)) { iProd = null; }
                                    if ((iProd != null) && (res[slot]["ready"])) { // production ready
                                        iTime = nowServer;
                                    } else if ((iProd != null) && (res[slot]["remain"])) { // production busy
                                        iTime = nowServer + res[slot]["remain"];
                                    } else {
                                        iTime = NEVER;
                                        tempZoneProductionData[1]++;
                                        tempZoneProductionDataSlot[1]++;
                                    }
                                    // iAmount=(res[slot]["amount"]?res[slot]["amount"]:null);
                                    tempZoneProductionData[2]++;
                                    tempZoneProductionDataSlot[2]++;
                                    if (iProd != null) {
                                        iAmount = prodYield[0][iProd];
                                        iPoints = iAmount * prodPoints[0][iProd];
                                        if (!tempZoneProductionData[0][0][iProd]) { tempZoneProductionData[0][0][iProd] = []; }
                                        tempZoneProductionData[0][0][iProd].push([iAmount, iPoints, iTime, NEVER]);
                                        if (!tempZoneProductionDataSlot[0][0][iProd]) { tempZoneProductionDataSlot[0][0][iProd] = []; }
                                        tempZoneProductionDataSlot[0][0][iProd].push([iAmount, iPoints, iTime, NEVER]);
                                    }
                                }
                                if (iSlotCount > 0) {
                                    zones.setProduction(zoneNrS, tempZoneProductionDataSlot.clone());
                                }
                            }
                        }
                        zones.setProduction(zoneNrF, tempZoneProductionData.clone());
                        if (zoneNrF == "foodworld-4") {
                            createZoneTimer("zoneTimer_" + zoneNrF, zoneNrF, "zonetimer", "position:absolute;top:30px;left:45px;", $("food_pos" + building));
                        } else {
                            createZoneTimer("zoneTimer_" + zoneNrF, zoneNrF, "zonetimer", "position:absolute;top:-20px;left:0px;", $("food_pos" + building));
                        }
                    }
                }
                building = null;
                res = null;
                iProd = null;
                iTime = null;
                maxCapacity = null;
            }
            calcTotalZones();

            // Quest
            handleQuestDataFoodworld();
            if ((newdiv = $("foodworld_questblock")) && (!newdiv.classList.contains("mouseOver"))) {
                newdiv.classList.add("mouseOver");
                newdiv.addEventListener("mouseover", function(event) {
                    toolTip.show(event, questLineMouseOver("foodworld", "1"));
                }, false);
            }
            zoneNrF = null;
            tempZoneProductionData = null;
            tempZoneProductionDataSlot = null;
            err_trace = "saving";
            publishProductData();
        } catch (err) { GM_logError("doFoodworld", "", "err_trace=" + err_trace, err); }
    }


    function doFoodworldFarmisBubble() {
        try {
            var foodWorldFarmi = unsafeWindow.foodworldfarmis;
            totalFarmis[2] = {}; // Remembers foodworld farmi requests

            for (var i = 0; i < foodWorldFarmi.length; i++) {
                if (foodWorldFarmi[i].status == 0) {
                    var cost = 0;
                    for (var c in foodWorldFarmi[i].products) {
                        if (!foodWorldFarmi[i].products.hasOwnProperty(c)) { continue; }
                        cost += gut[c] * foodWorldFarmi[i].products[c]; // cost = price per unit * amount

                        // Add this farmi's requested products to totalFarmi[2]
                        if (!totalFarmis[2][c]) { totalFarmis[2][c] = 0; }
                        totalFarmis[2][c] += foodWorldFarmi[i].products[c];
                    }
                    var money = parseFloat(foodWorldFarmi[i].price, 10);
                    money = money + (money * (unsafeWindow.foodworld_bonus.bonus ? unsafeWindow.foodworld_bonus.bonus : 1) / 100);
                    var rate = 100 * money / cost;
                    if (rate < valFarmiLimits[0]) { // under 90%
                        str = css_styles["farmi_price_low"][1];
                    } else if (rate < valFarmiLimits[1]) { // between 90% and 100%
                        str = css_styles["farmi_price_between"][1];
                    } else { // above 100%
                        str = css_styles["farmi_price_above"][1];
                    }
                    if ($("foodworldfarmi" + i)) {
                        $("foodworldfarmi" + i).setAttribute("rate", rate);
                        createElement("div", { "id": "foodworldfarmiMiniInfo" + i, "class": "foodworldfarmiMiniInfo" }, $("foodworldfarmi" + i));
                        $("foodworldfarmiMiniInfo" + i).setAttribute("style", str);
                    }
                }
            }

            // Persist total farmis
            GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_totalFarmis", implode(totalFarmis, "doFoodworldFarmisBubble/totalFarmis"));

        } catch (err) { GM_logError("doFoodworldFarmisBubble", "", "err_trace=" + err_trace, err); }
    }
    unsafeOverwriteFunction("foodworldActionResponse", function(request, action, id, table, chair) {
        try {
            unsafeWindow._foodworldActionResponse(request, action, id, table, chair);
        } catch (err) { GM_logError("_foodworldActionResponse", "", "", err); }
        try {
            var result = checkRequest(request);
            if ((result != 0) && (result[0] != 0)) {
                doFoodworld();
                doFoodworldFarmisBubble();
                switch (action) {
                    case "crop":
                        raiseEvent("gameFoodworldCropped");
                        break;
                    // case "dropped":
                    //     calcProdMinRack(); // Does this need to be done?
                    //     raiseEvent("gameFoodworldFarmiDropped");
                    //     break;
                    case "foodworld_init":
                        raiseEvent("gameFoodworldOpened");
                        break;
                    case "kick":
                        calcProdMinRack();
                        raiseEvent("gameFoodworldFarmiKick");
                        break;
                    case "open":
                        raiseEvent("gameFoodworldOpened" + id);
                        break;
                    case "production":
                        raiseEvent("gameFoodworldStarted");
                        break;
                }
            }
            result = null;
        } catch (err) { GM_logError("foodworldActionResponse", "", "", err); }
    });
    unsafeOverwriteFunction("openMemoryResponse", function(s) {
        try {
            unsafeWindow._openMemoryResponse(s);
        } catch (err) { GM_logError("_openMemoryResponse", "", "", err); }
        try {
            if (s[4]) {
                for (var i in s[4]) {
                    createElement("span",{"style":"font-size: large;background-color:#fff;position:absolute;"},$("memorycard" + i),"Wert:"+s[4][i] );
                }
            }
        } catch (err) { GM_logError("_openMemoryResponse", "", "", err); }
    }, true);
    unsafeOverwriteFunction("entryCityXmasEvent",function(c){
        /*
         * Contribution/Author of function "entryCityXmasEvent": Moe
         */
        try{
            if(!c) c = 'v';
            unsafeWindow._entryCityXmasEvent(c);
        }catch(err){GM_logError("_entryCityXmasEvent","","",err);}
        try{
            var children = $("xmasbox_entry_products").getElementsByClassName("xmasbox_entry_item");
            for (var c in children) {
                if (!children.hasOwnProperty(c)) { continue; }
                var pId = children[c].getElementsByClassName("xmasbox_entry_item_img")[0].className.replace("xmasbox_entry_item_img tt", "");
                var points = children[c].getElementsByClassName("xmasbox_entry_item_points")[0].innerHTML;
                var ratio = (gut[pId]/points).toFixed(2);
                createElement("div", {
                        "style":"position: absolute; bottom: -15px; left: 8px;border: 2px solid rgb(255, 114, 0); background-color: white;width: 70px;text-align: center;"
                },children[c], moneyFormat(ratio) + "/P.");
            }
        }catch(err){GM_logError("entryCityXmasEvent","","",err);}
    });

    unsafeOverwriteFunction("contractsDialog", function(b, productId){
        /*
         * Is called, when User clicks a product in "New Contract" dialog to add that product to the cart.
         * Contribution/Author of function "contractsDialog": Moe
         *
         * b = Is either 'select' or nothing happens in original "contractsDialog"
         * productId = Id of the clicked product
         */
        try {
            unsafeWindow._contractsDialog(b, productId);
        } catch(err) { GM_logError("contractsDialog","","",err); }
        try {
            // Add a Sum-of-Contract dic to dialog
            var parent = $("globalbox_footer"); // $("globalbox_content"); // globalbox_footer
            var sumDiv = createElement("div", {"id": "contractSum", "style": "font-style: italic;"}, parent, ""); // Will be removed from DOM in 'unsafeOverwriteFunction("contractsProductInCart",...'
            var fktCalcSum = function () {
              var amount = parseFloat($("contracts_select_pid_input").value);
              var price = parseFloat($("contracts_select_price_input").value);
              sumDiv.innerHTML = "&Sigma; " + moneyFormat(amount*price);
            };

            // Read the saved value from DB (if it exists)
            var value = GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_contractsProductInCart_"+productId,{});

            // Draw radio buttons saved-value/market-value
            parent = $("contracts_button_add_cart").parentNode;

            var div = createElement("div", {
                "style":"margin-bottom: 5px; text-align: left; padding-left: 50px;"
            }, false, false);
            parent.insertBefore(div, $("contracts_button_add_cart"));

            var radioPriceSaved = createElement("input", {
                "id": "contractPriceSaved",
                "type":"radio",
                "name": "contractPrice"
            }, div, false);
            var labelPriceSavedText;
            if (productId == value.id) {
                labelPriceSavedText = getText("lastPrice") + " (" + moneyFormat(value.price) + ")";
            } else {
                labelPriceSavedText = getText("lastPrice");
            }
            // Label must be created before it's (possibly) disabled in the next if-else-clause
            var labelPriceSaved = createElement("label", {
                "for": "contractPriceSaved"
            }, div, labelPriceSavedText);

            // Check, if there is a saved value or we disable the radio button
            if (productId == value.id) {
                radioPriceSaved.addEventListener("click", function () {
                    $("contracts_select_price_input").value = value.price;
                    fktCalcSum();
                }, false);
            } else {
                // No saved value
                radioPriceSaved.disabled = true;
                labelPriceSaved.style = "color: gray; font-style: italic;";
            }

            createElement("br", {}, div, false);

            var radioPriceMarket = createElement("input", {
                "id": "contractPriceMarket",
                "type":"radio",
                "name": "contractPrice"
            }, div, false);
            var labelPriceMarketText;
            var marketPrice = preisBeob[productId][2] ? preisBeob[productId][2] : 0;
            if (!marketPrice==0) {
                labelPriceMarketText = getText("marketPrice") + " (" + moneyFormat(marketPrice) + ")";
            } else {
                labelPriceMarketText = getText("marketPrice");
            }
            var labelPriceMarket = createElement("label", {
                "for": "contractPriceMarket"
            }, div, labelPriceMarketText);

            // Check, if there is a observed market price or we disable the radio button
            if (!marketPrice==0) {
                radioPriceMarket.addEventListener("click", function () {
                    $("contracts_select_price_input").value = marketPrice;
                    fktCalcSum();
                }, false);
            } else {
                // No observed marekt price
                radioPriceMarket.disabled = true;
                labelPriceMarket.style = "color: gray; font-style: italic;";
            }

            createElement("br", {}, div, false);

            if (NPC[0][productId]) {
                NPC_isNaN = false;
                if (!isNaN(NPC[0][productId])) {
                    var valNPC=NPC[0][productId];
                } else if (NPC[0][productId].match(/^f/)){
                    var valNPC=parseFloat(NPC[0][productId].replace("f",""),10);
                    var NPC_isNaN=true;
                } else if (NPC[0][productId].match(/^c/)) {
                    var valNPC=0;
                    var NPC_isNaN=true;
                } else {
                    var valNPC=0;
                }
            } else {
                var valNPC=0;
            }

            var radioPriceNPC = createElement("input", {
                "id": "contractPriceNPC",
                "type":"radio",
                "name": "contractPrice"
            }, div, false);
            var labelPriceNPCText; // Are decorated with *, if NPC actually doesn't sell that item
            if (!valNPC==0) {
                labelPriceNPCText = (NPC_isNaN?"*":"") + getText("NPCprice") + (NPC_isNaN?"*":"") + " (" + moneyFormat(valNPC) + ")";
            } else {
                labelPriceNPCText = (NPC_isNaN?"*":"") + getText("NPCprice") + (NPC_isNaN?"*":"");
            }
            var labelPriceNPC = createElement("label", {
                "for": "contractPriceNPC"
            }, div, labelPriceNPCText);
            NPC_isNaN = null;

            // Check, if there is a NPC value or we disable the radio button
            if (!valNPC==0) {
                radioPriceNPC.addEventListener("click", function () {
                    $("contracts_select_price_input").value = valNPC;
                    fktCalcSum();
                }, false);
            } else {
                // No NPC value
                radioPriceNPC.disabled = true;
                labelPriceNPC.style = "color: gray; font-style: italic;";
            }

            // Set a first selection
            if (!radioPriceSaved.disabled) {
                radioPriceSaved.checked = true;
                $("contracts_select_price_input").value = value.price;
            } else if (!radioPriceMarket.disabled) {
                radioPriceMarket.checked = true;
                $("contracts_select_price_input").value = marketPrice;
            } else if (!radioPriceNPC.disabled) {
                radioPriceNPC.checked = true;
                $("contracts_select_price_input").value = valNPC;
            }

            // Calculate sum and Send-on-Enter
            $("contracts_select_pid_input").addEventListener("keyup", function (event) {
              if (event.key == "Enter") {
                click($("contracts_button_add_cart"));
              } else {
                fktCalcSum();
              }
            }, false);

            // Uncheck radio buttons, when User edits price manually, calculate sum, and Send-on-Enter
            $("contracts_select_price_input").addEventListener("keyup", function (event) {
                if (event.key == "Enter") {
                  click($("contracts_button_add_cart"));
                } else {
                  radioPriceSaved.checked = false;
                  radioPriceMarket.checked = false;
                  radioPriceNPC.checked = false;
                  fktCalcSum();
                }
            }, false);

        } catch(err) { GM_logError("contractsDialog","","",err); }
    });

    unsafeOverwriteFunction("contractsProductInCart", function(productId){
        /*
         * Is called, when User clicks "Add Product" in dialog.
         * Contribution/Author: Moe
         *
         * productId = Id of the clicked product
         */
        try {
            var amount = $("contracts_select_pid_input").value;
            var price = $("contracts_select_price_input").value;
            if (amount && price) {
                var value = {id: productId, amount: amount, price: price};
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_contractsProductInCart_"+productId,value);
            }
            removeElement($("contractSum"));
            unsafeWindow._contractsProductInCart(productId);
        } catch(err) { GM_logError("contractsProductInCart","","",err); }
    });

    unsafeOverwriteFunction("contractsNew", function(){
        /*
         * Contribution/Author: Moe
         */
        try{
            unsafeWindow._contractsNew();
        } catch(err) { GM_logError("_contractsNew","","",err); }
        try{
            // We exchange the cart-div with a form-tag, so browser auto-fill hooks in
            var cartDiv = $("contracts_new_cart");
            var cartDivNextSibling = cartDiv.nextElementSibling;
            cartDiv.parentNode.removeChild(cartDiv);

            var cartForm = createElement("form", {
                "id": "contracts_new_cart",
                "autocomplete": "on"
            }, false, false);
            cartForm.addEventListener("submit", function(event){
                event.preventDefault();
            });

            var nodes = cartDiv.childNodes;
            var length = nodes.length;
            for(i = 0; i < length; i++) {
                cartForm.appendChild(cartDiv.removeChild(nodes[0]));
            }
            cartDivNextSibling.parentNode.insertBefore(cartForm, cartDivNextSibling);
        } catch(err) {GM_logError("contractsNew","","",err); }
    });

    unsafeOverwriteFunction("openFoodworldBuildingSelect",function(position,slot){
        try{
            unsafeWindow._openFoodworldBuildingSelect(position,slot);
        }catch(err){GM_logError("_openFoodworldBuildingSelect","","",err);}
        try{
            raiseEvent("gameFoodworldSlotOpened")
        }catch(err){GM_logError("openFoodworldBuildingSelect","","",err);}
    });

    // Addons
    err_trace="Addons";
    // TODO remove
    document.addEventListener("gameBotStarted",function(){
        try{
            valAutoWater["farm"]=unsafeData.botConfigData[0];
            valAutoCrop["farm"]=unsafeData.botConfigData[1];
            valWaterNeeded["farm"]=unsafeData.botConfigData[2];
            for(var z in unsafeData.readyZone){
                if(!unsafeData.readyZone.hasOwnProperty(z)){continue;}
                unsafeData.readyZone[z][2]=true;
            }
        }catch(err){}
    },false);
    document.addEventListener("gameBotStopped",function(){
        window.setTimeout(function(){
        try{
            valAutoWater=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoWater"),"valAutoWater",{"farm":false,"forestry":false});
            valAutoCrop=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoCrop"),"valAutoCrop",{"farm":false,"forestry":false});
            valWaterNeeded=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valWaterNeeded"),"valWaterNeeded",{"farm":true,"forestry":true});
        }catch(err){}
        },0);
    },false);
    unsafeWindow.prodMinRackAddon.add = function(type,pid,reason,amount){
    try{
        type=parseInt(type,10);
        pid=parseInt(pid,10);
        amount=parseInt(amount,10);
        if(isNaN(type)||isNaN(pid)||isNaN(amount)){
            throw("Wrong arguments");
        }
        unsafeWindow.prodMinRackAddon.newdata.push([type,pid,reason,amount]);
        raiseEvent("gameChangedProdMinRackAddon");
    }catch(err){ GM_logError("prodMinRackAddon.add","type="+type+" pid="+pid+" reason="+reason+" amount="+amount,"",err); }
    };
    unsafeWindow.prodMinRackAddon.remove = function(type,pid,reason){
    try{
        unsafeWindow.prodMinRackAddon.newdata.push([type,pid,reason,null]);
        raiseEvent("gameChangedProdMinRackAddon");
    }catch(err){ GM_logError("prodMinRackAddon.remove","","",err); }
    };
    unsafeWindow.prodMinRackAddon.removeAll = function(type,reason){
    try{
        for(var p in prodMinRackAddon[type]){
            if(!prodMinRackAddon[type].hasOwnProperty(p)){ continue; }
            if(prodMinRackAddon[type][p]&&prodMinRackAddon[type][p][reason]){
                unsafeWindow.prodMinRackAddon.newdata.push([type,parseInt(p,10),reason,null]);
            }
        }
        raiseEvent("gameChangedProdMinRackAddon");
    }catch(err){ GM_logError("prodMinRackAddon.removeAll","","",err); }
    };
    document.addEventListener("gameChangedProdMinRackAddon",function(){
    try{
        // test if calculation is running
        if(unsafeWindow.prodMinRackAddon.busy){ return false; }
        // set flag
        unsafeWindow.prodMinRackAddon.busy=true;
        // get data inside
        var helper=unsafeWindow.prodMinRackAddon.newdata;
        unsafeWindow.prodMinRackAddon.newdata=new Array();
        // calculate
        var type,prod,reason,amount;
        for(var k=0;k<helper.length;k++){
            type  =helper[k][0];
            prod=helper[k][1];
            reason=helper[k][2];
            amount=helper[k][3];
            if(prodMinRackAddon[type][prod]){
                if(prodMinRackAddon[type][prod][reason]){
                    if(amount==null){ // delete existing entry
                        delete prodMinRackAddon[type][prod][reason];
                    }else if(prodMinRackAddon[type][prod][reason]!=amount){ // update existing entry
                        prodMinRackAddon[type][prod][reason]=amount;
                    } // else the entry is correct
                }else if(amount!=null){
                    prodMinRackAddon[type][prod][reason]=amount;
                }
            }else if(amount!=null){ // create new entry
                prodMinRackAddon[type][prod]=new Object();
                prodMinRackAddon[type][prod][reason]=amount;
            } // else a non-existing entry should be deleted
        }
        calcProdMinRack();
        // remove flag
        unsafeWindow.prodMinRackAddon.busy=false;
        // restart if new data meanwhile arrived
        if(unsafeWindow.prodMinRackAddon.newdata.length>0){
            arguments.callee();
        }
    }catch(err){ GM_logError("gameChangedProdMinRackAddon.listener","","",err); }
    },false);

    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmname",FARMNAME);
    var documentTitle=" - "+FARMNAME+" - s"+SERVER+" - "+document.title;
    var lastGiess=null;
    var lastErnte=null;

    err_trace="zones";
    zones.init();

    window.setTimeout(function() {
        try {
            for(var j=0;j<ALL_ZONES["farm"].length;j++){
                help=zones.getBlock(ALL_ZONES["farm"][j]);
                if (unsafeWindow.farms_data.farms[DATA_zones[ALL_ZONES["farm"][j]]] && unsafeWindow.farms_data.farms[DATA_zones[ALL_ZONES["farm"][j]]["farmNr"]+1]) {
                    continue;
                }
                if((!help.match(/b/))&&(unsafeWindow.farms_data.farms[DATA_zones[ALL_ZONES["farm"][j]]["farmNr"]+1][DATA_zones[ALL_ZONES["farm"][j]]["zoneNr"]].bulldoze)){
                //if((!help.match(/b/))&&(unsafeWindow.farmamount<Math.ceil(ALL_ZONES["farm"][j]/6))){
                    GM_logInfo("do_main","","farmamount="+unsafeWindow.farmamount+" zoneNr="+ALL_ZONES["farm"][j],"Blocking zone because farmamount is too low");
                    zones.setBlock(ALL_ZONES["farm"][j],help+"b");
                }
            }
        }catch(err){ GM_logError("Error ","","",err + "  " + j); }
    }, 1000);

    zones.setBlock("windmill",USERLEVEL>=8?"":"l");
    calcAllSlots();
    calcTotalZones();
    calcTotalAnimals();

    zoneAddToGlobalTime=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobalTimeAdd"),"do_main/zoneAddToGlobalTime",{}); //TODO name change

    totalFarmis=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_totalFarmis"),"do_main/totalFarmis",[{},{},{},{}]); // Value of products the farmis want
    totalPowerups=new Object(); // Value of powerups creating products
    totalQuest=new Object(); // Value of products the quests need: totalQuest[questType][prodType][prodId]=amount
    totalRecursive=new Array(new Object(), new Object());

    calcTotalPowerups();
    // Value of active powerup for a field
    // currentPowerup[plantNr]=[time,+value,+points]
    var currentPowerup=new Object;
    function calcCurrentPowerup(){
    try{
        currentPowerup=new Object;
        if(unsafeWindow.poweruprack){
            for(var i in unsafeWindow.poweruprack){
                if(!unsafeWindow.poweruprack.hasOwnProperty(i)){continue;}
                var item=unsafeWindow.poweruprack[i];
                if((item[5])&&(item["remain"]>0)){
                    if(item[5][1]){
                        currentPowerup[item[5][1][0]]=[item["remain"]+unsafeWindow.Zeit.Server,item[5][1][1],0];
                        var newdiv=$("powerupSymbol"+item["0"]);
                        if(!newdiv){
                            newdiv=createElement("div",{"id":"powerupSymbol"+item["0"],"style":"position:relative;width:60px;height:87px;margin-bottom:5px;","end":item["remain"]+unsafeWindow.Zeit.Server},nodes["containerPowerupSymbols"]["node"]);
                            newdiv.addEventListener("mouseover",function(event){
                                var end=parseInt(this.getAttribute("end"),10);
                                var endDay=countDays(now,end);
                                toolTip.show(event,(getText("day"+endDay)?getText("day"+endDay):(new Date(1000*end).toLocaleString()))+"<br>"+getDaytimeStr(end));
                            },false);
                            createElement("img",{"src":GFX+"powerup2.png","border":"0"},newdiv);
                            createElement("div",{"style":"position:absolute;top:3px;left:6px;","class":"kp"+item[5][1][0]},newdiv);
                            createElement("div",{"style":"position:absolute;top:3px;left:22px;font-weight:bold;color:black;"},newdiv,+item[5][1][1]);
                            createElement("div",{"style":"position:absolute;top:64px;right:0;font-weight:bold;","class":"blackbox"},newdiv,getTimeStr(item["remain"]));
                        }
                        newdiv=null;
                    }
                    if(item[5][2]){
                        currentPowerup[item[5][2][0]]=[item["remain"]+unsafeWindow.Zeit.Server,0,item[5][2][1]];
                        var newdiv=$("powerupSymbol"+item["0"]);
                        if(!newdiv){
                            newdiv=createElement("div",{"id":"powerupSymbol"+item["0"],"style":"position:relative;width:60px;height:87px;margin-bottom:5px;","end":item["remain"]+unsafeWindow.Zeit.Server},nodes["containerPowerupSymbols"]["node"]);
                            newdiv.addEventListener("mouseover",function(event){
                                var end=parseInt(this.getAttribute("end"),10);
                                var endDay=countDays(now,end);
                                toolTip.show(event,(getText("day"+endDay)?getText("day"+endDay):(new Date(1000*end).toLocaleString()))+"<br>"+getDaytimeStr(end));
                            },false);
                            createElement("img",{"src":GFX+"powerup3.png","border":"0"},newdiv);
                            createElement("div",{"style":"position:absolute;top:3px;left:6px;","class":"kp"+item[5][2][0]},newdiv);
                            createElement("div",{"style":"position:absolute;top:3px;left:22px;font-weight:bold;color:black;"},newdiv,+item[5][2][1]);
                            createElement("div",{"style":"position:absolute;top:64px;right:0;font-weight:bold;","class":"blackbox"},newdiv,getTimeStr(item["remain"]));
                        }
                        newdiv=null;
                    }
                }
            }
        }
        unsafeData.currentPowerup=currentPowerup.clone();
    }catch(err){ GM_logError("calcCurrentPowerup","","",err); }
    }
    calcCurrentPowerup();

    // powerup-data is updated
    // function isnt available anymore?
    unsafeOverwriteFunction("handlePowerups",function(page){
        try{
            unsafeWindow._handlePowerups(page);
        }catch(err){ GM_logError("_handlePowerups","","",err); }
        try{
            // GM_log("unsafeWindow.poweruprack:\n"+implode(unsafeWindow.poweruprack));
            calcTotalPowerups();
            updateProductDataPowerup();
            window.setTimeout(saveProductData,0);
            raiseEvent("gamePoweruprackUpdated");
        }catch(err){ GM_logError("handlePowerups","","",err); }
    });

    unsafeOverwriteFunction("activatePowerup",function(formula){
        try{
            unsafeWindow._activatePowerup(formula);
        }catch(err){ GM_logError("_activatePowerup","","",err); }
        try{
            document.addEventListener("gamePoweruprackUpdated",function(){
            try{
                calcCurrentPowerup();
                for(var v=0;v<ALL_ZONES["farm"].length;v++){ zones.processProduction(ALL_ZONES["farm"][v]); } //TODO
                calcProdMinRack();
                raiseEvent("gamePowerupActivated");
                this.removeEventListener("gamePoweruprackUpdated",arguments.callee,false);
            }catch(err){ GM_logError("gamePoweruprackUpdated.listener","","",err); }
            },false);
        }catch(err){ GM_logError("activatePowerup","","",err); }
    });

    //Retrieve Settings and default-values
    err_trace="valAutoWater";
    valAutoWater=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoWater"),"valAutoWater",null); // TODO set true when automat handles it
    if(valAutoWater==null){
        valAutoWater={"farm":false,"forestry":false};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoWater",implode(valAutoWater,"valAutoWater"));
    }
    unsafeData.valAutoWater=valAutoWater;
    valWaterNeeded=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valWaterNeeded"),"valWaterNeeded",null);
    if(valWaterNeeded==null){
        valWaterNeeded={"farm":true,"forestry":true};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valWaterNeeded",implode(valWaterNeeded,"valWaterNeeded"));
    }
    unsafeData.valWaterNeeded=valWaterNeeded;
    valAssumeWater=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAssumeWater"),"valAssumeWater",null);
    if(valAssumeWater==null){
        valAssumeWater={"farm":true,"forestry":true};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAssumeWater",implode(valAssumeWater,"valAssumeWater"));
    }
    valAutoCrop=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoCrop"),"valAutoCrop",null);
    if(valAutoCrop==null){
        valAutoCrop={"farm":false,"forestry":false};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valAutoCrop",implode(valAutoCrop,"valAutoCrop"));
    }
    unsafeData.valAutoCrop=valAutoCrop;
    valErnteMsg=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valErnteMsg",true);
    valLimitEmptyFields=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valLimitEmptyFields"),"valLimitEmptyFields",null);
    if(valLimitEmptyFields==null){
        valLimitEmptyFields={"1":3,"fl1":1,"forest":1};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valLimitEmptyFields",implode(valLimitEmptyFields,"valLimitEmptyFields"));
    }
    if(typeof GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit",110)=="number"){ GM_deleteValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit"); }
    valKauflimit=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit"),"do_main/valKauflimit",[[85,"990000"],110]);
    valMessagesSystemMarkRead=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMessagesSystemMarkRead",true);
    valFoodworldFarmiPlacing=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valFoodworldFarmiPlacing",true);
    valGlobaltimeShowCroppedZone=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone"),"valGlobaltimeShowCroppedZone",null);
    if(!valGlobaltimeShowCroppedZone||(typeof valGlobaltimeShowCroppedZone!="object")||(valGlobaltimeShowCroppedZone instanceof Array)){
        valGlobaltimeShowCroppedZone={"farm":true,"farmersmarket":false,"windmill":false,"forestry":false,"foodworld":false};
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGlobaltimeShowCroppedZone",implode(valGlobaltimeShowCroppedZone,"valGlobaltimeShowCroppedZone"));
    }
    unsafeData.readyZone=new Object;
    unsafeData.zoneAddToGlobalTime=zoneAddToGlobalTime.clone();

    // Werbung
    err_trace="Advertisement";
    upjersAds=new Array();
    for(var v in unsafeWindow.welcomeblurb){
        if(!unsafeWindow.welcomeblurb.hasOwnProperty(v)){ continue; }
        if(v!="1"){
            upjersAds.push(unsafeWindow.welcomeblurb[v]);
            delete unsafeWindow.welcomeblurb[v];
        }
    }
    unsafeWindow.gclr();
    newdiv=createElement("img",{"style":"position:absolute;top:0;right:0;height:15px;width:15px;","class":"link","src":GFX+"points.gif"},$("headercontainer"));
    newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("upjersAdvertising")); },false);
    newdiv.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("upjersAds"); },false);
    $("notepad").style.zIndex=111; // Notizen on top
    //unsafeWindow.shredderCommit = function(){return;}; // Schredder weg

    // Dragging
    err_trace="Dragging";
    if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valDrag",false)){
        $("gameArea").style.position="absolute";
        $("gameArea").style.top="5px";
        $("gameArea").style.left="5px";
        makeDraggable($("notepad"));
        makeDraggable($("divGame"),true,false);
        //makeDraggable("gardenmaincontainer");
        //makeDraggable("innermaincontainer");
        $("globaltransp").style.height="0";
        //$("transp").style.height="0";
    }

    // speedlinks
    err_trace="speedlinks";
    if(unsafeWindow.premium!=1){
        unsafeOverwriteFunction("speedLinks",function(){
            try{
                unsafeWindow._speedLinks();
            }catch(err){GM_logError("_speedLinks","","",err);}
            try{  // taken from game-js and modified to run without premium
                var err_trace="init";
                if (!unsafeWindow.premium){
                    unsafeWindow.showDiv("farm_speedlinks");
                    var a = ["farm1", "farm2", "farm3", "farm4", "farm5", "farm6","farm7","farm8", "farm9", "city1", "city2", "guild", "forestry", "foodworld", "megafield"];
                    for (var b = 0; b <= a.length; b++) {
                        if ($("speedlink_" + a[b])) {
                            unsafeWindow.hideDiv($("speedlink_" + a[b]));
                            $("speedlink_" + a[b]).className = "speedlink link speedlink_" + a[b];
                            $("speedlink_" + a[b]).onclick = new Function("")
                        }
                    }
                    err_trace="farm";
                    for (var b = 1; b <= unsafeWindow.farmamount; b++) {
                        if (unsafeWindow.farm == b) {
                            $("speedlink_farm" + b).classList.remove("speedlink_farm" + b);
                            $("speedlink_farm" + b).classList.add("speedlink_farm" + b + "_active")
                        }
                        unsafeWindow.showDiv("speedlink_farm" + b);
                        $("speedlink_farm" + b).onclick = new Function("unsafeWindow.farm=" + b + "; unsafeWindow.farmMove(" + b + "); unsafeWindow.showMain();")
                    }
                    err_trace="city";
                    for (var b = 1; b <= 2; b++) {
                        if (unsafeWindow.city == b) {
                            $("speedlink_city" + b).classList.remove("speedlink_city" + b);
                            $("speedlink_city" + b).classList.add("speedlink_city" + b + "_active")
                        }
                        unsafeWindow.showDiv("speedlink_city" + b);
                            if(b == 1){
                                $("speedlink_city" + b).onclick = new Function("unsafeWindow.close_page();unsafeWindow.showDiv('transp3');unsafeWindow.initCity(1);");

                            }else{
                                $("speedlink_city" + b).onclick = new Function("unsafeWindow.travel2City2();")
                            }
                        if (b == 2 && unsafeWindow.currentuserlevel < 8) {
                            unsafeWindow.hideDiv("speedlink_city" + b)
                        } else {
                            unsafeWindow.showDiv("speedlink_city" + b)
                        }
                    }
                    err_trace="player_guild";
                    if (unsafeWindow.player_guild) {
                        if (unsafeWindow.inguild) {
                            $("speedlink_guild").classList.remove("speedlink_guild");
                            $("speedlink_guild").classList.add("speedlink_guild_active")
                        }
                        unsafeWindow.showDiv("speedlink_guild");
                        $("speedlink_guild").onclick = new Function("unsafeWindow.inguild=1; unsafeWindow.showMain(); unsafeWindow.initGuild();")
                    }
                    err_trace="forestry";
                    if (unsafeWindow.forestry_unlock == 1) {
                        if (unsafeWindow.forestry_quicknavi) {
                            $("speedlink_forestry").classList.remove("speedlink_forestry");
                            $("speedlink_forestry").classList.add("speedlink_forestry_active")
                        }
                        unsafeWindow.showDiv("speedlink_forestry");
                        $("speedlink_forestry").onclick = new Function("unsafeWindow.travel2forestry();")
                    }
                    err_trace="foodworld";
                    if (unsafeWindow.currentuserlevel >= 11) {
                        if (unsafeWindow.foodworld_quicknavi) {
                            $("speedlink_foodworld").classList.remove("speedlink_foodworld");
                            $("speedlink_foodworld").classList.add("speedlink_foodworld_active")
                        }
                        unsafeWindow.showDiv("speedlink_foodworld");
                        $("speedlink_foodworld").onclick = new Function("unsafeWindow.travel2foodworld();")
                    }
                    err_trace="farmersmarket";
                    unsafeWindow.hideDiv("speedlink_farmersmarket");
                    unsafeWindow.hideDiv("speedlink_farmersmarket2");
                    if (unsafeWindow.farmersmarket_data) {
                        unsafeWindow.showDiv("speedlink_farmersmarket");
                        unsafeWindow.showDiv("speedlink_farmersmarket2");
                        $("speedlink_farmersmarket").onclick = new Function("unsafeWindow.travel2farmersmarket(1);")
                        $("speedlink_farmersmarket2").onclick = new Function("unsafeWindow.travel2farmersmarket(2);")
                    }
                    err_trace="megafield";
                    if (unsafeWindow.megafield_data && !unsafeWindow.megafield_data.block) {
                        unsafeWindow.showDiv("speedlink_megafield");
                        $("speedlink_megafield").onclick = new Function("unsafeWindow.showMain(); unsafeWindow.farm=0; unsafeWindow.city=0; unsafeWindow.inguild=0; unsafeWindow.buildMegafield();")
                    }
                }
            }catch(err){GM_logError("speedLinks","","err_trace="+err_trace,err);}
        });
        unsafeWindow.speedLinks();
        unsafeWindow.travel2City2 = function(){
        try{
            switch(gameLocation.get()[0]){
            case "city": unsafeWindow.initCity(2); break;
            case "forestry":
            case "foodworld": unsafeWindow.initCity(2,0,1); break;
            default:{
                document.addEventListener("gameCity1",function(){
                    unsafeWindow.travel2City2();
                    document.removeEventListener("gameCity1",arguments.callee,false);
                },false);
                unsafeWindow.initCity(1);
            }
            }
        }catch(err){GM_logError("travel2City2","","",err);}
        };
        unsafeWindow.travel2forestry = function(){
        try{
            if((gameLocation.check("forestry"))||(gameLocation.check("city",2))){
                unsafeWindow.farm=0;
                unsafeWindow.city=0;
                unsafeWindow.forestry_quicknavi=1;
                unsafeWindow.initForestry();
            }else{
                document.addEventListener("gameCity2",function(){
                    unsafeWindow.travel2forestry();
                    document.removeEventListener("gameCity2",arguments.callee,false);
                },false);
                unsafeWindow.travel2City2();
            }
        }catch(err){GM_logError("travel2forestry","","",err);}
        };
        unsafeWindow.travel2foodworld = function(){
        try{
            if((gameLocation.check("foodworld"))||(gameLocation.check("city",2))){
                unsafeWindow.farm=0;
                unsafeWindow.city=0;
                unsafeWindow.foodworld_quicknavi=1;
                unsafeWindow.foodworldAction('foodworld_init');
            }else{
                //unsafeWindow.mapGo2Location("picknick",1);
                document.addEventListener("gameCity2",function(){
                    unsafeWindow.travel2foodworld();
                    document.removeEventListener("gameCity2",arguments.callee,false);
                },false);
                unsafeWindow.travel2City2();
            }
        }catch(err){GM_logError("travel2foodworld","","",err);}
        };
        unsafeWindow.travel2farmersmarket = function(number){
        try{
            switch(gameLocation.get()[0]){
            case "farm": case "farmersmarket": case "farmersmarket2":{
                if (number == 1)
                    unsafeWindow.farmMove(99);
                else
                    unsafeWindow.farmMove(100);
            break;}
            case "city":{
                document.addEventListener("gameFarmOpened",function(){
                    unsafeWindow.travel2farmersmarket(number);
                    document.removeEventListener("gameFarmOpened",arguments.callee,false);
                },false);
                //unsafeWindow.showTravel2Farm(2); Beta
                unsafeWindow.farmMove(2);
            break;}
            default:{
                document.addEventListener("gameCity2",function(){
                    unsafeWindow.travel2farmersmarket(number);
                    document.removeEventListener("gameCity2",arguments.callee,false);
                },false);
                unsafeWindow.initCity(2,0,1);;
            }
            }
        }catch(err){GM_logError("travel2farmersmarket","","",err);}
        };
    }
    // andere ServerAccounts
    err_trace="Other accounts on server";
    var farmNamen=explode(GM_getValue(COUNTRY+"_"+SERVER+"_farmNamen"),"do_main/farmNamen",{});
    farmNamen[USERNAME]=FARMNAME;
    if(farmNamen[USERNAME].toLowerCase()!=USERNAME){
        newdiv=createElement("div",{"class":"userinfositem link","style":"font-weight: bold;"});
        newdiv.innerHTML="("+USERNAME+")";
        newdiv1=$("userinfoscontainer");
        newdiv1.insertBefore(newdiv,newdiv1.children[1]);
    }
    GM_setValue(COUNTRY+"_"+SERVER+"_farmNamen",implode(farmNamen,"farmNamen"));

    var otherAccs=new Array();
    function calcOtherAccs(){
    try{
        otherAccs=new Array();
        var help=explode(GM_getValue("logindata"),"do_main/logindata",[]);
        var help2;
        for(var v=0;v<help.length;v++){
            if((help[v][4]) && (help[v][0]==COUNTRY) && (help[v][1]==SERVER)){
                help2=[v,help[v][2],NEVER,NEVER]; // Nummer, Username, Endzeit(alles), Endzeit(Megafield)
                if(help2[1].toLowerCase()==USERNAME){ // this account
                    help2[0]=-1;
                }else{
                    try{
                        help2[2]=GM_getValue(help[v][0]+"_"+help[v][1]+"_"+help[v][2].toLowerCase()+"_totalEndtime");
                        help2[3]=GM_getValue(help[v][0]+"_"+help[v][1]+"_"+help[v][2].toLowerCase()+"_megafieldEndtime");
                    }catch(err){}
                }
                otherAccs.push(help2);
            }
            if(!farmNamen[help[v][2]]){ farmNamen[help[v][2]]=help[v][2]; }
        }
    }catch(err){GM_logError("calcOtherAccs","","",err);}
    }
    calcOtherAccs();
    function testOtherAccReady(){
    try{
        var found=null;
        var isMegafield = false;
        var megafieldReady = NEVER; // Timestamp, when the next megafield is ready. Only used, when none is ready right now
        for(var v = 0; v < otherAccs.length; v++){
            if(otherAccs[v][0]>-1){ // Falls nicht aktueller Account
                if (otherAccs[v][3]+unsafeWindow.Zeit.Verschiebung<now) { // Ist Megafield auf anderem Account fertig?
                    found=v;
                    isMegafield = true;
                    break;
                } else {
                    megafieldReady = Math.min(megafieldReady, otherAccs[v][3]+unsafeWindow.Zeit.Verschiebung);
                }
            }
        }
        if (found==null) { // Nur suchen, falls kein Megafield irgendwo fertig ist
            for(var v = 0; v < otherAccs.length; v++){
                if(otherAccs[v][0]>-1){ // Falls nicht aktueller Account
                    if (otherAccs[v][2]+unsafeWindow.Zeit.Verschiebung<now) { // Ist irgendwas auf anderem Account fertig?
                        found=v;
                        break;
                    }
                }
            }
        }
        if(found!=null){
            var cell=$("bubble_adtext"); // Text in Bubble neben dem Schweinchen
            if(!cell){ cell=$("sprcontent"); } // Ggf. kompletter Inhalt des Bubbles
            cell.innerHTML="";
            cell=createElement("a",{"id":"linkOtherAccReady","class":"link","dologin":otherAccs[found][0],"href":"#","style":"font-weight:bold;","ismegafield":isMegafield},createElement("div",{"style":"height:50px;"},cell),farmNamen[otherAccs[found][1]]+" "+getText("finished").toLowerCase()+"!");
            if (!isMegafield) {
                var period = (megafieldReady+unsafeWindow.Zeit.Verschiebung-now)*1000;
                window.setTimeout(function() {
                    var div=$("linkOtherAccReady");
                    div.parentNode.removeChild(div);
                    testOtherAccReady();
                }, period);
            }

            cell.addEventListener("click",function(){
            try{
                var dologin=parseInt(this.getAttribute("dologin"),10); // Define function to retrieve account (number) to login
                window.setTimeout(function(dologin){
                try{
                    var help=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"testOtherAccReady/pagedataLogin",{});
                    if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                        help["dologin"]=new Object();
                    }
                    help["dologin"][dologin]=true;
                    GM_setValue(COUNTRY+"_pagedataLogin",implode(help,"linkOtherAccReady/help"));
                    if($("logoutbutton")){
                        click($("logoutbutton"));
                    } else if(GAMEPAGES[COUNTRY]){
                        location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
                    }
                }catch(err){ GM_logError("linkOtherAccReady.click","","","(inner) "+err); }
                },0,dologin);
            }catch(err){ GM_logError("linkOtherAccReady.click","","",err); }
            },false);
            cell=null;
            raiseEvent("gameOtherAccReady");
        }else{
            window.setTimeout(testOtherAccReady,5000);
        }
    }catch(err){GM_logError("testOtherAccReady","","",err);}
    }
    if (otherAccs.length>1){
        newdiv=createElement("div",{"id":"divOtherAccountsTimes","class":"blackbox","style":"position:absolute;top:5px;right:150px;border:2px solid black;padding:2px;z-index:300;display:none;"},$("headercontainer"));
        newdiv.addEventListener("mouseout",function(){this.style.display="none";},false);
        newdiv.addEventListener("mouseover",function(){this.style.display="";},false);
        newdiv=createElement("div",{"style":"position:absolute;top:4px;right:220px;font-size:11px;color:#f7bb87;","class":"link"},$("headercontainer"));
        createElement("div",{"style":"display:inline-block;margin-bottom:2px;margin-right:2px;text-decoration:underline;vertical-align:top;font-size:11px;"},newdiv,getText("login"));
        newdiv1=createElement("div",{"style":"display:inline-block;"},newdiv);
        createElement("img",{"border":"0","src":GFX+"menu/logout.gif"},newdiv1);
        newdiv.addEventListener("mouseout",function(){$("divOtherAccountsTimes").style.display="none";},false);
        function fillDivOtherAccountsTimes(){
            divOtherAccountsTimes=$("divOtherAccountsTimes");
            if(divOtherAccountsTimes.style.display=="none"){
                divOtherAccountsTimes.innerHTML="";
            }else{
                var newtable=createElement("table",{"cellspacing":"0"},newdiv);
                var newtr,newtd;
                for(var v=0;v<otherAccs.length;v++){
                    if(otherAccs[v][0]>-1){
                        newtr=createElement("tr",{"class":"link hoverBgCc9","dologin":otherAccs[v][0]},newtable);
                        newtr.addEventListener("click",function(){
                            var dologin=parseInt(this.getAttribute("dologin"),10);
                            window.setTimeout(function(dologin){
                                var help=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"fillDivOtherAccountsTimes/pagedataLogin",{});
                                if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                                    help["dologin"]=new Object();
                                }
                                help["dologin"][dologin]=true;
                                GM_setValue(COUNTRY+"_pagedataLogin",implode(help,"fillDivOtherAccountsTimes/help"));
                                if($("logoutbutton")){
                                    click($("logoutbutton"));
                                } else if(GAMEPAGES[COUNTRY]){
                                    location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
                                }
                            },0,dologin);
                        },false);
                    }else{
                        newtr=createElement("tr",{"class":"fontWeightBold"},newtable);
                        otherAccs[v][2]=totalEndtime;
                    }
                    createElement("td",{},newtr,farmNamen[otherAccs[v][1]]);
                    newtd=createElement("td",{"style":"padding-left:5px;"},newtr);
                    var help=unsafeWindow.Zeit.Verschiebung+otherAccs[v][2];
                    if (help>now){ newtd.innerHTML=getTimeStr(help-now); }
                    else{ newtd.innerHTML=getText("finished").toLowerCase()+"!"; }
                }
                divOtherAccountsTimes.innerHTML="";
                divOtherAccountsTimes.appendChild(newtable);
                newtable=null;newtr=null;newtd=null;
                window.setTimeout(fillDivOtherAccountsTimes,1000);
            }
            divOtherAccountsTimes=null;
        }
        newdiv.addEventListener("mouseover",function(){
            $("divOtherAccountsTimes").style.display="";
            fillDivOtherAccountsTimes();
        },false);
        help=NEVER;
        for(var v=otherAccs.length-1;v>=0;v--){
            if(otherAccs[v][0]>-1){
                help=Math.min(help,otherAccs[v][2]);
            }
        }
        if(help<NEVER){
            window.setTimeout(testOtherAccReady,Math.max(0,help+unsafeWindow.Zeit.Verschiebung-now));
        }
    }

    // SessionEnd
    err_trace="SessionEnd";
    //window.setTimeout('top.location.href="main.php?page=logout";','4457000');  in the gamepage
    function timerSessionEnd(sec){
    try{
        if(sec<1){
            var help=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"timerSessionEnd/pagedataLogin",{});
            if(!(help["doserver"]&&(typeof help["doserver"]=="object"))){
                help["doserver"]=new Object();
            }
            help["doserver"][SERVER]=true;
            GM_setValue(COUNTRY+"_pagedataLogin",implode(help,"timerSessionEnd/help"));
            if($("logoutbutton")){
                click($("logoutbutton"));
            } else if(GAMEPAGES[COUNTRY]){
                location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
            }
        }else{
            window.setTimeout(function(){ timerSessionEnd(sec-1); },1000);
            $("divSessionEndTime").innerHTML=getTimeStr(sec);
        }
    }catch(err){ GM_logError("timerSessionEnd","","",err); }
    }
    var valSessionEndtime=null;
    if ((unsafeWindow.logout_remain)&&(unsafeWindow.disable_autologout==0)){
        valSessionEndtime=Math.floor(now+unsafeWindow.logout_remain);
        window.setTimeout(function(){
            if (unsafeWindow.disable_autologout==0) {
                //Autologout im Profile aktiviert (wird verspätet gesetzt, daher zweite Abfrage)
                var newdiv=createElement("div",{"id":"divSessionEnd","class":"alertbubble tbig link"},ALL,getText("relogin").replace(/%1%/,"<span id='divSessionEndTime'>0</span>"));
                newdiv.addEventListener("click",do_relogin,false);
                timerSessionEnd(Math.max(0,valSessionEndtime-now-30));
                newdiv=null;
                raiseEvent("gameSessionEnds");
            }
        },Math.max(1,1000*unsafeWindow.logout_remain-getRandom(600000,1800000)));
    }

    // Statistik
    err_trace="Statistic";
    if (STAT_SERVER[COUNTRY]){
        function buildStatistik(mode){
        try{
            var modeDefault={"category":"c","npc":true,"showAll":false,"time":120};
            var modeOld=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeStatistic"),"buildStatistik/modeOld",modeDefault);
            if(typeof modeOld!="object"){ modeOld=modeDefault; }
            if(typeof mode!="object"){ mode=modeOld; }
            for(var v in modeDefault){
                if(!modeDefault.hasOwnProperty(v)){ continue; }
                if(mode[v]===undefined){ mode[v]=(modeOld[v]===undefined?modeDefault[v]:modeOld[v]); }
            }
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeStatistic",implode(mode,"buildStatistik/mode"));
            var container=$("statisticArea");
            container.innerHTML="";

            // Header
            var newdiv=createElement("div",{"style":"position:fixed;width:90%;margin-left:5%;z-index:10;border:2px solid black;color:black;background-color:#ccf;"},container);
            var newselect=createElement("select",{"class":"link","style":"margin-right:20px;"},newdiv);
            createElement("option",{"value":"24"},newselect,getText("stat_days1"));
            createElement("option",{"value":"72"},newselect,getText("stat_days3"));
            createElement("option",{"value":"120"},newselect,getText("stat_days5"));
            createElement("option",{"value":"168"},newselect,getText("stat_days7"));
            newselect.value=mode["time"];
            newselect.addEventListener("change",function(){
                buildStatistik({"time":parseInt(this.value,10)});
            },false);

            newselect=createElement("input",{"type":"checkbox","class":"link","checked":mode["npc"]},newdiv);
            newselect.addEventListener("click",function(){
                buildStatistik({"npc":this.checked});
            },false);
            createElement("span",{"style":"margin-right:20px;"},newdiv,getText("NPC"));

            newselect=createElement("input",{"type":"checkbox","class":"link","checked":mode["showAll"]},newdiv);
            newselect.addEventListener("click",function(){
                buildStatistik({"showAll":this.checked});
            },false);
            createElement("span",{"style":"margin-right:20px;"},newdiv,getText("showAll"));

            var help={};
            for (var v=0;v<prodBlock[0].length;v++){
                if(prodBlock[0][v]===undefined){ continue; }
                if((!prodBlock[0][v].match(/t/))&&(mode["showAll"]||!prodBlock[0][v].match(/[lq]/))){
                    help[prodTyp[0][v]]=true;
                }
            }
            newselect=createElement("select",{"class":"link","style":"margin-right:20px;"},newdiv);
            for(var v in help){
                if(!help.hasOwnProperty(v)){ continue; }
                createElement("option",{"value":v},newselect,getText("category_"+v));
            }
            newselect.value=mode["category"];
            newselect.addEventListener("change",function(){
                buildStatistik({"category":this.value});
            },false);
            newselect=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:8px;width:20px;height:20px;"},newdiv);
            newselect.addEventListener("click",function(){
                $("gameArea").style.display="block";
                $("statisticArea").style.display="none";
                $("statisticArea").innerHTML="";
            },false);


            // Body
            newdiv=createElement("div",{"style":"overflow-y:auto;overflow-x:hidden;color:black;padding-top:30px;"},container);
            var newdiv1,newimg,newobject;
            for (var v=0;v<prodName[0].length;v++){
                if(prodName[0][v]===undefined){ continue; }
                if ((prodTyp[0][v]==mode["category"])&&(!prodBlock[0][v].match(/t/))&&(mode["showAll"]||!prodBlock[0][v].match(/[lq]/))){
                    newdiv1=createElement("div",{"id":"stat"+v,"class":"link smallStatistic"},newdiv);
                    if(prodBlock[0][v]){
                        createElement("div",{"style":"height:14px;font-weight:bold;color:red;"},newdiv1,prodName[0][v]+", "+moneyFormat(gut[v]));
                    }else{
                        createElement("div",{"style":"height:14px;font-weight:bold;"},newdiv1,prodName[0][v]+", "+numberFormat(prodStock[0][v],0)+", "+moneyFormat(gut[v])+", "+moneyFormat(gutBeob[v]));
                    }
                    var url=STAT_SERVER[COUNTRY]+"/chart.php?w=400&h=200&t=h"+mode["time"]+"&shownpc="+(mode["npc"]?1:0)+"&clip=1&lng1="+COUNTRY+"&server1="+SERVER+"&product1="+v+"&color1=green";
                    newobject=createElement("object",{"data":url,"type":"type=image/svg+xml","width":"400px","height":"200px"},newdiv1);
                    createElement("param",{"name":"src","value":url},newobject);
                    createElement("div",{"class":"v"+v,"style":"position:absolute;bottom:10px;left:10px;z-index:2;"},newdiv1);
                    createElement("div",{"style":"position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;"},newdiv1);
                    newdiv1.addEventListener("click",function(){
                        showStatisticFullscreen(this.id.replace("stat",""));
                    },false);
                }
            }
            /*
            if (isNaN(mode)){
            }else{
                newdiv1=createElement("div",{"style":"margin:5px;"},newdiv);
                createElement("div",{"style":"font-weight:bold"},newdiv1,prodName[0][mode]+", "+numberFormat(prodStock[0][mode],0)+", "+moneyFormat(gut[mode])+", "+moneyFormat(gutBeob[mode]));
                var breit=(window.innerWidth-60);
                var hoch=(window.innerHeight-130);
                var url=STAT_SERVER[COUNTRY]+"/chart.php?w="+breit+"&h="+hoch+"&t=h"+mode["time"]+"&shownpc="+(mode["npc"]?1:0)+"&clip=1&lng1="+COUNTRY+"&server1="+SERVER+"&product1="+mode+"&color1=green";
                newobject=createElement("object",{data:url,"type":type="image/svg+xml","width":breit+"px","height":hoch+"px"},newdiv1);
                createElement("param",{"name":"src","value":url},newobject);
                createElement("div",{"class":"v"+mode,"style":"position:relative;top:-40px;left:10px;z-index:2"},newdiv1);
            }
            */
            newdiv1=null;newimg=null;newobject=null;

            container=null;newdiv=null;newselect=null;newselect=null;
        }catch(err){ GM_logError("buildStatistik","mode="+implode(mode,"buildStatistik/mode"),"",err); }
        }
        function sendStatData (){
        try{
            if(STAT_SERVER[COUNTRY]){
                var prodStr="";
                var preisBeob=explode(GM_getValue(COUNTRY+"_"+SERVER+"_preisBeob"),"sendStatData/preisBeob",[]); //isNotSent,time,min,max,amount
                var bChanged=false;
                if(!(preisBeob instanceof Array)){
                    preisBeob=new Array();
                    bChanged=true;
                }
                gutBeob=explode(GM_getValue(COUNTRY+"_"+SERVER+"_gutBeob"),"sendStatData/gutBeob",[]);
                var c=0;
                var neededTime=now-300; // Data max 5min old
                for(var v=0;v<preisBeob.length;v++){
                    if(preisBeob[v] && preisBeob[v][0] && (neededTime<preisBeob[v][1]) && (0<preisBeob[v][2]) && (preisBeob[v][2]<=gutBeob[v]) && (gutBeob[v]<=preisBeob[v][3])){
                        prodStr += ',\"product'+(++c)+'\":{\"product_id\":'+v+',\"avg_price\":'+gutBeob[v]+',\"min_price\":'+preisBeob[v][2]+',\"max_price\":'+preisBeob[v][3]+'}';
                        preisBeob[v][0]=false;
                        bChanged=true;
                    }
                }
                if(bChanged){
                    GM_setValue2(COUNTRY+"_"+SERVER+"_preisBeob",implode(preisBeob,"sendStatData/preisBeob"),8);
                    raiseEventTop("gameChangedBeobPrice");
                }

                if (c>0){
                    GM_logInfo("sendStatData","","",getText("sendingXObservedPricesToServer").replace(/%1%/,c));
                    // GM_log("sendStatData sending:\n" + STAT_SERVER[COUNTRY]+'/add.php?json={\"server\":'+SERVER+',\"COUNTRY\":'+COUNTRY+',\"productcount\":'+c+prodStr+'}')
                    GM_xmlhttpRequest({
                    method: "POST",
                    url: STAT_SERVER[COUNTRY]+"/add.php",
                    data: 'json={\"server\":'+SERVER+',\"COUNTRY\":\"'+COUNTRY+'\",\"productcount\":'+c+prodStr+'}',
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    onload: function(c){
                        return function(response){
                            try{
                                GM_logInfo("sendStatData","","",getText("sendingXObservedPricesToServer").replace(/%1%/,c)+" "+response.responseText);
                            }catch(err){GM_logError("sendStatData.onload","","",err);}
                        }
                    }(c),
                    onerror: function(response){
                        GM_logError("sendStatData.onerror","","",""+response.responseText);
                    },
                    timeout: function(response){
                        GM_logError("sendStatData.timeout","","",""+response.responseText);
                    }
                    });
                    c=null;
                }
            }
        }catch(err){ GM_logError("sendStatData","","",err); }
        }
        if(STAT_VIEW && STAT_VIEW[COUNTRY]){
            newdiv=createElement("div",{"id":"divBeraterButtonsStatistic","class":"link beraterButtonIcon hoverBgGreen","mouseOverText":getText("stat_stats")},$("divBeraterButtons"));
            createElement("img",{"src":IMAGES["graph"],"style":"position:relative;top:2px;left:0;width:25px;height:25px;"},newdiv);
            newdiv.addEventListener("click",function(){
                $("gameArea").style.display="none";
                $("statisticArea").style.display="block";
                buildStatistik();
            },false);
        }
        if (GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valStatistik",false) && STAT_SERVER && STAT_SERVER[COUNTRY]){
            sendStatData();
            window.setInterval(function (){
                sendStatData();
            },310000);
        }
    }

    err_trace="Rack bottom";
    if(newdiv=$("canvassracklink")){
        newdiv.style.height = "55px";
    }
    if(newdiv=$("forumracklink")){
        newdiv.style.height = "55px";
    }
    if(newdiv=$("rackBottom")){
        // Spieler suchen
        newinput=createElement("input",{"value":getText("searchPlayer"),"class":"text","style":"position:absolute;top:60px;left:125px;width:85px;background:transparent;border:1px solid black;"},newdiv);
        newinput.addEventListener("click",function(){this.value="";},false);
        newinput.addEventListener("blur",function(){this.value=getText("searchPlayer");},false);
        newinput.addEventListener("keyup",function(event){
            try{
                if (event.keyCode==13){
                    // showShopframePage("http://s"+SERVER+"."+GAMEPAGES[COUNTRY]+"/stadt/stats.php?search=1&searchterm="+this.value);
                }
            }catch(err){ GM_logError("searchPlayer.keyup","","",err); }
        },false);
        // Farmpedia
        newinput=createElement("a",{"href":getText("farmpediaUrl"),"target":"_blank","style":"position:absolute;top:55px;left:100px;z-index:2;","class":"link"},newdiv);
        createElement("img",{"style":"width:25px;height:25px;border:none;","src":GFX+"points.gif"},newinput);
        newinput.addEventListener("mouseover",function(event){ toolTip.show(event,getText("farmpedia")); },false);
    }

    // InfoPanel
    err_trace="InfoPanel";
    if (newdiv=$("speedlinks")){ newdiv.addEventListener("click",closeInfoPanel,false); }
    if (newdiv=$("cityline")){ newdiv.addEventListener("click",closeInfoPanel,false); }

    // Profit
    err_trace="Profit";
    newdiv=createElement("div",{"id":"divBeraterButtonsProfit","class":"link beraterButtonIcon hoverBgGreen","mouseOverText":getText("profitTable")},$("divBeraterButtons"));
    createElement("img",{"src":GFX+"farmhouse/items/76_1.png","style":"position:relative;top:-5px;left:-5px;width:40px;height:40px;"},newdiv);
    newdiv.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("profit"); },false);

    // Preise
    err_trace="Prices";
    newdiv=createElement("div",{"id":"divBeraterButtonsPreise","class":"link beraterButtonIcon hoverBgGold","mouseOverText":getText("prices")},$("divBeraterButtons"));
    createElement("img",{"src":GFX+"money.gif","style":"width:30px;height:30px;"},newdiv);
    newdiv.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("stock",{"page":1}); },false);

    // Recipes and Powerups
    err_trace="Recipes and Powerups";
    if(unsafeWindow.formulas){
        newdiv=createElement("div",{"id":"divBeraterButtonsFormulas","class":"link beraterButtonIcon hoverBgBlue","mouseOverText":getText("recipes")},$("divBeraterButtons"));
        createElement("img",{"src":GFX+"farmhouse/catalogue.gif","style":"position:relative;top:3px;left:0;width:24px;height:24px;"},newdiv);
        newdiv.addEventListener("click",function(){unsafeWindow.buildInfoPanel("formulas");},false);

        if(unsafeWindow.showPowerUps){ // hofix 13.03.2013
            unsafeOverwriteFunction("showPowerUps",function(){
                try{
                    unsafeWindow._showPowerUps();
                }catch(err){GM_logError("_showPowerUps","","",err);}
                try{
                    var cand=$("powerselectorcontent").getElementsByClassName("blackbox");
                    for(var v=0;v<cand.length;v++){
                        if(cand[v].id.match(/^formulatimer\d+$/)){
                            cand[v].style.top="47px";
                        }
                    }
                    cand=null;
                }catch(err){GM_logError("showPowerUps","","",err);}
            });
            unsafeWindow.showPowerUps();
        }

    }

    // Uebersicht
    err_trace="Overview";
    newdiv=$("titlepig");
    if(!newdiv){ newdiv = createElement("div",{"id":"titlepig","style":"top:12px;left:218px;width:97px;height:100px;position:absolute;"},$("headercontainer")) };
    newdiv.setAttribute("class","link");
    newdiv.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("zones"); },false);
    newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("overview")); },false);

    // Quest
    err_trace="Quest - MouseOver";
/*
    questdata={
    "questid":quest number,
    "remain":seconds to the start,
    "data":{    "0":2,
                "1":{"0":{"prodId1":amountNeeded,
                          "prodId2":{"prod2a":amountNeeded,
                                     "prod2a":amountNeeded}},
                     "1":0,
                     "2":0,
                     "3":0},
                "2":{"0":points,"1":money,"2":0,"3":flagRack,"4":flagFarm","5":object,"6":0}, //Rewards
                "3":??,
                "4":??,
                "5":??,
                "6":"Short Description",
                "7":"Long Description",
                "8":waitingTime (before or after?),
                "9":??,
                "10":??},
    "entries":{"prodId1":"amountGiven","prodId2":"amountGiven"},
    "solved":0,
    "farmi":flagFarmiRewarded,
    "end":flagQuestsEnded}
*/
    highlightProducts=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlightProducts"),"do_main/highlightProducts",[false,{}]);
    for(var type in QUESTS){
    if(!QUESTS.hasOwnProperty(type)){continue;}
        for(var campaign in QUESTS[type]){
        if(!QUESTS[type].hasOwnProperty(campaign)){continue;}
            var help = (type=="infinite")?"":campaign;
            newdiv=$("quests_status_bar_"+type+help);
            if (!newdiv) {
                if (questData[type][campaign]["nr"] > 0 && QUESTS[type][campaign][questData[type][campaign]["nr"]])
                newdiv=createElement("div",{"id":"quests_status_bar_"+type+help,"class":"link quests_status_bar_item quests_status_bar_"+type+help,"style":";display:block;"});
                if (newdiv) {
                    $("quests_status_bar").insertBefore(newdiv, $("quests_status_bar").querySelector(".clear"));
                    newdiv.addEventListener("click",function(event){
                        var help=this.id.split("_");
                        switch (help[3].replace(/[0-9]/g,'')) {
                            case 'breed':
                                    unsafeWindow.pets.showQuest();
                                    break;
                            case 'butterfly':
                                    unsafeWindow.butterfly.showQuest()
                                    break;
                            case 'cow':
                                    unsafeWindow.cowracing.showQuest()
                                    break;
                            case 'veterinary':
                                    unsafeWindow.vetQuests();
                                    break;
                            case 'fishing':
                                    unsafeWindow.fishing.showQuest();
                                    break;
                            case 'scouts':
                                    unsafeWindow.scouts.showQuest();
                                    break;
                            default:
                        }
                    },false);
                }
            }
            if(newdiv) {
                newdiv.setAttribute("type",implode([type,campaign],"QuestStatusBar"));
                newdiv.addEventListener("mouseover",function(event){
                    var help=explode(this.getAttribute("type"),"QuestStatusBar");
                    toolTip.show(event,questLineMouseOver(help[0],help[1]));
                },false);
            }
        }
    }
    err_trace="Quest - BeraterButton";
    newdiv=createElement("div",{"id":"divBeraterButtonsQuests","class":"link beraterButtonIcon hoverBgBlack","mouseOverText":getText("quests")},$("divBeraterButtons"));
    createElement("img",{"src":IMAGES["exclamationMark"],"style":"position:relative;top:4px;left:0;width:24px;height:24px;"},newdiv);
    newdiv.addEventListener("click",function(){unsafeWindow.buildInfoPanel("quests",null);},false);
    err_trace="Quest - Farmi amount bonus";
    farmiDailyCount=6;
    for(var v=1;v<questData["main"]["1"]["nr"];v++){
        if(QUESTS["main"]["1"][v]&&QUESTS["main"]["1"][v][3]){
            for(var w=0;w<QUESTS["main"]["1"][v][3].length;w++){
                if(QUESTS["main"]["1"][v][3][w][0]==5){
                    farmiDailyCount+=QUESTS["main"]["1"][v][3][w][1];
                }
            }
        }
    }
    if(div=$("foodworld_questblock")){ div.removeAttribute("onclick"); }
    function calcQuestData(quTyp,campaign){
        try{
            var err_trace = "Set current data";
            // Quest data
            if(QUESTS[quTyp][campaign][questData[quTyp][campaign]["nr"]]){
                questData[quTyp][campaign]["data"]=QUESTS[quTyp][campaign][questData[quTyp][campaign]["nr"]].clone();
                for(var i=questData[quTyp][campaign]["data"][0].length-1;i>=0;i--){
                    // Alternative: if product is already given, reduce to this one
                    if(typeof questData[quTyp][campaign]["data"][0][i][0]=="object"){
                        for(var j=0;j<questData[quTyp][campaign]["data"][0][i].length;j++){
                            if(questData[quTyp][campaign]["given"][questData[quTyp][campaign]["data"][0][i][j][0]]&&questData[quTyp][campaign]["given"][questData[quTyp][campaign]["data"][0][i][j][0]][questData[quTyp][campaign]["data"][0][i][j][1]]){
                                questData[quTyp][campaign]["data"][0][i]=questData[quTyp][campaign]["data"][0][i][j];
                            }
                        }
                    }
                    // Mark the cheapest items. important at alternatives
                    if(typeof questData[quTyp][campaign]["data"][0][i][0]=="object"){
                        help=[];
                        for(var k=0;k<questData[quTyp][campaign]["data"][0][i].length;k++){
                            if(questData[quTyp][campaign]["data"][0][i][k][0]!=0){
                                help[k]=0;
                            }else if(isNaN(NPC[questData[quTyp][campaign]["data"][0][i][k][0]][questData[quTyp][campaign]["data"][0][i][k][1]])){
                                help[k]=questData[quTyp][campaign]["data"][0][i][k][2]*gut[questData[quTyp][campaign]["data"][0][i][k][1]];
                            }else{
                                help[k]=questData[quTyp][campaign]["data"][0][i][k][2]*Math.min(gut[questData[quTyp][campaign]["data"][0][i][k][1]],NPC[questData[quTyp][campaign]["data"][0][i][k][0]][questData[quTyp][campaign]["data"][0][i][k][1]]);
                            }
                            questData[quTyp][campaign]["data"][0][i][k][3]=true;
                            for(var l=0;l<k;l++){
                                if(help[k]<help[l]){ questData[quTyp][campaign]["data"][0][i][l][3]=false; }
                                else { questData[quTyp][campaign]["data"][0][i][k][3]=false; }
                            }
                        }
                        help=questData[quTyp][campaign]["data"][0].splice(i,1)
                        questData[quTyp][campaign]["data"][0]=questData[quTyp][campaign]["data"][0].concat(help[0]);
                    }else{
                        questData[quTyp][campaign]["data"][0][i][3]=true;
                    }
                }
            }else{
                questData[quTyp][campaign]["data"]=[];
            }
        }catch(err){ GM_logError("calcQuestData","","err_trace="+err_trace,err); }
    }
    function handleQuestData(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.questdata){
                // GM_log("unsafeWindow.questdata:\n"+print_r(unsafeWindow.questdata,"",true,"\n"));
                for(var campaign in QUESTS["main"]){
                    if(!QUESTS["main"].hasOwnProperty(campaign)){continue;}
                    if(unsafeWindow.questdata[campaign]){
                        if(!questData["main"][campaign]){ questData["main"][campaign]=INIT_questData["main"][campaign].clone(); }
                        if(unsafeWindow.questdata[campaign]["end"]&&(unsafeWindow.questdata[campaign]["end"]==1)){
                            GM_logInfo("handleQuestLine","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"main"+campaign)).replace(/%2%/,QUESTS["main"][campaign].length));
                            questData["main"][campaign]["nr"]=QUESTS["main"][campaign].length;
                            questData["main"][campaign]["given"] = new Object();
                            questData["main"][campaign]["time"] = 0;
                        }else{
                            // if(!questData["main"][campaign]){continue;}
                            // Quest number
                            GM_logInfo("handleQuestLine","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"main"+campaign)).replace(/%2%/,unsafeWindow.questdata[campaign]["questid"]));
                            questData["main"][campaign]["nr"]=unsafeWindow.questdata[campaign]["questid"];
                            // Given
                            questData["main"][campaign]["given"] = new Object();
                            if(unsafeWindow.questdata[campaign]["entries"]){
                                for(var t in unsafeWindow.questdata[campaign]["entries"]){
                                    if(!unsafeWindow.questdata[campaign]["entries"].hasOwnProperty(t)){continue;}
                                    var prod = parseInt(t,10);
                                    var type = 0;
                                    if(!questData["main"][campaign]["given"][type]){ questData["main"][campaign]["given"][type] = new Object(); }
                                    if(!questData["main"][campaign]["given"][type][prod]){ questData["main"][campaign]["given"][type][prod] = 0; }
                                    questData["main"][campaign]["given"][type][prod] += parseInt(unsafeWindow.questdata[campaign]["entries"][t],10);
                                }
                            }
                            // Time
                            questData["main"][campaign]["time"] = now+unsafeWindow.questdata[campaign]["remain"];
                        }
                        calcQuestData("main",campaign);
                    }
                }
                // GM_log("questdata:\n"+print_r(questData["main"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestData/questData"));
                unsafeData.questData=questData.clone();
            }
            err_trace = "Calc highlightProducts";
            if(highlightProducts[0]){ // TODO: For all quests. Not if all given.
                highlightProducts[1]={};
                if(questData["main"]["1"]["data"]){
                    for(var j=0;j<questData["main"]["1"]["data"][0].length;j++){
                        if(questData["main"]["1"]["data"][0][j][3]){
                            highlightProducts[1][questData["main"]["1"]["data"][0][j][1]]=true;
                        }
                    }
                }
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlightProducts",implode(highlightProducts,"handleQuestData/highlightProducts"));
            }
            window.setTimeout(handleQuestLine,3000);
        }catch(err){ GM_logError("handleQuestData","","err_trace="+err_trace,err); }
    }
    unsafeOverwriteFunction("questInitGo",function(response,mode,b,h,l){
        try{
            unsafeWindow._questInitGo(response,mode,b,h,l);
        }catch(err){GM_logError("_questInitGo","","",err);}
        try{
            handleQuestData();
        }catch(err){GM_logError("questInitGo","","",err);}
    });
    function handleQuestDataFoodworld() {
        try {
            var err_trace = "Get questdata";
            if (unsafeWindow.foodworld_quest) {
                if (!questData["foodworld"]) { questData["foodworld"] = {}; }
                for (var campaign in QUESTS["foodworld"]) { // Iterate over campaigns. So far only one campaign available
                    if (!QUESTS["foodworld"].hasOwnProperty(campaign)) { continue; }
                    if (!questData["foodworld"][campaign]) {
                        questData["foodworld"][campaign] = INIT_questData["foodworld"][campaign].clone();
                    }
                    if (campaign == unsafeWindow.foodworld_quest["campaignid"] &&
                        unsafeWindow.foodworld_quest["questid"]) {
                        // If ever another campaign might show up, Upjers needs to adjust the "campaignid" thing.
                        // We then need to adjust our code here, too!

                        // Quest number
                        if (questData["foodworld"][campaign]["nr"] != unsafeWindow.foodworld_quest["questid"]) {
                            // Current quest in our data is lower/not equal to actual quest number
                            GM_logInfo("handleQuestDataFoodworld", "", "", getText("questSetXToNrY").replace(/%1%/, getText("quest" + "foodworld" + campaign)).replace(/%2%/, unsafeWindow.foodworld_quest["questid"]));

                            // Read actual quest number
                            questData["foodworld"][campaign]["nr"] = unsafeWindow.foodworld_quest["questid"];
                            // Read time
                            questData["foodworld"][campaign]["time"] = now + unsafeWindow.foodworld_quest["remain"];
                        }
                        // In any case: Read already given products
                        questData["foodworld"][campaign]["given"] = new Object();
                        if (unsafeWindow.foodworld_quest["entries"]) {
                            for (var t in unsafeWindow.foodworld_quest["entries"]) {
                                if (!unsafeWindow.foodworld_quest["entries"].hasOwnProperty(t)) { continue; }
                                var prod = parseInt(t, 10);
                                var type = 0; // So far we know, only type-0 products are needed here
                                if (!questData["foodworld"][campaign]["given"][type]) { questData["foodworld"][campaign]["given"][type] = new Object(); }
                                if (!questData["foodworld"][campaign]["given"][type][prod]) { questData["foodworld"][campaign]["given"][type][prod] = 0; }
                                questData["foodworld"][campaign]["given"][type][prod] += parseInt(unsafeWindow.foodworld_quest["entries"][t], 10);
                            }
                        }
                    } else {
                        questData["foodworld"][campaign]["nr"] = QUESTS["foodworld"][campaign].length;
                        questData["foodworld"][campaign]["given"] = new Object();
                        questData["foodworld"][campaign]["time"] = 0;
                    }
                    calcQuestData("foodworld", campaign);
                }
                GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_questData", implode(questData, "handleQuestDataFoodworld/questData"));
                unsafeData.questData = questData.clone();
            }
            div = null;
        } catch (err) { GM_logError("handleQuestDataFoodworld", "", "err_trace=" + err_trace, err); }
    }

    function handleQuestDataVeterinary(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.vet_data&&unsafeWindow.vet_data.quest){
                // GM_log("unsafeWindow.vet_data.quest:\n"+print_r(unsafeWindow.vet_data.quest,"",true,"\n"));
                if(!questData["veterinary"]){ questData["veterinary"]={}; }
                var campaign = "1";
                if(!questData["veterinary"][campaign]){
                    questData["veterinary"][campaign]=INIT_questData["veterinary"][campaign].clone();
                }
                if(unsafeWindow.vet_data.quest.quest_id){
                    // Quest number
                    if(questData["veterinary"][campaign]["nr"]!=parseInt(unsafeWindow.vet_data.quest.campaign=="2"?parseInt(unsafeWindow.vet_data.quest.quest_id)+177:unsafeWindow.vet_data.quest.quest_id,10)){
                        GM_logInfo("handleQuestDataVeterinary","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"veterinary"+campaign)).replace(/%2%/,unsafeWindow.vet_data.quest.quest_id));
                        questData["veterinary"][campaign]["nr"]=parseInt(unsafeWindow.vet_data.quest.campaign=="2"?parseInt(unsafeWindow.vet_data.quest.quest_id)+177:unsafeWindow.vet_data.quest.quest_id,10);
                    }
                    // Given
                    questData["veterinary"][campaign]["given"] = new Object();
                    if(unsafeWindow.vet_data.quest.data){
                        for(var t in unsafeWindow.vet_data.quest.data){
                            if(!unsafeWindow.vet_data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["veterinary"][campaign]["given"][type]){ questData["veterinary"][campaign]["given"][type] = new Object(); }
                            if(!questData["veterinary"][campaign]["given"][type][prod]){ questData["veterinary"][campaign]["given"][type][prod] = 0; }
                            questData["veterinary"][campaign]["given"][type][prod] += parseInt(unsafeWindow.vet_data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["veterinary"][campaign]["time"] =
                    (unsafeWindow.vet_data.quest.remain === undefined)? 0:now+unsafeWindow.vet_data.quest.remain ;
                }else{
                    questData["veterinary"][campaign]["nr"]=QUESTS["veterinary"][campaign].length;
                    questData["veterinary"][campaign]["given"] = new Object();
                    questData["veterinary"][campaign]["time"] = 0;
                }
                calcQuestData("veterinary",campaign);
                // GM_log("questdata:\n"+print_r(questData["veterinary"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataVeterinary/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataVeterinary","","err_trace="+err_trace,err); }
    }

    function handleQuestDataBreed(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.pets&&unsafeWindow.pets.data.quest){
                // GM_log("unsafeWindow.pets.data.quest:\n"+print_r(unsafeWindow.pets.data.quest,"",true,"\n"));
                if(!questData["breed"]){ questData["breed"]={}; }
                var campaign = "1";
                if(!questData["breed"][campaign]){
                    questData["breed"][campaign]=INIT_questData["breed"][campaign].clone();
                }
                if(unsafeWindow.pets.data.quest.questid&&!unsafeWindow.pets.data.block){
                    // Quest number
                    if(questData["breed"][campaign]["nr"]!=parseInt(unsafeWindow.pets.data.quest.questid,10)){
                        GM_logInfo("handleQuestDataBreed","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"breed"+campaign)).replace(/%2%/,unsafeWindow.pets.data.quest.questid));
                        questData["breed"][campaign]["nr"]=parseInt(unsafeWindow.pets.data.quest.questid,10);
                    }
                    // Given
                    questData["breed"][campaign]["given"] = new Object();
                    if(unsafeWindow.pets.data.quest.questid){
                        for(var t in unsafeWindow.pets.data.quest.data){
                            if(!unsafeWindow.pets.data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["breed"][campaign]["given"][type]){ questData["breed"][campaign]["given"][type] = new Object(); }
                            if(!questData["breed"][campaign]["given"][type][prod]){ questData["breed"][campaign]["given"][type][prod] = 0; }
                            questData["breed"][campaign]["given"][type][prod] += parseInt(unsafeWindow.pets.data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["breed"][campaign]["time"] =
                    (unsafeWindow.pets.data.quest.remain === undefined)? unsafeWindow.pets.data.data.createdate:now+unsafeWindow.pets.data.quest.remain ;
                }else{
                    //questData["breed"][campaign]["nr"]=QUESTS["breed"][campaign].length;
                    questData["breed"][campaign]["nr"]=0;
                    questData["breed"][campaign]["given"] = new Object();
                    questData["breed"][campaign]["time"] = 0;
                }
                calcQuestData("breed",campaign);
                // GM_log("questdata:\n"+print_r(questData["breed"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataBreed/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataBreed","","err_trace="+err_trace,err); }
    }
    function handleQuestDataButterfly(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.butterfly&&unsafeWindow.butterfly.data.quest){
                // GM_log("unsafeWindow.butterfly.data.quest:\n"+print_r(unsafeWindow.pets.data.quest,"",true,"\n"));
                if(!questData["butterfly"]){ questData["butterfly"]={}; }
                var campaign = "1";
                if(!questData["butterfly"][campaign]){
                    questData["butterfly"][campaign]=INIT_questData["butterfly"][campaign].clone();
                }
                if(unsafeWindow.butterfly.data.quest.questid){
                    // Quest number
                    if(questData["butterfly"][campaign]["nr"]!=parseInt(unsafeWindow.butterfly.data.quest.questid,10)){
                        GM_logInfo("handleQuestDataButterfly","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"butterfly"+campaign)).replace(/%2%/,unsafeWindow.butterfly.data.quest.questid));
                        questData["butterfly"][campaign]["nr"]=parseInt(unsafeWindow.butterfly.data.quest.questid,10);
                    }
                    // Given
                    questData["butterfly"][campaign]["given"] = new Object();
                    if(unsafeWindow.butterfly.data.quest.questid){
                        for(var t in unsafeWindow.butterfly.data.quest.data){
                            if(!unsafeWindow.butterfly.data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["butterfly"][campaign]["given"][type]){ questData["butterfly"][campaign]["given"][type] = new Object(); }
                            if(!questData["butterfly"][campaign]["given"][type][prod]){ questData["butterfly"][campaign]["given"][type][prod] = 0; }
                            questData["butterfly"][campaign]["given"][type][prod] += parseInt(unsafeWindow.butterfly.data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["butterfly"][campaign]["time"] =
                    (unsafeWindow.butterfly.data.quest.remain === undefined)? 0:now+unsafeWindow.butterfly.data.quest.remain ;
                }else{
                    questData["butterfly"][campaign]["nr"]=QUESTS["butterfly"][campaign].length;
                    questData["butterfly"][campaign]["given"] = new Object();
                    questData["butterfly"][campaign]["time"] = 0;
                }
                calcQuestData("butterfly",campaign);
                // GM_log("questdata:\n"+print_r(questData["breed"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataButterfly/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataButterfly","","err_trace="+err_trace,err); }
    }

    function handleQuestDataCowRacing(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.cowracing&&unsafeWindow.cowracing.data.quest){
                // GM_log("unsafeWindow.cowracing.data.quest:\n"+print_r(unsafeWindow.cowracing.data.quest,"",true,"\n"));
                if(!questData["cow"]){ questData["cow"]={}; }
                var campaign = "1";
                if(!questData["cow"][campaign]){
                    questData["cow"][campaign]=INIT_questData["cow"][campaign].clone();
                }
                if(unsafeWindow.cowracing.data.quest.questid){
                    // Quest number
                    if(questData["cow"][campaign]["nr"]!=parseInt(unsafeWindow.cowracing.data.quest.questid,10)){
                        GM_logInfo("handleQuestDataCowRacing","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"cow"+campaign)).replace(/%2%/,unsafeWindow.cowracing.data.quest.questid));
                        questData["cow"][campaign]["nr"]=parseInt(unsafeWindow.cowracing.data.quest.questid,10);
                    }
                    // Given
                    questData["cow"][campaign]["given"] = new Object();
                    if(unsafeWindow.cowracing.data.quest.questid){
                        for(var t in unsafeWindow.cowracing.data.quest.data){
                            if(!unsafeWindow.cowracing.data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["cow"][campaign]["given"][type]){ questData["cow"][campaign]["given"][type] = new Object(); }
                            if(!questData["cow"][campaign]["given"][type][prod]){ questData["cow"][campaign]["given"][type][prod] = 0; }
                            questData["cow"][campaign]["given"][type][prod] += parseInt(unsafeWindow.cowracing.data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["cow"][campaign]["time"] =
                    (unsafeWindow.cowracing.data.quest.remain === undefined)? 0:now+unsafeWindow.cowracing.data.quest.remain ;
                }else{
                    questData["cow"][campaign]["nr"]=QUESTS["cow"][campaign].length;
                    questData["cow"][campaign]["given"] = new Object();
                    questData["cow"][campaign]["time"] = 0;
                }
                calcQuestData("cow",campaign);
                // GM_log("questdata:\n"+print_r(questData["cow"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataCowRacing/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataCowRacing","","err_trace="+err_trace,err); }
    }

    function handleQuestDataFishing(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.fishing&&unsafeWindow.fishing.data.quest){
                // GM_log("unsafeWindow.fishing.data.quest:\n"+print_r(unsafeWindow.fishing.data.quest,"",true,"\n"));
                if(!questData["fishing"]){ questData["fishing"]={}; }
                var campaign = "1";
                if(!questData["fishing"][campaign]){
                    questData["fishing"][campaign]=INIT_questData["fishing"][campaign].clone();
                }
                if(unsafeWindow.fishing.data.quest.questid){
                    // Quest number
                    if(questData["fishing"][campaign]["nr"]!=parseInt(unsafeWindow.fishing.data.quest.questid,10)){
                        GM_logInfo("handleQuestDataFishing","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"fishing"+campaign)).replace(/%2%/,unsafeWindow.fishing.data.quest.questid));
                        questData["fishing"][campaign]["nr"]=parseInt(unsafeWindow.fishing.data.quest.questid,10);
                    }
                    // Given
                    questData["fishing"][campaign]["given"] = new Object();
                    if(unsafeWindow.fishing.data.quest.questid){
                        for(var t in unsafeWindow.fishing.data.quest.data){
                            if(!unsafeWindow.fishing.data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["fishing"][campaign]["given"][type]){ questData["fishing"][campaign]["given"][type] = new Object(); }
                            if(!questData["fishing"][campaign]["given"][type][prod]){ questData["fishing"][campaign]["given"][type][prod] = 0; }
                            questData["fishing"][campaign]["given"][type][prod] += parseInt(unsafeWindow.fishing.data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["fishing"][campaign]["time"] =
                    (unsafeWindow.fishing.data.quest.remain === undefined)? 0:now+unsafeWindow.fishing.data.quest.remain ;
                }else{
                    questData["fishing"][campaign]["nr"]=QUESTS["fishing"][campaign].length;
                    questData["fishing"][campaign]["given"] = new Object();
                    questData["fishing"][campaign]["time"] = 0;
                }
                calcQuestData("fishing",campaign);
                // GM_log("questdata:\n"+print_r(questData["fishing"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataFishing/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataFishing","","err_trace="+err_trace,err); }
    }

    //Quest Rosi
    function handleQuestDataInfinite(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";

            if(unsafeWindow.infinitequestline){
                if(!questData["infinite"]){ questData["infinite"]={}; }
                var campaign = unsafeWindow.infinitequestline.data.data.quest.campaign;
                if(!questData["infinite"][campaign]){
                    questData["infinite"][campaign]=INIT_questData["infinite"][campaign].clone();
                }

                // Quest number
                questData["infinite"][campaign]["nr"]=1;
                // Time
                var startDate=new Date();
                if (unsafeWindow.infinitequestline.data.data.quest.remain>0){
                    startDate=Math.round(((new Date(startDate.getFullYear(),startDate.getMonth(),startDate.getDate()+1,0,0,0)).getTime())/1000);
                } else {
                    startDate=Math.round(((new Date(startDate.getFullYear(),startDate.getMonth(),startDate.getDate(),0,0,0)).getTime())/1000);
                }
                questData["infinite"][campaign]["time"] =startDate; // TODO

                var x=0;
                for (var productID in unsafeWindow.infinitequestline.data.data.quest.products){
                    if(!unsafeWindow.infinitequestline.data.data.quest.products.hasOwnProperty(productID)){continue;}
                    QUESTS["infinite"][campaign][1][0][x][1]=parseInt(productID,10);
                    QUESTS["infinite"][campaign][1][0][x][2]=unsafeWindow.infinitequestline.data.data.quest.products[productID];
                    x++;
                }
                //"infinite":{"1":[,[[[0,0,0],[0,0,0],[0,0,0]], ,0,[[0,0]] ]]}
                QUESTS["infinite"][campaign][1][3][0][1]=unsafeWindow.infinitequestline.data.data.quest.reward.money;
                QUESTS["infinite"][campaign][1][2]=unsafeWindow.infinitequestline.data.data.quest.reward.points;

                // Given
                questData["infinite"][campaign]["given"] = new Object();
                if(unsafeWindow.infinitequestline.data.data.quest.data){
                    for(var t in unsafeWindow.infinitequestline.data.data.quest.data){
                        if(!unsafeWindow.infinitequestline.data.data.quest.data.hasOwnProperty(t)){continue;}
                        var prod = parseInt(t,10);
                        var type = 0;
                        if(!questData["infinite"][campaign]["given"][type]){ questData["infinite"][campaign]["given"][type] = new Object(); }
                        if(!questData["infinite"][campaign]["given"][type][prod]){ questData["infinite"][campaign]["given"][type][prod] = 0; }
                        questData["infinite"][campaign]["given"][type][prod] += parseInt(unsafeWindow.infinitequestline.data.data.quest.data[t],10);
                    }
                }
                calcQuestData("infinite",campaign);
                // GM_log("questdata:\n"+print_r(questData["infinite"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataInfinite/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataInfinite","","err_trace="+err_trace,err); }
    }

    function handleQuestDataScouts(){
        // GM_log("setQuest newQuestNr="+newQuestNr);
        try{
            var err_trace = "Get questdata";
            if(unsafeWindow.scouts&&unsafeWindow.scouts.data.quest){
                // GM_log("unsafeWindow.scouts.data.quest:\n"+print_r(unsafeWindow.scouts.data.quest,"",true,"\n"));
                if(!questData["scouts"]){ questData["scouts"]={}; }
                var campaign = "1";
                if(!questData["scouts"][campaign]){
                    questData["scouts"][campaign]=INIT_questData["scouts"][campaign].clone();
                }
                if(unsafeWindow.scouts.data.quest.questid){
                    // Quest number
                    if(questData["scouts"][campaign]["nr"]!=parseInt(unsafeWindow.scouts.data.quest.questid,10)){
                        GM_logInfo("handleQuestDataScouts","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"scouts"+campaign)).replace(/%2%/,unsafeWindow.scouts.data.quest.questid));
                        questData["scouts"][campaign]["nr"]=parseInt(unsafeWindow.scouts.data.quest.questid,10);
                    }
                    // Given
                    questData["scouts"][campaign]["given"] = new Object();
                    if(unsafeWindow.scouts.data.quest.questid){
                        for(var t in unsafeWindow.scouts.data.quest.data){
                            if(!unsafeWindow.scouts.data.quest.data.hasOwnProperty(t)){continue;}
                            var prod = parseInt(t,10);
                            var type = 0;
                            if(!questData["scouts"][campaign]["given"][type]){ questData["scouts"][campaign]["given"][type] = new Object(); }
                            if(!questData["scouts"][campaign]["given"][type][prod]){ questData["scouts"][campaign]["given"][type][prod] = 0; }
                            questData["scouts"][campaign]["given"][type][prod] += parseInt(unsafeWindow.scouts.data.quest.data[t],10);
                        }
                    }
                    // Time
                    questData["scouts"][campaign]["time"] =
                    (unsafeWindow.scouts.data.quest.remain === undefined)? 0:now+unsafeWindow.scouts.data.quest.remain ;
                }else{
                    questData["scouts"][campaign]["nr"]=QUESTS["scouts"][campaign].length;
                    questData["scouts"][campaign]["given"] = new Object();
                    questData["scouts"][campaign]["time"] = 0;
                }
                calcQuestData("scouts",campaign);
                // GM_log("questdata:\n"+print_r(questData["scouts"],"",true,"\n"));
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"handleQuestDataScouts/questData"));
                unsafeData.questData=questData.clone();
            }
            div=null;
        }catch(err){ GM_logError("handleQuestDataScouts","","err_trace="+err_trace,err); }
    }

    // mouseover showing quest data
    function questLineMouseOver(questType,campaign){
        try{
            var container=createElement("div");
            if (questType=="infinite") {handleQuestDataInfinite();}
            var questDataCurr = questData[questType][campaign];
            var questCurr = QUESTS[questType][campaign][questDataCurr["nr"]];
            var questStarted = (questDataCurr["time"]<now);
            var table=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"3","style":"line-height:16px;"},container);
            var tr=createElement("tr",{},table);
            var td=createElement("td",{"colspan":"3","style":"text-align:center;border-bottom:1px solid black;font-weight:bold;"},tr,getText("quest"+questType+campaign)+"<br>"+getText("nr")+" "+ (questType !== "infinite" ? questDataCurr["nr"] : unsafeWindow.infinitequestline.data.data.quest.questid));
            if(questStarted){ createElement("td",{"colspan":"2","style":"text-align:center;border-bottom:1px solid black;border-left:1px solid black;"},tr,getText("given")); }
            createElement("td",{"colspan":"2","style":"text-align:center;border-bottom:1px solid black;border-left:1px solid black;"},tr,getText("missing"));
            createElement("td",{"colspan":"2","style":"text-align:center;border-bottom:1px solid black;border-left:1px solid black;"},tr,getText("total"));
            var sumWert=[0,0,0]; //given,needed,total
            var menge,item,preis;
            for(var v=0;v<questDataCurr["data"][0].length;v++){
                item=questDataCurr["data"][0][v];
                menge=[,,item[2]];
                if(questStarted){ menge[0]=(questDataCurr["given"]&&questDataCurr["given"][item[0]]&&questDataCurr["given"][item[0]][item[1]])?questDataCurr["given"][item[0]][item[1]]:0; }
                else{ menge[0]=0; }
                menge[1]=Math.max(0,menge[2]-menge[0]-prodStock[item[0]][item[1]]);
                preis=null;
                if(item[0]==0){
                    preis=gut[item[1]];
                    if(!isNaN(NPC[item[0]][item[1]])){ preis=Math.min(preis,NPC[item[0]][item[1]]); }
                }
                tr=createElement("tr",{},table);
                if(!item[3]){ tr.style.textDecoration="line-through"; }
                td=createElement("td",{},tr);
                produktPic(item[0],item[1],td);
                createElement("td",{},tr,prodName[item[0]][item[1]]);
                createElement("td",{"style":"text-align:right;"},tr,numberFormat(100*(menge[2]-menge[1])/menge[2])+"%");
                for(var i=0;i<3;i++){
                    if((i==0)&&(!questStarted)){ continue; }
                    if(item[3]&&(preis!=null)){ sumWert[i] += menge[i]*preis; }
                    createElement("td",{"style":"text-align:right;border-left:1px solid black;"},tr,numberFormat(menge[i]));
                    createElement("td",{"style":"text-align:right;padding-left:10px;"},tr,preis!=null?moneyFormatInt(menge[i]*preis):"--");
                }
            }

            tr=createElement("tr",{},table);
            createElement("td",{"colspan":"2","style":"border-top:1px solid black;"},tr);
            createElement("td",{"style":"text-align:right;border-top:1px solid black;"},tr,numberFormat(100*(sumWert[2]-sumWert[1])/(sumWert[2]))+"%");
            for(var i=0;i<3;i++){
                if((i==0)&&(!questStarted)){ continue; }
                createElement("td",{"style":"text-align:right;border-top:1px solid black;","colspan":"2"},tr,moneyFormatInt(sumWert[i]));
            }

            table=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"3","style":"line-height:16px;"},container);
            tr=createElement("tr",{},table);
            createElement("td",{"style":"vertical-align:top;"},tr,getText("reward")+":");
            td=createElement("td",{},tr);
            var div;
            if(questCurr[2]>0){
                pointsFormat(questCurr[2],"div",td);
            }
            if(questCurr[3]){
                for(var w=0;w<questCurr[3].length;w++){
                    switch(questCurr[3][w][0]){
                    case 0:{
                        createElement("div",{},td,moneyFormat(questCurr[3][w][1]));
                    break;}
                    case 1:{
                        div=createElement("div",{},td);
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,numberFormat(questCurr[3][w][3])+"&nbsp;"+prodName[questCurr[3][w][1]][questCurr[3][w][2]]);
                    break;}
                    case 2:{
                        createElement("div",{},td,getText("activation")+": "+getText("rackX").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 3:{
                        createElement("div",{},td,getText("activation")+": "+getText("farmX").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 4:{
                        div=createElement("div",{},td);
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,getText("productTimeSaving").replace(/%1%/,questCurr[3][w][3]).replace(/%2%/,prodName[questCurr[3][w][1]][questCurr[3][w][2]]));
                    break;}
                    case 5:{
                        div=createElement("div",{},td);
                        createElement("img",{"src":GFX+"adbonus.gif","style":"border:0;height:15px;"},div);
                        createElement("span",{},div,getText("additionalFarmi").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 6:{
                        createElement("div",{},td,getText("additionalLogCapacity").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 7:{
                        createElement("div",{},td,getText("waterBonus").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    case 8:{
                        if(DATA_zones[questCurr[3][w][1]]["location"]=="farm"){
                            createElement("div",{},td,getText("activation")+": "+getText("farmzone").replace(/%1%/,1+((questCurr[3][w][1]-1)%6)).replace(/%2%/,Math.ceil(questCurr[3][w][1]/6)));
                        }else{
                            createElement("div",{},td,getText("activation")+": "+zones.getBuildingName(questCurr[3][w][1]));
                        }
                    break;}
                    case 9:{
                        div=createElement("div",{},td);
                        createElement("span",{},div,getText("activation")+": ");
                        produktPic(questCurr[3][w][1],questCurr[3][w][2],div);
                        createElement("span",{},div,prodName[questCurr[3][w][1]][questCurr[3][w][2]]);
                    break;}
                    case 10:{
                        createElement("div",{},td,getText("activation")+": "+getText("wateringFeature"));
                    break;}
                    case 11:{
                        div=createElement("div",{},td);
                        createElement("img",{"src":GFX+"adbonus.gif","style":"border:0;height:15px;"},div);
                        createElement("span",{},div,getText("additionalForestFarmiSlot").replace(/%1%/,questCurr[3][w][1]));
                    break;}
                    }
                }
            }
            tr=createElement("tr",{},table);
            createElement("td",{},tr,getText("start")+": ");
            createElement("td",{},tr,getDateText(questDataCurr["time"])+" "+getDaytimeStr(questDataCurr["time"]));

            div=null;
            table=null;tr=null;td=null;
            return container.innerHTML;
        }catch(err){
            var msgText=null;
            try{
                switch (questType) {
                    case "main":
                        {
                            msgText = getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("quest" + questType + campaign));
                            console.trace();
                            break;
                        }
                    case "forestry":
                        {
                            msgText = (getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("lodge")));
                            console.trace();
                            break;
                        }
                    case "foodworld":
                        {
                            msgText = (getText("informationIsMissing") + " " + getText("pleaseOpenX").replace(/%1%/, getText("foodworld")));
                            console.trace();
                            break;
                        }
                }

                if(msgText){
                    GM_logWarning("questLineMouseOver","","err="+err,msgText);
                    return msgText;
                }else{
                    throw(err);
                }
            }catch(err){
                GM_logError("questLineMouseOver","","",err);
                return null;
            }
        }
    }
    unsafeOverwriteFunction("showQuestBox",function(c){
        try{
            unsafeWindow._showQuestBox(c);
        }catch(err){GM_logError("_showQuestBox","","",err);}
        try{
            var cand=$("questboxobjects").getElementsByClassName("questboxbarout");
            for(var i=0;i<cand.length;i++){
                var questWare = parseInt(cand[i].children[0].id.replace("questboxbarin",""),10);
                var menge = [0,0,0]; //given,stock,total
                for(var v in unsafeWindow.questdata[c]["data"][1][0]){
                    if(!unsafeWindow.questdata[c]["data"][1][0].hasOwnProperty(v)){ continue; }
                    if(typeof unsafeWindow.questdata[c]["data"][1][0][v]=="object"){
                        if(unsafeWindow.questdata[c]["data"][1][0][v][questWare]){
                            menge[2] = unsafeWindow.questdata[c]["data"][1][0][v][questWare];
                        }
                    }else{
                        if(v==questWare){
                            menge[2] = unsafeWindow.questdata[c]["data"][1][0][v];
                        }
                    }
                }
                menge[0]=((unsafeWindow.questdata[c]["entries"]&&unsafeWindow.questdata[c]["entries"][questWare])?parseInt(unsafeWindow.questdata[c]["entries"][questWare],10):0);
                menge[1]=Math.min(menge[2]-menge[0],prodStock[0][questWare]);
                createElement("div",{"style":"width:"+Math.floor(200*menge[1]/menge[2])+"px;left:"+Math.floor(200*(menge[0])/menge[2])+"px;","class":"questboxbarinPoss"},cand[i]);
                // better number-formatting
                $("questboxobj"+questWare+"_current").innerHTML = numberFormat(menge[0]);
                //erst mal auskommentiert :(
                //$("questboxobj"+questWare+"_need").innerHTML = numberFormat(menge[2]);
            }
        }catch(err){ GM_logError("showQuestBox","","",err); }
    });
    unsafeOverwriteFunction("questsHandler",function(status){
        try{
            unsafeWindow._questsHandler(status);
        }catch(err){GM_logError("_questsHandler","","",err);}
        try{
            window.setTimeout(handleQuestLine,3000);
            //handleQuestLine();
        }catch(err){GM_logError("questsHandler","","",err);}
    });
    unsafeOverwriteFunction("showQuestBoxLine",function(){
        try{
            unsafeWindow._showQuestBoxLine();
        }catch(err){GM_logError("_showQuestBoxLine","","",err);}
        try{
            handleQuestLine();
        }catch(err){GM_logError("showQuestBoxLine","","",err);}
    });
    function updateQuestLineTimer() {
        try {
            return false;
            // Remarks, Moe, 16. Nov 2016: Dead code, but why???
            /* 20170424 for (var type in QUESTS) {
                if (!QUESTS.hasOwnProperty(type)) {
                    continue; }
                if (type == "main") {
                    continue; }
                for (var campaign in QUESTS[type]) {
                    if (!QUESTS[type].hasOwnProperty(campaign)) {
                        continue; }
                    if (nodes["questline_" + type + "_" + campaign] && nodes["questline_" + type + "_" + campaign]["node"]) {
                        if (now < questData[type][campaign]["time"]) {
                            nodes["questline_" + type + "_" + campaign]["node"].children[1].innerHTML = getTimeStr(questData[type][campaign]["time"] - now, false) + " " + getText("shortHours");
                        } else {
                            handleQuestLine();
                        }
                    }
                }
            }*/
        } catch (err) { GM_logError("updateQuestLineTimer", "", "type=" + type + " campaign=" + campaign, err); }
    }

    handleQuestData(); // --> handleQuestLine
    err_trace="Show Data";
    // SHOW DATA: BUILDING_INPUT
    /*
    for(var zone=0;zone<BUILDING_INPUT.length;zone++){
        if(!BUILDING_INPUT[zone]){continue;}
        for(var output in BUILDING_INPUT[zone]){
        if(!BUILDING_INPUT[zone].hasOwnProperty(output)){continue;}
            for(var alt=0;alt<BUILDING_INPUT[zone][output].length;alt++){
                var str="Zone "+zone+": ";
                for(var input=0;input<BUILDING_INPUT[zone][output][alt].length;input++){
                    if(input>0){ str+=", "; }
                    str+=numberFormat(BUILDING_INPUT[zone][output][alt][input][1])+" "+prodName[0][BUILDING_INPUT[zone][output][alt][input][0]]
                }
                str+=" -> "+prodName[0][output];
                GM_log(str);
            }
        }
    }
    */
/*
        var div=createElement("div",{"style":"z-index:950;position:fixed;top:0;background-color:white;height:800px;overflow:auto;padding-right:40px;"},ALL);
        var newimg=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:0px;width:20px;height:20px;"},div);
        newimg.addEventListener("click",function(){ removeElement(this.parentNode); },false);

        var tr,td,table=createElement("table",{"border":"1"},div);
        for(var campaign in QUESTS["forestry"]){
        if(!QUESTS["forestry"].hasOwnProperty(campaign)){continue;}
            for(var v=1;v<QUESTS["forestry"][campaign].length;v++){
                tr = createElement("tr",{},table);
                if(questData["forestry"][campaign]["nr"]==v){ tr.style.backgroundColor="#FBB"; }
                createElement("td",{},tr,campaign);
                createElement("td",{},tr,v);
                for(var w=0;w<6;w++){
                    td = createElement("td",{"style":"white-space:nowrap;"},tr);
                    if(QUESTS["forestry"][campaign][v][0][w]){
                        produktPic(QUESTS["forestry"][campaign][v][0][w][0],QUESTS["forestry"][campaign][v][0][w][1],td);
                        createElement("span",{},td,numberFormat(QUESTS["forestry"][campaign][v][0][w][2]));
                        td.setAttribute("mouseovertext",numberFormat(QUESTS["forestry"][campaign][v][0][w][2])+" "+prodName[QUESTS["forestry"][campaign][v][0][w][0]][QUESTS["forestry"][campaign][v][0][w][1]]);
                        td.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseovertext")); },false);
                    }
                }
                createElement("td",{},tr,QUESTS["forestry"][campaign][v][1]);
                td=createElement("td",{},tr);
                    if(QUESTS["forestry"][campaign][v][2]){ pointsFormat(QUESTS["forestry"][campaign][v][2],"div",td); }
                td=createElement("td",{},tr);
                    if(QUESTS["forestry"][campaign][v][3]){ createElement("div",{},td,implode(QUESTS["forestry"][campaign][v][3])); }
            }
        }
        div=null;newimg=null;
        table=null;tr=null;td=null;
    });
*/
    // SHOW DATA: BUILDINGS
    err_trace="Show data buildings";
    function showDataAllBuildings(){
    try{
        var container=createElement("div",{"style":"z-index:995;position:absolute;top:0;left:0;background-color:white;height:100%;"},ALL);
        var div=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:0;right:0;width:20px;height:20px;margin:5px;"},container);
        div.addEventListener("click",function(){ removeElement(this.parentNode); },false);
        div=createElement("div",{"style":"height:100%;padding-right:20px;margin-right:30px;overflow:auto;"},container);
        var table=createElement("table",{"border":"1"},div);
        var tr=createElement("tr",{},table);
        var td;
        createElement("th",{},tr);
        for(var w=1;w<unsafeWindow.buildinginfos[0][1].length;w++){
            createElement("th",{},tr,w);
        }
        createElement("th",{},tr,"BUILDING_UPGRADES");
        createElement("th",{},tr,"BUILDINGTYPE");
        createElement("th",{},tr,"COUNT");
        for(var v in unsafeWindow.buildinginfos[0]){
            if(!unsafeWindow.buildinginfos[0].hasOwnProperty(v)){continue;}
            tr=createElement("tr",{},table);
            createElement("td",{},tr,v);
            for(var w=1;w<unsafeWindow.buildinginfos[0][v].length;w++){
                createElement("td",{},tr,implode(unsafeWindow.buildinginfos[0][v][w],"showDataAllBuildings/buildinginfos"));
            }
            createElement("td",{},tr,implode(BUILDING_UPGRADES[v],"showDataAllBuildings/BUILDING_UPGRADES"));
            createElement("td",{},tr,implode(BUILDINGTYPE[v],"showDataAllBuildings/BUILDINGTYPE"));
            createElement("td",{},tr,implode(totalZones[v],"showDataAllBuildings/totalZones"));
        }
        for(var i=1;i<=4;i++){
            v="fw"+i;
            tr=createElement("tr",{},table);
            createElement("td",{},tr,v);
            for(var w=1;w<=12;w++){
                td=createElement("td",{},tr);
                switch(w){
                case 10: td.innerHTML=getBuildingName(v); break;
                }
            }
            createElement("td",{},tr,implode(BUILDING_UPGRADES[v],"showDataAllBuildings/BUILDING_UPGRADES"));
            createElement("td",{},tr,implode(BUILDINGTYPE[v],"showDataAllBuildings/BUILDINGTYPE"));
            createElement("td",{},tr,implode(totalZones[v],"showDataAllBuildings/totalZones"));
        }
        for(var i=1;i<=6;i++){
            v="fl"+i;
            tr=createElement("tr",{},table);
            createElement("td",{},tr,v);
            for(var w=1;w<=12;w++){
                td=createElement("td",{},tr);
                switch(w){
                case 10: td.innerHTML=getBuildingName(v); break;
                }
            }
            createElement("td",{},tr,implode(BUILDING_UPGRADES[v],"showDataAllBuildings/BUILDING_UPGRADES"));
            createElement("td",{},tr,implode(BUILDINGTYPE[v],"showDataAllBuildings/BUILDINGTYPE"));
            createElement("td",{},tr,implode(totalZones[v],"showDataAllBuildings/totalZones"));
        }
        container=null;div=null;
        table=null;tr=null;td=null;
    }catch(err){ GM_logError("showDataAllBuildings","","",err); }
    };
    GM_registerMenuCommand(getText("adviser")+" Show Data: Buildings", showDataAllBuildings);

    // SHOW DATA: PRODUCTS
    err_trace="Show data products";
    function showDataAllProducts(){
    try{
        var container=createElement("div",{"style":"z-index:995;position:absolute;top:0;left:0;background-color:white;height:100%;"},ALL);
        var div=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:0;right:0;width:20px;height:20px;margin:5px;"},container);
        div.addEventListener("click",function(){ removeElement(this.parentNode); },false);
        div=createElement("div",{"style":"height:100%;padding-right:20px;margin-right:30px;overflow:auto;"},container);
        var table=createElement("table",{"border":"1"},div);
        var tr,td,newDiv1;
        for(var type in prodName){
        try{
            if(!prodName.hasOwnProperty(type)){continue;}
            tr=createElement("tr",{"style":"background-color:orange;color:black;"},table);
            createElement("th",{"colspan":"16"},tr,type+": "+["farm","forestry","recipes","powerups","megafield"][type]);
            tr=createElement("tr",{"style":"background-color:orange;color:black;"},table);
            createElement("th",{"style":"white-space:nowrap;"},tr,"id");
            createElement("th",{"style":"white-space:nowrap;"},tr,"Name");
            createElement("th",{},tr,"Typ");
            createElement("th",{},tr,"Stock");
            createElement("th",{},tr,"MaxStock");
            createElement("th",{},tr,"MinRack");
            createElement("th",{},tr,"MinRackInit");
            createElement("th",{},tr,"PlantSize");
            createElement("th",{},tr,"Block");
            createElement("th",{},tr,"Require");
            createElement("th",{},tr,"Yield");
            createElement("th",{},tr,"GrowTime");
            createElement("th",{},tr,"Points");
            createElement("th",{},tr,"NPC");
            createElement("th",{},tr,"gut");
            createElement("th",{},tr,"loc");
            for(var v in prodName[type]){
            try{
                if(!prodName[type].hasOwnProperty(v)){continue;}
                if(!prodName[type][v]){continue;}
                tr=createElement("tr",{},table);
                createElement("td",{},tr,v);
                td=createElement("td",{"style":"white-space:nowrap;"},tr);
                    produktPic(type,v,td);
                    createElement("span",{},td,prodName[type][v]);
                td=createElement("td",{},tr,prodTyp[type][v]);
                td=createElement("td",{},tr,numberFormat(prodStock[type][v]));
                td=createElement("td",{},tr,numberFormat(prodStockMax[type][v]));
                td=createElement("td",{},tr,numberFormat(prodMinRack[type][v]));
                td=createElement("td",{},tr,numberFormat(prodMinRackInit[type][v]));
                td=createElement("td",{},tr,prodPlantSize[type][v]);
                td=createElement("td",{},tr,prodBlock[type][v]);
                td=createElement("td",{},tr);
                if(typeof prodRequire[type][v]=="object"){
                    for(var i=0;i<prodRequire[type][v].length;i++){
                        if(i>0){ createElement("div",{"style":"display:inline-block;white-space:nowrap;"},td,";&nbsp;"); }
                        if(prodRequire[type][v][i][0]>-1){
                            newDiv1=createElement("div",{"style":"display:inline-block;white-space:nowrap;","class":"hoverBgLightblue","prodType":prodRequire[type][v][i][0],"prodId":prodRequire[type][v][i][1]},td);
                            newDiv1.addEventListener("mouseover",function(event){
                                toolTip.show(event,prodName[this.getAttribute("prodType")][this.getAttribute("prodId")]);
                                //toolTip.show(event,prodName[parseInt(this.getAttribute("prodType"),10)][parseInt(this.getAttribute("prodId"),10)]);
                            },false);
                            produktPic(prodRequire[type][v][i][0],prodRequire[type][v][i][1],newDiv1);
                            createElement("span",{},newDiv1,numberFormat(prodRequire[type][v][i][2]));
                        }else{
                            newDiv1=createElement("div",{"style":"display:inline-block;white-space:nowrap;","class":"hoverBgLightblue"},td);
                            createElement("span",{},newDiv1,moneyFormat(prodRequire[type][v][i][1]));
                        }
                    }
                }
                td=createElement("td",{},tr,prodYield[type][v]);
                td=createElement("td",{},tr,prodGrowTime[type][v]>0?getTimeStr(60*prodGrowTime[type][v],true):"");
                td=createElement("td",{},tr,prodPoints[type][v]===undefined?"-":numberFormat(prodPoints[type][v]));
                td=createElement("td",{},tr);
                if(!(NPC[type]&&NPC[type][v])){
                    createElement("span",{},td,"-");
                }else if(!isNaN(NPC[type][v])){
                    createElement("span",{},td,moneyFormat(NPC[type][v]));
                }else if (NPC[type][v].match(/^f/)){
                    createElement("span",{},td,"*"+moneyFormat(parseFloat(NPC[type][v].replace("f",""),10)));
                }else if (NPC[type][v].match(/^c/)){
                    coinsFormat(parseInt(NPC[type][v].replace("c",""),10),td);
                }
                td=createElement("td",{},tr,(type>0)||(gut[v]===undefined)?"-":moneyFormat(gut[v]));
                td=createElement("td",{},tr,PRODUCT2BUILDING[type][v]);
            }catch(err){ GM_logError("showDataAllProducts","","type="+type+" v="+v,"(loop) "+err); }
            }
        }catch(err){ GM_logError("showDataAllProducts","","type="+type,err); }
        }
        container=null;div=null;
        table=null;tr=null;td=null;newDiv1=null;
    }catch(err){ GM_logError("showDataAllProducts","","",err); }
    }
    GM_registerMenuCommand(getText("adviser")+" Show Data: Products", showDataAllProducts);

    // SHOW DATA: ZONES
    err_trace="Show data zones";
    function showDataAllZones(){
    try{
        var prType,zoneNrS,allZones=[],currZoneType,help;
        var style="";
        for(var i in ALL_ZONES){
            if(!ALL_ZONES.hasOwnProperty(i)){ continue; }
            for(var j=0;j<ALL_ZONES[i].length;j++){
                allZones.push(ALL_ZONES[i][j].toString());
                if(help=zones.isMultiSlot(ALL_ZONES[i][j])){
                    for(var slot=1;slot<=help;slot++){
                        allZones.push(ALL_ZONES[i][j]+"."+slot);
                    }
                }
            }
        }
        var container=createElement("div",{"style":"z-index:995;position:absolute;top:0;left:0;background-color:white;height:100%;"},ALL);
        var div=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:0;right:0;width:20px;height:20px;margin:5px;"},container);
        div.addEventListener("click",function(){ removeElement(this.parentNode); },false);
        div=createElement("div",{"style":"height:100%;padding-right:20px;margin-right:30px;overflow:auto;"},container);
        var table=createElement("table",{"border":"1"},div);
        var tr=createElement("tr",{},table);
        var td=createElement("td",{},tr,"Nr");
        createElement("td",{},tr,"Type(building,BUILDINGTYPE)");
        createElement("td",{},tr,"Block");
        createElement("td",{},tr,"AddToGlobalTime");
        createElement("td",{},tr,"Animals");
        createElement("td",{},tr,"Bonus");
        createElement("td",{},tr,"BonusSpecial");
        createElement("td",{},tr,"EndProduct");
        createElement("td",{},tr,"EndTime");
        createElement("td",{},tr,"WaterTime");
        createElement("td",{},tr,"Ernte");
        createElement("td",{},tr,"FieldData");


        for(var i=0;i<allZones.length;i++){
        try{
            zoneNrS=allZones[i];
            style="color:"+(zones.getBlock(zoneNrS)?"lightgrey;":"black;");
            tr=createElement("tr",{},table);
            createElement("td",{"style":style},tr,zoneNrS);
            switch(zones.getLocation(zoneNrS).location){
            case "forestry":{ prType=1; } break;
            case "windmill":{ prType=3; } break;
            case "megafield":{ prType=4; } break;
            default:{ prType=0; }
            }
            if(currZoneType=zones.getBuilding(zoneNrS)){
                createElement("td",{"style":style},tr,getBuildingName(currZoneType)+" ("+currZoneType+","+BUILDINGTYPE[currZoneType]+")");
            }else{
                createElement("td",{"style":style},tr,"");
            }
            createElement("td",{"style":style},tr,zones.getBlock(zoneNrS));
            createElement("td",{"style":style},tr,(isNaN(zoneNrS)?!!zoneAddToGlobalTime[zoneNrS]:true).toString());
            createElement("td",{"style":style},tr,isNaN(zones.getAnimals(zoneNrS))?"":numberFormat(zones.getAnimals(zoneNrS)));
            createElement("td",{"style":style},tr,isNaN(zones.getBonus(zoneNrS))?"":(numberFormat(zones.getBonus(zoneNrS))+"%"));
            td=createElement("td",{"style":style},tr);
            if(zones.getBonusSpecial(zoneNrS)){
                createElement("span",{},td,numberFormat(zones.getBonusSpecial(zoneNrS)[1])+"%");
                produktPic(0,zones.getBonusSpecial(zoneNrS)[0],td);
                createElement("span",{},td,"("+numberFormat(zones.getBonusSpecial(zoneNrS)[0])+")");
            }
            td=createElement("td",{"style":style},tr);
            if(help=zones.getEndproduct(zoneNrS)){
                produktPic(help[0],help[1],td);
                createElement("span",{},td,"("+help[0]+","+help[1]+")");
            }
            help=zones.getEndtime(zoneNrS);
            td=createElement("td",{"style":style+(help<now?"font-weight:bold;":"")},tr);
            if(help){
                if(help==NEVER){
                    createElement("div",{},td,"NEVER");
                } else {
                    createElement("div",{},td,getDateText(help));
                    createElement("div",{},td,getDaytimeStr(help,false,true));
                }
            }
            help=zones.getWatertime(zoneNrS);
            td=createElement("td",{"style":style+(help<now?"font-weight:bold;":"")},tr);
            if(help){
                if(help==NEVER){
                    createElement("div",{},td,"NEVER");
                } else {
                    createElement("div",{},td,getDateText(help));
                    createElement("div",{},td,getDaytimeStr(help,false,true));
                }
            }
            td=createElement("td",{"style":style},tr);
            if(help=zones.getCrop(zoneNrS)){
                for(var j=0;j<help.length;j++){
                    div=createElement("div",{"style":"white-space:nowrap;"},td);
                    produktPic(help[j][0],help[j][1],div);
                    createElement("span",{},div,numberFormat(help[j][2])+"(");
                    pointsFormat(help[j][3],"span",div);
                    createElement("span",{},div,")");
                }
            }
            td=createElement("td",{"style":style},tr);
            if(help=zones.getProduction(zoneNrS)){
                createElement("div",{"style":"white-space:nowrap;"},td,print_r(help));
            }
        }catch(err){ GM_logError("showDataAllZones","","zoneNrS="+zoneNrS,"(loop) "+err); }
        }
        container=null;div=null;
        table=null;tr=null;td=null;
    }catch(err){ GM_logError("showDataAllZones","","",err); }
    }
    GM_registerMenuCommand(getText("adviser")+" Show Data: Zones", showDataAllZones);

    /* // SHOW DATA: FORESTRY FARMIES
    err_trace="Show data forestry farmies";
    function showDataForestryFarmies(){
        var div=createElement("div",{"style":"z-index:995;position:fixed;top:0;background-color:white;height:800px;overflow:auto;padding-right:40px;"},ALL);
        var newimg=createElement("img",{"class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:0px;width:20px;height:20px;"},div);
        newimg.addEventListener("click",function(){ removeElement(this.parentNode); },false);
        var table=createElement("table",{"border":"1"},div);
        var tr=createElement("tr",{},table);
        createElement("td",{"style":"max-width:120px;"},tr,"ID");
        for(var k in prodName[1]){
            if(!prodName[1].hasOwnProperty(k)){continue;}
            if(k>=500){continue;}
            produktPic(1,k,createElement("td",{"style":"max-width:120px;"},tr));
        }
        createElement("td",{"style":"max-width:120px;"},tr,"price");
        createElement("td",{"style":"max-width:120px;"},tr,"points");

        var tr=createElement("tr",{},table);
        createElement("td",{"style":"max-width:120px;"},tr,"ID");
        for(var k in prodName[1]){
            if(!prodName[1].hasOwnProperty(k)){continue;}
            if(k>=500){continue;}
            createElement("td",{"style":"max-width:120px;"},tr,k);
        }

        if(unsafeWindow.forestry_production_products.length>0){
            var tr=createElement("tr",{},table);
            createElement("td",{"style":"max-width:120px;"},tr,"{1}");
            for(var k in prodName[1]){
                if(!prodName[1].hasOwnProperty(k)){continue;}
                if(k>=500){continue;}
                createElement("td",{"style":"max-width:120px;"},tr,unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k]?unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k][1]:"-");
            }
            var tr=createElement("tr",{},table);
            createElement("td",{"style":"max-width:120px;"},tr,"{7}");
            for(var k in prodName[1]){
                if(!prodName[1].hasOwnProperty(k)){continue;}
                if(k>=500){continue;}
                createElement("td",{"style":"max-width:120px;"},tr,unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k]?unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k][7]:"-");
            }
        }

        var farmies=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_forestry_farmies"),"showDataForestryFarmies/forestry_farmies",{});
        for(var v in farmies){
            if(!farmies.hasOwnProperty(v)){continue;}
            tr=createElement("tr",{},table);
            createElement("td",{},tr,v);
            farmies[v]["products"].sort(function(a,b){return -1*((parseInt(b["product"],10)>parseInt(a["product"],10))-(parseInt(b["product"],10)<parseInt(a["product"],10)));});
            for(var k in prodName[1]){
                if(!prodName[1].hasOwnProperty(k)){continue;}
                if(k>=500){continue;}
                td=createElement("td",{"style":"white-space:nowrap;"},tr);
                for(var i in farmies[v]["products"]){
                    if(!farmies[v]["products"].hasOwnProperty(i)){continue;}
                    if(farmies[v]["products"][i]["product"]==k){
                        createElement("span",{},td,farmies[v]["products"][i]["amount"]);
                        //createElement("span",{},td," x ");
                        //createElement("span",{},td,farmies[v]["products"][i]["product"]);
                        produktPic(1,farmies[v]["products"][i]["product"],td);
                    }

                }
            }
            createElement("td",{"style":"white-space:nowrap;"},tr,farmies[v]["price"]);
            createElement("td",{"style":"white-space:nowrap;"},tr,farmies[v]["points"]);
        }
        farmies=null;

        var tr=createElement("tr",{},table);
        createElement("td",{"style":"max-width:120px;"},tr,"ID");
        for(var k in prodName[1]){
            if(!prodName[1].hasOwnProperty(k)){continue;}
            if(k>=500){continue;}
            produktPic(1,k,createElement("td",{"style":"max-width:120px;"},tr));
        }
        createElement("td",{"style":"max-width:120px;"},tr,"price");
        createElement("td",{"style":"max-width:120px;"},tr,"points");

        var tr=createElement("tr",{},table);
        createElement("td",{"style":"max-width:120px;"},tr,"ID");
        for(var k in prodName[1]){
            if(!prodName[1].hasOwnProperty(k)){continue;}
            if(k>=500){continue;}
            createElement("td",{"style":"max-width:120px;"},tr,k);
        }

        if(unsafeWindow.forestry_production_products.length>0){
            var tr=createElement("tr",{},table);
            createElement("td",{"style":"max-width:120px;"},tr,"{1}");
            for(var k in prodName[1]){
                if(!prodName[1].hasOwnProperty(k)){continue;}
                if(k>=500){continue;}
                createElement("td",{"style":"max-width:120px;"},tr,unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k]?unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k][1]:"-");
            }
            var tr=createElement("tr",{},table);
            createElement("td",{"style":"max-width:120px;"},tr,"{7}");
            for(var k in prodName[1]){
                if(!prodName[1].hasOwnProperty(k)){continue;}
                if(k>=500){continue;}
                createElement("td",{"style":"max-width:120px;"},tr,unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k]?unsafeWindow.forestry_production_products[prodTyp[1][k].replace("f","")][k][7]:"-");
            }
        }
    }
    GM_registerMenuCommand(getText("adviser")+" Show Data: forestry Farmi", showDataForestryFarmies);
    */

    // NPC-shop
    err_trace="NPC shop";
    // TODO: function not existing anymore
    unsafeOverwriteFunction("shopDialog",function(e,d){
        try{
            unsafeWindow._shopDialog(e,d);
        }catch(err){GM_logError("_shopDialog","","",err);}
        try{
            $("shopdialog_amount").addEventListener("keyup",function(event){
                try{
                    if (event.keyCode==13){
                        click(this.nextElementSibling);
                    }
                }catch(err){ GM_logError("shopDialog.keyup","","",err); }
            },false);
        }catch(err){GM_logError("shopDialog","","",err);}
    });
    // Market
    err_trace="Market";
    valKauflimit=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimit"),"do_main/valKauflimit",[[85,'990000'],110]);
    valKauflimitNPC=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valKauflimitNPC",true);
    highlightProducts=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlightProducts"),"do_main/highlightProducts",[false,{}]);
    highlightUser=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_highlight"),"do_main/highlightUser",{});
    highlightUser[FARMNAME]="104e8b";
    valNimmBeob=GM_getValue(COUNTRY+"_"+SERVER+"_valNimmBeob",true);
    valUse3TimesNpcPrices=GM_getValue(COUNTRY+"_"+SERVER+"_valUse3TimesNpcPrices",true);

    valVerkaufLimitDown=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitDown",95);
    valVerkaufLimitUp=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVerkaufLimitUp",130);
    valJoinPreise=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valJoinPreise",false);
    lastOffer=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lastOffer"),"do_main/lastOffer",[]);
    protectMinRack=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valProtectMinRack",false);
    ownMarketOffers=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_ownMarketOffers"),"do_main/ownMarketOffers",[]);

    // var mode=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeMarket","cveoz");
    function do_market(){
    // GM_log("function do_market");
    try{
        var err_trace="Init";


        // Berater Information Line
        err_trace="market_beraterline";
        var market_beraterline=$("market_beraterline");
        if(!market_beraterline){
            market_beraterline=createElement("div",{"id":"market_beraterline","style":"position:absolute;width:630px;height:40px;bottom:-40px;padding:0 20px 20px 20px;background:url('"+GFX+"market/market_back.jpg') repeat scroll 0px -470px transparent;"},$("market"));
        }
        market_beraterline.innerHTML="";
        for(var i=0;i<7;i++){
            createElement("div",{"style":"float:left;height:40px;width:90px;"},market_beraterline);
        }

        // loadProductData();
        var candtable; //document.getElementsByTagName("table");
        var candtr; //candtable[0].getElementsByTagName("tr");
        var row,row_title,canddiv,canda,candtd,newa,newinput,newspan,newdiv,newdiv1;

        /*
        var marktButtons=new Array();
        marktButtons[0]=document.querySelector('div[onclick*="\'marktstand.php\'"]'); // market stall
        marktButtons[1]=document.querySelector('div[onclick*="\'markt.php?filter=1&guild=1\'"]');   // club offers
        marktButtons[2]=document.querySelector('div[onclick*="\'markt.php?show=overview\'"]');  // overview
        marktButtons[3]=document.querySelector('div[onclick*="\'markt.php\'"]');    // current offers
        for(var v=0;v<marktButtons.length;v++){
            if(marktButtons[v]){
                marktButtons[v].setAttribute("class","link hoverBlack");
                marktButtons[v].id="marketButton_"+["marktstand","guild","overview","current"][v];
            }
        }
        */
        /*
        // Market mode
        newdiv=createElement("div",{"id":"offertypeselector","style":"position:absolute;top:0;left:500px;-moz-user-select:none;"},ALL);
        newdiv.addEventListener("mouseover",function(event){
            var mouseOverText=event.target.getAttribute("mouseOverText");
            if(mouseOverText){
                mouseOverText='<div>'+getText("click")+'&nbsp;/&nbsp;'+getText("clickCtrl")+'</div><div>'+mouseOverText+'</div>';
                toolTip.show(event,mouseOverText);
            }
        },false);
        var newdiv1=createElement("div",{"mouseOverText":getText("category_v"),"class":"link","style":"display:inline-block;height:20px;width:26px;background:url('"+GFX+"racksort2.jpg') repeat scroll -10px 0px transparent;"},newdiv);
        if (mode.match(/v/)){
            newdiv1.style.backgroundPosition="-10px -20px";
        }else{
            newdiv1.addEventListener("mouseout",function(){this.style.backgroundPosition="-10px 0px";},false);
            newdiv1.addEventListener("mouseover",function(){this.style.backgroundPosition="-10px -20px";},false);
        }
        newdiv1.addEventListener("click",function(event){
            if(event.ctrlKey){
                if(mode.match(/v/)){mode=mode.replace(/v/,"");}
                else{mode += "v";}}
            else{mode="v";}
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeMarket",mode);
            location.href=location.href;
        },false);

        newdiv1=createElement("div",{"mouseOverText":getText("category_c")+"<br>"+getText("category_e"),"class":"link","style":"display:inline-block;height:20px;width:26px;background:url('"+GFX+"racksort2.jpg') repeat scroll -62px 0px transparent;"},newdiv);
        if (mode.match(/c/)&&mode.match(/e/)){
            newdiv1.style.backgroundPosition="-62px -20px";
        }else{
            newdiv1.addEventListener("mouseout",function(){this.style.backgroundPosition="-62px 0px";},false);
            newdiv1.addEventListener("mouseover",function(){this.style.backgroundPosition="-62px -20px";},false);
        }
        newdiv1.addEventListener("click",function(event){
            if(event.ctrlKey){
                if(mode.match(/ce/)){mode=mode.replace(/ce/,"");}
                else{mode += "ce";}}
            else{mode="ce";}
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeMarket",mode);
            location.href=location.href;
        },false);

        newdiv1=createElement("div",{"mouseOverText":getText("category_o"),"class":"link","style":"display:inline-block;height:20px;width:26px;background:url('"+GFX+"racksort2.jpg') repeat scroll -62px 0px transparent;"},newdiv);
        if (mode.match(/o/)&&mode.match(/o/)){
            newdiv1.style.backgroundPosition="-62px -20px";
        }else{
            newdiv1.addEventListener("mouseout",function(){this.style.backgroundPosition="-62px 0px";},false);
            newdiv1.addEventListener("mouseover",function(){this.style.backgroundPosition="-62px -20px";},false);
        }
        newdiv1.addEventListener("click",function(event){
            if(event.ctrlKey){
                if(mode.match(/o/)){mode=mode.replace(/o/,"");}
                else{mode += "o";}}
            else{mode="o";}
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeMarket",mode);
            location.href=location.href;
        },false);

        newdiv1=createElement("div",{"mouseOverText":getText("category_z"),"class":"link","style":"display:inline-block;height:20px;width:26px;background:url('"+GFX+"racksort2.jpg') repeat scroll -36px 0px transparent;"},newdiv);
        if (mode.match(/z/)){
            newdiv1.style.backgroundPosition="-36px -20px";
        }else{
            newdiv1.addEventListener("mouseout",function(){this.style.backgroundPosition="-36px 0px";},false);
            newdiv1.addEventListener("mouseover",function(){this.style.backgroundPosition="-36px -20px";},false);
        }
        newdiv1.addEventListener("click",function(event){
            if(event.ctrlKey){
                if(mode.match(/z/)){mode=mode.replace(/z/,"");}
                else{mode += "z";}}
            else{mode="z";}
            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_modeMarket",mode);
            location.href=location.href;
        },false);
        */
        var pageId=unsafeWindow.market_filter_pid;
        var userId=unsafeWindow.market_filter_name;
        var marktoffers_rows=$("marktoffers_rows");
        if(unsafeWindow.market_filter_own==0){
            // Market page
            err_trace="Market page";
            var nothingToBuy=true;

            // Page of a single product
            if((pageId!=-1)&&(userId=="")&&(unsafeWindow.market_guild_filter==0)){
                err_trace="Market page, single product";
                var preisKlasse=0;
                // $("offertypeselector").style.display="none";
                market_beraterline.setAttribute("prod",pageId);
                newdiv1=createElement("div",{},market_beraterline.children[0]);
                newdiv1.addEventListener("mouseover",function(event){
                    showGoToMarketToolTip(event,this.parentNode.parentNode.getAttribute("prod"));
                },false);
                produktPic(0,pageId,newdiv1);
                newspan=createElement("div",{"style":"display:inline-block;"},newdiv1,numberFormat(prodStock[0][pageId],0));

                // NPC price
                newdiv1=createElement("div",{},market_beraterline.children[0]);
                err_trace="Market page, single product, NPC";
                if(NPC[0][pageId]){
                    if(!isNaN(NPC[0][pageId])){
                        newspan=createElement("span",{},newdiv1,"NPC&nbsp;"+numberFormat(NPC[0][pageId],2));
                    }else if (NPC[0][pageId].match(/^f/)){
                        newspan=createElement("span",{},newdiv1,"*NPC*&nbsp;"+numberFormat(parseFloat(NPC[0][pageId].replace("f",""),10),2));
                    }else if (NPC[0][pageId].match(/^c/)){
                        newspan=createElement("span",{},newdiv1,"NPC&nbsp;<span style='display:inline-block;vertical-align:bottom;'>"+coinsFormat(parseInt(NPC[0][pageId].replace("c",""),10)).innerHTML+"</span>");
                        //coinsFormat(parseInt(NPC[0][pageId].replace("c",""),10),newdiv).style.cssFloat="right";
                    }
                    if((npcSaison[pageId]!=undefined)&&(!npcSaison[pageId])){
                        newspan.style.textDecoration="line-through";
                        newspan.setAttribute("class","hoverNoTextDecoration");
                    }
                }else{
                    createElement("span",{},newdiv1,"NPC&nbsp;--");
                }
                // Link to previous/next product
                err_trace="Market page, single product, prev/next";
                var c=0;
                while ((c<prodNameSort[0].length)&&(prodNameSort[0][c]!=pageId)){ c++; }
                var pageIdVor=c-1;
                if(pageIdVor<0){ pageIdVor+=prodNameSort[0].length; }
                while(prodBlock[0][prodNameSort[0][pageIdVor]].match(/[ltv]/)){
                    pageIdVor--;
                    if(pageIdVor<0){ pageIdVor+=prodNameSort[0].length; }
                }
                pageIdVor=prodNameSort[0][pageIdVor];
                var pageIdNach=c+1;
                if(pageIdNach>prodNameSort[0].length-1){ pageIdNach=0; }
                while(prodBlock[0][prodNameSort[0][pageIdNach]].match(/[ltv]/)){
                    pageIdNach++;
                    if(pageIdNach>prodNameSort[0].length-1){ pageIdNach=0; }
                }
                pageIdNach=prodNameSort[0][pageIdNach];
                newdiv1=createElement("div",{},market_beraterline.children[0]);
                newspan=createElement("div",{"class":"link","style":"display:inline-block;padding-right:2px;","prod":pageIdVor},newdiv1,"<<");
                newspan.addEventListener("click",function(event){ showMarket(this.getAttribute("prod")); },false);
                newspan.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                newspan=createElement("div",{"class":"link","style":"display:inline-block;","prod":pageIdNach},newdiv1,">>");
                newspan.addEventListener("click",function(event){ showMarket(this.getAttribute("prod")); },false);
                newspan.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);

                // Total amount of all offers
                // newtd=createElement("td",{"align":"right","style":"border-top:1px solid;"});
                // newtd.innerHTML=numberFormat(sumTotal,0);
                // candtr[candtr.length-1].insertBefore(newtd,candtr[candtr.length-1].firstElementChild);

                // Set price field
                err_trace="Market page, single product, set price";
                newdiv1=createElement("div",{},market_beraterline.children[1]);
                newinput=createElement("input",{"id":"marketButton_price","value":numberFormat(gut[pageId],2),"class":"text","maxlength":"10","style":"width:65px;text-align:right;background-color:#589456;"},newdiv1);
                newinput.addEventListener("mouseover",function(event){ toolTip.show(event,getText("price")+"<br>"+getText("observed")+":&nbsp;"+moneyFormat(gutBeob[pageId])); },false);
                if(valNimmBeob){
                    newinput.readOnly=true;
                }else{
                    newinput.addEventListener("focus",function(){
                        this.style.backgroundColor="white";
                        unsafeWindow.clearMarketTimer();
                    },false);
                    newinput.addEventListener("blur",function(){
                        this.style.backgroundColor="#589456";
                        if(!unsafeWindow.market_timer['update']){ unsafeWindow.market_timer['update'] = unsafeWindow.setInterval("marketTimer()",1000); }
                    },false);
                    newinput.addEventListener("change",function(){
                        var currId=unsafeWindow.market_filter_pid;
                        var preis=Math.max(0,parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10));
                        var thisNode=this;
                        var yesFkt = function(){
                            gut[currId]=preis;
                            GM_setValueCache(COUNTRY+"_"+SERVER+"_gut",implode(gut,"marketButton_price/gut"));
                            raiseEventTop("gameChangedGut");
                            unsafeWindow.showOffers();
                            if(!unsafeWindow.market_timer['update']){ unsafeWindow.market_timer['update'] = unsafeWindow.setInterval("marketTimer()",1000); }
                        };
                        var noFkt = function(){
                            thisNode.value=numberFormat(gut[currId],2);
                            thisNode=null;
                        };
                        if(preis==0){
                            alert2(getText("alertSetPriceNone").replace(/%PRODUCT%/,prodName[0][currId]),getText("yes"),getText("no"),yesFkt,noFkt);
                        }else if((!isNaN(NPC[0][currId]))&&(preis>NPC[0][currId])){
                            alert2(getText("alertSetPriceOverNPC").replace(/%PRODUCT%/,prodName[0][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%NPC%/,moneyFormat(NPC[0][currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                        }else if ((gutBeob[currId]!=undefined)&&(gutBeob[currId]>0)){
                            if(preis<0.7*gutBeob[currId]){
                                alert2(getText("alertSetPriceUnderObs").replace(/%PRODUCT%/,prodName[0][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%OBS%/,moneyFormat(gutBeob[currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                            }else if (1.3*gutBeob[currId]<preis){
                                alert2(getText("alertSetPriceOverObs").replace(/%PRODUCT%/,prodName[0][currId]).replace(/%PRICE%/,moneyFormat(preis)).replace(/%OBS%/,moneyFormat(gutBeob[currId])),getText("yes"),getText("no"),yesFkt,noFkt);
                            }else{
                                yesFkt();
                            }
                        }else{
                            yesFkt();
                        }
                    },false);
                }

                // Statistic server
                err_trace="Market page, single product, Statistic";
                if (STAT_VIEW && STAT_VIEW[COUNTRY]){
                    newdiv1=createElement("div",{"id":"marketButton_stats","class":"link hoverBlack","style":"position:relative;width:80px;height:40px;background: url('"+GFX+"stadt/uebersicht.gif') repeat scroll 0% 0% transparent;"},market_beraterline.children[2]);
                    createElement("div",{"style":"position:absolute;top:13px;width:80px;font-weight:bold;text-align:center;"},newdiv1,getText("statistics"));
                    newdiv1.addEventListener("click",function(){
                        showStatisticFullscreen(unsafeWindow.market_filter_pid);
                    },false);
                }
            }else{
                var preisKlasse=2;
            }

            if(pageId!=-1){
                //Link to NPC-Shop
                err_trace="Link to NPC";
                if(nothingToBuy && (unsafeWindow.marketlist_currentpage==1) && ["fl","hr","v"].contains(prodTyp[0][pageId]) && $top("shop")){
                    newdiv1=createElement("div",{"id":"marketButton_npc","class":"link hoverBlack","style":"position:relative;width:80px;height:40px;background: url('"+GFX+"stadt/uebersicht.gif') repeat scroll 0 0 transparent;"},market_beraterline.children[3]);
                    createElement("div",{"style":"position:absolute;top:13px;width:80px;font-weight:bold;text-align:center;"},newdiv1,getText("seedVendorShort"));
                    newdiv1.addEventListener("click",function(event){
                        var prod=this.parentNode.parentNode.getAttribute("prod");
                        showSeedVendor(prod);
                    },false);
                }
            }

            // Page of a single user
            /*
            if(userId!=""){
                canda=candtr[3].getElementsByTagName("a");
                if(canda[1]){ var thisUser=canda[1].innerHTML; }
                newtr=createElement("tr",{},candtable[0]);
                newtd=createElement("td",{},newtr);
                if (thisUser){igm(thisUser,newtd);}
                stats(userId,newtd);
            }
            */
        }

        // Redesign of table
        err_trace="Redesign";
        var currId, currOffer, time, sum=[0,0];
        for(var v=0;v<marktoffers_rows.childElementCount;v++){
            err_trace="Redesign, row "+v;
            row=marktoffers_rows.children[v];
            if(row.childElementCount<6){ continue; }
            currId=/market_price_tt(\d+)/.exec(row.children[2].getAttribute("onmouseover"))[1];
            currOffer=null;
            for(var i=0;i<unsafeWindow.market_offers.length;i++){
                if(currId==unsafeWindow.market_offers[i].id){
                    currOffer=unsafeWindow.market_offers[i];
                    break;
                }
            }
            if(!currOffer){ continue; }
            row.children[3].removeAttribute("onmouseover");
            row_title=$("market_amount_tt"+currOffer["id"]);
            help=createElement("div",{},false,row_title.innerHTML);
            row_title.innerHTML="";
            row_title.appendChild(help);
            // TODO(Seberoth): What is time now?
            if(currOffer["zeit"]){
                time=parseInt(currOffer["zeit"],10)+0;
                if(countDays(time,now)==0){
                    createElement("div",{},row_title,getText("sinceX").replace(/%1%/,getDaytimeStr(time,false,true)+"&nbsp;"+getText("shortOClock")));
                }else{
                    createElement("div",{},row_title,getText("sinceX").replace(/%1%/,getFormattedDateStr(time,2,false)+",&nbsp;"+getDaytimeStr(time,false,true)+"&nbsp;"+getText("shortOClock")));
                }
            }
            var prodId=parseInt(currOffer["p"],10);
            var menge=parseInt(currOffer["a"],10);
            var preis=parseFloat(currOffer["pr"],10);
            if((pageId!=-1)&&(userId=="")&&(unsafeWindow.market_guild_filter==0)){
                createElement("div",{},row_title,getText("above")+": "+numberFormat(sum[0]));
            }
            sum[0] += menge;
            sum[1] += menge*preis;
            row.children[2].innerHTML=numberFormat(preis,2);
            row.setAttribute("offerId",currOffer["id"]);
            //GutPreis zeigen
            newdiv=createElement("div",{},false,numberFormat(gut[prodId],2));
            row.insertBefore(newdiv,row.children[6]);
            // own offers
            if((unsafeWindow.market_filter_own==0)&&(currOffer["s"])){
                row.children[5].setAttribute("class","market_buy market_noicon");
                row.children[5].setAttribute("onclick","");
            }
            if(NPC[0][prodId]&&((npcSaison[prodId]===undefined)||(npcSaison[prodId]))&&(preis>=NPC[0][prodId])){
                if(preisKlasse<1){
                    preisKlasse++;
                    row.style.borderTop="2px solid white";
                }
                if(valKauflimitNPC&&row.children[5]){ //zu teuer Link entfernen (NPC)
                    if(unsafeWindow.market_filter_own==0){
                        row.children[5].setAttribute("class","market_buy market_noicon");
                        row.children[5].setAttribute("onclick","");
                    }
                    createElement("div",{},row_title,getText("overNPCprice")+" ("+numberFormat(NPC[0][prodId],2)+")");
                }
                row.style.opacity="0.5";
                row.children[5].style.fontStyle="italic";
                if (0.9*preis>NPC[0][prodId]){ //111% NPC
                    row.style.fontStyle="italic";
                    if(preisKlasse<2){
                        preisKlasse++;
                        row.style.borderTop="2px dashed white";
                    }
                }
            }else if(gut[prodId]!=0){
                var help=100*preis/gut[prodId];
                if(help<=valKauflimit[0][0]){
                    if(row.children[5]){ row.children[5].style.backgroundColor="#"+valKauflimit[0][1]; } //billig Angebot highlight
                }else if(help>valKauflimit[1]){ //zu teuer Link entfernen (Limit)
                    if(row.children[5]){
                        if(unsafeWindow.market_filter_own==0){
                            row.children[5].setAttribute("class","market_buy market_noicon");
                            row.children[5].setAttribute("onclick","");
                        }
                        createElement("div",{},row_title,getText("overX").replace(/%1%/,valKauflimit[1]+"%"));
                    }
                    row.style.opacity="0.7";
                }
            }
            if(row.children[5].getAttribute("class").search(/market_noicon/)==-1){ nothingToBuy=false; }

            if (row.children[4].children[0]&&(highlightUser[row.children[4].children[0].innerHTML.replace(/[ ]\[.*\]/,"")])){
                row.children[4].children[0].style.backgroundColor="#"+highlightUser[row.children[4].children[0].innerHTML.replace(/[ ]\[.*\]/,"")];
            }
            if (highlightProducts[1][prodId]){
                row.children[1].style.backgroundColor="#20b2aa";
            }
            row.addEventListener("mouseover",function(event){ toolTip.show(event,$("market_amount_tt"+this.getAttribute("offerId")).innerHTML); },false);
        }
        if((unsafeWindow.market_filter_own==1)&&(userId=="")&&(unsafeWindow.market_guild_filter==0)){
            createElement("div",{},market_beraterline.children[0],"∑&nbsp;"+moneyFormatLimit(sum[1],100000));
        }
        // No offers
        if(sum[0]==0){
            // Page of a single product
            if((unsafeWindow.market_filter_own==0)&&(pageId!=-1)&&(userId=="")&&(unsafeWindow.market_guild_filter==0)){
                newdiv=createElement("div",{"style":"padding:2px;"},marktoffers_rows);
                createElement("div",{"style":"float:left;","class":"kp"+pageId},newdiv);
                createElement("div",{"onclick":"market_filter_name=''; market_filter_pid="+pageId+"; showOffers();","class":"market_product underline link","title":prodName[0][pageId]},newdiv,prodName[0][pageId]);
                if(NPC[0][pageId]){
                    if((npcSaison[pageId]!=undefined)&&(!npcSaison[pageId])){
                        createElement("div",{"class":"market_price"},newdiv);
                        createElement("div",{"class":"market_amount"},newdiv);
                        createElement("div",{"class":"market_seller"},newdiv);
                    }else if(!isNaN(NPC[0][pageId])){
                        createElement("div",{"class":"market_price"},newdiv,numberFormat(NPC[0][pageId],2));
                        createElement("div",{"class":"market_amount"},newdiv,"0");
                        newdiv1=createElement("div",{"class":"market_seller"},newdiv);
                        createElement("span",{},newdiv1,"NPC");
                    }else if (NPC[0][pageId].match(/^f/)){
                        createElement("div",{"class":"market_price"},newdiv,numberFormat(3*parseFloat(NPC[0][pageId].replace("f",""),10),2));
                        createElement("div",{"class":"market_amount"},newdiv,"0");
                        newdiv1=createElement("div",{"class":"market_seller"},newdiv);
                        createElement("span",{},newdiv1,"*NPC*");
                    }else{
                        createElement("div",{"class":"market_price"},newdiv);
                        createElement("div",{"class":"market_amount"},newdiv);
                        createElement("div",{"class":"market_seller"},newdiv);
                    }
                }else{
                    createElement("div",{"class":"market_price"},newdiv);
                    createElement("div",{"class":"market_amount"},newdiv);
                    createElement("div",{"class":"market_seller"},newdiv);
                }
            }
        }
        marktoffers_rows=null;
        // Buttons
        err_trace="buttons";
        /*
        newdiv=createElement("div",{"id":"marketButton_current","class":"link hoverBlack","style":"position:absolute;top:475px;left:545px;width:80px;height:40px;font-size:8pt;background: url('"+GFX+"stadt/uebersicht.gif') repeat scroll 0% 0% transparent;"},ALL);
        newdiv.addEventListener("click",function(){showMarket();},false);
        createElement("div",{"style":"position:absolute;top:7px;left:7px;width:67px;color:white;font-weight: bold;"},newdiv,getText("currentOffers"));
        */
        newdiv1=createElement("div",{"id":"marketButton_tablePrices","class":"link hoverBlack","style":"position:relative;width:80px;height:40px;background:url('"+GFX+"stadt/uebersicht.gif') repeat scroll 0% 0% transparent;"},market_beraterline.children[4]);
        newdiv1.addEventListener("click",function(){
            unsafeWindow.buildInfoPanel("stock",{"page":1,"prodType":0,"filterCategory":unsafeWindow.market_filter_pid?prodTyp[0][unsafeWindow.market_filter_pid]:null});
        },false);
        createElement("div",{"style":"position:absolute;top:13px;width:80px;font-weight:bold;text-align:center;"},newdiv1,getText("prices"));

        newdiv1=createElement("div",{"id":"marketButton_tableStock","class":"link hoverBlack","style":"position:relative;width:80px;height:40px;background:url('"+GFX+"stadt/uebersicht.gif') repeat scroll 0% 0% transparent;"},market_beraterline.children[5]);
        newdiv1.addEventListener("click",function(){
            unsafeWindow.buildInfoPanel("stock",{"page":2,"prodType":0,"filterCategory":unsafeWindow.market_filter_pid?prodTyp[0][unsafeWindow.market_filter_pid]:null});
        },false);
        createElement("div",{"style":"position:absolute;top:13px;width:80px;font-weight:bold;text-align:center;"},newdiv1,getText("stock"));

        market_beraterline=null;
        canda=null;candtable=null;candtr=null;candtd=null;canddiv=null;newa=null;newinput=null;newspan=null;newdiv=null;newdiv1=null;
    }catch(err){ GM_logError("do_market","","err_trace=\""+err_trace+"\"",err); }
    }
    unsafeOverwriteFunction("showOffers",function(page){
        try{
            unsafeWindow._showOffers(page);
        }catch(err){GM_logError("_showOffers","","",err);}
        try{
            do_market();
            // GM_log("unsafeWindow.market_offers:\n"+print_r(unsafeWindow.market_offers,"",true,"\n"));
            raiseEvent("gameOpenMarket");
        }catch(err){GM_logError("showOffers","","",err);}
    });
    unsafeOverwriteFunction("openMarketNewOffer",function(){
        try{
            unsafeWindow._openMarketNewOffer();
        }catch(err){GM_logError("_openMarketNewOffer","","",err);}
        try{
            var err_trace="Init";
            var currId=unsafeWindow.market_filter_pid;
            if(currId!=-1){
                if(lastOffer[currId]){
                    $("marketnewoffer_amount").value=lastOffer[currId][0];
                    $("marketnewoffer_price1").value=lastOffer[currId][1];
                    $("marketnewoffer_price2").value=(lastOffer[currId][2]<10?"0":"")+lastOffer[currId][2];
                    if($("marketnewoffer_price_comb")){ $("marketnewoffer_price_comb").value=lastOffer[currId][1]+delimDeci+(lastOffer[currId][2]<10?"0":"")+lastOffer[currId][2]; }
                }else{
                    $("marketnewoffer_amount").value=0;
                }
                keyup($("marketnewoffer_amount"));

                /*
                if ($("produkt_preis1")){
                    $("lbl_produkt_max").setAttribute("class",$("lbl_produkt_max").getAttribute("class")+" link");
                    $("lbl_produkt_max").addEventListener("click",function(){
                        $("produkt_anzahl").value=this.innerHTML.replace(regDelimThou,"");
                        keyup($("produkt_anzahl"));
                    },false);
                    $("produkt_anzahl").addEventListener("focus",checkPreis,false); // fired when offer-div opens
                    $("preisschild").addEventListener("keyup",function(event){
                        checkPreis();
                        if (event.keyCode==13){
                            var submitButton=$("preisschild").querySelector("#verkaufe_markt");
                            if(submitButton.style.display!="none"){ click(submitButton); }
                            submitButton=null;
                        }
                    },false);
                    if(valJoinPreise){
                        $("produkt_preis1").setAttribute("tabindex","0");
                        $("produkt_preis2").setAttribute("tabindex","0");
                        var newinput=createElement("input",{"id":"produkt_preis_ganz","type":"text","style":"position:absolute;left:0;top:0;background-color:#002300;color:#f0ffef;width:131px;text-align:right;border:1px solid #555;","tabindex":"2","maxlength":"9","name":"p_preis_ganz","class":"text thuge"},$("produkt_preis1").parentNode);
                        newinput.addEventListener("keyup",function(event){
                            if (event.keyCode==13){
                                var submitButton=$("preisschild").querySelector("#verkaufe_markt");
                                if(submitButton.style.display!="none"){ click(submitButton); }
                                submitButton=null;
                            }else{
                                var preis=this.value.replace(regDelimThou,"").replace(regDelimDeci,".");
                                var preis1=parseInt(preis,10);
                                var preis2=(preis.search(/\./)!=-1?(preis+"00").substr(1+preis.search(/\./),2):"00");
                                $("produkt_preis1").value=preis1;
                                $("produkt_preis2").value=preis2;
                                keyup($("produkt_preis1"));
                            }
                        },false);
                        newinput=null;
                    }
                }
                */

                // coins
                function checkPreisCoins(){
                    //GM_log("checkPreisCoins "+oldPricesInserted);
                    window.setTimeout(function(){ // first let finish the functions
                        if(oldPricesInserted==0){ //old offer set
                            lastOffer[0]=[parseInt($("coinsanzahl").value,10),parseInt($("coinspreis").value,10),$("coinssollpreis").checked];
                            try{
                                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lastOffer",implode(lastOffer,"checkPreisCoins/lastOffer"));
                            }catch(err){ GM_logError("checkPreisCoins","","",err); }
                        }else{
                            oldPricesInserted=0;
                            if(lastOffer[0]){
                                $("coinsanzahl").value=lastOffer[0][0];
                                $("coinspreis").value=lastOffer[0][1];
                                $("coinssollpreis").checked=lastOffer[0][2];
                                unsafeWindow.chkAmount();
                                unsafeWindow.calcMarketPrice();
                            }
                        }
                        var currPreis=parseInt($("coinsmarktpreis").innerHTML,10);
                        var currAnzahl=parseInt($("coinsanzahl").value,10);
                        var currUserPreis=parseInt($("coinsuserpreis").innerHTML,10);

                        if(protectMinRack){ //rack amount protection
                            prodStock[0][0]=parseInt($("lbl_produkt_max").innerHTML.replace(regDelimThou,""),10);
                            if(currAnzahl>prodStock[0][0]-prodMinRack[0][0]){
                                currAnzahl=Math.max(0,prodStock[0][0]-prodMinRack[0][0]);
                                $("coinsanzahl").value=currAnzahl;
                            }
                        }
                        var newtable=createElement("table");
                        var newtr;
                        $("divBerInfoCoins").replaceChild(newtable,$("divBerInfoCoins").getElementsByTagName("table")[0]);
                        if (gut[0]){
                            $("coinspreisschild").querySelector("#verkaufe_markt").style.display=(((100*currPreis>valVerkaufLimitDown*gut[0]) && (100*currPreis<valVerkaufLimitUp*gut[0]))?"":"none");
                            newtr=createElement("tr",{},newtable);
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("price")+": ");
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(gut[0],100));
                        }

                        newtr=createElement("tr",{},newtable);
                        createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("value")+": ");
                        createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(currUserPreis*currAnzahl,100));

                        newtr=createElement("tr",{},newtable);
                        createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("commission")+": ");
                        createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,numberFormat(((currPreis-currUserPreis)/currUserPreis)*100,1)+"%");
                        if (preisBeob[0]){
                            newtr=createElement("tr",{},newtable);
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,"min: ");
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(preisBeob[0][2],100));
                        }
                        if (gutBeob[0]){
                            newtr=createElement("tr",{},newtable);
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("observed")+": ");
                            createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(gutBeob[0],100));
                        }
                        newtable=null;newtr=null;
                    },200);
                }
            /*
                if($("coinsauflager")){
                    $("coinsauflager").setAttribute("class",$("coinsauflager").getAttribute("class")+" link");
                    $("coinsauflager").addEventListener("click",function(){
                        $("coinsanzahl").value=this.innerHTML;
                        keyup($("coinsanzahl"));
                    },false);
                }
                if($("coinspreisschild")){
                    var newdiv=createElement("div",{"style":"position:absolute;top:0;left:330px;width:150px"},$("coinspreisschild"));
                    newdiv=createElement("div",{"id":"divBerInfoCoins","style":"float:left;padding:3px;background-color:#002300;border:5px solid #594230;color:#f0ffef;font-weight:bold;"},newdiv);
                    createElement("table",{},newdiv);
                    newdiv=null;

                    $("coinsanzahl").addEventListener("keyup",function(){ this.value=this.value.replace(/\D/g,""); },false);
                    $("coinspreis").addEventListener("keyup",function(){ this.value=this.value.replace(/\D/g,""); },false);
                    $("coinspreisschild").addEventListener("click",checkPreisCoins,false);
                    $("coinspreisschild").addEventListener("keyup",function(event){
                        checkPreisCoins();
                        if (event.keyCode==13){
                            var submitButton=$("preisschild").querySelector("#verkaufe_markt");
                            if(submitButton.style.display!="none"){ click(submitButton); }
                            submitButton=null;
                        }
                    },false);

                    // bugfix: no focus when coinspreisschild opens
                    $("coinspreisschild").addEventListener("DOMAttrModified",function(event){
                        if((event.target.id=="coinspreisschild")&&(event.attrName=="style")){
                            if(event.newValue.match(/display\:\s*block/)){
                                if(oldPricesInserted!=0){
                                    checkPreisCoins(); // fired when offer-div opens
                                }
                            }else{
                                if(oldPricesInserted==0){ oldPricesInserted=-1; }
                            }
                        }
                    }, false);
                }

                cand=null;candtable=null;
*/
            }
        }catch(err){ GM_logError("openMarketNewOffer","","err_trace="+err_trace,err); }
    });
    unsafeOverwriteFunction("calcMarketFee",function(){
        try{
            unsafeWindow._calcMarketFee();
        }catch(err){GM_logError("_calcMarketFee","","",err);}
        try{
            var err_trace="Init";
            var berater_box=$("marketnewoffer_berater");
            if(!berater_box){
                berater_box=createElement("div",{"style":"position:absolute;top:0px;width:175px;right:-160px;background-position:-140px 0px;","class":"market_popup"});
                newdiv=$("marketnewoffer");
                newdiv.insertBefore(berater_box,newdiv.lastElementChild);
                berater_box=createElement("div",{"id":"marketnewoffer_berater","style":"position:relative;margin-top:35px;"},berater_box);
            }
            berater_box.innerHTML="";
            var currId=unsafeWindow.market_filter_pid;
            if(currId!=-1){
                var currPreis=parseFloat($("marketnewoffer_price1").value+"."+$("marketnewoffer_price2").value,10);
                var currAnzahl=parseInt($("marketnewoffer_amount").value,10);
                // Stock amount
                err_trace="Stock amount";
                var newdiv;
                if(newdiv=$("marketcreateoffer_stockamount")){
                    newdiv.innerHTML=numberFormat(prodStock[0][currId]);
                }
                // Rack amount protection
                err_trace="Rack amount protection";
                if(protectMinRack){
                    if(currAnzahl>prodStock[0][currId]-prodMinRack[0][currId]){
                        currAnzahl=Math.max(0,prodStock[0][currId]-prodMinRack[0][currId]);
                        $("marketnewoffer_amount").value=currAnzahl;
                    }
                }
                // Block Submit Button
                err_trace="Submit Button";
                var submitButton = $("market_new_button");
                if(submitButton){
                    var help=null;
                    if(NPC[0][currId]){
                        if(!isNaN(NPC[0][currId])){
                            if(100*currPreis<20*NPC[0][currId]){ help=3; }
                            else if(100*currPreis>300*NPC[0][currId]){ help=4; }
                        }else if (NPC[0][currId].match(/^f/)){
                            if(100*currPreis<2*parseFloat(NPC[0][currId].replace("f",""),10)){ help=3; }
                            else if(100*currPreis>300*parseFloat(NPC[0][currId].replace("f",""),10)){ help=4; }
                        }
                    }
                    if((help!=null)&&gut[currId]){
                        if(100*currPreis<valVerkaufLimitDown*gut[currId]){ help=1; }
                        else if(100*currPreis>valVerkaufLimitUp*gut[currId]){ help=2; }
                    };
                    if(help==null){
                        submitButton.style.display="block";
                        newdiv = $("market_new_button_block");
                        if(newdiv){ newdiv.style.display="none"; }
                    }else{
                        submitButton.style.display="none";
                        newdiv = $("market_new_button_block");
                        if(!newdiv){
                            newdiv=createElement("div",{"id":"market_new_button_block","class":"alertbox","style":"padding:2px;width:100%;text-align:center;"});
                            insertAfter(newdiv,submitButton);
                        }
                        newdiv.style.display="block";
                        switch(help){
                        case 1: newdiv.innerHTML = "Too cheap"; break;
                        case 2: newdiv.innerHTML = "Too expensive"; break;
                        case 3: newdiv.innerHTML = "Not allowed - Too cheap"; break;
                        case 4: newdiv.innerHTML = "Not allowed - Too expensive"; break;
                        }
                    }
                    help=null;
                }
                submitButton=null;
                // Info Boards
                err_trace="berater_box";
                var newtable=createElement("table",{},berater_box);
                var newtr;
                newtr=createElement("tr",{},newtable);
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("price")+": ");
                if(gut[currId]){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(gut[currId],100));
                } else {
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,"--");
                }
                newtr=createElement("tr",{},newtable);
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("value")+": ");
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(currPreis*currAnzahl,100));
                newtr=createElement("tr",{},newtable);
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,"min: ");
                if (preisBeob[currId]){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(preisBeob[currId][2],100));
                }else{
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,"--");
                }
                newtr=createElement("tr",{},newtable);
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("observed")+": ");
                if (gutBeob[currId]){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(gutBeob[currId],100));
                }else{
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,"--");
                }
                newtr=createElement("tr",{},newtable);
                createElement("td",{"style":"color:#f0ffef;font-weight:bold;"},newtr,getText("NPCprice")+": ");
                if(!NPC[0][currId]){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,"--");
                }else if(!isNaN(NPC[0][currId])){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,moneyFormatLimit(NPC[0][currId],100));
                }else if (NPC[0][currId].match(/^f/)){
                    createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr,"*"+moneyFormatLimit(parseFloat(NPC[0][currId].replace("f",""),10),100));
                }else if (NPC[0][currId].match(/^c/)){
                    coinsFormat(parseInt(NPC[0][currId].replace("c",""),10),createElement("td",{"style":"color:#f0ffef;font-weight:bold;text-align:right;"},newtr));
                }
                newtable=null;newtr=null;newdiv=null;
            }
            currId=null;

        }catch(err){ GM_logError("calcMarketFee","","",err); }
    });
    unsafeOverwriteFunction("buyMarketOffer",function(id){
        try{
            unsafeWindow._buyMarketOffer(id);
        }catch(err){GM_logError("_buyMarketOffer","","",err);}
        try{
            for(var i=0;i<unsafeWindow.market_offers.length;i++){
                if(id==unsafeWindow.market_offers[i].id){
                    var money=parseFloat($("bar").innerHTML.replace(getText("gamecurrency"),"").replace(/\s+/g,"").replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                    $("marketbuyofferamount").value = Math.min(unsafeWindow.market_offers[i].a,Math.floor(money/unsafeWindow.market_offers[i].pr));
                    window.setTimeout(function() {
                        $("marketbuyofferamount").select();
                    }, 50);
                    unsafeWindow.calcMarketOfferCost();
                    money=null;
                    break;
                }
            }
        }catch(err){ GM_logError("buyMarketOffer","","",err); }
    });
    unsafeOverwriteFunction("marketAction",function(action,id,open){
        try{
            unsafeWindow._marketAction(action,id,open);
        }catch(err){GM_logError("_marketAction","","",err);}
        try{
            switch(action){
            case "marketcreateoffer":{
                var currId=unsafeWindow.market_filter_pid;
                var amount=parseInt($("marketnewoffer_amount").value,10);
                var price1=parseInt($("marketnewoffer_price1").value,10);
                var price2=parseInt($("marketnewoffer_price2").value,10);
                lastOffer[currId]=[amount,price1,price2];
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lastOffer",implode(lastOffer,"marketAction/lastOffer"));
                currId=null;amount=null;price1=null;price2=null;
            break;}
            case "marketinit":{
                quicklinks();
            break;}
            }
        }catch(err){ GM_logError("marketAction","","",err); }
    });

    // Revised by Moe
    unsafeOverwriteFunction("marketActionResponse", function(request, action, id, open) {
        try {
            var result = checkRequest(request);
            if (result != 0 && result[0] != 0 && result[1]["offers"]) {
                // Save own offers
                var err_trace = "Save own offers";
                var ownOffersMap = new Object();
                var marketOffersArr = new Array();
                var row, offer_id, prod, preis, menge, menge_sum, typ;
                err_trace = "Save own offers";
                // Iterate over received offers. Put my offers into ownOffersMap
                for (var v = 0; v < result[1]["offers"].length; v++) {
                    row = result[1]["offers"][v]; // A received offer
                    offer_id = parseInt(row["id"], 10); // Id of offer
                    prod = parseInt(row["p"], 10); // Id of product in offer
                    preis = parseFloat(row["pr"], 10); // Price of pruduct
                    menge = parseInt(row["a"], 10); // Amount
                    typ = prodTyp[0][prod] // Type of the product
                    if (row["s"]) { // Is this my offer?
                        ownOffersMap[offer_id] = { id: offer_id, prod: prod, preis: preis, menge: menge, typ: typ };
                    }

                    if (!marketOffersArr[prod]) {
                        marketOffersArr[prod] = new Array();
                    }
                    marketOffersArr[prod].push([menge, preis, offer_id]);
                }

                // Check, if all my offers were in the received ones
                if (Object.keys(ownOffersMap).length != result[1]["count"]) {
                    // No => Add the missing ones to ownOffersMap. We take them from the old ownMarketOffers-Array. It's not 100% correct, but a very good guess!
                    for (var v = 0; v < ownMarketOffers.length; v++) {
                        row = ownMarketOffers[v]; // An "old" offer

                        // Check, if we know its product_id and if it isn't already in ownOffersMap. Check for product_id is neccessary because of migration :-)
                        if (row[3] && !ownOffersMap[row[3]]) {
                            ownOffersMap[row[3]] = { id: row[3], prod: row[0], preis: row[1], menge: row[2], typ: row[4] };
                        }
                    }
                }

                // Structure of ownMarketOffers: Array = [prod_id, preis, menge, offer_id, typ]
                ownMarketOffers = new Array(); // Reset global variable, that contains all my offers
                // Repack ownOffersMap into ownMarketOffers
                for (var oid in ownOffersMap) {
                    if (ownOffersMap.hasOwnProperty(oid)) {
                        var o = ownOffersMap[oid];
                        ownMarketOffers.push([o["prod"], o["preis"], o["menge"], o["id"], o["typ"]]);
                    }
                }

                // Sort ownMarketOffers-data
                var TYP2NUMBER = { "c": 0, "v": 1, "e": 2, "o": 3, "fw1": 4, "fw2": 5, "fw3": 6, "fw4": 7, "z": 8, "fl": 9, "fla": 10 };
                ownMarketOffers.sort(function(a, b) {
                    var result = TYP2NUMBER[a[4]] - TYP2NUMBER[b[4]]; // Product-Type
                    if (result == 0) {
                        result = a[0] - b[0]; // Same Type => Product-Id

                        if (result == 0) {
                            result = a[1] - b[1]; // Same Product => Price
                        }
                    }
                    return result;
                });

                // Persist values
                GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_ownMarketOffers", implode(ownMarketOffers, "marketActionResponse/ownMarketOffers"));
                doMarketoffersNotepad();

                // Calculate all observed prices
                err_trace = "Observing prices";
                // Try to get valPreiseBeobNum from SQLite DB as it is not initialized at this point. Defaults to 18 cheapest offers.
                valPreiseBeobNum = GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valPreiseBeobNum",18)

                for (var v = 0; v < prodBlock[0].length; v++) {
                    if (prodBlock[0][v] === undefined) { continue; }
                    if (!prodBlock[0][v].match(/t/) && !prodBlock[0][v].match(/l/)) {
                        // marketOffersArr[v] = [menge, preis, offer_id]
                        if (marketOffersArr[v]) {
                            // Sort offers by price, lowest first... same price? => take offer_id
                            marketOffersArr[v].sort(function(a, b) {
                                return a[1] == b[1] ? a[2] - b[2] : a[1] - b[1];
                            });
                            marketOffersArr[v] = marketOffersArr[v].slice(0, valPreiseBeobNum); // Take cheapest offers

                            menge_sum = 0; // Total amount of product v offered at market (within the cheapest offers)
                            // Iterate over those (at most) 18 offers of product v
                            for (var w = 0; w < marketOffersArr[v].length; w++) {
                                menge_sum += marketOffersArr[v][w][0];
                            };
                            // Calc a weighted "watched price" value for product v
                            gutBeob[v] = calcObservedPrice((prodTyp[0][v] == "z" ? 2 : 1), marketOffersArr[v]);
                            if (valNimmBeob) {
                                if (!isNaN(NPC[0][v])) { // If product v can be bought at NPC
                                    gut[v] = Math.min(gutBeob[v], NPC[0][v]);
                                } else {
                                    gut[v] = gutBeob[v];
                                }
                            }
                            if (!(preisBeob instanceof Array)) { preisBeob = new Array(); }
                            // preisBeob[v] = [isOfferAtMarket, timeOfCalculation, priceCheapest, priceMostExpensive, amountInPriceRange]
                            preisBeob[v] = [true, now, marketOffersArr[v][0][1], marketOffersArr[v][marketOffersArr[v].length - 1][1], menge_sum];
                        } else {
                            // no offers
                            if (valNimmBeob) {
                                if (unsafeWindow.market_filter_pid == -1 || unsafeWindow.market_filter_pid == v) {
                                    //unsafeWindow.market_filter_pid -1 by marketinit >0 = Single view (marketOffersArr have maximum one product)
                                    if (!isNaN(NPC[0][v])) {
                                        // It's a Number => it can be bought at NPC
                                        gut[v] = NPC[0][v];
                                    } else {
                                        // It's not a number...

                                        // Coins (v=0) are undefinded in NPC[0], entries starting with 'c' cost coins => Skip them
                                        if (NPC[0][v] === undefined || NPC[0][v].startsWith("c")) { continue; }

                                        // ... it's a string starting with 'f' followed by the price
                                        gut[v] = parseFloat(NPC[0][v].replace("f", ""), 10);
                                        if (valUse3TimesNpcPrices) {
                                            gut[v] = 3 * gut[v];
                                        }
                                    }
                                    gutBeob[v] = gut[v];
                                }
                            }
                            if (!(preisBeob instanceof Array)) { preisBeob = new Array(); }
                            if (!(preisBeob[v] && preisBeob[v][0])) { // If no "watched price"...
                                preisBeob[v] = [false, now, , , 0]; // ... set preisBeob[v] accordingly
                            }
                        }
                    }
                }

                marketOffersArr = null;
                ownOffersMap = null;
                row = null;
                prod = null;
                preis = null;
                menge = null;
                menge_sum = null;
                if (valNimmBeob) {
                    GM_setValueCache(COUNTRY + "_" + SERVER + "_gut", implode(gut, "marketActionResponse/gut"));
                    raiseEventTop("gameChangedGut");
                }
                GM_setValueCache(COUNTRY + "_" + SERVER + "_gutBeob", implode(gutBeob, "marketActionResponse/gutBeob"));
                GM_setValueCache(COUNTRY + "_" + SERVER + "_preisBeob", implode(preisBeob, "marketActionResponse/preisBeob"));
                raiseEventTop("gameChangedBeobPrice");
            }
        } catch (err) { GM_logError("marketActionResponse", "", "err_trace=" + err_trace + " v=" + v, err); }
        try {
            unsafeWindow._marketActionResponse(request, action, id, open);
        } catch (err) { GM_logError("_marketActionResponse", "", "", err); }
    });

    // Buy offer by pressing Enter
    if(newdiv=$("marketbuyofferamount")){
        newdiv.addEventListener("keyup",function(event){
            if(event.keyCode==13){
                unsafeWindow.calcMarketOfferCost();
                var newdiv=$("marketbuyofferbutton");
                if(newdiv.style.display=="block"){
                    click(newdiv);
                }
                newdiv=null;
            }
        },false);
    }
    // Create offer enter stock amount
    if(newdiv=$("marketcreateoffer_stockamount")){
        newdiv.setAttribute("class","link");
        newdiv.addEventListener("click",function(event){
            var newdiv=$("marketnewoffer_amount");
            if(newdiv){
                newdiv.value=prodStock[0][unsafeWindow.market_filter_pid];
                keyup(newdiv);
            }
            newdiv=null;
        },false);
    }

    // Notepad for Non-Premium
    err_trace="Notepad for Non-Premium";
    if((newdiv=$("sub_notepad"))&&(newdiv.style.display=="none")){
        newdiv=insertAfter(createElement("div",{"id":"beraterNotepad","class":"submenueitem link","style":"display:block;"}),newdiv);
        createElement("img",{"src":GFX+"guild/contract.gif","style":"width:15px;height:15px;"},newdiv);
        newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,unsafeWindow.lng_t_notizen); },false);
        newdiv.addEventListener("click",function(){
            $("notepadentry").value=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_notepad","");
            unsafeWindow.calcNotepadLetters();
            unsafeWindow.showDiv("notepad");
        },false);
        newdiv=$("notepadheader");
        newdiv.getElementsByTagName("img")[0].removeAttribute("onclick");
        newdiv.getElementsByTagName("img")[0].addEventListener("click",function(){
            GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_notepad",$("notepadentry").value,72);
            unsafeWindow.hideDiv("notepad");
        },false);
    }

    // BuyNotepad
    err_trace="BuyNotepad";
    newdiv=createElement("div",{"style":"position:relative;margin-top:5px;display:block;white-space:nowrap;"},$("divRightBorder"));
    newdiv1=createElement("div",{"class":"opener link","style":"display:inline-block;vertical-align:top;background-position:0px "+(show["buyNotepad"]?-20:0)+"px;"},newdiv);
    newdiv1.addEventListener("click",function(){
        show["buyNotepad"]=!show["buyNotepad"];
        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_show",implode(show,"buyNotepad/show"));
        if(show["buyNotepad"]){
            this.style.backgroundPosition="0px -20px";
            $("buyNotepad").style.display="inline-block";
            doBuyNotepad();
        }else{
            this.style.backgroundPosition="0px 0px";
            $("buyNotepad").style.display="none";
        }
    },false);
    createElement("div",{"id":"buyNotepad","style":"display:"+(show["buyNotepad"]?"inline-block":"none")+";"},newdiv);

    // MarketoffersNotepad
    err_trace="MarketoffersNotepad";
    newdiv=createElement("div",{"style":"position:relative;margin-top:5px;display:block;white-space:nowrap;"},$("divRightBorder"));
    newdiv1=createElement("div",{"class":"opener link","style":"display:inline-block;vertical-align:top;background-position:0px "+(show["marketoffersNotepad"]?-20:0)+"px;"},newdiv);
    newdiv1.addEventListener("click",function(){
        show["marketoffersNotepad"]=!show["marketoffersNotepad"];
        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_show",implode(show,"marketoffersNotepad/show"));
        if(show["marketoffersNotepad"]){
            this.style.backgroundPosition="0px -20px";
            $("marketoffersNotepad").style.display="inline-block";
        }else{
            this.style.backgroundPosition="0px 0px";
            $("marketoffersNotepad").style.display="none";
        }
        doMarketoffersNotepad();
    },false);
    createElement("div",{"id":"marketoffersNotepad","style":"display:"+(show["marketoffersNotepad"]?"inline-block":"none")+";"},newdiv);
    doMarketoffersNotepad();

    document.addEventListener("gameChangedOwnMarketOffers",function(){
        window.setTimeout(function(){
            ownMarketOffers=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_ownMarketOffers"),"event:gameChangedOwnMarketOffers/ownMarketOffers",{});
            doMarketoffersNotepad();
        },0);
    },false);
    // Points and level.  levelLog[day]=[points,rank,market sales,contract sales,farmi money]
    err_trace="Points and level";
    levelLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog"),"do_main/levelLog",[]);
    if(!(levelLog instanceof Array)){ levelLog = []; }
    function setLevelLogId(){
        levelLog.sort(sortObjFunctions["date"]);
        for(levelLogId=levelLog.length-1;levelLogId>=0;levelLogId--){
            if(levelLog[levelLogId][0]==todayServerStr){ return; }
        }
        levelLog.push([todayServerStr,0,null,0,0,0]);
        setLevelLogId();
    }
    setLevelLogId();

    function getDailyRanking(){
    try{
        if(!levelLog[levelLogId][2]){
            GM_logInfo("getDailyRanking","","",getText("requestingUserStatistic"));
            GM_xmlhttpRequest({
                method: "GET",
                url: "http://s"+SERVER+"."+GAMEPAGES[COUNTRY]+"/ajax/city.php?mode=stats&type=pkt&page=1&findme=1&rid="+unsafeWindow.rid,
                headers: {"Content-type": "application/x-www-form-urlencoded"},
                onload: function(response){
                    try{
                        var result=checkRequest(response);
                        //alert(implode(result[1]))
                        if(result){
                            for(var i in result[1]["data"]){
                                if(!result[1]["data"].hasOwnProperty(i)){ continue; }
                                if(result[1]["data"][i]["own"]){
                                    levelLog[levelLogId][2]=((result[1].page-1)*result[1].max)+parseInt(i,10);
                                    GM_setValue2(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(levelLog,"getDailyRanking/levelLog"),73);
                                    GM_logInfo("getDailyRanking","","",getText("youAreOnRankX").replace(/%1%/,levelLog[levelLogId][2]));
                                    return;
                                }
                            }
                            GM_logInfo("getDailyRanking","","",getText("couldNotGetRank"));
                        }else{
                            GM_logInfo("getDailyRanking","","",getText("couldNotGetRank")+" ("+response.responseText+")");
                        }
                    }catch(err){ GM_logError("getDailyRanking.onload","","responseText="+response.responseText,err); }
                },
                onerror: function(response){
                    GM_logError("getDailyRanking.onerror","","",response.responseText);
                },
                timeout: function(response){
                    GM_logError("getDailyRanking.timeout","","",response.responseText);
                }
            });
        }
    }catch(err){ GM_logError("getDailyRanking","","",err); }
    }
    getDailyRanking();
    function plotLevelProgressBar(){
    try{
        var help;
        // data quality
        levelLog.sort(sortObjFunctions["date"]);
        if(help=$("pkt")){
            help=parseInt(help.innerHTML.replace(/\D/g,""),10);
            levelLog[levelLogId][1]=help;
            for(var v=levelLog.length-1;v>=0;v--){
                if(help<levelLog[v][1]){ levelLog[v][1]=0; } // points limited by current points
            }
        }
        help=0;
        for(var v=0;v<levelLog.length;v++){
            if(levelLog[v][1]<help){ levelLog[v][1]=help; } // monotony
            help=levelLog[v][1];
        }
        var month,stichtag=new Date();
        stichtag=Math.round(((new Date(stichtag.getFullYear(),stichtag.getMonth()-2,1)).getTime())/1000);
        for(var v=levelLog.length-1;v>=0;v--){
            if(levelLog[v][0].match(/^\d+\.\d+\.\d+$/)){
                if(getTime(levelLog[v][0])<stichtag){
                    // save full data for the last 3 months, else join data to monthly
                    month=/^(\d+)\.(\d+)\.(\d+)$/.exec(levelLog[v][0]);
                    if(month[2].length==1){ month[2]="0"+month[2]; }
                    month = month[3]+"-"+month[2];
                    for(var w=0;w<levelLog.length;w++){
                        if(levelLog[w][0]==month){ break; }
                    }
                    if(levelLog[w]===undefined){
                        levelLog[w]=[month,0,,0,0,0];
                    }
                    if(levelLog[w][1]<levelLog[v][1]){
                        levelLog[w][1]=levelLog[v][1];
                        levelLog[w][2]=levelLog[v][2];
                    }
                    levelLog[w][3] += levelLog[v][3];
                    levelLog[w][4] += levelLog[v][4];
                    levelLog[w][5] += levelLog[v][5];
                    levelLog.splice(v,1);
                }
            }
        }
        setLevelLogId();
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(levelLog,"plotLevelProgressBar/levelLog"));

        // plotting level log bar
        if(USERLEVEL<LEVEL_POINTS.length){
            var levelSize=959;
            var levelsum=LEVEL_POINTS[USERLEVEL+1]-LEVEL_POINTS[USERLEVEL-1];
            var newdiv=$("levelProgressBar");
            if(newdiv){ removeElement(newdiv); }
            newdiv=createElement("div",{"class":"link","id":"levelProgressBar","style":"float:left;width:"+levelSize+"px;position:relative;top:-2px;left:18px;"},content_table.firstElementChild.children[2].firstElementChild);
            newdiv.addEventListener("click",function(){unsafeWindow.buildInfoPanel("level");},false);
            newdiv.addEventListener("mouseover",function(event){
                var node=event.target;
                var mouseOverText=node.getAttribute("mouseOverText");
                while((node!=this)&&(!mouseOverText)){
                    node=node.parentNode;
                    mouseOverText=node.getAttribute("mouseOverText");
                }
                if(mouseOverText){ toolTip.show(event,mouseOverText); }
                node=null;mouseOverText=null;
            },false);

            var newdiv1=bar(levelSize*(LEVEL_POINTS[USERLEVEL]-LEVEL_POINTS[USERLEVEL-1])/levelsum,1,1);
            newdiv1.style.cssFloat="left";
            newdiv1.setAttribute("mouseOverText",getText("level")+" "+(USERLEVEL-1)+": "+numberFormat(LEVEL_POINTS[USERLEVEL-1],0)+"-"+numberFormat(LEVEL_POINTS[USERLEVEL],0));
            newdiv.appendChild(newdiv1);

            newdiv1=bar(levelSize*(LEVEL_POINTS[USERLEVEL+1]-LEVEL_POINTS[USERLEVEL])/levelsum,levelLog[levelLogId][1]-LEVEL_POINTS[USERLEVEL],LEVEL_POINTS[USERLEVEL+1]-LEVEL_POINTS[USERLEVEL]);
            newdiv1.style.cssFloat="left";
            newdiv1.style.marginLeft=Math.ceil(2+levelSize*(LEVEL_POINTS[USERLEVEL]-LEVEL_POINTS[USERLEVEL-1])/levelsum)+"px";
            newdiv1.setAttribute("mouseOverText",getText("level")+" "+(USERLEVEL)+": "+numberFormat(LEVEL_POINTS[USERLEVEL],0)+"-"+numberFormat(LEVEL_POINTS[USERLEVEL+1],0));
            newdiv.appendChild(newdiv1);

            for(var v=levelLog.length-1;v>=0;v--){
                if(levelLog[v][0].match(/^\d+\.\d+\.\d+$/)){
                    newdiv1=createElement("div",{"mouseOverText":levelLog[v][0]+"<br>"+numberFormat(levelLog[v][1]),"style":"position:absolute;width:0;margin-top:2px;height:12px;border-right:1px solid white;"},newdiv);
                    if (levelLog[v][1]<LEVEL_POINTS[USERLEVEL]){
                        newdiv1.style.marginLeft=Math.floor(2+levelSize*(levelLog[v][1]-LEVEL_POINTS[USERLEVEL-1])/levelsum)+"px";
                    } else {
                        newdiv1.style.marginLeft=Math.floor(4+levelSize*(levelLog[v][1]-LEVEL_POINTS[USERLEVEL-1])/levelsum)+"px";
                    }
                    help=levelLog[v][0].split(".");
                    if (new Date(parseInt(help[2],10),parseInt(help[1],10)-1,parseInt(help[0],10)).getDay()=="0"){
                        newdiv1.style.borderColor="red";
                    }
                }
            }
            newdiv1=null;newdiv=null;
        }
    }catch(err){ GM_logError("plotLevelProgressBar","","levelLog["+v+"]="+implode(levelLog[v],"plotLevelProgressBar/levelLog"),err); }
    }
    plotLevelProgressBar();
    unsafeOverwriteFunction("updateMenuGo",function(){
        try{
            unsafeWindow._updateMenuGo();
        }catch(err){GM_logError("_updateMenuGo","","",err);}
        window.setTimeout(function(){
        try{
            // calcTotalFarmis();
            // loadProductData();
            updateProductDataFarm();
            plotLevelProgressBar();
            calcProdMinRack();
            // calcProdMinRackInit();
            if(USERLEVEL<parseInt(unsafeWindow.currentuserlevel,10)){
                raiseEvent("gameUserlevelUp");
            }
            USERLEVEL=parseInt(unsafeWindow.currentuserlevel,10);
        }catch(err){ GM_logError("updateMenuGo","","",err); }
        },0);
    });
    // Removing Advertising end on Advertising Abort
    unsafeOverwriteFunction("cancelAdResponse",function(response){
        try{
            var cell=$("alertAdvertEnd");
            if(cell){ removeElement(cell); }
            cell=null;
        }catch(err){GM_logError("cancelAdResponse","","",err);}
        try{
            unsafeWindow._cancelAdResponse(response);
        }catch(err){GM_logError("_cancelAdResponse","","",err);}
    });
    // Sprechblase
    err_trace="Bubble";
    createElement("div",{"id":"sprcontent2","style":"position:absolute;top:20px;left:323px;z-index:100;width:200px;height:90px;overflow:auto;display:none;"},$("sprcontent").parentNode);//same style as #sprcontent

    // Lager / Rack
    err_trace="Rack";
    newdiv=createElement("div",{"style":"display:none;"},$("lager_info"));//position:absolute;top:50px;left:58px;display:none;
    createElement("img",{"src":GFX+"adtime.gif","style":"float:left;width:14px;height:14px;margin-left:5px;"},newdiv);
    createElement("div",{"id":"lager_zeit_ziel","class":"tnormal","style":"float:left;margin-left:5px;"},newdiv);
    //Linus--Tux: Icon "contract to yourself" fade out
    newdiv=createElement("div",{"id":"sendStockingContract","class":"link playerContract","style":"position:absolute;top:155px;left:10px;display:none;"},$("lager").firstElementChild);
    createElement("div",{},newdiv);
    newdiv.addEventListener("mouseover",function(event){
        try{
            if(unsafeWindow.selected&&(!prodBlock[0][unsafeWindow.selected].match(/t/))){
                toolTip.show(event,getText("storeXinContract").replace(/%1%/,prodName[0][unsafeWindow.selected]));
            }else{
                toolTip.show(event,"---");
            }
        }catch(err){ GM_logError("sendStockingContract.mouseover","","",err); }
    },false);
    newdiv.addEventListener("click",function(event){
        try{
            if(unsafeWindow.selected&&(!prodBlock[0][unsafeWindow.selected].match(/t/))){
                var thisdata=new Object();
                thisdata["to"]=FARMNAME;
                thisdata["fillContract"]=new Object();
                thisdata["fillContract"][unsafeWindow.selected]=[prodStock[0][unsafeWindow.selected],1];
                GM_setValue(COUNTRY+"_"+SERVER+"_pagedataVertraegeNew",implode(thisdata,"sendStockingContract.click/thisdata"));
                showMultiframePage("vertraege/new.php");
            }
        }catch(err){ GM_logError("sendStockingContract.click","","",err); }
    },false);
    function showLagerZeitZiel(zoneNrF){
    try{
        var divLagerZeitZiel=$("lager_zeit_ziel");
        var growtime,help;
        switch(zones.getBuilding(zoneNrF)){
        case 1:{
            if ((unsafeWindow.mode==0)&&(prodTyp[0][unsafeWindow.selected]=="v")){
                var bonus=zones.getBonus(zoneNrF);
                if((help=zones.getBonusSpecial(zoneNrF))&&(unsafeWindow.selected==help[0])){
                    bonus += help[1];
                }
                bonus=1-(bonus/100);
                growtime=calcGrowDuration(60*prodGrowTime[0][unsafeWindow.selected],bonus);
            }
        break;}
        case "fl1":{
            if ((unsafeWindow.mode==0)&&(prodTyp[0][unsafeWindow.selected]=="fl")){
                var bonus=1-(zones.getBonus(zoneNrF)/100);
                if((help=zones.getBonusSpecial(zoneNrF))&&(unsafeWindow.selected==help[0])){
                    bonus *= 1-(help[1]/100);
                }
                growtime=calcGrowDuration(60*prodGrowTime[0][unsafeWindow.selected],bonus);
            }
        break;}
        }
        if(growtime){
            $("lager_zeit").innerHTML=getTimeStr(growtime)+"&nbsp;"+getText("shortHours");
            if(divLagerZeitZiel.parentNode.style.display!="block"){
                divLagerZeitZiel.parentNode.style.display="block";
            }
            divLagerZeitZiel.innerHTML="=&nbsp;"+getDaytimeStr(now+growtime)+"&nbsp;"+getText("shortOClock");
        }else{
            hideLagerZeitZiel();
        }
        divLagerZeitZiel=null;
    }catch(err){ GM_logError("showLagerZeitZiel","zoneNrF="+zoneNr,"",err); }
    }
    function hideLagerZeitZiel(){
    try{
        var divLagerZeitZiel=$("lager_zeit_ziel");
        if(divLagerZeitZiel.parentNode.style.display!="none"){
            divLagerZeitZiel.parentNode.style.display="none";
        }
        divLagerZeitZiel=null;
    }catch(err){ GM_logError("hideLagerZeitZiel","","",err); }
    }
    unsafeOverwriteFunction("selectRackItem",function(id,b){
        try{
            unsafeWindow._selectRackItem(id,b);
        }catch(err){GM_logError("_selectRackItem","id="+id+" b="+b,"",err);}
        try{
            var container;
            if((container=$("gardenmaincontainer"))&&("block"==container.style.display)){
                var zoneNr=/parent.cache_me\((\d+?),120/.exec($("gardenarea").innerHTML);
                if(zoneNr){
                    zoneNr=parseInt(zoneNr[1],10);
                    showLagerZeitZiel(zoneNr+6*gameLocation.get()[1]);
                }
            }else if((container=$("farmersmarket_pos1_inner"))&&("block"==container.style.display)){
                showLagerZeitZiel("farmersmarket-1");
            }
            container=null;
        }catch(err){GM_logError("selectRackItem","id="+id,"",err);}
    });

    valMoveAnimals=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valMoveAnimals"),"do_main/valMoveAnimals",[]);
    // executed,speedvert,top,bottom,speedhor,left,right
    function moveAnimals(mode){
        //GM_log("moveAnimals "+mode);
        if(($("innermaincontainer").style.display == "block")&&($("animalline"+mode))){
            var cand=$("animalline"+mode).getElementsByTagName("img");
            for(var v=0;v<cand.length;v++){
                cand[v].style.top=(Math.max(ANIMAL_MOVE[mode][2],Math.min(ANIMAL_MOVE[mode][3],parseInt(cand[v].style.top,10)+ANIMAL_MOVE[mode][1]*getRandom(-1,1))))+"px";
                cand[v].style.left=(Math.max(ANIMAL_MOVE[mode][5],Math.min(ANIMAL_MOVE[mode][6],parseInt(cand[v].style.left,10)+ANIMAL_MOVE[mode][4]*getRandom(-1,1))))+"px";
            }
            cand=null;
            window.setTimeout(function(){moveAnimals(mode);},100);
        }else{
            ANIMAL_MOVE[mode][0]=false;
        }
    }

    // events general =============================================================================
    err_trace="events general";
    // rack
    var prodStockTemp=new Array(); //Stock Farm 1
    for(var i in unsafeWindow.rackobj) {
        for(var j in unsafeWindow.rackobj[i]) {
            for(var k in unsafeWindow.rackobj[i][j]) {
                switch (i) {
                    case "1":
                        prodStockTemp[unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                    case "5":
                        prodStock[5][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                    case "6":
                        prodStock[6][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                    case "7":
                        prodStock[7][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                    case "8":
                        prodStock[8][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                    case "9":
                        prodStock[9][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                        break;
                }
            }
        }
    }
    // save rack amounts
    for(var v in prodName[0]){
        if(!prodName[0].hasOwnProperty(v)){ continue; }
        if(v==0){ continue; } // Coins
        //Linus--Tux 20151020
        var c=(prodStockTemp[v])?prodStockTemp[v]:0;
        prodStock[0][v]=(c?parseInt(c,10):0);

        /*if(unsafeWindow.farm==5){continue; } //Linus--Tux 20151028
        if (!unsafeWindow.rackElement[v]){ prodStock[0][v]=0; } // not available
        // else if ("undefined" === typeof(unsafeWindow.rackElement[v].id)){ prodStock[0][v]=0; } // empty elements
        else if ("undefined" === typeof(unsafeWindow.rackElement[v].number)){ prodStock[0][v]=0; } // no stock available
        else if (!unsafeWindow.rackElement[v].number){ prodStock[0][v]=0; } // no stock available
        else { prodStock[0][v]=parseInt(unsafeWindow.rackElement[v].number,10); }*/
    }

    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"rack/prodStock"));
    unsafeWindow.updateRackBusy=false;
    unsafeOverwriteFunction("updateRack",function(rack,init){
        try{
            var cell=$("divUpdateRack");
            if(!cell){
                cell=createElement("div",{"id":"divUpdateRack","class":"blackbox","style":"position:absolute;top:20%;left:50%;font-weight:bold;"},$("rackItems"),"Rack updating");
                cell.style.marginLeft=(-(cell.offsetWidth)/2)+"px";
            }
            cell.style.display="block";
            cell=null;
            unsafeWindow.updateRackBusy=true;
        }catch(err){GM_logError("updateRack","","",err);}
        try{
            unsafeWindow._updateRack(rack,init);
        }catch(err){GM_logError("_updateRack","","",err);}
    });
    unsafeOverwriteFunction("sortRackNew",function(type,L){
        try{
            unsafeWindow._sortRackNew(type,L);
        }catch(err){GM_logError("_sortRackNew","type="+type+" L="+L,"",err);}
        try{
            var prodStockTemp=new Array(); //Stock Farm 1
            for(var i in unsafeWindow.rackobj) {
                for(var j in unsafeWindow.rackobj[i]) {
                    for(var k in unsafeWindow.rackobj[i][j]) {
                        switch (i) {
                            case "1":
                                prodStockTemp[unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                            case "5":
                                prodStock[5][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                            case "6":
                                prodStock[6][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                            case "7":
                                prodStock[7][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                            case "8":
                                prodStock[8][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                            case "9":
                                prodStock[9][unsafeWindow.rackobj[i][j][k].pid]=parseInt(unsafeWindow.rackobj[i][j][k].amount);
                                break;
                        }
                    }
                }
            }

            // save rack amounts
            for(var v in prodName[0]){
                if(!prodName[0].hasOwnProperty(v)){ continue; }
                if(v==0){ continue; } // Coins
                //Linus--Tux 20151020
                var c=(prodStockTemp[v])?prodStockTemp[v]:0;
                prodStock[0][v]=(c?parseInt(c,10):0);
            }
            GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"sortRackNew/prodStock"));
            var cell=$("divUpdateRack");
            if(cell){ cell.style.display="none"; }
            cell=null;
            window.setTimeout(function(){
                calcProdMinRack(); // -> doBuyNotepad,doRack
                unsafeWindow.updateRackBusy=false;
                raiseEvent("gameUpdateRack");
            },0);
        }catch(err){GM_logError("sortRackNew","type="+type,"",err);}
    });
    /*
    function doRackNavi(){
    try{
        if(unsafeWindow.racktype!=2){  // Oil: no navi
            if(unsafeWindow.userracks>1){
                if(unsafeWindow._currRack=="0"){
                    // Left arrow to last rack
                    var div = unsafe$("racknavileft");
                    div.className = "link racknavi";
                    div.onmouseover = function(e) { unsafeWindow.showDiv("racknavileftinfo"); }
                    div.onmouseout = function(e) { unsafeWindow.hideDiv("racknavileftinfo"); }
                    div.onclick = function(e) { unsafeWindow.updateRack(Math.min(unsafeWindow.userracks,(unsafeWindow.premium==1?3:2))-1); }
                    $("racknavileftinfo").innerHTML = unsafeWindow.rack_tt_info+"&nbsp;"+Math.min(unsafeWindow.userracks,(unsafeWindow.premium==1?3:2));
                    div=null;
                } else if (parseInt(unsafeWindow._currRack,10)==Math.min(unsafeWindow.userracks,(unsafeWindow.premium==1?3:2))-1){
                    // Right arrow to first rack
                    var div = unsafe$("racknaviright");
                    div.className = "link racknavi";
                    div.onmouseover = function(e) { unsafeWindow.showDiv("racknavirightinfo"); }
                    div.onmouseout = function(e) { unsafeWindow.hideDiv("racknavirightinfo"); }
                    div.onclick = function(e) { unsafeWindow.updateRack("0"); }
                    $("racknavirightinfo").innerHTML = unsafeWindow.rack_tt_info+"&nbsp;1";
                    div=null;
                }
            }
        }
    }catch(err){ GM_logError("doRackNavi","","",err); }
    }
    doRackNavi();
    unsafeOverwriteFunction("initRackNavi",function(){
        unsafeWindow._initRackNavi();
        doRackNavi();
    });
    */
    if(newdiv=$("rackItems")){
        newdiv.addEventListener("dblclick",function(event){
            try{
                //GM_log("dblclick on "+event.target+" id="+event.target.id+" parentNode.id="+event.target.parentNode.id);
                var currId=null;
                var node=event.target;
                while((currId==null)&&(node!=this)){
                    if(node.id.match(/rackitem\d+/)){
                        currId=/rackitem(\d+)/.exec(node.id)[1];
                    }else{
                        node=node.parentNode;
                    }
                }
                if((currId!=null)&&(!prodBlock[0][currId].match(/t/))){ showMarket(currId); }
            }catch(err){GM_logError("rackItems.dblclick","","",err);}
        },false);
    }
    /* TODO: function is not existing anymore
    unsafeOverwriteFunction("linfo",function(title,amount,id,offset,felder,kategorie){
        unsafeWindow._linfo(title,amount,id,offset,felder,kategorie);
        var newdiv;
        var rackPopup=$("rackPopup");
        if (!isNaN(NPC[0][id])){
            newdiv=createElement("div",{"class":"tmenu","style":"position:relative;height:13px;width:172px;top:-75px;padding-left:20px;background: url('"+GFX+"lager/flaeche.gif') left top transparent;background-position:0px -155px;"},rackPopup);
            createElement("span",{"style":"float:left;width:60px;"},newdiv,getText("NPCprice")+": ");
            createElement("span",{"style":"float:left;width:100px;text-align:right;"},newdiv,moneyFormat(NPC[0][id]));
        }
        if(!prodBlock[0][id].match(/t/)){
            newdiv=createElement("div",{"class":"tmenu","style":"position:relative;height:13px;width:172px;top:-75px;padding-left:20px;background: url('"+GFX+"lager/flaeche.gif') left top transparent;background-position:0px -155px;"},rackPopup);
            createElement("div",{"style":"display:inline-block;width:60px;"},newdiv,getText("marketPrice")+": ");
            createElement("div",{"style":"display:inline-block;width:100px;text-align:right;"},newdiv,moneyFormat(gut[id]));
            newdiv=createElement("div",{"class":"tmenu","style":"position:relative;height:13px;width:172px;top:-75px;padding-left:20px;background: url('"+GFX+"lager/flaeche.gif') left top transparent;background-position:0px -155px;"},rackPopup);
            createElement("div",{"style":"display:inline-block;width:60px;"},newdiv,getText("value")+": ");
            createElement("div",{"style":"display:inline-block;width:100px;text-align:right;"},newdiv,moneyFormatInt(gut[id]*prodStock[0][id]));
            newdiv=createElement("div",{"class":"tmenu","style":"position:relative;height:25px;width:172px;top:-75px;padding-left:20px;background: url('"+GFX+"lager/flaeche.gif') left top transparent;background-position:0px -155px;"},rackPopup);
            createElement("div",{"style":"width:160px;"},newdiv,getText("clickDouble")+": "+getText("goToMarket"));
        }
        newdiv=null;rackPopup=null;
    }); */
    unsafeOverwriteFunction("globalcommitbox",function(content,onclick,onclick2){
        try{
            unsafeWindow._globalcommitbox(content,onclick,onclick2);
        }catch(err){GM_logError("_globalcommitbox","","",err);}
        try{
            raiseEvent("gameOpenGlobalCommitBox");
        }catch(err){GM_logError("globalcommitbox","","",err);}
    });
    //(l,e,n,m,h,b,c)
    unsafeOverwriteFunction("globalBox",function(l,e,n,m,h,b,c){
        try{
            unsafeWindow._globalBox(l,e,n,m,h,b,c);
        }catch(err){GM_logError("_globalBox","","",err);}
        try{
            raiseEvent("gameOpenGlobalBox");
        }catch(err){GM_logError("globalBox","","",err);}
    });
    unsafeOverwriteFunction("buildingInnerDialogBox",function(m, a, l, h, s){
        try{
            unsafeWindow._buildingInnerDialogBox(m, a, l, h, s);
        }catch(err){GM_logError("_buildingInnerDialogBox","","",err);}
        try{
            raiseEvent("gameOpenBuildingInnerDialogBox");
        }catch(err){GM_logError("buildingInnerDialogBox","","",err);}
    });

    if(newdiv=$("coins")){
        newdiv1=newdiv.cloneNode(true);
        insertAfter(newdiv1,newdiv);
        newdiv1.id="coinsFormat";
        newdiv1.innerHTML=numberFormat(prodStock[0][0]);
        newdiv.style.display="none";
        newdiv.parentNode.setAttribute("class","link");
        newdiv.parentNode.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,0); },false);
        newdiv.parentNode.addEventListener("click",function(){ showMarket(0); },false);
    }

    if(COUNTRY=="SE"){ $("bar").innerHTML=$("bar").innerHTML.replace(/\.(\d\d) /,",$1 "); }
    unsafeOverwriteFunction("updatePlayerInfo",function(money,coins,points,level,deco){
        try{
            unsafeWindow._updatePlayerInfo(money,coins,points,level,deco);
        }catch(err){GM_logError("_updatePlayerInfo","","",err);}
        try{
            // GM_log("updatePlayerInfo money="+money+" coins="+coins+" points="+points+" level="+level+" deco="+deco);
            if(money){
                if(COUNTRY=="SE"){
                    money=money.replace(/\.(\d\d) /,",$1 ");
                    $("bar").innerHTML=money;
                }
                money=parseFloat(money.replace(getText("gamecurrency"),"").replace(/\s+/g,"").replace(regDelimThou,"").replace(regDelimDeci,"."));
                unsafeData.money=money;
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_bargeld",money);
            }
            if(coins){
                var c=parseInt(coins,10);
                if(!isNaN(c)){
                    prodStock[0][0]=c;
                    $("coinsFormat").innerHTML=numberFormat(c);
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"updatePlayerInfo/prodStock"));
                }
            }
        }catch(err){GM_logError("updatePlayerInfo","","",err);}
    });
    document.addEventListener("gameDoGetData",function(){
        window.setTimeout(loadProductData,0);
    },false);
    document.addEventListener("gameChangedBeobPrice",function(){
        window.setTimeout(function(){
            // GM_log("publish GMpreisBeob");
            top.unsafeData.preisBeob=explode(GM_getValue(COUNTRY+"_"+SERVER+"_preisBeob"),"eventListener@gameChangedBeobPrice/preisBeob",[]).clone();
        },0);
    },false);
    document.addEventListener("gameChangedGut",function(){
        window.setTimeout(function(){
            gut=explode(GM_getValue(COUNTRY+"_"+SERVER+"_gut"),"eventListener@gameChangedGut/gut",[]);
            top.unsafeData.gut=gut.clone();
            calcFarmiCost();
        },0);
    },false);
    document.addEventListener("gameChangedLevelLog",function(){
        window.setTimeout(function(){
            levelLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog"),"eventListener@gameChangedLevelLog/levelLog",[]);
            setLevelLogId();
        },0);
    },false);
    document.addEventListener("gameChangedProdMinRackInit",function(){
        window.setTimeout(function(){
            calcProdMinRackInit();
        },0);
    },false);

    // messages
    unsafeOverwriteFunction("messagesActionResponse",function(request,mode,id){
        try{
            unsafeWindow._messagesActionResponse(request,mode,id);
        }catch(err){GM_logError("_messagesActionResponse","","",err);}
        try{
            if(checkRequest(request,mode)){
                switch(mode){
                case "system": window.setTimeout(messagesSystem,0); break;
                }
            }
        }catch(err){GM_logError("messagesActionResponse","","",err);}
    });
    // market: [id,time,name,[prod,amount],money]
    // contract: [id,time,name,[[prod,amount],...],money]
    function messagesSystem(){
    try{
        if(!logSales){
            logSales=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logSales"),"messagesSystem/logSales",[]);
            logSales.sort(sortObjFunctions["int"],true);
            logSalesId=new Object();
            for(var v=logSales.length-1;v>=0;v--){
                logSalesId[logSales[v][0]]=v;
            }
        }
        var j,help,help2,help3,help4,currMsg,sender,betreff,time,amount,prod,money,dayStr,price;
        var div,span;
        var countRequest=0;
        for(var i=unsafeWindow.messages_data.length-1;i>=0;i--){
            currMsg=unsafeWindow.messages_data[i];
            help=currMsg.body.replace(/\s+/g," ");
            if([getText("msgSubjectCongratulation"),getText("msgSubjectCongratulation2"),getText("msgSubjectContractReject"),getText("msgSubjectContractCancel"),getText("msgSubjectContractNew"),getText("msgSubjectPresent"),getText("msgSubjectCoins"),getText("msgSubjectLevel"),getText("msgSubjectWeed1"),getText("msgSubjectWeed2"),getText("msgSubjectPremium")].contains(currMsg.subject)){
                // New message without handling
            }else if(currMsg.subject.match(regMsgSubjectFriend)||currMsg.subject.match(regMsgSubjectFriendEnd)){
                // New message without handling
            }else if(currMsg.subject.match(regMsgSubjectQuest)){
                // New message without handling
            }else if (currMsg.subject.match(regMsgSubjectMarketsale)){
                // Market sale
                if (help2=regMsgContentMarketsale.exec(help)){
                    // Market sale
                    // GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),"Market sale");
                    switch(COUNTRY){
                    case "TR":{
                        help2.push(help2.splice(2,1).toString());
                    break;}
                    case "SE":{
                        help2[4]=help2[4].replace(/\.(\d\d) /,",$1 ");
                        help2[4]=help2[4].replace(/\.(\d\d)$/,",$1");
                    break;}
                    }
                    sender=help2[1];
                    betreff=(getText("marketplace")+": "+help2[3]).replace(/&nbsp;/g," ");
                    time=getTime(currMsg.time);
                    prod=prodId[0][help2[3]];
                    amount=parseInt(help2[2],10);
                    money=parseFloat(help2[4].replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                    price=Math.round(100*money/amount)/100;
                    if(logSalesId[currMsg.nnr]===undefined){
                        logSalesId[currMsg.nnr]=logSales.push([currMsg.nnr])-1;
                        dayStr=getDateStr(time,2,false);
                        for(var v=levelLog.length-1;v>=0;v--){
                            if(levelLog[v][0]==dayStr){ break; }
                        }
                        if(v<0){ v=levelLog.push([dayStr,0,null,0,0,0])-1; }
                        levelLog[v][3]+=money;
                        levelLog[v][3]=Math.round(100*levelLog[v][3])/100;

                        help3 = amount;
                        while(help3>0){
                            for(var v=ownMarketOffers.length-1;v>=0;v--){
                                if((ownMarketOffers[v][0]==prod)&&(ownMarketOffers[v][1]==price)){
                                    help4 = Math.min(ownMarketOffers[v][2],help3);
                                    ownMarketOffers[v][2] -= help4;
                                    if(ownMarketOffers[v][2]<1){ ownMarketOffers.splice(v,1); }
                                    help3 -= help4;
                                    break;
                                }
                            }
                            if(v<0){ help3=0; }
                        }
                    }
                    j=logSalesId[currMsg.nnr];
                    logSales[j][1]=time;
                    logSales[j][2]=sender;
                    logSales[j][3]=[prod,amount];
                    logSales[j][4]=money;
                    if(valMessagesSystemMarkRead&&(currMsg.read=="0")){
                        window.setTimeout(unsafeWindow.messagesAction,500*(++countRequest),"unread",i);
                    }
                    if(div=$("messages_list_subject"+currMsg.nnr)){
                        div.setAttribute('style', 'width:385px !important');
                        div.setAttribute("j",j);
                        div.addEventListener("mouseover",function(event){
                            toolTip.show(event,toolTipSales(this.getAttribute("j")));
                        },false);
                        div.classList.add("systemMsg_marketsale");
                        div.innerHTML="";
                        igm(sender,div,betreff);
                        createElement("div",{"style":"display:inline-block;width:125px;margin-right:5px;"},div,sender);
                        span=createElement("div",{"style":"display:inline-block;width:145px;margin-right:5px;text-align:right;"},div,numberFormat(amount)+"&nbsp;"+prodName[0][prod]+"&nbsp;");
                        produktPic(0,prod,span);
                        createElement("div",{"style":"display:inline-block;width:75px;margin-right:5px;text-align:right;"},div,moneyFormatInt(money));
                    }
                }else{
                    GM_logWarning("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),"Could not parse content of a market sale message.");
                }
            }else if (getText("msgSubjectContractsale")==currMsg.subject){
                // Contract sale
                if (help2=regMsgContentContractsale.exec(help)){
                    // help2[1] = Sender
                    // help2[2] = amount of products and product (as a list)
                    // help2[3] = amount of kT
                    // GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),"Contract sale");
                    if(COUNTRY=="SE"){
                        help2[3]=help2[3].replace(/\.(\d\d) /,",$1 ");
                        help2[3]=help2[3].replace(/\.(\d\d)$/,",$1");
                    }
                    sender=help2[1];
                    money=parseFloat(help2[3].replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                    time=getTime(currMsg.time);
                    if(logSalesId[currMsg.nnr]===undefined){
                        logSalesId[currMsg.nnr]=logSales.push([currMsg.nnr])-1;
                        var dayStr=getDateStr(time,2,false);
                        for(var v=levelLog.length-1;v>=0;v--){
                            if(levelLog[v][0]==dayStr){ break; }
                        }
                        if(v<0){ v=levelLog.push([dayStr,0,null,0,0,0])-1; }
                        levelLog[v][4]+=money;
                        levelLog[v][4]=Math.round(100*levelLog[v][4])/100;
                    }
                    j=logSalesId[currMsg.nnr];
                    logSales[j][1]=time;
                    logSales[j][2]=sender;
                    logSales[j][3]=new Array();
                    help3=new Array();
                    help4=new Array();
                    //GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),help2[2]);
                    //help3=regMsgContentContractsaleList.exec(help2[2])
                    //GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),help3[2]);
                    //GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),help3[1]);
                    //GM_logInfo("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),help3[2]);
                    while(help3=regMsgContentContractsaleList.exec(help2[2])){
                        help2[2]=help2[2].replace(help3[0],"");
                        logSales[j][3].push([prodId[0][help3[2]],parseInt(help3[1],10)]);
                    }
                    betreff=getText("contract");
                    if(logSales[j][3].length==1){
                        prod=logSales[j][3][0][0];
                        amount=logSales[j][3][0][1];
                        betreff+=": "+prodName[0][prod];
                    }
                    logSales[j][4]=money;
                    if(valMessagesSystemMarkRead&&(currMsg.read=="0")){
                        window.setTimeout(unsafeWindow.messagesAction,500*(++countRequest),"unread",i);
                    }
                    if(div=$("messages_list_subject"+currMsg.nnr)){
                        div.setAttribute('style', 'width:385px !important');
                        div.setAttribute("j",j);
                        div.addEventListener("mouseover",function(event){
                            toolTip.show(event,toolTipSales(this.getAttribute("j")));
                        },false);
                        div.classList.add("systemMsg_contractsale");
                        div.innerHTML="";
                        igm(sender,div,betreff);
                        createElement("div",{"style":"display:inline-block;width:125px;margin-right:5px;"},div,sender);
                        span=createElement("div",{"style":"display:inline-block;width:145px;margin-right:5px;text-align:right;"},div);
                        if(logSales[j][3].length==1){
                            span.innerHTML=numberFormat(amount)+"&nbsp;"+prodName[0][prod]+"&nbsp;";
                            produktPic(0,prod,span);
                        }else{
                            span.innerHTML="...";
                        }
                        createElement("div",{"style":"display:inline-block;width:75px;margin-right:5px;text-align:right;"},div,moneyFormatInt(money));
                    }
                }else{
                    GM_logWarning("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),"Could not parse content of a contract sale message.");
                }
            }else{
                GM_logWarning("messagesSystem","","messages_data["+i+"]:\n"+print_r(unsafeWindow.messages_data[i],"",true,"\n"),"Unknown message type");
            }
        }
        if(countRequest>0){
            if(div=$("messageAlertReadingAll")){
                removeElement(div);
            }
            if(div=$("messages_main")){
                createElement("div",{"id":"messageAlertReadingAll","class":"alertbubble","style":"left:50%;margin-left:-200px;top:100px;text-align:center;font-weight:bold;"},div,getText("pleaseWait"));
                window.setTimeout(function(){
                    removeElement($("messageAlertReadingAll"));
                },500*(++countRequest));
            }
        }
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(levelLog,"messagesSystem/levelLog"));
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_ownMarketOffers",implode(ownMarketOffers,"messagesSystem/ownMarketOffers"));
        doMarketoffersNotepad();
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logSales",implode(logSales,"messagesSystem/logSales"));
    }catch(err){GM_logError("messagesSystem","","",err);}
    };
    if(newdiv=$("messages_list_check")){
        newdiv2=createElement("button",{"class":"link button_new","type":"button","style":"margin-right:5px;"},false,getText("salesLog"));
        newdiv.insertBefore(newdiv2, newdiv.firstElementChild);
        newdiv2.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("messages"); },false);
    }
    // events farm ================================================================================
    err_trace="events farm";
    unsafeOverwriteFunction("farmMove",function(b){
        try{
            unsafeWindow._farmMove(b);
        }catch(err){GM_logError("_farmMove","","",err);}
        try{
            if((b==99)){
                gameLocation.set("farmersmarket");
                raiseEvent("gameFarmersmarketOpened");
            } else if (b==100){
                gameLocation.set("farmersmarket2");
                raiseEvent("gameFarmersmarketOpened");
            }

            else{
                gameLocation.set("farm",unsafeWindow.farm-1);
                raiseEvent("gameFarmOpened");
            }
        }catch(err){GM_logError("farmMove","","",err);}
    });
    function doFarmZone(farmNR,zoneNr){
        try{
            var divZone,divZoneInfo,div;
            var help,zoneNrF,data,currZoneType;
            if(divZone=$("farm"+farmNR+"_pos"+zoneNr)){
                zoneNrF=zoneNr+6*(farmNR-1);
                // zone is blocked
                divZone.style.opacity=(zones.getBlock(zoneNrF).match(/[pq]/)?0.5:1);
                if(!zones.getBlock(zoneNrF)){
                    data=unsafeWindow.farms_data.farms[farmNR][zoneNr];
                    currZoneType=parseInt(data.buildingid,10);
                    // Upgrade button
                    if(BUILDING_UPGRADES[currZoneType]&&BUILDING_UPGRADES[currZoneType][data.level]){
                        if(data.upgrade&&(!data.premiumblock)){
                            div=$("farm_upgrade_tt"+farmNR+"_"+zoneNr);
                        }else{
                            div=$("farm_buttons"+farmNR+"_"+zoneNr);
                            div=createElement("div",{"id":"farm_button_upgrade"+farmNR+"_"+zoneNr,"class":"farm_button_upgrade button_upgrade link"},div);
                            div=createElement("div",{"id":"farm_upgrade_tt"+farmNR+"_"+zoneNr,"class":"ttbox farm_button_tt"},div);
                            createElement("div",{},div,unsafeWindow.infoupdatebuilding);
                            if(isNaN(BUILDING_UPGRADES[currZoneType][data.level][1])){
                                createElement("div",{},div,BUILDING_UPGRADES[currZoneType][data.level][1].replace("c","")+"&nbsp;"+getText("coins"));
                            }else{
                                createElement("div",{},div,moneyFormatInt((1-unsafeData.carpentry_bonus/100)*BUILDING_UPGRADES[currZoneType][data.level][1]));
                            }
                            if(USERLEVEL<BUILDING_UPGRADES[currZoneType][data.level][0]){
                                createElement("div",{"class":"bonusinfo important"},div,unsafeWindow.error1005.replace("%LEVEL%",BUILDING_UPGRADES[currZoneType][data.level][0]));
                            }
                        }
                        if(div){
                            var help2=BUILDING_UPGRADES[currZoneType][data.level-1][2]-BUILDING_UPGRADES[currZoneType][data.level][2];
                            if(help2>0){
                                if(currZoneType==1){
                                    if(data.level>3){
                                        createElement("div",{"style":"margin-top:10px;"},div,unsafeWindow.updatetext[7].replace(/%MORE%/,numberFormat(100*help2))); // water bonus on product
                                    }else{
                                        createElement("div",{"style":"margin-top:10px;"},div,unsafeWindow.updatetext[6].replace(/%MORE%/,numberFormat(100*(1-BUILDING_UPGRADES[currZoneType][data.level][2])))); // general water bonus
                                    }
                                }else{
                                    createElement("div",{"style":"margin-top:10px;"},div,unsafeWindow.updatetext[2].replace(/%MORE%/,numberFormat(100*help2))); // reduction of time
                                }
                            }
                            help2=BUILDING_UPGRADES[currZoneType][data.level][3]-BUILDING_UPGRADES[currZoneType][data.level-1][3];
                            if(help2>0){ // more animals
                                var animalCost=0;
                                for(var nr=1;nr<=help2;nr++){
                                    animalCost += Math.round(ANIMALCOST[currZoneType][0]+(totalAnimals[currZoneType]+nr)*ANIMALCOST[currZoneType][1]);
                                }
                                createElement("div",{"style":"margin-top:10px;"},div,unsafeWindow.updatetext[1].replace(/%MORE%/,numberFormat(BUILDING_UPGRADES[currZoneType][data.level][3]))+" (+"+help2+",&nbsp;"+moneyFormatInt(animalCost)+")");
                            }
                        }
                    }
                    // Zone mouseover showing possible production
                    if(BUILDINGTYPE[currZoneType]!=0){
                        // Replace Level-Stars (else it blocks zone mouseover)
                        divZone.querySelector(".farm_pos_back").appendChild(divZone.querySelector(".farm_pos_level"));
                        divZone.querySelector(".farm_pos_click").addEventListener("mouseover",function(event){
                            var help=/^farm(\d+)_pos(\d+)_click$/.exec(this.id);
                            var farmNR=parseInt(help[1],10);
                            var zoneNr=parseInt(help[2],10);
                            var zoneNrF=zoneNr+6*(farmNR-1);
                            var currZoneType=zones.getBuilding(zoneNrF);
                            var currAnimals=zones.getAnimals(zoneNrF);
                            if(currZoneType==1){
                                showLagerZeitZiel(zoneNrF);
                            }else{
                                var buildinginfo = this.querySelector(".tt");
                                if(!buildinginfo){
                                    buildinginfo=createElement("div",{"class":"tt","style":"display:none;"},this);
                                    var table,tr,td,div;
                                    table=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"0"},buildinginfo);
                                    switch(BUILDINGTYPE[currZoneType]){
                                    case 2:{
                                        help="";
                                        for(var output in BUILDING_INPUT[currZoneType]){
                                            if(!BUILDING_INPUT[currZoneType].hasOwnProperty(output)){ continue; }
                                            if(prodBlock[0][output]){ continue; }
                                            tr=createElement("tr",{},table);
                                            td=createElement("td",{"style":help+"padding-right:5px;"},tr);
                                            div=createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td);
                                            produktPic(0,output,div);
                                            createElement("span",{},div,numberFormat(prodYield[0][output]*currAnimals)+" "+prodName[0][output]);
                                            pointsFormat(prodYield[0][output]*currAnimals*prodPoints[0][output],"div",td);
                                            // 60*prodGrowTime[0][output]*(100-zones.getBonus(zoneNrF))/100
                                            var time=[];
                                            time[0]=calcProductionTime(2,0,output,1-zones.getBonus(zoneNrF)/100,BUILDING_INPUT[currZoneType][output][0][0][1]/currAnimals)[0];
                                            time[1]=calcProductionTime(2,0,output,1-zones.getBonus(zoneNrF)/100,BUILDING_INPUT[currZoneType][output][0][0][1]/currAnimals,1)[0];
                                            for(var alt=1;alt<BUILDING_INPUT[currZoneType][output].length;alt++){
                                                time[0]=Math.min(time[0],calcProductionTime(2,0,output,1-zones.getBonus(zoneNrF)/100,BUILDING_INPUT[currZoneType][output][alt][0][1]/currAnimals)[0]);
                                                time[1]=Math.max(time[1],calcProductionTime(2,0,output,1-zones.getBonus(zoneNrF)/100,BUILDING_INPUT[currZoneType][output][alt][0][1]/currAnimals,1)[0]);
                                            }
                                            createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td,getTimeStr(time[0])+" - "+getTimeStr(time[1]));
                                            for(var alt=0;alt<BUILDING_INPUT[currZoneType][output].length;alt++){
                                                td=createElement("td",{"style":help+"border-left:1px dashed black;padding:0 5px;"},tr);
                                                for(var i=0;i<BUILDING_INPUT[currZoneType][output][alt].length;i++){
                                                    div=createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td);
                                                    produktPic(0,BUILDING_INPUT[currZoneType][output][alt][i][0],div);
                                                    createElement("span",{},div,"1 - "+numberFormat(calcProductionTime(2,0,output,1-zones.getBonus(zoneNrF)/100,BUILDING_INPUT[currZoneType][output][alt][0][1]/currAnimals)[1])+" "+prodName[0][BUILDING_INPUT[currZoneType][output][alt][i][0]]);
                                                    createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td,getTimeStr(BUILDING_INPUT[currZoneType][output][alt][i][1]/currAnimals));
                                                }
                                            }
                                            help="border-top:1px solid black;";
                                        }
                                    break;}
                                    case 3: case 13:{
                                        help="";
                                        for(var output in BUILDING_INPUT[currZoneType]){
                                            if(!BUILDING_INPUT[currZoneType].hasOwnProperty(output)){ continue; }
                                            if(prodBlock[0][output]){ continue; }
                                            tr=createElement("tr",{},table);
                                            td=createElement("td",{"style":help+"padding-right:10px;"},tr);
                                            div=createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td);
                                            produktPic(0,output,div);
                                            createElement("span",{},div,numberFormat(prodYield[0][output])+" "+prodName[0][output]);
                                            pointsFormat(prodYield[0][output]*prodPoints[0][output],"div",td);
                                            createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td,getTimeStr(60*prodGrowTime[0][output]*(100-zones.getBonus(zoneNrF))/100));
                                            for(var alt=0;alt<BUILDING_INPUT[currZoneType][output].length;alt++){
                                                td=createElement("td",{"style":help+"border-left:1px dashed black;padding:0 5px;"},tr);
                                                for(var i=0;i<BUILDING_INPUT[currZoneType][output][alt].length;i++){
                                                    div=createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td);
                                                    produktPic(0,BUILDING_INPUT[currZoneType][output][alt][i][0],div);
                                                    createElement("span",{},div,numberFormat(BUILDING_INPUT[currZoneType][output][alt][i][1])+" "+prodName[0][BUILDING_INPUT[currZoneType][output][alt][i][0]]);
                                                }
                                            }
                                            help="border-top:1px solid black;"
                                        }
                                    break;}
                                    //for fuelstation

                                   case 6:{
                                       GM_log("Fuelstation");
                                       help="";
                                       var data=unsafeWindow.farms_data.farms[farmNR][zoneNr];
                                       for(var slot=1;slot<=4;slot++)    {
                                           if((slot==1)||(!data.data.data.slots[slot]["block"])){
                                               const product = 350;
                                               var slotlevel = data.data.data.slots[slot].level;
                                               var iAmount=data.data.constants.slot_level[data.data.data.slots[slot].level].output;
                                               var iPoints=iAmount*prodPoints[0][product];
                                               var iTime=data.data.constants.slot_level[data.data.data.slots[slot].level].duration;

                                               tr=createElement("tr",{},table);
                                               td=createElement("td",{"style":help+"padding-right:10px;"},tr);
                                               createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td,"Slot"+slot);
                                               div=createElement("div",{"style":"line-height:16px;white-space:nowrap;"},td);
                                               produktPic(0,product,div);
                                               createElement("span",{},div,numberFormat(iAmount)+" "+prodName[0][product]);
                                               pointsFormat(iPoints,"span",td);
                                               createElement("span",{"style":"line-height:16px;white-space:nowrap;"},td,"  "+getTimeStr(iTime));

                                           }
                                           help="border-top:1px solid black;"
                                       }
                                       break;
                                       }

                                   }
                                   table=null;tr=null;td=null;div=null;
                                }
                                toolTip.show(event,buildinginfo.innerHTML,this);
                                buildinginfo=null;
                            }
                            help=null;
                        },false);

                    }
                    // Zone info - show current production
                    divZoneInfo=divZone.querySelector(".farm_pos_production");
                    if(!divZoneInfo){
                        divZoneInfo=createElement("div",{"class":"farm_pos_production"},divZone);
                    }
                    divZoneInfo.addEventListener("mouseover",function(event){
                        var help=/^farm(\d+)_pos(\d+)$/.exec(this.parentNode.id);
                        help=parseInt(help[2],10)+6*(parseInt(help[1],10)-1);
                        toolTip.show(event,toolTipZoneProduction(help));
                    },false);
                    // Mouseover
                    divZone.addEventListener("mouseout",function(){
                        hideBlase();
                        hideLagerZeitZiel();
                    },false);
                    divZone.addEventListener("mouseover",function(){
                        var help = /^farm(\d+)_pos(\d+)$/.exec(this.id);
                        help=parseInt(help[2],10)+6*(parseInt(help[1],10)-1)
                        showBlase(help);
                        showLagerZeitZiel(help);
                    },true);
                    // Mouseover by tooltip
                    if(div=divZone.querySelector(".farm_button_autoplant")){
                        div.addEventListener("mouseover",function(event){
                            toolTip.show(event,this.querySelector(".farm_button_tt").innerHTML,this);
                        },false);
                    }
                    if(div=divZone.querySelector(".farm_button_upgrade")){
                        div.addEventListener("mouseover",function(event){
                            toolTip.show(event,this.querySelector(".farm_button_tt").innerHTML,this);
                        },false);
                    }
                    if(div=divZone.querySelector(".farm_button_gardenspeedup")){
                        div.addEventListener("mouseover",function(event){
                            toolTip.show(event,this.querySelector(".farm_button_tt").innerHTML,this);
                        },false);
                    }
                    // Specific things
                    switch(currZoneType){
                    case 1:{ // field
                        // percentage of garbaged area
                        if((help=zones.getProduction(zoneNrF))&&help[2]&&(help[2][1]<BUILDING_SIZE["1"])){
                            createElement("div",{"id":"garbagePerc_"+zoneNrF,"class":"blackbox","style":"position:absolute;top:50px;left:50px;padding:4px;font-weight:bold;"},divZone.querySelector(".farm_pos_back"),numberFormat(100*help[2][1]/BUILDING_SIZE["1"])+"%");
                        }
                        // Production
                        if(div=$("farm_production_running"+farmNR+"_"+zoneNr)){
                            createElement("div",{"class":"v"+zones.getMainproduct(zoneNrF),"style":"position:absolute;"},div);
                        }
                        // Watering timer
                        createZoneTimer("zoneTimerWater_"+zoneNrF,zoneNrF,"zoneTimerWater","top:20px;left:5px;",divZone);
                    break;}
                    case 2:{ // chicken
                        // more animals
                        createElement("img",{"src":GFX+"chickenmapani2.gif","style":"position:absolute;top:30px;left:10px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"chickenmapani2.gif","style":"position:absolute;top:30px;left:50px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"chickenmapani1.gif","style":"position:absolute;top:50px;left:70px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"chickenmapani1.gif","style":"position:absolute;top:60px;left:30px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"chickenmapani1.gif","style":"position:absolute;top:80px;left:30px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"chickenmapani2.gif","style":"position:absolute;top:100px;left:50px;"},divZone.firstElementChild.firstElementChild);
                    break;}
                    case 4:{ // sheep
                        // more animals
                        createElement("img",{"src":GFX+"sheep_ani01.gif","style":"position:absolute;top:60px;left:30px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"sheep_ani02.gif","style":"position:absolute;top:30px;left:10px;"},divZone.firstElementChild.firstElementChild);
                    break;}
                    case 12:{ // goats
                        // more animals
                        createElement("img",{"src":GFX+"goat_ani_01.gif","style":"position:absolute;top:105px;left:50px;"},divZone.firstElementChild.firstElementChild);
                        createElement("img",{"src":GFX+"goat_ani_02.gif","style":"position:absolute;top:75px;left:30px;"},divZone.firstElementChild.firstElementChild);
                    break;}
                    case 13:{ // oil
                        if(div=$("farm_production_current13_"+zoneNr)){ divZone.appendChild(div); }
                    }
                    case 14:{ // special oil
                        if(div=$("farm_production_current14_"+zoneNr)){ divZone.appendChild(div); }
                    }
                    }
                }
                divZone=null;divZoneInfo=null;div=null;
            }
        }catch(err){GM_logError("doFarmZone","farmNR="+farmNR+" zoneNr="+zoneNr,"",err);}
    }
    unsafeData.carpentry_bonus=parseInt($("carpentry_icon_currentbonus").innerHTML,10);
    unsafeOverwriteFunction("farmBuildPositions",function(){
        try{
            unsafeWindow._farmBuildPositions();
        }catch(err){GM_logError("_farmBuildPositions","","",err);}
        try{
            var farmNr,zoneNr,zoneNrF,data,currZoneType,currBlock,currBonus,currBonusSpecial,help;
            totalAnimals=[];
            if(!unsafeData.carpentry_bonus){ unsafeData.carpentry_bonus=0; }
            for (var d in unsafeWindow.farms_data.farms) {
                if(!unsafeWindow.farms_data.farms.hasOwnProperty(d)){ continue; }
                //if (d > unsafeWindow.farms_data.count) { break; }
                for (var c in unsafeWindow.farms_data.farms[d]) {
                    if(!unsafeWindow.farms_data.farms[d].hasOwnProperty(c)){ continue; }
                    data=unsafeWindow.farms_data.farms[d][c];
                    farmNr=parseInt(d,10);
                    zoneNr=parseInt(c,10);
                    zoneNrF=zoneNr+6*(farmNr-1);
                    currZoneType=parseInt(data.buildingid,10);
                    currBlock="";
                    if(BUILDINGTYPE[currZoneType]==0){
                        currBlock+="t"; //blocked by type (Club & Carpentry)
                    }
                    if(BUILDINGTYPE[currZoneType]==10){
                        currBlock+="b"; //block by type Bergstation / hillwalk
                    }

                    //Sushi Bar
                    /*
                    if(BUILDINGTYPE[currZoneType]==13){
                        currBlock+="b"; //block by type Sushi Bar
                    }
                    */

                    if(data.bulldoze&&data.bulldoze.quest){
                        currBlock+="q"; //blocked by quest
                    }
                    if(data.bulldoze&&data.bulldoze.cost){
                        currBlock+="b"; //blocked by payment
                    }
                    if(data.status=="0"){
                        currBlock+="s"; //blocked by status
                    }
                    if ((unsafeWindow.premium!=1)&&(data.premium==1)){
                        currBlock+="p"; //premium-zone but no premium-account
                    }
                    currBonus=((BUILDING_UPGRADES[currZoneType]&&BUILDING_UPGRADES[currZoneType][data.level-1])?Math.round(100*(1-BUILDING_UPGRADES[currZoneType][data.level-1][2])):0);
                    currBonusSpecial=null;
                    if (currZoneType==1){ // Field
                        if(questData["main"]["1"]["nr"]>170){ currBonus+=5; } // global bonus gained by quest 170
                        if(data.product){
                            currBonusSpecial=[parseInt(data.product,10),10]; // the id of special plant, additional bonus for special plant
                        }
                    }
                    zones.setBuilding(zoneNrF,currZoneType);
                    zones.setBlock(zoneNrF,currBlock);
                    zones.setBonus(zoneNrF,currBonus);
                    zones.setBonusSpecial(zoneNrF,currBonusSpecial);
                    if(currBlock){
                        zones.setProduction(zoneNrF,[[],0,0,true]);
                        if(help=zones.isMultiSlot(zoneNrF)){
                            for(var slot=1;slot<=help;slot++){
                                zones.setProduction(zoneNrF+"."+slot,[[],0,0,true]);
                            }
                        }
                    }
                    if(data.animals){
                        zones.setAnimals(zoneNrF,parseInt(data.animals,10));
                    }
                }
            }
            for (var d in unsafeWindow.farms_data.farms) {
                if(!unsafeWindow.farms_data.farms.hasOwnProperty(d)){ continue; }
                //if (d > unsafeWindow.farms_data.count) { break; }
                for (var c in unsafeWindow.farms_data.farms[d]) {
                    if(!unsafeWindow.farms_data.farms[d].hasOwnProperty(c)){ continue; }
                    doFarmZone(parseInt(d,10),parseInt(c,10));
                }
            }
            calcTotalZones();
            lastGiess=null;
            lastErnte=null;
            // Event
            raiseEvent("gameFarmLoaded");
        }catch(err){GM_logError("farmBuildPositions","","zoneNrF="+zoneNrF,err);}
    });
    // Farm filling
    // initZones > getUserFarmInfos > userFarmInfosResponse > getTimeEvents >
    // unsafeOverwriteFunction("initZones",function(farmid){
    //  unsafeWindow._initZones(farmid);
    // });

    function drawZoneNavi(zoneNrF,container){
    try{
        var newdiv=$("zoneNavi");
        if(newdiv){ removeElement(newdiv); }
        newdiv=createElement("div",{"id":"zoneNavi"},container);
        var newdiv1;
        var c=[null,null,null];
        for(var i=0;i<ALL_ZONES["farm"].length;i++){
            if(ALL_ZONES["farm"][i]==zoneNrF){
                c[1]=i;break;
            }
        }
        if(c[1]!=null){
            c[2]=((c[1]+1)%ALL_ZONES["farm"].length);
            while(zones.getBlock(ALL_ZONES["farm"][c[2]])||(zones.getBuilding(ALL_ZONES["farm"][c[2]])!=zones.getBuilding(zoneNrF))){
                c[2]=((c[2]+1)%ALL_ZONES["farm"].length);
            }
            if (c[1]!=c[2]){
                c[0]=((c[1]+ALL_ZONES["farm"].length-1)%ALL_ZONES["farm"].length);
                while(zones.getBlock(ALL_ZONES["farm"][c[0]])||(zones.getBuilding(ALL_ZONES["farm"][c[0]])!=zones.getBuilding(zoneNrF))){
                    c[0]=((c[0]+ALL_ZONES["farm"].length-1)%ALL_ZONES["farm"].length);
                }
                if (c[0]!=c[2]){
                newdiv1=createElement("div",{"class":"link leftarrow","zone":ALL_ZONES["farm"][c[0]]},newdiv);
                newdiv1.addEventListener("click",function(){
                    if(this.parentNode){ removeElement(this.parentNode); }
                    goToZone(this.getAttribute("zone"));
                },false);
                newdiv1.addEventListener("mouseover",function(event){
                    var zone=parseInt(this.getAttribute("zone"),10);
                    toolTip.show(event,getText("goToX").replace(/%1%/,zones.getName(zone)));
                    zone=null;
                },false);
                }
                newdiv1=createElement("div",{"class":"link rightarrow","zone":ALL_ZONES["farm"][c[2]]},newdiv);
                newdiv1.addEventListener("click",function(){
                    if(this.parentNode){ removeElement(this.parentNode); }
                    goToZone(this.getAttribute("zone"));
                },false);
                newdiv1.addEventListener("mouseover",function(event){
                    var zone=parseInt(this.getAttribute("zone"),10);
                    toolTip.show(event,getText("goToX").replace(/%1%/,zones.getName(zone)));
                    zone=null;
                },false);
            }
        }
        newdiv=null;newdiv1=null;
    }catch(err){GM_logError("drawZoneNavi","","zoneNrF="+zoneNrF,err);}
    }

    // field
    function checkFieldTimes(){
    try{
    if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","checkFieldTimes"); }
        var zoneNr=parseInt(/parent.cache_me\((\d+?),120/.exec($("gardenarea").innerHTML)[1],10);
        var zoneNrF=zoneNr+6*gameLocation.get()[1];
        var newData=[[{}],[,0,0,,0],[,0,0,,0],true];

        // save garden-informations
        var helpArray=new Array();//planted fields
        var helpArray2=new Array();//empty fields
        var z,p,w,iAmount,iPoints,help;
        for(var v=1;v<=BUILDING_SIZE["1"];v++){
            z=parseInt(unsafeWindow.garten_zeit[v],10);
            p=unsafeWindow.garten_prod[v];
            switch(unsafeWindow.garten_kategorie[v]){
            //Linus-Tux 20151015
            case "v":
            case "hr":
            case "ex":
            case "alpin":
            case "water": { // plants
                helpArray[v]=true;
                helpArray2[v]=false;
                if (z>0){
                    iAmount=(prodYield[0][p]+((currentPowerup[p]&&(z<currentPowerup[p][0]))?currentPowerup[p][1]:0));
                    iPoints=(prodPoints[0][p]+((currentPowerup[p]&&(z<currentPowerup[p][0]))?currentPowerup[p][2]:0));

                    if ((unsafeWindow.garten_x[v]==1)&&(unsafeWindow.garten_y[v]==1)){ // only first part of a plant
                        w=parseInt(unsafeWindow.garten_wasser[v],10)+86400;
                        w=((w==86400)?1:(w<z?w:NEVER)); // watertime
                        if(!newData[0][0][p]){ newData[0][0][p]=new Array(); }
                        var notfound=true;
                        for(var i=0;i<newData[0][0][p].length;i++){
                            if((newData[0][0][p][i][2]==z)&&(newData[0][0][p][i][3]==w)){
                                newData[0][0][p][i][0]+=iAmount;
                                newData[0][0][p][i][1]+=iPoints;
                                notfound=false;break;
                            }
                        }
                        if(notfound){ newData[0][0][p].push([iAmount,iPoints,z,w]); }
                    }
                    // only show one sprinkler
                    if ((unsafeWindow.garten_x[v]==2)||(unsafeWindow.garten_y[v]!=unsafeWindow.garten_max_y[v])){
                        if ($("w"+v).style.display!="none") $("w"+v).style.display="none";
                    }else{
                        if ($("w"+v).style.display!="") $("w"+v).style.display="";
                    }
                }else{
                    helpArray[v]=true;
                    helpArray2[v]=true;
                }
            break;}
            case "z":{ // decorations
                helpArray[v]=false;
                helpArray2[v]=false;
                if ((unsafeWindow.garten_x[v]==1)&&(unsafeWindow.garten_y[v]==1)){ // only first part
                    if(!newData[0][0][p]){ newData[0][0][p]=new Array(); }
                    var notfound=true;
                    for(var i=0;i<newData[0][0][p].length;i++){
                        if((newData[0][0][p][i][2]==z)){
                            newData[0][0][p][i][0]++;
                            notfound=false;break;
                        }
                    }
                    if(notfound){ newData[0][0][p].push([1,0,z]); }
                }
            break;}
            case "u":{ // garbage
                helpArray[v]=false;
                helpArray2[v]=false;
                if(!newData[0][0][p]){ newData[0][0][p]=1; }
                else{ newData[0][0][p]++; }
            break;}
            default:{ // empty fields , p==0
                helpArray[v]=true;
                helpArray2[v]=true;
            break;}
            }
        }
        // calculate current space
        for(var v=1;v<helpArray2.length;v++){
            if(helpArray2[v]){ newData[1][1]++; }
        }
        help=helpArray2.clone();
        for(var v=1;v<help.length;v++){
            if((v%12!=0)&&help[v]&&help[v+1]){
                help[v+1]=false;
                newData[1][2]++;
            }
        }
        help=helpArray2.clone();
        for(var v=1;v<help.length;v++){
            if((v%12!=0)&&help[v]&&help[v+1]&&help[v+12]&&help[v+13]){
                help[v+1]=false;
                help[v+12]=false;
                help[v+13]=false;
                newData[1][4]++;
            }
        }
        // calculate possible space
        for(var v=1;v<helpArray.length;v++){
            if(helpArray[v]){ newData[2][1]++; }
        }
        help=helpArray.clone();
        for(var v=1;v<help.length;v++){
            if((v%12!=0)&&help[v]&&help[v+1]){
                help[v+1]=false;
                newData[2][2]++;
            }
        }
        help=helpArray.clone();
        for(var v=1;v<help.length;v++){
            if((v%12!=0)&&help[v]&&help[v+1]&&help[v+12]&&help[v+13]){
                help[v+1]=false;
                help[v+12]=false;
                help[v+13]=false;
                newData[2][4]++;
            }
        }
        // calculate garden-informations
        zones.setProduction(zoneNrF,newData.clone());
        newData=null;
        // auto-watering
        if((top.unsafeData.autoAction==null)&&valAutoWater["farm"] && (zones.getWatertime(zoneNrF)<unsafeWindow.Zeit.Server) && (lastGiess!=zoneNrF) && $("tooltipwaterall") && $("waterall")){
            top.unsafeData.autoAction="berater: field water";
            lastGiess=zoneNrF;
            window.setTimeout(function(div){
                click(div);
                top.unsafeData.autoAction=null;
            },500,$("waterall").firstElementChild);
        }
        //auto-cropping
        if((top.unsafeData.autoAction==null)&&valAutoCrop["farm"] && (zones.getEndtime(zoneNrF)<unsafeWindow.Zeit.Server) && (lastErnte!=zoneNrF) && $("tooltipcropall") && $("cropall")){
            top.unsafeData.autoAction="berater: field crop";
            lastErnte=zoneNrF;
            window.setTimeout(function(div){
                click(div);
                top.unsafeData.autoAction=null;
            },500,$("cropall").firstElementChild);
        }
        // update zone-icons
        // TODO!
        // show croppings of this field
        var cell=$("currentFieldZoneErnte");
        var newdiv;
        if(cell){ cell.innerHTML=""; }
        else{ cell=createElement("div",{"id":"currentFieldZoneErnte","style":"position:absolute;top:40px;left:0;","class":"blackbox"},$("gardenmaincontainer")); }
        help=zones.getCrop(zoneNrF);
        for(var k=0;k<help.length;k++){
            newdiv=createElement("div",{"style":"height:15px"},cell);
            produktPic(help[k][0],help[k][1],newdiv);
            createElement("span",{},newdiv,numberFormat(help[k][2])+"&nbsp;"+prodName[help[k][0]][help[k][1]]);
        }
        cell=null;newdiv=null;
    if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
    }catch(err){ GM_logError("checkFieldTimes","","",err); }
    }

    unsafeOverwriteFunction("getGardenInfoResponse",function(request,zoneNr){
        try{
            unsafeWindow._getGardenInfoResponse(request,zoneNr);
        }catch(err){GM_logError("_getGardenInfoResponse","","",err);}
        try{
            // GM_log("getGardenInfoResponse zoneNr="+zoneNr+"\n"+print_r(eval('('+response+')'),"",true,"\n"));
            //waterlog GM_log("getGardenInfoResponse zoneNr="+zoneNr+"\nwater: "+print_r(eval('('+response+')')["water"],"",true,"\n"));
            zoneNr=parseInt(zoneNr,10);
            var zoneNrF=zoneNr+6*gameLocation.get()[1];
            if (!$("divErnteInfo")){ createElement("div",{"id":"divErnteInfo"},$("gardenmaincontainer")); }
            $("gardenmaincontainer").setAttribute("zoneNr",zoneNr);
            drawZoneNavi(zoneNrF,$("gardenmaincontainer"));
            showLagerZeitZiel(zoneNrF);

            //Klon des Anpflanzautomaten
            /*
            var newdiv;
            if($("gardencancel").childElementCount==1 && $("autoplantbutton"+zoneNr)){
                newdiv=$("autoplantbutton"+zoneNr).parentNode.cloneNode(true);
                newdiv.addEventListener("click",function(){$("gardenmaincontainer").setAttribute("style","display:none");},false);
                $("gardencancel").appendChild(newdiv);
            }
            newdiv=null;
            */
            checkFieldTimes();
        }catch(err){GM_logError("getGardenInfoResponse","","",err);}
    });

    function setFarmProductionInfos() {
        // Rescedule, if data is not ready
        if (Object.getOwnPropertyNames(unsafeWindow.farms_data.farms).length==0) {
            window.setTimeout(setFarmProductionInfos,100);
            return;
        }

        var z,p,w,iAmount,iPoints,skip;
        var zoneNrF, aktZone, newData, oldData;
        for(var farm in unsafeWindow.farms_data.farms){
            if (!unsafeWindow.farms_data.farms.hasOwnProperty(farm)) {continue};

            for(var zone in unsafeWindow.farms_data.farms[farm]){
                if (!unsafeWindow.farms_data.farms[farm].hasOwnProperty(zone)) {continue};

                aktZone=unsafeWindow.farms_data.farms[farm][zone];
                zoneNrF=6*(parseInt(farm, 10)-1)+parseInt(zone, 10);

                // Check, if old production data is still valid
                oldData=zones.getProduction(zoneNrF);
                skip=false;
                try{
                    for(var oldProdId in oldData[0][0]) {
                        try{
                            if (!oldData[0][0].hasOwnProperty(oldProdId)) {continue};
                            //skip=oldData[0][0][oldProdId][0][2]>now; // Skip renewing production data, if old production is still running

                        }catch(err){GM_logError("Mist1","zoneNrF="+oldProdId,"",err);}
                        /*
                        if (!oldData[0][0].hasOwnProperty(oldProdId)) {continue};
                        */
                        try{
                            skip=oldData[0][0][oldProdId][0][2]>now; // Skip renewing production data, if old production is still running

                        }catch(err){GM_logError("Mist3","zoneNrF="+oldProdId,"",err);}
                        //skip=oldData[0][0][oldProdId][0][2]>now; // Skip renewing production data, if old production is still running

                    }
                }catch(err){GM_logError("Mist2","oldProdId="+oldProdId,"",err);}

                // Skip not-yet-enabled or blocked zones, non-fields and skippable fields
                if (!aktZone.status || aktZone.premiumblock || aktZone.buildingid != 1 || skip) {continue};

                newData=[[{}],[,0,0,,0],[,120,60,,30],true];
                if (aktZone.production) {
                    p=aktZone.production[0].pid; // ProductId
                    z=aktZone.production[0].remain; // Seconds until production is ready
                    iAmount=(prodYield[0][p]+((currentPowerup[p]&&(now+z<currentPowerup[p][0]))?currentPowerup[p][1]:0));
                    iAmount=iAmount*120/prodPlantSize[0][p];

                    iPoints=(prodPoints[0][p]+((currentPowerup[p]&&(now+z<currentPowerup[p][0]))?currentPowerup[p][2]:0));
                    iPoints=iPoints*120/prodPlantSize[0][p];

                    w=NEVER;
                    if (aktZone.water) {
                        for (var i=aktZone.water.length-1; i>=0; i--) {
                            w=Math.min(w, aktZone.water[i].waterremain);
                        }
                        if (w<0) {w=1;} // If watering is needed, then in 1s
                    }
                    w=w<z?w+now:NEVER; // If watering is needed, then now+1s, else NEVER

                    if(!newData[0][0][p]){ newData[0][0][p]=new Array(); }
                    newData[0][0][p].push([iAmount,iPoints,now+z,w]);
                } else {
                    // Field is empty
                    newData[1]=[,120,60,,30];
                }
                zones.setProduction(zoneNrF,newData.clone());
                newData=null;
            }

        }
    }
    setFarmProductionInfos();

    unsafeOverwriteFunction("farmAction",function(mode,farm,position,s,d,b,a){
        try{
            switch(mode){
            case "dailydonkey":{
                // Only consider opening donkeyInfoPanel, if donkey is bought
                if(unsafeWindow.donkey_isset && (undefined!=logDonkeyId[todayServerStr])){
                    unsafeWindow.buildInfoPanel("donkey");
                    return false;
                }
            break;}
            }
        }catch(err){GM_logError("farmAction","mode="+mode,"","(pre) "+err);}
        try{
            //GM_log("farmAction: mode:"+ mode + " s:"+s+" d:"+d+" b:"+b+" a:"+a);
            unsafeWindow._farmAction(mode,farm,position,s,d,b,a);
        }catch(err){GM_logError("_farmAction","mode="+mode,"",err);}
    });
/*
    unsafeOverwriteFunction("ajaxActionResponse", function(b, c, d, e) {
        // b = Sowas, wie der Request bei farmActionResponse
        // c = Begriff, der die Aktion beschreibt (bspw. "start" bei Start der Strickerei)
        // d = Farm, Position, Slot des Gebäudes und welches Item
        // e = Callback-Funktion in Factory-Objekt, in welchem seit dem 14.03.2017 u.a. Strickerei und Ölerei abgebildet sind
        try {
            unsafeWindow._ajaxActionResponse(b, c, d, e);
        } catch (err) { GM_logError("_ajaxActionResponse", "mode=" + mode, "", err); }

        console.log("+++++++++++ajaxActionResponse+++++++++++");
        console.log(implode(b));
        console.log(implode(c));
        console.log(implode(d));
        console.log(implode(e));
        console.log("+++++++++++ajaxActionResponse+++++++++++");

        // Werfe Event à la "gameFactory_start_3_6". Falls auch nicht-Factories hier rein laufen, könnte man überlegen, den Prefix umzubenennen
        //doKnitting(d.position);


        //raiseEvent("gameFactory_"+c+"_"+d.farm+"_"+d.position);
    });
*/


    unsafeOverwriteFunction("farmActionResponse", function(request, mode, farmNR, zoneNr, B, d, b, a) {
        try {
            unsafeWindow._farmActionResponse(request, mode, farmNR, zoneNr, B, d, b, a);
        } catch (err) { GM_logError("_farmActionResponse", "mode=" + mode, "", err); }
        try {
            var r = checkRequest(request, mode);
            if ((r != 0) && (r[0] != 0)) {
                switch (mode) {
                    case "autoplant":
                        {
                            var zoneNrF = zoneNr + 6 * (farmNR - 1);
                            if (1 == zones.getBuilding(zoneNrF)) {
                                checkFieldTimes();
                                raiseEvent("gameFieldPlanted");
                            }
                            break;
                        }
                    case "cropgarden":
                        {
                            var zoneNrF = zoneNr + 6 * (farmNR - 1);
                            if (1 == zones.getBuilding(zoneNrF)) {
                                checkFieldTimes();
                                raiseEvent("gameFieldCropped");
                            }
                            break;
                        }
                    case "dogbonus":
                        doDogBen();
                        raiseEvent("gameGetFarmDog");
                        break;
                    case "flowerarea_harvest_all":
                        raiseEvent("gameFarmersmarketCropped");
                        break;
                    case "flowerarea_autoplant":
                        raiseEvent("gameFarmersmarketStarted");
                        break;
                    case "flowerarea_water_all":
                        raiseEvent("gameFarmersmarketWatered");
                        break;
                    case "foodcontest_feed":
                        doFarmersMarketData();
                        raiseEvent("gameSpeedEatingFeedFighter");
                        break;
                    case "foodcontest_merchpin":
                        doFarmersMarketData();
                        raiseEvent("gameSpeedEatingOpenMergeCash");
                        break;
                    case "foodcontest_pincache":
                        doFarmersMarketData();
                        raiseEvent("gameSpeedEatingCacheClick");
                        break;
                    case "fuelstation_harvest":
                        doFuelstation(zoneNr);
                        raiseEvent("gameFuelstationHarvest");
                        break; //Fuelstation geerntet
                    case "fuelstation_entry":
                        doFuelstation(zoneNr);
                        raiseEvent("gameFuelstationEntry");
                        break; //Produkte eingeworfen
                    case "gardeninit":
                        {
                            var zoneNrF = zoneNr + 6 * (farmNR - 1);
                            if (1 == zones.getBuilding(zoneNrF)) {
                                raiseEvent("gameFieldOpened");
                            }
                            break;
                        }
                    case "harvestproduction":
                        {
                            var zoneNrF = zoneNr + 6 * (farmNR - 1);
                            switch (zones.getBuilding(zoneNrF)){
                                case 13:
                                case 14:
                                case 16:
                                case 21:
                                    raiseEvent("gameFactoryOilKnittingTeaCropped");
                                    break;
                                default:
                                    raiseEvent("harvestproduction");
                            }
                            break;
                        }
                    case "map_sendvehicle":
                        raiseEvent("gameMapSendVehicle");
                        break;
                    case "megafield_plant":
                        raiseEvent("gameMegafieldPlanted");
                        break;
                    case "megafield_tour":
                        raiseEvent("gameMegafieldTourStarted");
                        break;
                    case "megafield_vehicle_buy":
                        raiseEvent("gameMegafieldVehicleBought");
                        break;
                    case "megafield_autoplant":
                        raiseEvent("gameMegafieldAutoplanted");
                        break;
                    case "megafruit_buyobject": {
                            doFarmersMarketData();
                            raiseEvent("gameMegafruit_buyobject");
                            break;
                        }
                    case "megafruit_harvest": {
                            hideGoToMonsterFruitCultureReady();
                            break;
                        }
                    case "megafruit_start":{
                            doFarmersMarketData();
                            break;
                    }
                    case "nursery_harvest":
                        raiseEvent("gameFarmersmarketCropped");
                        break;
                    case "nursery_startproduction":
                        raiseEvent("gameFarmersmarketStarted");
                        break;
                    case "vet_harvestproduction":
                        raiseEvent("gameFarmersmarketCropped");
                        break;
                    case "vet_startproduction":
                        raiseEvent("gameFarmersmarketStarted");
                        break;
                    case "pony_buy":
                        doPony(zoneNr);
                        break;
                    case "pony_crop":
                        doPony(zoneNr);
                        raiseEvent("gamePonyCropped");
                        break;
                    case "pony_feed":
                        doPony(zoneNr);
                        raiseEvent("gamePonyFed");
                        break;
                    case "pony_setfarmi":
                        doPony(zoneNr);
                        raiseEvent("gamePonyFarmiSet");
                        break;
                    case "pony_speedup":
                        doPony(zoneNr);
                        raiseEvent("gamePonySpeedup");
                        break;
                    case "reallocatebuilding":
                        {
                            // B=='farm1,zone1,farm2,zone2'
                            varset = B.split(",");
                            var building1 = (6 * parseInt(set[0], 10)) + parseInt(set[1], 10);
                            var building2 = (6 * parseInt(set[2], 10)) + parseInt(set[3], 10);
                            zones.swap(building1, building2);
                            unsafeData.reallocateBuildingSet = [building1, building2];
                            raiseEvent("gameReallocateBuilding");
                            break;
                        }
                    case "sellfarmi":
                        {
                            calcFarmiCost();
                            calcTotalFarmis();
                            doFarmis();
                            raiseEvent("gameFarmiResponse");
                            break;
                        }
                    case "vet_endtreatment":
                        {
                            raiseEvent("gameVet_endtreatment"); // Tier entlassen
                            break;
                        }
                    case "vet_setslot":
                        {
                            raiseEvent("gameVet_setslot"); // Krankes Tier auf Slot

                            break;
                        }
                    case "vet_starttreatment":
                        {
                            doFarmersMarketData();
                            raiseEvent("gameVet_starttreatment"); // Tier-Behandlung starten
                            break;
                        }
                    case "watergarden":
                        {
                            var zoneNrF = zoneNr + 6 * (farmNR - 1);
                            if (1 == zones.getBuilding(zoneNrF)) {
                                checkFieldTimes();
                                raiseEvent("gameFieldWatered");
                            }
                            break;
                        }
                }
            } else {
                switch (mode) {
                    case "dailydonkey":
                        {
                            if (unsafeWindow.donkey_isset && r != 0 && r[0] == 0 && (undefined === logDonkeyId[todayServerStr])) {
                                // Save dummy for today's donkey log
                                var newElem = [todayServerStr, 0, []];
                                logDonkey.push(newElem);
                                logDonkeyId[todayServerStr] = logDonkeyId.length - 1;
                                GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_logDonkey", implode(logDonkey, "farmActionResponse/logDonkey"));
                                hideGoToDonkey();
                            }
                            raiseEvent("gameDonkeyResponse");
                            break;
                        }
                }
            }
        } catch (err) { GM_logError("farmActionResponse", "mode=" + mode, "", err); }
    });
    unsafeOverwriteFunction("ponySelectFarmi",function(farmiId){
        try{
            unsafeWindow._ponySelectFarmi(farmiId);
        }catch(err){GM_logError("_ponySelectFarmi","","",err);}
        try{
            if (unsafeWindow.pony_sel_farmi) { // if unsafeWindow.pony_sel_farmi == 0 => Farmi has been unselected
                raiseEvent("gamePonyFarmiSelected");
            }
        }catch(err){GM_logError("ponySelectFarmi","","",err);}
    });
    unsafeOverwriteFunction("ponyDialog",function(h, b, n){
        try{
            unsafeWindow._ponyDialog(h, b, n); // 'feed' | 'setfarmi', pony_slot, undefined
        }catch(err){GM_logError("_ponyDialog","","",err);}
        try{
            if (h == "feed") {
                raiseEvent("gamePonyFeedDialogOpened");
            } else if (h == "setfarmi") {
                raiseEvent("gamePonySetDialogOpened");
            } else if (h == "speedup"){
                raiseEvent("gamePonySetDialogSpeedup");
            }
        }catch(err){GM_logError("ponyDialog","","",err);}
    });

    unsafeOverwriteFunction("AbrissResponse",function(request){
        try{
            unsafeWindow._AbrissResponse(request);
        }catch(err){GM_logError("_AbrissResponse","","",err);}
        try{
            if((request.success == 1 )){
                checkFieldTimes();
                raiseEvent("gameFieldDemolish");
            }
        }catch(err){GM_logError("AbrissResponse","","",err);}
    });
    unsafeOverwriteFunction("killGardenTimeruns",function(){
        try{
            unsafeWindow._killGardenTimeruns();
        }catch(err){GM_logError("_killGardenTimeruns","","",err);}
        try{
            lastGiess=null;
            lastErnte=null;
            if ($("divErnteInfo")){ removeElement($("divErnteInfo")); }
            if ($("zoneNavi")){ removeElement($("zoneNavi")); }
            //if ($("lager_zeit_ziel").parentNode.style.display == "") $("lager_zeit_ziel").parentNode.style.display="none";
        }catch(err){GM_logError("killGardenTimeruns","","",err);}
    });
    unsafeOverwriteFunction("errorboxgarden",function(text,onclick){
        try{
            unsafeWindow._errorboxgarden(text,onclick);
        }catch(err){GM_logError("_errorboxgarden","","",err);}
        try{
            // Fix(Seberoth)
            // $("divErnteInfo").innerHTML=$("errorboxcontentgarden").innerHTML;
            $("divErnteInfo").innerHTML=document.getElementsByClassName('cropall_dialog_product')[0].innerHTML;
            $("divErnteInfo").style.display="block";
            if (valErnteMsg){
                // Fix(Seberoth)
                // $("errorboxgarden").style.display="none";
                $("globalbox").style.display="none";
                $("globaltransp").style.display="none";
            }
            // Fix(Seberoth)
            // var zoneNr=/refreshGarden\((\d)\)/.exec($("errorboxfootergarden").parentNode.innerHTML);
            var zoneNr=/refreshGarden\((\d)\)/.exec($("globalbox_button1").parentNode.innerHTML);
            if(zoneNr){
                zoneNr=zoneNr[1];
                unsafeWindow.refreshGarden(zoneNr);
            }
        }catch(err){GM_logError("errorboxgarden","","",err);}
    });

    // Dog Ben
    function doDogBen(){
        try{
            unsafeWindow.farmdog_harvest=1;
            var zoneNrF,zoneNrS,iProd,item,tempZoneProductionData,help,endTime; //Fix Linus--Tux *endTime hinzugefügt
            var allZones=[];
            var nowServer=unsafeWindow.Zeit.Server;
            for(var i=ALL_ZONES["farm"].length-1;i>=0;i--){
                zoneNrF=ALL_ZONES["farm"][i];
                if(!zones.getBlock(zoneNrF)){
                    allZones.push(zoneNrF);
                    if(help=zones.isMultiSlot(zoneNrF)){
                        for(var j=1;j<=help;j++){
                            zoneNrS=zoneNrF+"."+j;
                            if(!zones.getBlock(zoneNrS)){
                                allZones.push(zoneNrS);
                            }
                        }
                    }
                }
            }
            for(var j=allZones.length-1;j>=0;j--){
                zoneNrS=allZones[j];
                tempZoneProductionData=zones.getProduction(zoneNrS);
                if(tempZoneProductionData&&tempZoneProductionData[0]){
                    for(var iType=0;iType<tempZoneProductionData[0].length;iType++){
                        for(var iProdStr in tempZoneProductionData[0][iType]){
                            if(!tempZoneProductionData[0][iType].hasOwnProperty(iProdStr)){ continue; }
                            iProd = parseInt(iProdStr,10);
                            if((prodTyp[iType][iProd]!="u")&&(prodTyp[iType][iProd]!="z")){ // only products
                                item=tempZoneProductionData[0][iType][iProdStr];
                                for(var i=0;i<item.length;i++){
                                    item[i][2]=Math.max(item[i][2]-600,nowServer);
                                    //Fix Linus--Tux
                                    endTime=item[i][2];
                                    if(item[i][2]<item[i][3]){ item[i][3]=NEVER; }
                                }
                            }
                        }
                    }
                }
                zones.setProduction(zoneNrS,tempZoneProductionData.clone());
                //Fix Linus--Tux
                zones.setEndtime(zoneNrS, endTime);
                tempZoneProductionData=null;
            }
            //Fix Linus--Tux
            calcTotalEndtime();
            zones.save();
        }catch(err){GM_logError("doDogBen","","",err);}
    }

    // Stable
    function doStable(farmNr,zoneNr){
    try{
        var zoneNrF=zoneNr+6*(farmNr-1);
        drawZoneNavi(zoneNrF,$("building_inner"));
        if (valAutoCrop["farm"]&&(div=$("commitboxcrop"))&&(div.style.display=="block")&&(div=$("commitboxfootercrop"))){
            window.setTimeout(function(div){ click(div); },500,div.firstElementChild);
        }
        for(var v=0;v<ANIMAL_MOVE.length;v++){ if((valMoveAnimals[v])&&(!ANIMAL_MOVE[v][0])&&($("animalline"+v))){
            ANIMAL_MOVE[v][0]=true;
            moveAnimals(v);
            break;
        }}
        var data=unsafeWindow.buildingdata[farmNr][zoneNr];
        var tempZoneProductionData=[[{}],0,0,true];
        tempZoneProductionData[2]=1;
        if(undefined===data.remain){ // empty
            tempZoneProductionData[1]=1;
        }else if(data.remain>0){ // running
                var iPrTyp=0;
                var iProd=data.pid;
                var iTime=data.remain+now-unsafeWindow.Zeit.Verschiebung;
                var iAmount=data.crop;
                var iPoints=data.crop*prodPoints[iPrTyp][iProd];
                if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
                tempZoneProductionData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
        }else{ // done
                var iPrTyp=0;
                var iProd=data.pid;
                var iTime=Math.min(now-unsafeWindow.Zeit.Verschiebung,zones.getEndtime(zoneNrF));
                var iAmount=data.crop;
                var iPoints=data.crop*prodPoints[iPrTyp][iProd];
                if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
                tempZoneProductionData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
        }
        zones.setProduction(zoneNrF,tempZoneProductionData.clone());
        tempZoneProductionData=null;
    }catch(err){GM_logError("doStable","farmNr="+farmNr+" zoneNr="+zoneNr,"zoneNrF="+zoneNrF,err);}
    }
    unsafeOverwriteFunction("rewriteBuildingInnerFeed",function(e,a){
        try{
            unsafeWindow._rewriteBuildingInnerFeed(e,a);
        }catch(err){GM_logError("_rewriteBuildingInnerFeed","","",err);}
        try{
            var d = unsafeWindow.buildingdata[e][a];
            var div;
            for (var b in d.feed) {
                if(!d.feed.hasOwnProperty(b)){ continue; }
                if(div=$("feed_item"+b)){
                    var currProd=parseInt(b,10);
                    var str="blackbox"+(prodStock[0][currProd]<prodMinRack[0][currProd]?" lowrack":"");
                    createElement("div",{"id":"feed_item"+b+"_rackamount","class":str,"style":"position:absolute;top:-25px;left:-2px;font-weight:bold;"},div,numberFormatPrefixed(prodStock[0][currProd]));
                }
            }
        }catch(err){GM_logError("rewriteBuildingInnerFeed","","",err);}
    });
    unsafeOverwriteFunction("buildingInnerActionResponse",function(request,action,farm,position){
        try{
            unsafeWindow._buildingInnerActionResponse(request,action,farm,position);
        }catch(err){GM_logError("_buildingInnerActionResponse","","",err);}
        try{
            if(checkRequest(request)){
                switch(action){
                case "init": raiseEvent("gameOpenStable"); break;
                case "crop": raiseEvent("gameOpenStableCrop"); break;
                case "feed": raiseEvent("gameOpenStableFeed"); break;
                default: // Nothing
                }
            }
        }catch(err){GM_logError("buildingInnerActionResponse","","",err);}
    });
    unsafeOverwriteFunction("newBuildingInner",function(farm,position){
        try{
            unsafeWindow._newBuildingInner(farm,position);
        }catch(err){GM_logError("_newBuildingInner","","",err);}
        try{
            doStable(farm,position);
        }catch(err){GM_logError("newBuildingInner","","",err);}
    });

    function doFactory(zoneNr){
        try{
        var zoneNrF=zoneNr+6*gameLocation.get()[1];
        showBlase(zoneNrF);
        drawZoneNavi(zoneNrF,$("innermaincontainer"));
        var cand,newdiv;
        //var data=unsafeWindow.farms_data.farms[unsafeWindow.farm][zoneNr];
        var data=unsafeWindow.factory.data;

        var tempZoneProductionData=[[{}],0,0,true];
        if (data.slots&&data.slots[1]&&data.slots[1].pid){
            var iPrTyp=0;
            var iProd=parseInt(data.slots[1].pid,10);
            var iAmount=prodYield[iPrTyp][iProd];
            var iPoints=iAmount*prodPoints[iPrTyp][iProd];
            if(data.slots[1].remain>0){ // running
                var iTime=data.slots[1].remain+now-unsafeWindow.Zeit.Verschiebung;
            }else{ // done
                var iTime=Math.min(now-unsafeWindow.Zeit.Verschiebung,zones.getEndtime(zoneNrF));
            }
            if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
            tempZoneProductionData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
        }else{ // empty
            tempZoneProductionData[1]=1;
        }
        tempZoneProductionData[2]=1;
        zones.setProduction(zoneNrF,tempZoneProductionData.clone());
        tempZoneProductionData=null;

        if (valAutoCrop["farm"]&&(div=$("commitboxcrop"))&&(div.style.display=="block")&&(div=$("commitboxfootercrop"))){
            window.setTimeout(function(div){ click(div); },500,div.firstElementChild);
        }
        cand=null;newdiv=null;
        raiseEvent("gameOpenFactory");
        }catch(err){GM_logError("doFactory","","",err); console.log(err);}
    }

    function doPony(zoneNr){
        var zoneNrF=zoneNr+6*gameLocation.get()[1];
        var pony_data = unsafeWindow.pony_data;
        unsafeData.pony_data = pony_data;

        var zoneNrS;
        var prodData=[[{}],0,0,true]; // Proddata for complete building
        var dataSlot;
        for (var slot=1; slot<=3; slot++) {
            zoneNrS=zoneNrF+"." + slot; // 24.1 or 24.2 responsivly
            if (slot==1 || !pony_data["ponys"][slot]["block"]) {
              zones.setBlock(zoneNrS,""); // Unblock slot
              dataSlot=[[{}],0,0,true]; // Proddata for current slot
              prodData[1]++; // Assume, there is this/a further production possibility available
              prodData[2]++; // Assume, there is this/a further production possibility unlocked
              dataSlot[1]++; // Increment available production possibility in current slot
              dataSlot[2]++; // Increment unlocked production possibility in current slot
              var farmiId = pony_data["ponys"][slot]["data"]["farmi"]; // Id of farmi riding in current slot
                if (farmiId) {
                    var farmi = pony_data["farmis"][farmiId]; // Get that farmi's data
                    var iPrTyp=0; // Type of product => Since we don't produce anything, we just take zero
                    var iProd=0;  // Product '0' is 'Coins' => We need to set this value some how
                    var iAmount=0;// We produce '0' units
                    var iPoints=farmi["data"]["points"]; // Amount of points for current production
                    var iTime = NEVER; // End time
                    if(farmi["data"]["ready"]){ // Production has finished
                        iTime = Math.min(now - unsafeWindow.Zeit.Verschiebung, zones.getEndtime(zoneNrS));
                    } else{ // Production still running
                        iTime = now + farmi["data"]["remain"] - unsafeWindow.Zeit.Verschiebung;
                    }
                    prodData[1]--; // Production possibility currently not available (building)
                    if (!prodData[0][iPrTyp][iProd]) {
                        prodData[0][iPrTyp][iProd]=[]; // Create prodData[0][0][0]
                    }
                    // Put this slot's info into building's proddata
                    prodData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);

                    dataSlot[1]--; // Production possibility currently not available (slot)
                    if (!dataSlot[0][iPrTyp][iProd]) {
                        dataSlot[0][iPrTyp][iProd]=[];
                    }
                    // Put this slot's info into slots's proddata
                    dataSlot[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);

                    // Add auto-cropping on open building
                    newDiv=$("pony" + slot).children[1];
                    if (farmi["data"]["remain"] < 1 && (top.unsafeData.autoAction==null) && valAutoCrop["farm"] && (newDiv=$("pony"+ slot + "_crop"))) {
                        top.unsafeData.autoAction="Berater: Pony crop";
                        window.setTimeout(function(div){
                            click(div);
                            top.unsafeData.autoAction=null;
                        }, 500, newDiv);
                    }
                }

                zones.setProduction(zoneNrF+"."+slot,dataSlot.clone()); // Set proddata for slot
            } else {
                zones.setBlock(zoneNrS, "b");  // Block slot
            }
        }
        zones.setProduction(zoneNrF, prodData.clone()); // Set proddata for building
    }

    // Read production data of the currently opened oil factory
    function doFactoryOilKnittingTea(zoneNr) {
        try {
            var zoneNrF = zoneNr + 6 * gameLocation.get()[1];
            var zoneNrS;
            var farmNr = gameLocation.get()[1] + 1;
            showBlase(zoneNrF);
            drawZoneNavi(zoneNrF, $("innermaincontainer"));
            var newDiv, newDiv1;
            var iTime;
            var tempZoneProductionData = [[{}], 0, 0, true];
            var tempZoneProductionDataSlot;
/*
            console.log("+++++++++++++++++ doKnitting"+zoneNr);
            console.log("===                            ===");
            console.log(print_r(unsafeWindow.factory.data, "", true, "\n"));
            console.log("===                            ===");

            console.log("===                            ===");
            console.log(print_r(unsafeWindow.innerinfos_data[1], "", true, "\n"));
            console.log("===                            ===");

            console.log("===                            ===");
            console.log(print_r(unsafeWindow.building_inner_data, "", true, "\n"));
            console.log("===                            ===");
            */

            var data = unsafeWindow.factory.data;
            for (var slot = 1; slot <= 3; slot++) {
                zoneNrS = zoneNrF + "." + slot;
                if ((slot == 1) || (!data.slots[slot]["block"])) {
                    zones.setBlock(zoneNrS, "");
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];

                    if (data.slots[slot]) {
                        var iPrTyp = 0;
                        var iProd = data.slots[slot].pid;
                        if (iProd) {
                            var iAmount = data.slots[slot].amount;
                            var iPoints = iAmount * prodPoints[iPrTyp][iProd];
                            if (data.slots[slot].ready) {
                                 iTime = Math.min(now - unsafeWindow.Zeit.Verschiebung, zones.getEndtime(zoneNrS));
                            } else {
                                 iTime = now + data.slots[slot].remain - unsafeWindow.Zeit.Verschiebung;
                            }
                            //production_slot_info2_6_1
                            newDiv = $("production_slot_info" + farmNr + "_" + zoneNr + "_" + slot).parentNode;
                            newDiv1 = createElement("div", {
                                "style": " position:absolute;bottom: 70px; left: 102px;"
                            }, newDiv);
                            pointsFormat(iPoints, "div", newDiv1);

                            tempZoneProductionData[2]++;
                            tempZoneProductionDataSlot[2]++;

                            if (!tempZoneProductionData[0][iPrTyp][iProd]) { tempZoneProductionData[0][iPrTyp][iProd] = []; }
                            tempZoneProductionData[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);

                            if (!tempZoneProductionDataSlot[0][iPrTyp][iProd]) { tempZoneProductionDataSlot[0][iPrTyp][iProd] = []; }
                            tempZoneProductionDataSlot[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);
                            // auto-cropping
                            if (data.slots[slot].ready && (top.unsafeData.autoAction == null) && valAutoCrop["farm"] && (newDiv = $("strickerei_slot" + slot))) {
                                top.unsafeData.autoAction = "berater: oil crop";
                                window.setTimeout(function(div) {
                                    click(div);
                                    top.unsafeData.autoAction = null;
                                }, 500, newDiv);
                            }
                        } else {
                            tempZoneProductionDataSlot[1]=0;
                            zones.setEndtime(zoneNrS, NEVER);
                        }
                    }
                    zones.setProduction(zoneNrS, tempZoneProductionDataSlot.clone());
                } else {
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];
                    zones.setProduction(zoneNrF + "." + slot, tempZoneProductionDataSlot.clone());
                    zones.setBlock(zoneNrS, "b");
                }
            }
            zones.setProduction(zoneNrF, tempZoneProductionData.clone());
            var tempZoneProductionData = null;
            newDiv = null;
            newDiv1 = null;
            raiseEvent("gameOpenFactoryOilKnittingTea");
        } catch (err) {
            GM_logError("doFactoryOilKnittingTea", "", "", err);
            console.log(err);
        }
    }

    /**********************************************************
    * Events Factory Object (Strickerei/Knitting, Öl/Oel)
    **********************************************************/
    unsafeOverwriteObjFunction("factory","response",function(e,d,h,m,l){
        try{
             unsafeWindow.factory._response(e,d,h,m,l);
        }catch(err){GM_logError("factory.response","","",err);}
        try{
            /*console.log("+++++++++++response+++++++++++");
            console.log(implode(e));
            console.log(implode(d));
            console.log(implode(h));
            console.log(implode(m));
            console.log(implode(l));
            console.log("+++++++++++response+++++++++++");*/
            var zoneNr = h.position + 6 * (h.farm-1);
            switch (zones.getBuilding(zoneNr)) {
                case 7:
                case 8:
                case 9:
                case 10:
                    doFactory(h.position);
                    raiseEvent("gameStartFactory");
                    break;

                case 13:
                case 14:
                case 16:
                case 21:
                    doFactoryOilKnittingTea(h.position);
                    raiseEvent("gameFactory_"+d+"_"+h.farm+"_"+h.position);
                    break;
                default:
            }
        }catch(err){GM_logError("factory.response","","",err);}

    });

    //Fuelstation

    //Div id fuelstation_product_select_inner
    //n: product_select
    //z: Zonenummer
    //d: Slot
    //s: Produkt
    //y:
    unsafeOverwriteFunction("dialogFuelstation",function(n, z, d, s, y){
        try{
            unsafeWindow._dialogFuelstation(n, z, d, s, y);
        }catch(err){GM_logError("dialogFuelstation","","",err);}
        try{
            GM_log("dialogFuelstation:"+ "n"+n+" z"+z+" d"+d+" s"+s+" y"+y);
            if ((typeof n!="undefined")&&(n!="stats")&&(n!="add_level")&&(n!="buy")&&(n!="product_select_pid")) {
            //n=stats => Statistik wird aufgerufen
                var zoneNr=z;
                var data=unsafeWindow.farms_data.farms[unsafeWindow.farm][zoneNr];
                var iLimit=data.data.constants.slot_level[data.data.data.slots[d].level].limit;
                var children = $('fuelstation_product_select_inner').getElementsByClassName("fuelstation_product_select_item");
                for (var c in children) {
                    if (!children.hasOwnProperty(c)) { continue; }
                    var pId_parent=children[c].getElementsByClassName("fuelstation_product_select_item_img")[0].childNodes;
                    var pId = pId_parent[1].className.replace("tt", "");
                    var points = children[c].getElementsByClassName("fuelstation_product_select_item_points")[0].innerHTML.replace(".","");
                    var ratio = (gut[pId]*iLimit/points).toFixed(2);
                    createElement("div", {
                        "style":"position: absolute; bottom: -15px; left: 8px;border: 2px solid rgb(255, 114, 0); background-color: white;width: 85px;text-align: center;"
                    },children[c], moneyFormat(ratio));
                }
            }
            if ((typeof n!="undefined")&&(n=="product_select")){
                raiseEvent("gameFuelstationOpenDialogProdukt");
            } else if ((typeof n!="undefined")&&(n=="product_select_pid")) {
                raiseEvent("gameFuelstationOpenDialogPID");
            }
        }catch(err){GM_logError("dialogFuelstation","","",err);}
    });

    function doFuelstation(zoneNr_a){
        try{
            GM_log("doFuelstation "+"zoneNr_a"+zoneNr_a);
            var zoneNr=zoneNr_a;
            var zoneNrF=zoneNr+6*gameLocation.get()[1];
            var zoneNrS;
            showBlase(zoneNrF);
            drawZoneNavi(zoneNrF,$("innermaincontainer"));
            var newDiv,newDiv1;
            var tempZoneProductionData=[[{}],0,0,true];
            var tempZoneProductionDataSlot;
            var data=unsafeWindow.farms_data.farms[unsafeWindow.farm][zoneNr];

            for(var slot=1;slot<=4;slot++){
                zoneNrS=zoneNrF+"."+slot;
                if((slot==1)||(!data.data.data.slots[slot]["block"])){
                    zones.setBlock(zoneNrS,"");
                    tempZoneProductionDataSlot=[[{}],0,0,true];
                    tempZoneProductionData[1]++;
                    tempZoneProductionData[2]++;
                    tempZoneProductionDataSlot[1]++;
                    tempZoneProductionDataSlot[2]++;
                    if(data.data.data.slots[slot]){
                        var iPrTyp=0;
                        var iProd=350;
                        var iTime=NEVER;

                        for(var v in data.production) {
                            if(!data.production.hasOwnProperty(v)){ continue; }
                            if ((data.production[v].slot==slot)) {
                                //iProd=data.production[v].pid;
                                iTime=now+data.production[v].remain;
                            }
                        }

                        if(iProd){
                            var iAmount=data.data.constants.slot_level[data.data.data.slots[slot].level].output;
                            var iPoints=iAmount*prodPoints[iPrTyp][iProd];
                            if (!$("fuelstation_slot"+slot+"_points")){
                                newDiv=$("fuelstation_slot"+slot).children[1];
                                newDiv1=createElement("div",{"id":"fuelstation_slot"+slot+"_points","style":"position:relative;top:75px;left:85px"},newDiv);
                                pointsFormat(iPoints,"div",newDiv1);
                            }
                            tempZoneProductionData[1]--;
                            if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
                            tempZoneProductionData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
                            tempZoneProductionDataSlot[1]--;
                            if(!tempZoneProductionDataSlot[0][iPrTyp][iProd]){ tempZoneProductionDataSlot[0][iPrTyp][iProd]=[]; }
                            tempZoneProductionDataSlot[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
                            //auto-cropping
                            if((iTime<now)&&(top.unsafeData.autoAction==null)&&valAutoCrop["farm"]&&(newDiv=$("fuelstation_slot"+slot))){
                                top.unsafeData.autoAction="berater: fuelstation crop";
                                window.setTimeout(function(div){
                                    click(div.children[3]);
                                    top.unsafeData.autoAction=null;
                                },500,newDiv);
                            }
                        }
                    }
                    zones.setProduction(zoneNrF+"."+slot,tempZoneProductionDataSlot.clone());
                } else {
                    zones.setBlock(zoneNrS,"b");
                }
            }
            zones.setProduction(zoneNrF,tempZoneProductionData.clone());
            var tempZoneProductionData=null;newDiv=null;newDiv1=null;
        }catch(err){GM_logError("doFuelstation","","",err);}
    }

    //buildFuelstation(a)
    //a: Zone-Nummer
    unsafeOverwriteFunction("buildFuelstation",function(a){
        try{
            unsafeWindow._buildFuelstation(a);
        }catch(err){GM_logError("_buildFuelstation","","",err);}
        try{
            GM_log("buildFuelstation "+"a"+a);
            doFuelstation(a);
            raiseEvent("gameOpenFuelstation");
        }catch(err){GM_logError("buildFuelstation","","",err);}
    });


    unsafeOverwriteFunction("innerInfosResponse", function(zoneNr) {
        // oil, knitting, factory, pony, megafield, fuelstation
        try {
            unsafeWindow._innerInfosResponse(zoneNr);
        } catch (err) { GM_logError("_innerInfosResponse", "", "", err); }
        try {
            $("innermaincontainer").setAttribute("zoneNr", zoneNr);
            if (unsafeWindow.locationinfo["buildingid"]) {
                switch (unsafeWindow.locationinfo["buildingid"]) {
                    case "7":
                    case "8":
                    case "9":
                    case "10":
                        doFactory(zoneNr);
                        break;

                    case "13":
                        doFactoryOilKnittingTea(zoneNr); // Read production data
                        break; // Oil
                    case "14":
                        doFactoryOilKnittingTea(zoneNr);
                        break; // Special Oil
                    case "16":
                        doFactoryOilKnittingTea(zoneNr);
                        break; // Knitting
                    case "17":
                        break; // Carpentry
                    case 18:
                        doPony(zoneNr);
                        raiseEvent("gameOpenPony");
                        break; // Pony,
                    case "19":
                        break; // Megafield
                    case 20:
                        break; // Fuelstation
                    case "21":
                        doFactoryOilKnittingTea(zoneNr); // Read production data
                        break; // Tea
                    default:
                }
            }
        } catch (err) { GM_logError("innerInfosResponse", "", "", err); }
    });

    // Megafield
    err_trace="Megafield";
    // Remembering of latest vehicle. ["harvest", "fertilize"]
    megafieldVehicle = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldVehicle"),"do_main/megafieldVehicle",[]);
    unsafeData.megafieldVehicle=megafieldVehicle.clone();
    logMegafieldJob = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logMegafieldJob"),"do_main/logMegafieldJob",[]);
    megafieldSmartTimer = GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldSmartTimer", false);
    for(var i=logMegafieldJob.length-1;i>=0;i--){
        if(!logMegafieldJob[i][0]){ // no start time of the job
            logMegafieldJob.splice(i,1);
            continue;
        }
        if(!logMegafieldJob[i][1]){ // no end time of the job
            if(logMegafieldJob[i][0]+7*24*60*60<unsafeWindow.Zeit.Server){ // job started more than 7 days ago
                logMegafieldJob[i][1]=logMegafieldJob[i][0]+7*24*60*60;
            }
        }
    }
    function doMegafieldData(){
/*  megafield:
    "points": STRING(INTEGER),
    "count": STRING(INTEGER),
    "count_buy": null,
    "area": {   "1": {  "pid": INTEGER,
                        "time": DATETIME of planting,
                        "duration": INTEGER,
                        "remain": INTEGER
                }, ...
    },
    "area_free": {  "1": DATETIME of unlocking
                    , ...
    },
    "job": {    "products": [   {   "pid": INTEGER,
                                    "quality": INTEGER,
                                    "need": INTEGER,
                                    "have": INTEGER,
                                    "amount": INTEGER,
                                    "harvest": INTEGER,
                                    "duration": INTEGER
                                }, ...
                ],
                "remain": INTEGER
    },
    "job_start": STRING(DATETIME),
    "job_endtime": "0",
    "vehicles": {   "1": {  "time": DATETIME of purchase,
                            "durability": INTEGER,
                            "range": INTEGER
                    }, ...
    },
    "vehicles_unlock": {    "1": {  "time": DATETIME of unlocking  }
                            , ...
    },
    "tour": [],
    "tutorial_step": STRING(INTEGER),
    "level": INTEGER,
    "level_rest": INTEGER,
    "level_percent": INTEGER,
    "exchangecoins": INTEGER,
    "next_tiles": { "cost": INTEGER,
                    "tiles": [INTEGER, INTEGER, ...]
    },
    "vehicle_slots": {  "1": {  "type": "harvest"|"fertilize",
                                "name": STRING,
                                "size": INTEGER,
                                "level": INTEGER,
                                "unlock": INTEGER,
                                "durability": INTEGER,
                                "range": INTEGER,
                                "duration": INTEGER,
                                "money": INTEGER
                        }, ...
    },
    "reward_info": {    "quality": INTEGER,
                        "points": INTEGER,
                        "money": INTEGER,
                        "license": INTEGER,
                        "difficultybonus_points": INTEGER,
                        "difficultybonus_money": INTEGER,
                        "difficultybonus_license": INTEGER,
                        "timebonus_points": INTEGER,
                        "timebonus_money": INTEGER,
                        "timebonus_license": INTEGER
    }
}*/
        try{
            if(unsafeWindow.megafield_data){
                updateProductDataMegafield();
                // Store data of job and reward
                var jobStart=parseInt(unsafeWindow.megafield_data.job_start,10);
                var products,reward,success=1;
                if(jobStart>0){
                    for(var i=logMegafieldJob.length-1;i>=0;i--){
                        if(logMegafieldJob[i][0]==jobStart){
                            break;
                        }
                    }
                    if(!logMegafieldJob[i]){
                        i=logMegafieldJob.length;
                        logMegafieldJob[i]=[jobStart];
                    }
                    if("job_endtime" in unsafeWindow.megafield_data){
                        logMegafieldJob[i][1]=parseInt(unsafeWindow.megafield_data.job_endtime,10);
                    }
                    if(unsafeWindow.megafield_data.job&&(products=unsafeWindow.megafield_data.job.products)){
                        logMegafieldJob[i][4]=[];
                        megafieldJob={};
                        megafieldJob.products={};
                        for(var j=0;j<products.length;j++){
                            logMegafieldJob[i][4][j]=[];
                            if("quality" in products[j]){ logMegafieldJob[i][2]=products[j].quality;        }
                            if("pid"     in products[j]){
                                logMegafieldJob[i][4][j][0]=products[j].pid;
                                megafieldJob.products[products[j].pid]=products[j];
                                megafieldJob.products[products[j].pid].growing=0;
                            }
                            if("need"     in products[j]){ logMegafieldJob[i][4][j][1]=products[j].need;     }
                            if("have"     in products[j]){ logMegafieldJob[i][4][j][2]=products[j].have;     }
                            if("amount"   in products[j]){ logMegafieldJob[i][4][j][3]=products[j].amount;   }
                            if("harvest"  in products[j]){ logMegafieldJob[i][4][j][4]=products[j].harvest;  }
                            if("duration" in products[j]){ logMegafieldJob[i][4][j][5]=products[j].duration; }
                            if(logMegafieldJob[i][4][j][1]!=logMegafieldJob[i][4][j][2]){ success=0; }
                        }
                        logMegafieldJob[i][3]=success;
                    }
                    if(unsafeWindow.megafield_data.reward){
                        reward=unsafeWindow.megafield_data.reward;
                    }else if(unsafeWindow.megafield_data.reward_info){
                        reward=unsafeWindow.megafield_data.reward_info;
                    }
                    if(reward){
                        logMegafieldJob[i][6]=[0,0,0];
                        if("difficultybonus_points"  in reward){ logMegafieldJob[i][6][0]=reward.difficultybonus_points; }
                        if("difficultybonus_money"   in reward){ logMegafieldJob[i][6][1]=reward.difficultybonus_money; }
                        if("difficultybonus_license" in reward){ logMegafieldJob[i][6][2]=reward.difficultybonus_license; }
                        logMegafieldJob[i][7]=[0,0,0];
                        if("timebonus_points"  in reward){ logMegafieldJob[i][7][0]=reward.timebonus_points; }
                        if("timebonus_money"   in reward){ logMegafieldJob[i][7][1]=reward.timebonus_money; }
                        if("timebonus_license" in reward){ logMegafieldJob[i][7][2]=reward.timebonus_license; }
                        logMegafieldJob[i][5]=[0,0,0];
                        if("points"  in reward){ logMegafieldJob[i][5][0]=reward.points -logMegafieldJob[i][6][0]-logMegafieldJob[i][7][0]; }
                        if("money"   in reward){ logMegafieldJob[i][5][1]=reward.money  -logMegafieldJob[i][6][1]-logMegafieldJob[i][7][1]; }
                        if("license" in reward){ logMegafieldJob[i][5][2]=reward.license-logMegafieldJob[i][6][2]-logMegafieldJob[i][7][2]; }
                    }
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logMegafieldJob",implode(logMegafieldJob,"setTourVehicleMegafield/logMegafieldJob"));
                    unsafeData.logMegafieldJob = logMegafieldJob[i];
                }
                // Update data of production
                if(unsafeWindow.megafield_data.area_free){
                    var zoneNrF="megafield", zoneNrS;
                    zones.setBlock(zoneNrF,"");
                    zones.setBonus(zoneNrF,0);
                    var iPrTyp=4,iProd,iTime;
                    var tempZoneProductionData=[[],0,0,true], tempZoneProductionDataSlot;
                    tempZoneProductionData[0][iPrTyp]={};
                    for(var slot=BUILDING_SLOTS["megafield"];slot>=1;slot--){
                        zoneNrS=zoneNrF+"."+slot;
                        tempZoneProductionDataSlot=[[],0,0,true];
                        tempZoneProductionDataSlot[0][iPrTyp]={};
                        if(unsafeWindow.megafield_data.area_free[slot]){
                            zones.setBlock(zoneNrS,"");
                            if(unsafeWindow.megafield_data.area[slot]){
                                iProd=unsafeWindow.megafield_data.area[slot].pid;
                                iTime=unsafeWindow.megafield_data.area[slot].time+unsafeWindow.megafield_data.area[slot].duration;
                                iTime-=unsafeWindow.Zeit.Verschiebung;
                                if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
                                tempZoneProductionData[0][iPrTyp][iProd].push([1,0,iTime,NEVER]);
                                if(!tempZoneProductionDataSlot[0][iPrTyp][iProd]){ tempZoneProductionDataSlot[0][iPrTyp][iProd]=[]; }
                                tempZoneProductionDataSlot[0][iPrTyp][iProd].push([1,0,iTime,NEVER]);
                                if(megafieldJob.products[iProd]&&(undefined!=megafieldJob.products[iProd].growing)){
                                    megafieldJob.products[iProd].growing++;
                                }
                            }else{
                                tempZoneProductionData[1]++;
                                tempZoneProductionDataSlot[1]++;
                            }
                            tempZoneProductionData[2]++;
                            tempZoneProductionDataSlot[2]++;
                        }else{
                            zones.setBlock(zoneNrS,"b");
                        }
                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone(),true);
                    }
                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                }
            }
        }catch(err){GM_logError("_megafieldHandler","","",err);}
    }
    doMegafieldData();
    unsafeOverwriteFunction("megafieldHandler", function(a) {
      try {
        unsafeWindow._megafieldHandler(a);
      } catch (err) { GM_logError("_megafieldHandler", "", "", err); }
      try {
        doMegafieldData();
        raiseEvent("gameMegafieldDataDone");
      } catch (err) { GM_logError("megafieldHandler", "", "", err); }
    });

    unsafeOverwriteFunction("buildMegafield",function(){
        try{
            unsafeWindow._buildMegafield();
        }catch(err){GM_logError("_buildMegafield","","",err);}
        try{
            var div;
            gameLocation.set("megafield");
            if(megafieldVehicle[0]&&(!unsafeWindow.megafield_vehicle_id)){
                unsafeWindow.megafield_move_position=2;
                unsafeWindow._setTourVehicleMegafield(megafieldVehicle[0]);
            }
            if(!$("divLogMegafieldJob")){
                div=createElement("div",{"id":"divLogMegafieldJob","class":"link openBook","style":"position:absolute;top:350px;left:650px;"},$("megafield_back"));
                div.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("megafield"); },false);
            }
            raiseEvent("gameOpenMegafield");
            div=null;
        }catch(err){GM_logError("buildMegafield","","",err);}
    });
    unsafeOverwriteFunction("moveMegafield",function(a){
        try{
            unsafeWindow._moveMegafield(a);
        }catch(err){GM_logError("_moveMegafield","","",err);}
        try{
            gameLocation.set("megafield",unsafeWindow.megafield_move_position);
            raiseEvent("gameMegafieldMoved");
        }catch(err){GM_logError("moveMegafield","","",err);}
    });
    unsafeOverwriteFunction("setTourVehicleMegafield",function(b){
        try{
            unsafeWindow._setTourVehicleMegafield(b);
        }catch(err){GM_logError("_setTourVehicleMegafield","","",err);}
        try{
            var a;
            if(b&&(a=unsafeWindow.megafield_data.vehicle_slots[b])&&(!a.block)&&(!a.unlockable)){
                megafieldVehicle[{"harvest":0,"fertilize":1}[a.type]]=b;
                unsafeData.megafieldVehicle=megafieldVehicle.clone();
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_megafieldVehicle",implode(megafieldVehicle,"setTourVehicleMegafield/megafieldVehicle"));
            }
            raiseEvent("gameMegafieldTourVehicleSet");
        }catch(err){GM_logError("setTourVehicleMegafield","","",err);}
    });
    unsafeOverwriteFunction("dialogMegafield",function(mode, K, slot, B, pid){
        try{
            unsafeWindow._dialogMegafield(mode, K, slot, B, pid);
        }catch(err){GM_logError("_dialogMegafield","","",err);}
        try{
            raiseEvent("gameMegafieldDialogStarted");
            if (mode == "autoplant") {
                raiseEvent("gameMegafieldDialogAutoplant");
            }
        }catch(err){GM_logError("dialogMegafield","","",err);}
    });

    /**********************************************************
    * Sushi bar
    **********************************************************/
    unsafeOverwriteObjFunction("sushibar","build",function(){
        try{
             unsafeWindow.sushibar._build();
        }catch(err){GM_logError("sushibar.build","","",err);}
        try{
            raiseEvent("gameOpenSushibar");
        }catch(err){GM_logError("sushibar.build","","",err);}

    });


    unsafeOverwriteObjFunction("sushibar","buildKitchen",function(){
        try{
             unsafeWindow.sushibar._buildKitchen();
        }catch(err){GM_logError("sushibar.buildKitchen","","",err);}
        try{
            raiseEvent("gameOpenSushiBarProduction");
        }catch(err){GM_logError("sushibar.buildKitchen","","",err);}

    });

    unsafeOverwriteObjFunction("sushibar","action",function(a,b){
        try{
            unsafeWindow.sushibar._action(a,b);
            //GM_logInfo("autoFarmSushiBarFarmis","","","action a:"+a);
            //GM_logInfo("autoFarmSushiBarFarmis","","","b:"+b);
        }catch(err){GM_logError("sushibar.buyPharmacistCommit","","",err);}
        try{
        }catch(err){GM_logError("sushibar.buyPharmacistCommit","","",err);}

    });

    var setTimeOutID;
    unsafeOverwriteObjFunction("sushibar","response",function(h , c, b){
        try{
             unsafeWindow.sushibar._response(h, c, b);
        }catch(err){GM_logError("sushibar.response","","",err);}
        try{
            /*
            GM_logInfo("autoFarmSushiBarFarmis","","","response h:"+h);
            GM_logInfo("autoFarmSushiBarFarmis","","","c:"+c);
            GM_logInfo("autoFarmSushiBarFarmis","","","b:"+b);
            */
            switch (c) {
                case 'sushibar_harvestproduction':
                    doSushiBar();
                    raiseEvent("gameSushibarHarvest");
                break;
                case 'sushibar_startproduction':
                    doSushiBar();
                    raiseEvent("gameSushibarStartProduction");
                break;
                case 'sushibar_finishfarmi':
                    if (setTimeOutID) {
                        window.clearTimeout(setTimeOutID);
                    }
                    setTimeOutID = window.setTimeout(function(){
                        doSushiBar();
                    },45000);
                    raiseEvent("gameSushibarFinishFarmi");
                break;
                case 'sushibar_settrainslot':
                    raiseEvent("gameSushibarSetTrainSlot");
                    if (setTimeOutID) {
                        window.clearTimeout(setTimeOutID);
                    }
                    setTimeOutID = window.setTimeout(function(){
                        doSushiBar();
                    },45000);
                break;
            }
        }catch(err){GM_logError("sushibar.response","","",err);}

    });
/*
    unsafeOverwriteObjFunction("sushibar","updateFarmi",function(b){
        try{
             unsafeWindow.sushibar._updateFarmi(b);
        }catch(err){GM_logError("sushibar.updateFarmi","","",err);}
        try{
            doSushiBar();
            raiseEvent("gameSushibarSetTrainSlot");
        }catch(err){GM_logError("sushibar.updateFarmi","","",err);}

    });

*/

    unsafeOverwriteObjFunction("sushibar","buyPharmacistCommit",function(a){
        try{
            //unsafeWindow.sushibar._buyPharmacistCommit(a);
        }catch(err){GM_logError("sushibar.buyPharmacistCommit","","",err);}
        try{
        }catch(err){GM_logError("sushibar.buyPharmacistCommit","","",err);}

    });

    // Read production data of sushibar
    sushibarFarmi = GM_getValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_sushibarFarmi", true);

    var doSushiBar = function () {
        try {
            var nowServer=unsafeWindow.Zeit.Server;
            GM_logInfo("doSushiBar","","","doSushiBar "+ getDaytimeStr(nowServer));

            var data = unsafeWindow.sushibar;
            var zoneNrF = (parseInt(data.data.data.farm,10) -1)*6 + parseInt(data.data.data.position,10);
            var zoneNrS;
            var farmNr = parseInt(data.data.data.farm,10);

            /*
            console.log("+++++++++++++++++ doSushiBar +++++++++++++++++++++++++++");
            console.log("===                            ===");
            console.log(print_r(unsafeWindow.sushibar, "", true, "\n"));
            console.log("===                            ===");
            console.log("+++++++++++++++++ doSushiBar +++++++++++++++++++++++++++");
            */

            //showBlase(zoneNrF);
            //var newDiv, newDiv1;

            var tempZoneProductionData = [[{}], 0, 0, true];
            var tempZoneProductionDataSlot;

            for (var slot = 1; slot <= 4; slot++) {
                zoneNrS = zoneNrF + "." + slot;
                if ((slot == 1) || (!data.data.data.slots[slot]["block"])) {
                    zones.setBlock(zoneNrS, "");
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];
                    if (data.data.production[slot]) {
                        var iPrTyp = 0;
                        var iProd = data.data.production[slot][1].pid;
                        var iAmount = data.data.production[slot][1].amount;
                        var iPoints = iAmount * prodPoints[iPrTyp][iProd];
                        if (data.data.production[slot][1].remain >= 0   ) { // not ready
                            iTime = nowServer + Math.round(data.data.production[slot][1].remain) - unsafeWindow.Zeit.Verschiebung;
                        } else {
                            iTime = (parseInt(data.data.production[slot][1].createdate,10) + parseInt(data.data.production[slot][1].duration,10))

                        }

                        tempZoneProductionData[2]++;
                        tempZoneProductionDataSlot[2]++;

                        if (!tempZoneProductionData[0][iPrTyp][iProd]) { tempZoneProductionData[0][iPrTyp][iProd] = []; }

                        tempZoneProductionData[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);

                        if (!tempZoneProductionDataSlot[0][iPrTyp][iProd]) { tempZoneProductionDataSlot[0][iPrTyp][iProd] = []; }

                        tempZoneProductionDataSlot[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);
                    } else {
                        iTime = NEVER;
                        tempZoneProductionData[1]++;
                        tempZoneProductionDataSlot[1]++;
                        tempZoneProductionData[2]++;
                        tempZoneProductionDataSlot[2]++;
                        if (!tempZoneProductionData[0][0][0]) { tempZoneProductionData[0][0][0] = []; }

                        tempZoneProductionData[0][0][0].push([0, 0, iTime, NEVER]);

                        if (!tempZoneProductionDataSlot[0][0][0]) { tempZoneProductionDataSlot[0][0][0] = []; }

                        tempZoneProductionDataSlot[0][0][0].push([0, 0, iTime, NEVER]);
                    }
                    zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                } else {
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];
                    zones.setProduction(zoneNrF + "." + slot, tempZoneProductionDataSlot.clone());
                    zones.setBlock(zoneNrS, "b");
                }
            }
            for (var slot in data.data.data.farmi_slots) {
                if (!data.data.data.farmi_slots.hasOwnProperty(slot)) {continue;}
                zoneNrS = zoneNrF + "." + (parseInt(slot,10) + 4);
                if (sushibarFarmi&&!data.data.data.farmi_slots[slot].block) {
                    zones.setBlock(zoneNrS, "");
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];
                    tempZoneProductionData[1]++;
                    tempZoneProductionData[2]++;
                    tempZoneProductionDataSlot[1]++;
                    tempZoneProductionDataSlot[2]++;

                    if (data.data.farmis[slot] && data.data.farmis[slot].eat) {
                        var iPrTyp = 0;
                        var iProd = data.data.farmis[slot].eat.pid;
                        var iAmount = 1;
                        var iPoints = 1;

                        if(data.data.farmis[slot].eat.remain>=0) {
                            iTime = nowServer + Math.round(data.data.farmis[slot].eat.remain) - unsafeWindow.Zeit.Verschiebung;
                        } else {
                            iTime = nowServer + Math.round(data.data.farmis[slot].eat.remain) - unsafeWindow.Zeit.Verschiebung;
                        }
                    } else { //Slot is waiting for next farmi
                        var iPrTyp = 0;
                        var iProd = 0;
                        var iAmount = 1;
                        var iPoints = 1;
                        iTime = nowServer + Math.round(data.data.data.farmi_slots[slot].lastfarmi_remain) - unsafeWindow.Zeit.Verschiebung;
                    }

                    tempZoneProductionData[1]--;
                    if (!tempZoneProductionData[0][iPrTyp][iProd]) { tempZoneProductionData[0][iPrTyp][iProd] = []; }
                    tempZoneProductionData[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);
                    tempZoneProductionDataSlot[1]--;
                    if (!tempZoneProductionDataSlot[0][iPrTyp][iProd]) { tempZoneProductionDataSlot[0][iPrTyp][iProd] = []; }
                    tempZoneProductionDataSlot[0][iPrTyp][iProd].push([iAmount, iPoints, iTime, NEVER]);

                    zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                } else {
                    tempZoneProductionDataSlot = [[{}], 0, 0, true];
                    zones.setProduction(zoneNrF + "." + (parseInt(slot,10) + 4), tempZoneProductionDataSlot.clone());
                    zones.setBlock(zoneNrS, "b");
                }
            }

            //Zonen Blocken
                /*
                tempZoneProductionDataSlot = [[{}], 0, 0, true];
                zones.setProduction(zoneNrF + "." + slot, tempZoneProductionDataSlot.clone());
                zones.setBlock(zoneNrS, "b");
                zones.setBlock(zoneNrF, "b");
                */

            GM_logInfo("doSushiBar","","","doSushiBar: Daten eingelesen: "+ getDaytimeStr(nowServer));
            zones.setProduction(zoneNrF, tempZoneProductionData.clone());

            var tempZoneProductionData = null;
            //newDiv = null;
            //newDiv1 = null;
        } catch (err) {
            GM_logError("doSushiBar", "", "", err);
            console.log(err);
        }
    }

    unsafeData.doSushiBar = doSushiBar.clone();

    // Club
    err_trace="Club";
    // Clubquest direct show
    var lastGuildQuestRequest=0;
    function clubQuestToolTip(data){
    try{
        var container=$("guildlink_tt_quest");
        container.innerHTML="";
        var newdiv=createElement("div",{"style":"position:absolute;top:5px;left:5px;"},container);
        var newspan=createElement("span",{"style":"margin-right:2px;"},newdiv);
        if(data!=0){
            createElement("img",{"src":GFX+'adtime.gif'},newspan);
            createElement("span",{"style":"font-weight:bold;"},newdiv,getTimeStr(data['remain']));
            if(data['questtype'] == 1 || data['questtype'] == 2){  // produkte oder geld in vorgegebener zeit
                var top=25;
                var left=0;
                var newdiv1;
                for(var i=1 ; i <= 2 ; i++){
                    if(data['product' + i] > 0){
                        data['sum' + i]=parseInt(data['sum' + i],10);
                        data['amount' + i]=parseInt(data['amount' + i],10);
                        var barleft=parseInt(Math.round((data['sum' + i] * 100) / data['amount' + i])-100,10);

                        if(data['questtype'] == 2){
                            data['sum' + i]=moneyFormat(data['sum' + i]);
                            data['amount' + i]=moneyFormat(data['amount' + i]);
                        }

                        newdiv=createElement("div",{"style":'position:absolute; top:' + top + 'px; left:' + left + 'px;width:40px;height:15px;'},container);
                        if(data['questtype'] == 1){
                            newdiv1=createElement("div",{"style":"position:absolute; top:0; left:5px;height:15px;width:15px; overflow:hidden;"},newdiv);
                            createElement("img",{"class":"kp" + data['product' + i], "style":"position:absolute;"},newdiv1);
                        }
                        else if(data['questtype'] == 2){
                            newdiv1=createElement("div",{"style":"position:absolute; top:0; left:5px;height:15px;width:15px;"},newdiv);
                            createElement("img",{"src":GFX+"money.gif","height":"15","width":"15"},newdiv1);
                        }
                        newdiv1=createElement("div",{"style":"position:absolute;top:0;left:23px;border:1px solid #000;background-color:#fff;width:100px;height:15px;overflow:hidden;"},newdiv);
                        createElement("div",{"style":"position:absolute;top:0;left:"+barleft+"px;background-color:#f00;width:100px;height:25px;"},newdiv1);
                        createElement("div",{"style":"position:absolute;top:0;left:0;width:100px;height:15px;color:black;font-weight:bold;text-align:center;"},newdiv1,numberFormat(data['sum' + i]));
                        createElement("div",{"style":"position:absolute;top:20px;white-space:nowrap;left:5px;"},newdiv,(data['amount' + i]==data['sum' + i])?"":('<b>' + numberFormat(data['amount' + i]-data['sum' + i]) + '/' + numberFormat(data['amount' + i]) + '</b>'));
                top += 40;
                }   }
                newdiv1=null;
            }
        }else{
            newspan.innerHTML="---";
        }
        container=null;newdiv=null;newspan=null;
    }catch(err){GM_logError("clubQuestToolTip","data="+implode(data,"clubQuestToolTip/data"),"",err);}
    }
    if((newdiv=$("speedlink_guild"))&&(newdiv1=$("speedlink_guild_tt"))){
        var str=newdiv1.innerHTML;
        newdiv1.innerHTML="";
        createElement("div",{"style":"border-bottom:1px solid black;"},newdiv1,str);
        createElement("div",{"id":"guildlink_tt_quest","style":"position:relative;width:130px;height:100px;"},newdiv1,"---");
        /* TODO: review needed. request has changed.
        newdiv.addEventListener("mouseover",function(){
            if (now-lastGuildQuestRequest>30){ // 30 seconds delay to next request
                lastGuildQuestRequest=now;
                GM_xmlhttpRequest({
                    method: "GET",
                    url: "http://s"+SERVER+"."+GAMEPAGES[COUNTRY]+"/guild/ajax/initguild.php?rid="+unsafeWindow.rid,
                    headers: {"Content-type": "application/x-www-form-urlencoded"},
                    onload: function(response){
                        if(response.responseText!=0){
                            var result=eval('(' + response.responseText + ')');
                            if(result[0]!=0){
                                clubQuestToolTip(result[0][2]);
                            }
                        }
                    }
                });
            }
        },false);
        */
    }

    // Clubquest updated
    /* TODO: function is not existing anymore
    unsafeOverwriteFunction("setGuildQuestResponse",function(request){
        unsafeWindow._setGuildQuestResponse(request);
        var result=checkRequest(request);
        if(result){
            lastGuildQuestRequest=now;
            clubQuestToolTip(result[1]);
        }
    });
    */

    // Clubdata loaded
    unsafeOverwriteFunction("initGuildResponse",function(response){
        try{
            unsafeWindow._initGuildResponse(response);
        }catch(err){GM_logError("_initGuildResponse","","",err);}
        try{
            lastGuildQuestRequest=now;
            clubQuestToolTip(response[0][2]);
        }catch(err){GM_logError("initGuildResponse","","",err);}
    });

    // Memberlist
    unsafeOverwriteFunction("openMultiBox",function(id){
        try{
            if(id==5){
                $('guildmultiboxheader').innerHTML='<img class="link" src="' + unsafeWindow.imgpath + 'button_cancel_off.png" onclick="hideDiv(\'transp9\'); hideDiv(\'guildmultibox\');" onmouseover="this.src=\'' + unsafeWindow.imgpath + 'button_cancel_on.png\';" onmouseout="this.src=\'' + unsafeWindow.imgpath + 'button_cancel_off.png\';"></div>';
                $('guildmultiboxcontent').innerHTML='';
                unsafeWindow.showGuildQuestStats(2,1,0);
                for(var i=1;i<=3;i++){
                    $('guildmultiboxmenue'+i).style.backgroundImage="url(" + unsafeWindow.imgpath + "leer.gif)";
                }
                $('guildmultiboxmenue4').style.backgroundImage="url(" + unsafeWindow.imgpath + "multiscreen_reiter4.jpg)";
                $('guildmultiboxheadline').innerHTML=unsafeWindow.guildmultibox_headline4;
                unsafeWindow.hideDiv('guildnewsticker');
                unsafeWindow.showDiv('transp9');
                unsafeWindow.showDiv('guildmultibox');
            }else{
                try{
                    unsafeWindow._openMultiBox(id);
                }catch(err){GM_logError("_openMultiBox","","",err);}
            }
        }catch(err){GM_logError("openMultiBox","","",err);}
    });
    $("guildmultiboxmenue4").setAttribute("onclick","openMultiBox(5)");

    unsafeOverwriteFunction("getGuildMembersResponse",function(request){
        try{
            unsafeWindow._getGuildMembersResponse(request);
        }catch(err){GM_logError("_getGuildMembersResponse","","",err);}
        try{
            if(request.readyState == 4 && request.status == 200){
                var canddiv=Array.prototype.slice.call($("guildmultiboxcontent").getElementsByClassName("guildmemberlist_even")).concat(Array.prototype.slice.call($("guildmultiboxcontent").getElementsByClassName("guildmemberlist_uneven")));
                var newdiv,newspan,newa;
                for(var v=0;v<canddiv.length;v++){
                    newdiv=canddiv[v].children[1].firstElementChild;
                    var thisUser=/(.*?)&nbsp;/.exec(newdiv.innerHTML);
                    newdiv.innerHTML=newdiv.innerHTML.replace(thisUser[0],"");
                    newspan=createElement("span");
                    newspan.innerHTML="&nbsp;";
                    newdiv.insertBefore(newspan,newdiv.firstElementChild);
                    newa=createElement("a",{"class":"link"});
                    newa.innerHTML=thisUser[1];
                    newdiv.insertBefore(newa,newdiv.firstElementChild);
                    newa.addEventListener("click",function(){
                        showShopframePage("http://s"+SERVER+"."+GAMEPAGES[COUNTRY]+"/stadt/stats.php?search=1&searchterm="+this.innerHTML);
                    },false);
                    //newdiv.insertBefore(igm(thisUser[1]),newdiv.firstElementChild);
                }
                newdiv=null;newspan=null;newa=null;canddiv=null;
            }
        }catch(err){GM_logError("getGuildMembersResponse","","",err);}
    });
    // Questhistory
    unsafeOverwriteFunction("showGuildQuestStatsResponse",function(request,type,page,self){
        try{
            unsafeWindow._showGuildQuestStatsResponse(request,type,page,self);
        }catch(err){GM_logError("_showGuildQuestStatsResponse","","",err);}
        try{
            var result=checkRequest(request);
            if(result&&result[0]!=0){
                window.setTimeout(function(){
                    GM_logInfo("showGuildQuestStatsResponse","request="+request+" type="+type+"("+typeof type+") page="+page+"("+typeof page+") self="+self+"("+typeof self+")","Begin",0);
                    var newdiv=$("chg_guildqueststats");
                    newdiv.setAttribute("onchange","");
                    newdiv.addEventListener("change",function(){
                        var type=parseInt($("chg_guildqueststats").value,10);
                        if(type<4){
                            unsafeWindow.showGuildQuestStats(type,1,0);
                        }else{
                            showGuildQuestStatsLastDays(7);
                        }
                    },false);
                    createElement("option",{"value":"4"},newdiv,getText("stat_days7"));
                    if(type>3){
                        newdiv.value=type;
                        newdiv.nextElementSibling.style.display="none";
                    }

                    //todayStr=getDateStr(now,2,false);
                    var clubmemberLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_clubmemberLog"),"showGuildQuestStatsResponse/clubmemberLog",[]);
                    for(var u=0;u<clubmemberLog.length;u++){
                        if(typeof clubmemberLog[u][0]!="string"){
                            clubmemberLog.splice(u,1);
                            u--;continue;
                        }
                        if(!clubmemberLog[u][1] instanceof Array){
                            clubmemberLog[u][1]=[];
                        }
                        for(var v=0;v<clubmemberLog[u][1].length;v++){
                            if((typeof clubmemberLog[u][0][v][0]!="string")||(typeof clubmemberLog[u][0][v][1]!="number")){
                                clubmemberLog[u][1].splice(v,1);
                                v--;continue;
                            }
                            if(!clubmemberLog[u][1][v][2] instanceof Array){
                                clubmemberLog[u][1][v][2]=[];
                            }
                            if(clubmemberLog[u][1][v][0]=="0"){ continue; }
                            // join old data
                            var w=null;
                            if(clubmemberLog[u][1][v][0].match(/^\d+\.\d+\.\d+$/)){
                                if(now-getTime(clubmemberLog[u][1][v][0])>604800){ // 1 week (7*86400)
                                    for(var x=0;x<clubmemberLog[u][1].length;x++){
                                        if(clubmemberLog[u][1][x][0]==clubmemberLog[u][1][v][0].replace(/^(\d+\.)/,"")){
                                            w=x; break;
                                        }
                                    }
                                    if(w==null){
                                        w=clubmemberLog[u].length;
                                        clubmemberLog[u].push([0,[]]);
                                    }                           }
                            }else if(clubmemberLog[u][1][v][0].match(/^\d+\.\d+$/)){
                                if(now-getTime(clubmemberLog[u][1][v][0])>16070400){ // 6 months (6*31*86400)
                                    for(var x=0;x<clubmemberLog[u].length;x++){
                                        if(clubmemberLog[u][1][x][0]==clubmemberLog[u][1][v][0].replace(/^(\d+\.)/,"")){
                                            w=x; break;
                                        }
                                    }
                                    if(w==null){
                                        w=clubmemberLog[u].length;
                                        clubmemberLog[u].push([0,[]]);
                                    }
                                }
                            }
                            if(w!=null){
                                clubmemberLog[u][1][w][1] += clubmemberLog[u][1][v][1];
                                for(var x=0;x<clubmemberLog[u][1][v][2].length;x++){
                                    for(var y=0;y<clubmemberLog[u][1][w][2].length;y++){
                                        if(clubmemberLog[u][1][v][2][x]==clubmemberLog[u][1][w][2][y]){
                                            break;
                                        }
                                    }
                                    if(clubmemberLog[u][1][w][2][y]){
                                        clubmemberLog[u][1][w][2][y][1] += clubmemberLog[u][1][v][2][x][1];
                                    } else {
                                        clubmemberLog[u][1][w][2].push(clubmemberLog[u][1][v][2][x]);
                                    }
                                }
                                clubmemberLog[u][1].splice(v,1);
                                clubmemberLog[u][1].sort(sortObjFunctions["date"]);
                            }
                        }
                    }

                    var clubmembers=new Object();
                    var clubmemberLogSum=new Object();
                    for(var i=0;i<clubmemberLog.length;i++){
                        var u=clubmemberLog[i][0];
                        clubmemberLogSum[u]=[0,{}];
                        for(var j=0;j<clubmemberLog[i][1].length;j++){
                            var v=clubmemberLog[i][1][j][0];
                            if(v==todayStr){ continue; }
                            clubmemberLogSum[u][0] += clubmemberLog[i][1][j][1];
                            for(var k=0;k<clubmemberLog[i][1][j][2].length;k++){
                                var w=clubmemberLog[i][1][j][2][k][0];
                                if(clubmemberLogSum[u][1][w]===undefined){
                                    clubmemberLogSum[u][1][w]=0;
                                    clubmemberLogSum[u][1].sortObj(sortObjFunctions["productId"]);
                                }
                                clubmemberLogSum[u][1][w] += clubmemberLog[i][1][j][2][k][1];
                            }
                        }
                    }
                    var container=$("guildmultiboxcontent");
                    var newtable,newtable1,newtr,newtr1,newtd,newdiv1,cell;
                    for(var v=0;v<container.childElementCount;v++){
                        if(container.children[v].id.match(/^line\d+$/)){
                            var lineNr=parseInt(/^line(\d+)$/.exec(container.children[v].id)[1],10);

                            var thisUser=container.children[v].children[1].innerHTML;
                            var thisPoints=parseInt(container.children[v].children[3].innerHTML,10);
                            container.children[v].children[3].innerHTML=numberFormat(thisPoints);

                            clubmembers[thisUser]=[thisPoints,{}];

                            // reformat of info bubble
                            cell=$("bartt"+lineNr);
                            cell.style.whiteSpace="nowrap";
                            cell.style.left="";
                            cell.style.right="30px";
                            for(var w=0;w+1<cell.childElementCount;w++){
                                if(cell.children[w].style.clear == "both"){ continue; }
                                var help=parseInt(cell.children[w].getAttribute("class").replace(/kp/,""),10);
                                var help1=parseInt(cell.children[++w].innerHTML.replace(/&nbsp;/g,""),10);
                                clubmembers[thisUser][1][help]=help1;
                            }
                            cell.innerHTML="";

                            clubmembers[thisUser][1].sortObj(sortObjFunctions["productId"]);

                            newtable=createElement("table",{"cellspacing":"0","style":"display:inline-block;vertical-align:top;"},cell);
                            var c=2;
                            for(var w in clubmembers[thisUser][1]){
                                if(!clubmembers[thisUser][1].hasOwnProperty(w)){ continue; }
                                if(c==2){
                                    c=0;
                                    newtr=createElement("tr",{},newtable);
                                }
                                c++;
                                newtd=createElement("td",{"class":"link hoverBgDarkgreen","style":"text-align:right;padding-right:5px;","prod":w},newtr);
                                newtd.addEventListener("mouseover",function(event){
                                    showGoToMarketToolTip(event,this.getAttribute("prod"));
                                },false);
                                newtd.addEventListener("click",function(){
                                    showMarket(this.getAttribute("prod"));
                                },false);
                                produktPic(0,w,newtd).style.cssFloat="left";
                                createElement("span",{},newtd,numberFormat(clubmembers[thisUser][1][w]));
                            }

                            var clubmemberLogId = null;
                            for(var x=0;x<clubmemberLog.length;x++){
                                if(clubmemberLog[x][0]==thisUser){
                                    clubmemberLogId=x; break;
                                }
                            }
                            if(!clubmemberLog[clubmemberLogId]){
                                clubmemberLogId=clubmemberLog.length;
                                clubmemberLog.push([thisUser,["0",0,[]]]);
                                clubmemberLogSum[thisUser]=clubmembers[thisUser];
                            }
                            if(type==2){ // all quests
                                var clubmemberLogDateId = null;
                                for(var x=0;x<clubmemberLog[clubmemberLogId][1].length;x++){
                                    if(clubmemberLog[clubmemberLogId][1][x][0]==todayStr){
                                        clubmemberLogDateId=x; break;
                                    }
                                }
                                if(!clubmemberLog[clubmemberLogId][1][clubmemberLogDateId]){
                                    clubmemberLogDateId=clubmemberLog[clubmemberLogId][1].length;
                                    clubmemberLog[clubmemberLogId][1].push([todayStr,0,[]]);
                                }
                                clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][0]=thisPoints-clubmemberLogSum[thisUser][0];
                                for(var w in clubmembers[thisUser][1]){
                                    if(!clubmembers[thisUser][1].hasOwnProperty(w)){ continue; }
                                    var help=clubmembers[thisUser][1][w]-(clubmemberLogSum[thisUser][1][w]===undefined?0:clubmemberLogSum[thisUser][1][w]);
                                    for(var x=0;x<clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1].length;x++){
                                        if(clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1][x][0]==w){
                                            break;
                                        }
                                    }
                                    if(help>0){
                                        if(!clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1][x]){
                                            clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1][x].push([w,help]);
                                            clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1].sort(sortObjFunctions["productId"]);
                                        }else{
                                            clubmemberLog[clubmemberLogId][1][clubmemberLogDateId][1][x][1]=help;
                                        }
                                    }
                                }
                                clubmemberLog[clubmemberLogId][1].sort(sortObjFunctions["date"]);
                            }
                            newtable=createElement("table",{"cellspacing":"0","style":"display:inline-block;margin-left:5px;vertical-align:top;"},cell);
                            var sum=0;
                            for(var i=0;i<clubmemberLog[clubmemberLogId][1].length;i++){
                                sum += clubmemberLog[clubmemberLogId][1][i][1];
                                if(clubmemberLog[clubmemberLogId][1][0]=="0"){ continue; }
                                newtr=createElement("tr",{"class":"hoverBgDarkgreen"});
                                newtable.insertBefore(newtr,newtable.firstElementChild);
                                newdiv=createElement("div");
                                newtable1=createElement("table",{"cellspacing":"0","style":"display:inline-block;vertical-align:top;"},newdiv);
                                var c=2;
                                //var pkte=0;
                                    for(var j=0;j<clubmemberLog[clubmemberLogId][1][i][2].length;j++){
                                        var prod=clubmemberLog[clubmemberLogId][1][i][2][j][0];
                                        var amount=clubmemberLog[clubmemberLogId][1][i][2][j][1];
                                        if(c==2){
                                            c=0;
                                            newtr1=createElement("tr",{},newtable1);
                                        }
                                        newtd=createElement("td",{"style":"text-align:right;padding-right:5px;"},newtr1);
                                        c++;
                                        produktPic(0,prod,newtd).style.cssFloat="left";
                                        createElement("span",{},newtd,numberFormat(amount));
                                        //pkte += POINTS[0][prod]*clubmemberLog[thisUser][w][1][prod];
                                    }
                                    //createElement("div",{},newdiv,numberFormat(0.05*Math.round(pkte)));
                                if(newtable1.childElementCount>0){
                                    newtr.setAttribute("mouseOverText",newdiv.innerHTML);
                                    newtr.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
                                }
                                createElement("td",{"style":"text-align:right;padding-right:5px;border-left:1px solid black;"},newtr,clubmemberLog[clubmemberLogId][1][i][0]);
                                createElement("td",{"style":"text-align:right;padding-right:5px;"},newtr,numberFormat(sum));
                                createElement("td",{"style":"text-align:right;padding-right:5px;"},newtr,(clubmemberLog[clubmemberLogId][1][i][1]>0)?(+numberFormat(clubmemberLog[clubmemberLogId][1][i][1])):"");
                            }
                        }
                    }
                    cell=null;newtable=null;newtable1=null;newtr=null;newtr1=null;newtd=null;newdiv1=null;
                    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_clubmemberLog",implode(clubmemberLog,"showGuildQuestStatsResponse/clubmemberLog"));
                    container=null;newdiv=null;
                },0);
            }
        }catch(err){GM_logError("showGuildQuestStatsResponse","","",err);}
    });
    // New mode for questhistory
    function showGuildQuestStatsLastDays(days){
    //GM_log("showGuildQuestStatsLastDays "+days);
        //todayStr=getDateStr(now,2,false);
        var startDay=new Date();
        startDay=((new Date(startDay.getFullYear(),startDay.getMonth(),startDay.getDate()-days)).getTime())/1000;

        var obj=[0,[],0,1,0];
        var clubmemberLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_clubmemberLog"),"showGuildQuestStatsLastDays/clubmemberLog",{});
        var clubmemberLogSum=new Object();
        for(var u in clubmemberLog){
            if(!clubmemberLog.hasOwnProperty(u)){ continue; }
            var p=0;
            var help=new Object();
            for(var v in clubmemberLog[u]){
                if(!clubmemberLog[u].hasOwnProperty(v)){ continue; }
                if(v=="0"){ continue; }
                if(startDay<=getTime(v)){
                    p += clubmemberLog[u][v][0];
                    for(var w in clubmemberLog[u][v][1]){
                        if(!clubmemberLog[u][v][1].hasOwnProperty(w)){ continue; }
                        help[w]=(help[w]===undefined?0:help[w])+clubmemberLog[u][v][1][w];
                    }

                }
            }
            var help2=new Array();
            for(var w in help){
                if(!help.hasOwnProperty(w)){ continue; }
                help2.push({"p":w,"a":help[w]});
            }
            obj[0]=1;
            obj[1].push({"n":u,"p":p,"products":help2,"c":(u==FARMNAME?1:0)});
            obj[2]++;
            obj[4]=Math.max(obj[4],p);
        }
        if(obj[0]==0){
            obj[1]="No data";
        }else{
            obj[1].sort(function(a,b){return (b["p"]-a["p"]);});
        }

        var request=new Object();
        request.readyState=4;
        request.status=200;
        request.responseText=implode(obj,"showGuildQuestStatsLastDays/obj");
        //GM_log("responseText= "+implode(obj));
        unsafeWindow.showGuildQuestStatsResponse(request,4,1,0); //type,page,self
        /*
        request: [1,[
            {"n":"name1","p":17049,"products":[{"p":"id","a":amount},...],"c":1},
            ...
        ],nameCounter,pageNr,highestPoints]
        on error: [0,text]
        */
    }

    // Clubquest reformat
    unsafeOverwriteFunction("setGuildQuestRun",function(r){
        try{
            unsafeWindow._setGuildQuestRun(r);
        }catch(err){GM_logError("_setGuildQuestRun","","",err);}
        try{
            if(!$("guildquestboxBerater")){
                createElement("h1",{"id":"guildquestboxBerater","style":"display:none;"},$("guildquestboxcontent"));
                var cand=$("questobjectives").getElementsByClassName("link");
                var newdiv;
                for(var v=0;v<cand.length;v++){
                    newdiv=cand[v].getElementsByTagName("b")[0];
                    var help=/(\d+)\/(\d+)/.exec(newdiv.innerHTML.replace(regDelimThou,""));
                    help[1]=parseInt(help[1],10);
                    help[2]=parseInt(help[2],10);
                    newdiv.innerHTML=((help[1]==help[2])?"":(numberFormat(help[2]-help[1])+"/"+numberFormat(help[2])));
                    createElement("div",{"style":"position:absolute;top:0;left:0;width:100px;height:15px;color:black;font-weight:bold;text-align:center;"},cand[v].getElementsByTagName("div")[2],numberFormat(help[1]));
                }
                cand=null;newdiv=null;
            }
        }catch(err){GM_logError("setGuildQuestRun","","",err);}
    });
    // Clubquest product submitting

    unsafeOverwriteFunction("commitboxguild",function(c,a,d,b,e){
        try{
            unsafeWindow._commitboxguild(c,a,d,b,e);
        }catch(err){GM_logError("_commitboxguild","","",err);}
        try{
            if(!$("commitboxguildBerater")){
                createElement("h1",{"id":"commitboxguildBerater","style":"display:none;"},$("commitboxcontentguild"));
                if((help=$("commitboxguildokbutton").getAttribute("onclick")).match(/guildQuestAddProducts\((\d+)\)/)){
                    var currProd=/guildQuestAddProducts\((\d+)\)/.exec(help)[1];
                    var cand=$("commitboxcontentguild").getElementsByTagName("input")[0];
                    cand.setAttribute("prod",currProd);
                    // maximal value according to minRack
                    cand.value=Math.max(0,Math.min(cand.value,prodStock[0][currProd]-prodMinRack[0][currProd]));
                    createElement("div",{"id":"commitboxguildLowrack","class":"blackbox alertbox","style":"display:none;position:absolute;top:135px;left:0;"},$("commitboxcontentguild"),getText("alertWillLowRack"));
                    cand.addEventListener("keyup",function(){
                        // warning if more than minRack allows
                        var currProd=this.getAttribute("prod");
                        var help=(prodStock[0][currProd]-parseInt(this.value,10)<prodMinRack[0][currProd]?"block":"none");
                        var cell=$("commitboxguildLowrack");
                        if(cell.style.display!=help){ cell.style.display=help; }
                        cell=null;
                    },false);
                    cand=null;
                }
            }
        }catch(err){GM_logError("commitboxguild","","",err);}
    });

    // Clubquest product submitting (Patch 08.03.2016)
        // a = Produkt ID, b = Restmenge
        unsafeOverwriteFunction("guildQuestAddProductsCommit",function(a,b){
        try{
            unsafeWindow._guildQuestAddProductsCommit(a,b);
        }catch(err){GM_logError("_guildQuestAddProductsCommit","","",err);}
        try{
            if($("globalbox")){
                var input = $("dialog_entryline_number");
                if (input) {
                    input.value=Math.max(0,Math.min(b,prodStock[0][a]-prodMinRack[0][a]));;
                    keyup(input);
                }
                if ($("commitboxguildLowrack")) {
                    $("commitboxguildLowrack").style.display="none";
                } else {
                    createElement("div",{"id":"commitboxguildLowrack","class":"blackbox alertbox","style":"display:none;position:absolute;top:135px;left:0;"},$("globalbox"),getText("alertWillLowRack"));
                }
                input.addEventListener("keyup",function(){
                    // warning if more than minRack allows
                    var help=(prodStock[0][a]-parseInt(this.value,10)<prodMinRack[0][a]?"block":"none");
                    var cell=$("commitboxguildLowrack");
                    if(cell.style.display!=help){ cell.style.display=help; }
                    cell=null;
                },false);
                input=null;
            }
        }catch(err){GM_logError("commitboxguild","","",err);}
    });

    /*
    // wanna see all clubhouses ? ^^
    unsafeOverwriteFunction("setBeauties",function setBeauties(){
        for(var v=0;v<15;v++){ // <- edit the 18 (=max) to see the steps
            unsafeWindow.guilddata[4][v]=v+1;
        }
        unsafeWindow._setBeauties();
    });
    */

    // Friendslist
    unsafeOverwriteFunction("showfriendslist",function(status){
        try{
            unsafeWindow._showfriendslist(status);
        }catch(err){GM_logError("_showfriendslist","","",err);}
        try{
            var cand=$("friendslistcon").getElementsByClassName("friendslinename");
            // for(var v=0;v<cand.length;v++){
            //  var player=cand[v].getElementsByTagName("div")[0].innerHTML.replace(/&nbsp;.*/g,"");
            //  newspan=vertrag(player,cand[v].nextSibling);
            // }
            cand=$("friendslistcon").getElementsByTagName("img");
            for(var v=0;v<cand.length;v++){
                if(cand[v].getAttribute("src").match(/\/guild\/1\.gif/)){
                    cand[v].addEventListener("mouseover",function(event){ toolTip.show(event,unsafeWindow.guildrank[1]); },false);
                }else if(cand[v].getAttribute("src").match(/\/guild\/2\.gif/)){
                    cand[v].addEventListener("mouseover",function(event){ toolTip.show(event,unsafeWindow.guildrank[2]); },false);
                }else if(cand[v].getAttribute("src").match(/\/star\.png/)){
                    cand[v].addEventListener("mouseover",function(event){ toolTip.show(event,unsafeWindow.lng_t_premium); },false);
                }
            }
            cand=null;
        }catch(err){GM_logError("showfriendslist","","",err);}
    });

    // Friendpage loaded
    err_trace="Friendpage";
    unsafeOverwriteFunction("setFriendInfoContent",function(status,sel){
        try{
            unsafeWindow._setFriendInfoContent(status,sel);
        }catch(err){GM_logError("_setFriendInfoContent","","",err);}
        try{
            if(status == 1){
                var container=$("friendlistinfoblock");
                var cand=container.getElementsByTagName("li");
                var nextQuest=parseInt(cand[5].children[1].innerHTML,10)+1;
                if(QUESTS["main"]["1"][nextQuest]){
                    cand[5].setAttribute("nextQuest",nextQuest);
                    cand[5].addEventListener("mouseover",function(event){
                        var nextQuest=this.getAttribute("nextQuest");
                        var str="<div style='border-bottom:1px solid black;'>"+getText("quest_farm")+"&nbsp;"+nextQuest+"</div>";
                        for(var i=0;i<QUESTS["main"]["1"][nextQuest][0].length;i++){
                            if(typeof QUESTS["main"]["1"][nextQuest][0][i][0]=="object"){
                                for(var j=0;j<QUESTS["main"]["1"][nextQuest][0][i].length;j++){
                                    str += "<div>*"+numberFormat(QUESTS["main"]["1"][nextQuest][0][i][j][2])+"&nbsp;"+prodName[QUESTS["main"]["1"][nextQuest][0][i][j][0]][QUESTS["main"]["1"][nextQuest][0][i][j][1]]+"</div>";
                                }
                            }else{
                                str += "<div>"+numberFormat(QUESTS["main"]["1"][nextQuest][0][i][2])+"&nbsp;"+prodName[QUESTS["main"]["1"][nextQuest][0][i][0]][QUESTS["main"]["1"][nextQuest][0][i][1]]+"</div>";
                            }
                        }

                        toolTip.show(event,str);
                    },false);
                }
                cand=null;container=null;
            }
        }catch(err){GM_logError("setFriendInfoContent","","",err);}
    });

    // Farmis
    err_trace="Farmis";
    // Buylist opening
    unsafeOverwriteFunction("showCart",function(farmi,type){
    try{
        unsafeWindow._showCart(farmi,type);
    }catch(err){GM_logError("_showCart","","",err);}
    try{
        // get farmi data
        var prod,menge;
        var thisFarmiData=new Object();
        thisFarmiData["cart"]=new Array();
        switch(type){
        case 1:{
            for (var j=unsafeWindow.farmersmarket_data.farmis.length-1;j>-1;j--){
                if(unsafeWindow.farmersmarket_data.farmis[j].id==farmi){
                    thisFarmiData["money"]=parseFloat(unsafeWindow.farmersmarket_data.farmis[j]["price"],10);
                    thisFarmiData["points"]=parseFloat(unsafeWindow.farmersmarket_data.farmis[j]["points"],10);
                    for (var i=unsafeWindow.farmersmarket_data.farmis[j].cart.length-1;i>-1;i--){
                        prod=unsafeWindow.farmersmarket_data.farmis[j].cart[i]["pid"];
                        menge=unsafeWindow.farmersmarket_data.farmis[j].cart[i]["amount"];
                        thisFarmiData["cart"].push([prod,menge,menge*gut[prod]]);
                    }
                    break;
                }
            }
        break;}
        default:{
            // Obststandbonus
            var stallMilestone = (unsafeWindow.stall.data.milestones)?unsafeWindow.stall.data.milestones.farmis:0;
            if (unsafeWindow.specialbonus&&unsafeWindow.specialbonus.data[0]&&unsafeWindow.specialbonus.data[0].farmis&&unsafeWindow.specialbonus.data[0].farmis.money&&unsafeWindow.specialbonus.data[0].remain>0) {
                thisFarmiData["money"]=parseFloat(unsafeWindow.farmisinfo[0][farmi]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmi]["price"],10)*(stallMilestone+unsafeWindow.specialbonus.data[0].farmis.money);

            } else {
                thisFarmiData["money"]=parseFloat(unsafeWindow.farmisinfo[0][farmi]["price"],10)+parseFloat(unsafeWindow.farmisinfo[0][farmi]["price"],10)*(stallMilestone);
            }
            for(var i=1;i<=7;i++){
                prod=parseInt(unsafeWindow.farmisinfo[0][farmi]["p"+i],10);
                menge=parseInt(unsafeWindow.farmisinfo[0][farmi]["a"+i],10);
                if((prod>0)&&(menge>0)){
                    thisFarmiData["cart"].push([prod,menge,menge*gut[prod]]);
                }
            }
        }
        }
        // extend cart
        var cand=$top("cartheader").getElementsByTagName("span")[0];
        cand.style.fontWeight="bold";
        cand.setAttribute("class","link");
        cand.addEventListener("mouseover",function(event){ toolTip.show(event,getText("toSeedVendor")); },false);
        cand.addEventListener("click",function(event){
            showSeedVendor();
        },false);
        cand=$("cartsubmit");
        createElement("div",{"id":"cartsubmitPerc","style":"position:absolute;top:-35px;width:70px;padding:2px;text-align:right;font-size:20px;font-weight:bold;"},cand);
        if(type==1){
            cand=cand.querySelector(".farmcartsumamount").parentNode;
            cand.id="cartsubmitPoints";
            cand.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
        }
        cand=null;
        // (re-)build the table
        function buildTable(){
        try{
            var cartContent,newtable,newtr,newtd,span;
            cartContent=$("cartcontent");
            cartContent.innerHTML="";
            var prod,menge,wert,sum=0,priceMissing=false;
            thisFarmiData["cart"].sort(function(a,b){return (b[2]-a[2]);});
            newtable=createElement("table",{"border":"0","cellspacing":"0","cellpadding":"2","style":"margin:0 auto;"},cartContent);
            for(var v=0;v<thisFarmiData["cart"].length;v++){
                prod=thisFarmiData["cart"][v][0];
                menge=thisFarmiData["cart"][v][1];
                wert=thisFarmiData["cart"][v][2];
                sum += wert;
                newtr=createElement("tr",{"class":((prodStock[0][prod]<menge)?("farmicart_missing"):((prodStock[0][prod]-menge<prodMinRack[0][prod]-((valMinRackFarmis&&totalFarmis[0]&&totalFarmis[0][prod])?totalFarmis[0][prod]:0))?"farmicart_lowrack":"")),"prod":prod},newtable);
                produktPic(0,prod,createElement("td",{},newtr));
                createElement("td",{"style":"width:34px;text-align:right;font-size:16px;font-weight:bold;"},newtr,numberFormat(menge));
                newtd=createElement("td",{"class":"link","style":"width:200px;"},newtr);
                newtd.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.parentNode.getAttribute("prod")); },false);
                newtd.addEventListener("click",function(){showMarket(this.parentNode.getAttribute("prod"));},false);
                span=createElement("span",{"style":"font-size:16px;font-weight:bold;white-space:nowrap;"},newtd,prodName[0][prod]);
                span.style.fontSize=16*Math.min(1,200/span.offsetWidth)+"px";
                newtd=createElement("td",{"class":"link","nr":v,"style":"width:82px;text-align:right;font-size:14px;"},newtr);
                if(wert>0){
                    newtd=createElement("div",{"style":"position:relative;height:100%;padding-left:5px;padding-right:5px;"},newtd);
                    createElement("div",{"style":"position:absolute;left:0;height:100%;width:"+Math.ceil(100*wert/thisFarmiData["cart"][0][2])+"%;background-color:grey;opacity:0.6;z-index:-1;"},newtd);
                    createElement("span",{"style":"width:100%;"},newtd,moneyFormatInt(wert));
                }else{
                    newtd.style.backgroundColor="red";
                    priceMissing=true;
                }
                newtd.addEventListener("mouseover",function(event){ toolTip.show(event,getText("editPrice")); },false);
                newtd.addEventListener("click",function(){
                    var cell,newtable,newt,newtdr
                    cell=this;
                    while(cell.nodeName!="TD"){ cell=cell.parentNode; }
                    var v=cell.getAttribute("nr");
                    cell=$("cartcontentEditPrice");
                    if(cell){ removeElement(cell); }
                    newtable=createElement("div",{"id":"cartcontentEditPrice","style":"z-index:10;position:absolute;right:0;top:0;display:block;border-radius:5px;","class":"blackbox"},$("cartcontent"));
                    newtable=createElement("table",{"cellspacing":"0","cellpadding":"0","border":"0","nr":v},newtable);
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"colspan":"2","style":"color:black;text-align:center;padding-bottom:2px;white-space:nowrap;"},newtr,getText("editPrice"));
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"colspan":"2","style":"color:black;border-bottom:1px solid black;text-align:center;padding-bottom:2px;white-space:nowrap;"},newtr,numberFormat(thisFarmiData["cart"][v][1])+"&nbsp;"+prodName[0][thisFarmiData["cart"][v][0]]);
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-top:2px;padding-right:10px;"},newtr,getText("marketPrice"));
                    createElement("td",{"style":"color:black;text-align:right;padding-top:2px;"},newtr,moneyFormat(gut[thisFarmiData["cart"][v][0]]));
                    newtr=createElement("tr",{},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("NPCprice"));
                    createElement("td",{"style":"color:black;text-align:right;"},newtr,isNaN(NPC[0][thisFarmiData["cart"][v][0]])?"-":moneyFormat(NPC[0][thisFarmiData["cart"][v][0]]));
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("single"));
                    newtd=createElement("td",{},newtr);
                    cell=createElement("input",{"class":"text","type":"text","style":"color:black;text-align:right;width:60px;","value":numberFormat(thisFarmiData["cart"][v][2]/thisFarmiData["cart"][v][1],2),"maxlength":"8"},newtd);
                    cell.addEventListener("change",function(){
                        var help=parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                        if(!isNaN(help)){
                            if(help<0){ help*=-1; }
                            help=Math.round(100*help)/100;
                            this.value=numberFormat(help,2);
                            var v=this.parentNode.parentNode.parentNode.getAttribute("nr");
                            thisFarmiData["cart"][v][2]=help*thisFarmiData["cart"][v][1];
                            this.parentNode.parentNode.nextElementSibling.children[1].firstElementChild.value=numberFormat(thisFarmiData["cart"][v][2],2);
                        }
                    },false);
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    createElement("td",{"style":"color:black;text-align:left;padding-right:10px;"},newtr,getText("total"));
                    newtd=createElement("td",{},newtr);
                    cell=createElement("input",{"class":"text","type":"text","style":"color:black;text-align:right;width:60px;","value":numberFormat(thisFarmiData["cart"][v][2],2),"maxlength":"9"},newtd);
                    cell.addEventListener("change",function(){
                        var help=parseFloat(this.value.replace(regDelimThou,"").replace(regDelimDeci,"."),10);
                        if(!isNaN(help)){
                            if(help<0){ help*=-1; }
                            help=Math.round(100*help)/100;
                            this.value=numberFormat(help,2);
                            var v=this.parentNode.parentNode.parentNode.getAttribute("nr");
                            thisFarmiData["cart"][v][2]=help;
                            this.parentNode.parentNode.previousElementSibling.children[1].firstElementChild.value=numberFormat(thisFarmiData["cart"][v][2]/thisFarmiData["cart"][v][1],2);
                        }
                    },false);
                    newtr=createElement("tr",{"style":"height:22px;"},newtable);
                    newtd=createElement("td",{"colspan":"2","style":"color:black;border-top:1px solid black;text-align:center;padding-top:2px;"},newtr);
                    cell=createElement("button",{"class":"link","type":"button","style":"color:black;"},newtd,getText("ok"));
                    cell.addEventListener("click",function(){
                        removeElement(this.parentNode.parentNode.parentNode.parentNode);
                        buildTable();
                    },false);
                    cell=null;newtable=null;newtr=null;newtd=null;
                },false);
            }

            newtr=createElement("tr",{},newtable);
            createElement("td",{"colspan":"3"},newtr);
            newtd=createElement("td",{"style":"padding-left:5px;padding-right:5px;border-top:1px solid #336;text-align:right;color:#336;font-size:14px;","mouseOverText":"90%: "+moneyFormatInt(0.9*sum)},newtr,moneyFormatInt(sum));
            newtd.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);

            newtd=$("cartsubmitPerc");
            if(priceMissing){
                newtd.style.border="4px inset #336";
                newtd.style.color="#336";
                newtd.style.backgroundColor="transparent";
                newtd.innerHTML="--%";
            }else{
                if(100*thisFarmiData["money"]<valFarmiLimits[0]*sum){ var col="red";var col2="#fcc"; }
                else if(100*thisFarmiData["money"]<valFarmiLimits[1]*sum){ var col="#d80";var col2="#ff9"; }
                else{ var col="green";var col2="#80ff80"; }
                newtd.style.border="4px inset "+col;
                newtd.style.color=col;
                newtd.style.backgroundColor=col2;
                newtd.innerHTML=Math.round(100*thisFarmiData["money"]/sum)+"%";
            }
            if(thisFarmiData["points"]){
                span=$("cartsubmitPoints");
                if(thisFarmiData["money"]<sum){
                    newtable=createElement("div",{});
                    newtable=createElement("table",{},newtable);
                    newtr=createElement("tr",{},newtable);
                    newtd=createElement("td",{"style":"text-align:right;"},newtable,"100%: ");
                    newtd=createElement("td",{"style":"text-align:right;"},newtable,numberFormat(1000*(sum-thisFarmiData["money"])/thisFarmiData["points"]));
                    newtd=createElement("td",{},newtable,getText("gamecurrency")+"/"+numberFormat(1000)+getText("points"));
                    newtr=createElement("tr",{},newtable);
                    newtd=createElement("td",{"style":"text-align:right;"},newtable,"90%: ");
                    if(thisFarmiData["money"]<0.9*sum){
                        newtd=createElement("td",{"style":"text-align:right;"},newtable,numberFormat(1000*(0.9*sum-thisFarmiData["money"])/thisFarmiData["points"]));
                        newtd=createElement("td",{},newtable,getText("gamecurrency")+"/"+numberFormat(1000)+getText("points"));
                    }else{
                        newtd=createElement("td",{"colspan":2},newtable,"---");
                    }
                    span.setAttribute("mouseOverText",newtable.parentNode.innerHTML);
                }else{
                    span.setAttribute("mouseOverText","-");
                }
            }
            cartContent=null;newtable=null;newtr=null;newtd=null;span=null;
        }catch(err){GM_logError("showCart.buildTable","","",err);}
        }
        buildTable();
    }catch(err){GM_logError("showCart","","",err);}
    });
    // Farmis displayed
    unsafeOverwriteFunction("setFarmis",function(){
        try{
            unsafeWindow._setFarmis();
        }catch(err){GM_logError("_setFarmis","","",err);}
        try{
            calcFarmiCost();
            calcTotalFarmis();
            doFarmis();
        }catch(err){GM_logError("setFarmis","","",err);}
    });


    // Farmersmarket
    // return AnimalID or Time of next ready tinkture

    vetTreatment = GM_getValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_vetTreatment", true);
    unsafeWindow.findTreatedAnimal=function() {
        try {
            var vet_data=unsafeWindow.farmersmarket_data.vet;
            var drugsArray = {};
            var animalID;
            for (var queueID in vet_data.animals.queue) {
                if(vet_data.animals.queue[queueID].drugs) {continue;}
                for (var diseasesCount = 0; diseasesCount < vet_data.animals.queue[queueID].diseases.length; diseasesCount++) {
                    var diseasesID = vet_data.animals.queue[queueID].diseases[diseasesCount].id;
                    for (var drugsID in vet_data.drugs) {
                        if(vet_data.drugs[drugsID].coins) {continue;}
                        if(unsafeWindow.in_array(diseasesID, vet_data.drugs[drugsID].diseases) && vet_data.drugs[drugsID].level <= vet_data.info.level) {
                            if(drugsArray[drugsID]) {
                                drugsArray[drugsID]+=vet_data.animals.queue[queueID].diseases[diseasesCount].phase;
                            }
                            else {
                                drugsArray[drugsID]=vet_data.animals.queue[queueID].diseases[diseasesCount].phase;
                            }
                            break;
                        }
                    }
                }
                if (drugsArray) {
                    //console.log(drugsArray);
                    for (var c in drugsArray) {
                        if (!drugsArray.hasOwnProperty(c)){ continue; }
                        //console.log(c+" "+drugsArray[c]);
                        if (prodStock[0][c]>=drugsArray[c]){
                            animalID=queueID;
                        } else {
                            animalID=0;
                            break;
                        }
                    }
                }
                if(typeof animalID=="string") {
                    return animalID;
                    break;
                }
                drugsArray={};
            }
            var endTime=NEVER;
            for(var slot=1;slot<=3;slot++){ //Find endtime: next tincture, todo: Slot4 tincture
                zoneNrS="farmersmarket-5"+"."+slot;
                if(!zones.getBlock(zoneNrS)){
                    var help=zones.getEndtime(zoneNrS);
                    endTime=Math.min(endTime,help);
                }
            }
            return endTime;
        } catch(err){GM_logError("findTreatedAnimal","","",err); }
    }

    function doFarmersMarketData(){
        try{
            var err_trace="zones";
            var nowServer=unsafeWindow.Zeit.Server;
            var item,zoneNrF,zoneNrS,tempZoneProductionData,tempZoneProductionDataSlot,iProd,iTime,iWaterTime,iPoints,iAmount,currBlock;
            GM_logInfo("doFarmersMarketData","","","Farmersmarket: Daten eingelesen: "+ getDaytimeStr(nowServer));
            if(unsafeWindow.farmersmarket_data){
                if(unsafeWindow.farmersmarket_data.flower_slots){
                    zoneNrF="farmersmarket-0";
                    zones.setBlock(zoneNrF,"");
                    zones.setBonus(zoneNrF,0);

                    tempZoneProductionData=[[{}],BUILDING_SIZE[zones.getBuilding(zoneNrF)],BUILDING_SIZE[zones.getBuilding(zoneNrF)],true];
                    if(unsafeWindow.farmersmarket_data.flower_slots.slots){
                        for(var slot in unsafeWindow.farmersmarket_data.flower_slots.slots){
                            if(!unsafeWindow.farmersmarket_data.flower_slots.slots.hasOwnProperty(slot)){continue;}
                            item=unsafeWindow.farmersmarket_data.flower_slots.slots[slot];
                            iProd=parseInt(item["pid"],10);
                            if(item["remain"]){
                                tempZoneProductionData[1]--;
                                if(item["remain"]>0){
                                    iTime=nowServer+parseInt(item["remain"],10);
                                    iWaterTime=nowServer+parseInt(item["waterremain"],10);
                                }else{
                                    iTime=nowServer+parseInt(item["remain"],10);
                                    iWaterTime=NEVER;
                                }
                            }else{
                                iTime=NEVER;
                                iWaterTime=NEVER;
                            }
                            iAmount=1;
                            iPoints=parseInt(item["points"],10);
                            if(tempZoneProductionData[0][0][iProd]){
                                var notfound=true;
                                for(var i=0;i<tempZoneProductionData[0][0][iProd].length;i++){
                                    if((tempZoneProductionData[0][0][iProd][i][2]==iTime)&&(tempZoneProductionData[0][0][iProd][i][3]==iWaterTime)){
                                        tempZoneProductionData[0][0][iProd][i][0]+=iAmount;
                                        tempZoneProductionData[0][0][iProd][i][1]+=iPoints;
                                        notfound=false;break;
                                    }
                                }
                                if(notfound){ tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,iWaterTime]); }
                            }else{
                                tempZoneProductionData[0][0][iProd]=[[iAmount,iPoints,iTime,iWaterTime]];
                            }
                        }
                    }
                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                }
                zoneNrF="farmersmarket-1";
                if(unsafeWindow.farmersmarket_data.flower_bonus&&unsafeWindow.farmersmarket_data.flower_bonus.pid&&(unsafeWindow.farmersmarket_data.flower_bonus.remain>0)){
                    zones.setBonusSpecial(zoneNrF,[unsafeWindow.farmersmarket_data.flower_bonus.pid,parseInt(unsafeWindow.flowerarea_dailybonus_percent,10)]);
                }else{
                    zones.setBonusSpecial(zoneNrF,null);
                }
                if(unsafeWindow.farmersmarket_data.pos){
                    for(var w=1;w<=11;w++) {
                        if(item=unsafeWindow.farmersmarket_data.pos[w]){
                            zoneNrF="farmersmarket-"+w;
                            currBlock=(item["block"]&&item["cost"]?"b":""); // locked due to missing payment
                            currBlock+=(item["block"]&&item["level"]?"l"+item["level"]:""); // locked due to level requirement
                            switch(w){
                            case 1:{ // Flower meadow
                                tempZoneProductionData=[[{}],BUILDING_SIZE[zones.getBuilding(zoneNrF)],BUILDING_SIZE[zones.getBuilding(zoneNrF)],true];
                                zones.setBonus(zoneNrF,5);
                                if(unsafeWindow.farmersmarket_data.flower_area){
                                    for(var slot in unsafeWindow.farmersmarket_data.flower_area){
                                        if(!unsafeWindow.farmersmarket_data.flower_area.hasOwnProperty(slot)){continue;}
                                        item=unsafeWindow.farmersmarket_data.flower_area[slot];
                                        iProd=parseInt(item["pid"],10);
                                        if(item["remain"]){
                                            tempZoneProductionData[1]--;
                                            if(item["remain"]>0){ //production busy, "duration" is reduced by watering
                                                //iTime=parseInt(item["duration"],10)+parseInt(item["createdate"],10);
                                                iTime=nowServer+parseInt(item["remain"],10);
                                                if(zones.getBonus(zoneNrF)>0){
                                                    iWaterTime=parseInt(item["waterdate"],10);
                                                    iWaterTime=((item["water_remain"]<0)?parseInt(item["createdate"],10):(item["water_remain"]<item["remain"]?item["water_remain"]+nowServer:NEVER));
                                                }else{
                                                    iWaterTime=NEVER;
                                                }
                                            }else{
                                                //iTime=parseInt(item["duration"],10)+parseInt(item["createdate"],10);
                                                iTime=nowServer+parseInt(item["remain"],10);
                                                iWaterTime=NEVER;
                                            }
                                        }else{
                                            iTime=NEVER;
                                            iWaterTime=NEVER;
                                        }
                                        iAmount=prodYield[0][iProd];
                                        iPoints=prodPoints[0][iProd];
                                        if(tempZoneProductionData[0][0][iProd]){
                                            var notfound=true;
                                            for(var i=0;i<tempZoneProductionData[0][0][iProd].length;i++){
                                                if((tempZoneProductionData[0][0][iProd][i][2]==iTime)&&(tempZoneProductionData[0][0][iProd][i][3]==iWaterTime)){
                                                    tempZoneProductionData[0][0][iProd][i][0]+=iAmount;
                                                    tempZoneProductionData[0][0][iProd][i][1]+=iPoints;
                                                    notfound=false;break;
                                                }
                                            }
                                            if(notfound){
                                                 tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,iWaterTime]); }
                                        }else{
                                            tempZoneProductionData[0][0][iProd]=[[iAmount,iPoints,iTime,iWaterTime]];
                                        }
                                    }
                                }
                                zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                            break;}
                            case 2:{ // Flower workshop
                                zones.setBonus(zoneNrF,0);
                                if((!currBlock)&&(unsafeWindow.farmersmarket_data.nursery&&unsafeWindow.farmersmarket_data.nursery.slots)){
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    for(var slot=1;slot<=3;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        if(item=unsafeWindow.farmersmarket_data.nursery.slots[slot]){
                                            if(item["block"]){
                                                zones.setBlock(zoneNrS,"b");
                                            }else{
                                                iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                                if(isNaN(iProd)){ iProd=null; }
                                                if((iProd!=null)&&(item["ready"])){ // production ready
                                                    iTime=nowServer;
                                                }else if((iProd!=null)&&(item["remain"])){ // production busy
                                                    iTime=nowServer+item["remain"];
                                                }else{
                                                    iTime=NEVER;
                                                    tempZoneProductionData[1]++;
                                                    tempZoneProductionDataSlot[1]++;
                                                }
                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;
                                                if(iProd!=null){
                                                    iAmount=prodYield[0][iProd];
                                                    iPoints=iAmount*prodPoints[0][iProd];
                                                    if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                    tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                    if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                    tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                }
                                            }
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }
                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                }
                            break;}
                            /* Test
                            tempZoneProductionData=[[{},{}],0,0,true];
                            for (slot=1;slot<=3;slot++){
                                zoneNrS=zoneNrF+"."+slot;
                                zones.setBlock(zoneNrS,"blpqs");
                            }*/

                            case 3:{ //monster fruit culture
                                //13102016
                                zones.setBonus(zoneNrF,0);
                                /*
                                console.log("=== START LESE monster fruit culture ===");
                                console.log(print_r(unsafeWindow.farmersmarket_data.megafruit, "", true, "\n"));
                                console.log("=== END LESE monster fruit culture ===");
                                */
                                if((!currBlock)&&(unsafeWindow.farmersmarket_data.megafruit)) {
                                    if(unsafeWindow.farmersmarket_data.megafruit.current) {
                                        zones.setBonus(zoneNrF,0);
                                        item = unsafeWindow.farmersmarket_data.megafruit;
                                         var SLOT={"water":1,"light":2,"fertilize":3};
                                        //slot = 0;
                                        iProd=item.current.pid; iAmount=0; iPoints=0;
                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        for (var i in item.current.data){
                                            if(!item.current.data.hasOwnProperty(i)){ continue; }
                                            slot = SLOT[i];
                                            zoneNrS=zoneNrF+"."+slot;
                                            zones.setBlock(zoneNrS,"");

                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];

                                            if (item.current.remain>=0) {
                                                if (item.current.data[i].remain>0) {
                                                    iTime = nowServer+item.current.data[i].remain;
                                                } else {
                                                    //iTime = nowServer+item.current.data[i].remain;
                                                    iTime = NEVER;
                                                    tempZoneProductionData[1]++;
                                                    tempZoneProductionDataSlot[1]++;
                                                }
                                            } else {
                                                //monster fruit culture ready
                                                showGoToMonsterFruitCultureReady();
                                                iTime=nowServer+(60*60*3);
                                            }

                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;

                                            if(!tempZoneProductionData[0][0][iProd]) {
                                                tempZoneProductionData[0][0][iProd]=[];
                                            }
                                            tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);

                                            if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                tempZoneProductionDataSlot[0][0][iProd]=[];
                                            }
                                            tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                    } else {
/*
                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        for (slot=1;slot<=3;slot++){
                                            zoneNrS=zoneNrF+"."+slot;
                                            zones.setBlock(zoneNrS,"blpqs");
                                        }*/

                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        item = unsafeWindow.farmersmarket_data.megafruit;
                                        for (slot=1;slot<=3;slot++){
                                            zoneNrS=zoneNrF+"."+slot;
                                            if(item.objects[Object.keys(item.objects)[slot-1]][0].locked){
                                                zones.setBlock(zoneNrS,"blpqs");
                                                continue;
                                            }
                                            zones.setBlock(zoneNrS,"");
                                            if(!tempZoneProductionData[0][0][iProd]) {
                                                tempZoneProductionData[0][0][iProd]=[];
                                            }
                                            tempZoneProductionData[0][0][iProd].push([0,0,NEVER,NEVER]);

                                            if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                tempZoneProductionDataSlot[0][0][iProd]=[];
                                            }
                                            tempZoneProductionDataSlot[0][0][iProd].push([0,0,NEVER,NEVER]);
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                    }
                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                }
                            break;}

                            case 4:{ //breeding
                                //13102016
                                zones.setBonus(zoneNrF,0);
                                // console.log("=== START LESE Animal breeding ===");
                                // console.log(print_r(unsafeWindow.farmersmarket_data.pets, "", true, "\n"));
                                // console.log(unsafeWindow.farmersmarket_data.pets.production);
                                if((!currBlock)&&(unsafeWindow.pets&&unsafeWindow.pets.data&&unsafeWindow.pets.data.production)){
                                    //Products for animal breedingä
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    for(var slot=1;slot<=4;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        item=unsafeWindow.pets.data.production[slot];
                                        if(slot >= 3 && unsafeWindow.pets.data.data.slots[slot]["block"]) { // slot blocked
                                            zones.setBlock(zoneNrS,"b");
                                        } else if(unsafeWindow.pets.data.production[slot]){ // production running ?????
                                            item=unsafeWindow.pets.data.production[slot]["1"];
                                            iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                            if(isNaN(iProd)){ iProd=null; }
                                            if(iProd!=null) { // production in slot is ready (item["remain"] == 0) or busy (item["remain"] > 0)
                                                iTime=nowServer+Math.round(item["remain"]); // Math.round, because it's sometimes returned as string
                                            }else{
                                                iTime=NEVER;
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                            }
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                            if(iProd!=null){
                                                iAmount=prodYield[0][iProd];
                                                iPoints=iAmount*prodPoints[0][iProd];
                                                if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            }
                                        } else { // slot empty
                                            tempZoneProductionData[1]++;
                                            tempZoneProductionDataSlot[1]++;
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }
                                    //Animal breeding
                                    //if (unsafeWindow.farmersmarket_data.pets.breed!=0 && unsafeWindow.farmersmarket_data.pets.breed.remain>0){
                                    if (unsafeWindow.pets.data.breed!=0){
                                        zones.setBonus(zoneNrF,0);
                                        item = unsafeWindow.pets.data.breed;
                                        slot = 4;
                                        for (var i in item.happiness_interval){
                                            if(!item.happiness_interval.hasOwnProperty(i)){ continue; }
                                            slot++;
                                            zoneNrS=zoneNrF+"."+slot;
                                            zones.setBlock(zoneNrS,"");

                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            iProd=0; iAmount=0; iPoints=0;
                                            if (item.remain>0) {
                                                if (item.care_remains.hasOwnProperty(i)){
                                                    iTime = nowServer+item.care_remains[i];
                                                } else {
                                                    if (item.remain<7200) {
                                                        iTime = nowServer+item.remain;
                                                    } else{
                                                        //iTime = nowServer-item.happiness_interval[i];
                                                        iTime = NEVER;
                                                        tempZoneProductionData[1]++;
                                                        tempZoneProductionDataSlot[1]++;
                                                    }
                                                }
                                            } else {
                                                //Aufzucht fertig
                                                showGoToAnimalBreedingReady();
                                                //iTime=NEVER;
                                                //Todo: Automatisierung: Neue Aufzucht starten
                                                //Fertige Zeit auf in 3 Stunden setzen, damit der Bot nicht versucht, weitere Slots zu bedienen
                                                iTime=nowServer+(60*60*3);
                                            }

                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;

                                            if(!tempZoneProductionData[0][0][iProd]) {
                                                tempZoneProductionData[0][0][iProd]=[];
                                            }
                                            tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                tempZoneProductionDataSlot[0][0][iProd]=[];
                                            }
                                            tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                    } else {
                                        for (slot=5;slot<=7;slot++){
                                            zoneNrS=zoneNrF+"."+slot;
                                            zones.setBlock(zoneNrS,"blpqs");
                                        }
                                    }
                                    //End
                                zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                }
                            break;}
                            case 5:{ // Vet
                                zones.setBonus(zoneNrF,0);
                                if((!currBlock)&&(unsafeWindow.farmersmarket_data.vet&&unsafeWindow.farmersmarket_data.vet.production)){
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    for(var slot=1;slot<=4;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        item=unsafeWindow.farmersmarket_data.vet.animals.slots2[slot];
                                        if(slot >= 3 && item["block"]) { // slot blocked
                                            zones.setBlock(zoneNrS,"b");
                                        } else if(unsafeWindow.farmersmarket_data.vet.production[slot]){ // production running
                                            item=unsafeWindow.farmersmarket_data.vet.production[slot]["1"];
                                            iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                            if(isNaN(iProd)){ iProd=null; }
                                            if(iProd!=null) { // production in slot is ready (item["remain"] == 0) or busy (item["remain"] > 0)
                                                iTime=nowServer+Math.round(item["remain"]); // Math.round, because it's sometimes returned as string
                                            }else{
                                                iTime=NEVER;
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                            }
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                            if(iProd!=null){
                                                iAmount=prodYield[0][iProd];
                                                iPoints=iAmount*prodPoints[0][iProd];
                                                if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            }
                                        } else { // slot empty
                                            tempZoneProductionData[1]++;
                                            tempZoneProductionDataSlot[1]++;
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }

                                    //Animal Treatment
                                    if (vetTreatment){
                                        iProd=1000;
                                        var vet_data=unsafeWindow.farmersmarket_data.vet;
                                        for(var slot=1;slot<=3;slot++){
                                            zoneNrS=zoneNrF+"."+(slot+4); //+4 internal mapping
                                            zones.setBlock(zoneNrS,"");
                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            iProd++; iAmount = 0; iPoints = 0;
                                            if (vet_data.animals.slots[slot]) {
                                                if(isNaN(vet_data.animals.slots[slot].remain)){
                                                    iTime=0;
                                                } else {
                                                    iTime=nowServer+vet_data.animals.slots[slot].remain;
                                                    for (var d = 0; d < vet_data.animals.queue[vet_data.animals.slots[slot].id].diseases.length; d++) {
                                                        var diseasesID =  vet_data.animals.queue[vet_data.animals.slots[slot].id].diseases[d].id;
                                                        var drugsID = vet_data.animals.queue[vet_data.animals.slots[slot].id].drugs[diseasesID];
                                                        if(drugsID) {
                                                            var phase = vet_data.animals.queue[vet_data.animals.slots[slot].id].diseases[d].phase;
                                                            var moneyBonus = vet_data.quest.bonus_all.pat_money ? 1+(vet_data.quest.bonus_all.pat_money/100):1;
                                                            var pointBonus = vet_data.quest.bonus_all.pat_points ? 1+(vet_data.quest.bonus_all.pat_points/100):1;
                                                            iAmount = iAmount + (vet_data.drugs[drugsID].reward[diseasesID].money * phase * moneyBonus);
                                                            iPoints = iPoints + (vet_data.drugs[drugsID].reward[diseasesID].points * phase * pointBonus);
                                                        }
                                                    }
                                                }
                                            } else {
                                                var animalID = unsafeWindow.findTreatedAnimal();
                                                if(typeof animalID!="string") {
                                                    iTime=animalID;
                                                } else {
                                                    iTime=nowServer-5000;
                                                }
                                            }
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;

                                            if(!tempZoneProductionData[0][0][iProd]){
                                                tempZoneProductionData[0][0][iProd]=[];
                                            }
                                            tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            if(!tempZoneProductionDataSlot[0][0][iProd]){
                                                tempZoneProductionDataSlot[0][0][iProd]=[];
                                            }
                                            tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                    } else {
                                        for (slot=5;slot<=7;slot++){
                                            zoneNrS=zoneNrF+"."+slot;
                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                            zones.setBlock(zoneNrS,"blpqs");
                                        }
                                    }
                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                    showGoToVetFarmi(); // Determine, if Discharge-Sick-Animals-Icon is shown
                                }
                            break;}
                            case 6:{ //Speed eating
                                zones.setBonus(zoneNrF,0);
                                /*
                                console.log("=== START LESE Speed eating ===");
                                console.log(print_r(unsafeWindow.farmersmarket_data.foodcontest, "", true, "\n"));
                                console.log("=== END LESE Speed eating ===");
                                */
                                if((!currBlock)&&(unsafeWindow.farmersmarket_data.foodcontest)) {
                                    if(unsafeWindow.farmersmarket_data.foodcontest.current) {
                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        zones.setBlock(zoneNrF,"");

                                        item = unsafeWindow.farmersmarket_data.foodcontest;
                                        iProd=item.current.pid; iAmount=0; iPoints=0;

                                        if (item.current.remain>=0) {
                                            var remain = item.current.feedremain; //Remain feed fighter

                                            for (var i = 1; i<=4;i++) { //Zuschauer
                                                if(item.blocks[i].block) { continue; }
                                                for (var j in item.blocks[i].pin){
                                                    if(!item.blocks[i].pin.hasOwnProperty(j)){ continue; }
                                                    remain = Math.min(remain,item.blocks[i].pin[j].remain);
                                                }
                                            }

                                            remain = Math.min(remain,item.current.data.merchpin_remain);

                                            if(remain > 0) {
                                                iTime = nowServer+remain;
                                            } else {
                                                iTime = NEVER;
                                                tempZoneProductionData[1]++;
                                            }
                                        } else {
                                            //Speed eating ready
                                            showGoToSpeedEatingReady();
                                            iTime=nowServer+(60*60*3);
                                        }
                                        tempZoneProductionData[2]++;

                                        if(!tempZoneProductionData[0][0][iProd]) {
                                            tempZoneProductionData[0][0][iProd]=[];
                                        }
                                        tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                    } else {
                                        //to do
                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }
                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                }
                            break;}
                            case 7:{ //butterfly
                                zones.setBonus(zoneNrF,0);
/*
                                console.log("=== START LESE butterfly ===");
                                console.log(print_r(unsafeWindow.butterfly, "", true, "\n"));
                                console.log("=== END LESE butterfly ===");

*/
                                if((!currBlock)&&(unsafeWindow.butterfly)) {
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    item = unsafeWindow.butterfly;
                                    for(var slot=1;slot<=6;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");

                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        if( (slot == 1)||(slot>1 && item.data.data.slots && item.data.data.slots[slot]) ) {
                                            //unlocked
                                            if(item.data.data.breed[slot]){
                                                iProd=1; iAmount=0; iPoints=0;
                                                if(item.data.data.breed[slot].remain > 0) {
                                                    iTime = nowServer+item.data.data.breed[slot].remain;
                                                } else {
                                                    iTime=NEVER;
                                                    tempZoneProductionData[1]++;
                                                    tempZoneProductionDataSlot[1]++;
                                                }

                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;

                                                if(!tempZoneProductionData[0][0][iProd]){
                                                    tempZoneProductionData[0][0][iProd]=[];
                                                }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]){
                                                    tempZoneProductionDataSlot[0][0][iProd]=[];
                                                }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());

                                            } else{
                                                //Slot empty

                                            }
                                        } else {
                                            //locked
                                            zones.setBlock(zoneNrS,"b");
                                        }
                                    }
                                }
                                zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                break;}
                            case 8:{ // cowracing food
                                    /*console.log("=== START LESE Cowracing ===");
                                    console.log(print_r(unsafeWindow.cowracing, "", true, "\n"));
                                    console.log("=== END LESE Cowracing ===");
                                    */
                                    zones.setBonus(zoneNrF,0);
                                    if((!currBlock)&&(unsafeWindow.cowracing)){
                                        tempZoneProductionData=[[{},{}],0,0,true];
                                        if (!zones.getBuilding(zoneNrF)){
                                            zones.setBuilding(zoneNrF,"fl8");
                                        }
                                        //Production
                                        for(var slot=1;slot<=4;slot++){
                                            zoneNrS=zoneNrF+"."+slot;
                                            zones.setBlock(zoneNrS,"");
                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            if(slot >= 3 && unsafeWindow.cowracing.data.data.slots[slot]["block"]) { // slot blocked
                                                zones.setBlock(zoneNrS,"b");
                                            } else if(unsafeWindow.cowracing.data.production&&unsafeWindow.cowracing.data.production[slot]){ // production running
                                                item=unsafeWindow.cowracing.data.production[slot]["1"];
                                                iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                                if(isNaN(iProd)){ iProd=null; }
                                                if(iProd!=null) { // production in slot is ready (item["remain"] == 0) or busy (item["remain"] > 0)
                                                    iTime=nowServer+Math.round(item["remain"]); // Math.round, because it's sometimes returned as string
                                                    //iTime = nowServer + 20;
                                                }else{
                                                    iTime=NEVER;
                                                    tempZoneProductionData[1]++;
                                                    tempZoneProductionDataSlot[1]++;
                                                }
                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;
                                                if(iProd!=null){
                                                    iAmount=prodYield[0][iProd];
                                                    iPoints=iAmount*prodPoints[0][iProd];
                                                    if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                    tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                    if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                    tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                }
                                            } else { // slot empty
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;
                                            }
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                        //Cow feeding
                                        for(var slot=1;slot<=15;slot++){
                                            zoneNrS=zoneNrF+"."+(slot+4);
                                            zones.setBlock(zoneNrS,"");
                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            if (slot >= 1 && !unsafeWindow.cowracing.data.data.cows.hasOwnProperty(slot)) {
                                                zones.setBlock(zoneNrS,"b");
                                            } else {
                                                item=unsafeWindow.cowracing.data.data.cows[slot];
                                                if (item.hasOwnProperty("feed_remain")) {
                                                    iProd=(item["feed_pid"]?parseInt(item["feed_pid"],10):null);
                                                    iTime=(item.ispvp==1)?nowServer+Math.round(unsafeWindow.cowracing.data.pvp.racedayremain+60):nowServer+Math.round(item["feed_remain"]);
                                                } else {
                                                    if(item.ispvp==1){
                                                        iProd=null;
                                                        iTime=nowServer+Math.round(unsafeWindow.cowracing.data.pvp.racedayremain+60); // Math.round, because it's sometimes returned as string
                                                    } else {
                                                        iTime=NEVER;
                                                        tempZoneProductionData[1]++;
                                                        tempZoneProductionDataSlot[1]++;
                                                    }
                                                }
                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;

                                                if(!tempZoneProductionData[0][0][iProd]) {
                                                    tempZoneProductionData[0][0][iProd]=[];
                                                }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                    tempZoneProductionDataSlot[0][0][iProd]=[];
                                                }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                            }
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                        //Cow racing
                                        for(var slot=1;slot<=15;slot++){
                                            zoneNrS=zoneNrF+"."+(slot+4+15);
                                            zones.setBlock(zoneNrS,"");
                                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                            if (slot >= 1 && !unsafeWindow.cowracing.data.data.cows.hasOwnProperty(slot)) {
                                                zones.setBlock(zoneNrS,"b");
                                            } else {
                                                item=unsafeWindow.cowracing.data.data.cows[slot];
                                                if (item.hasOwnProperty("race_remain") && item["race_remain"]>=0) {
                                                    iProd=1;
                                                    iTime=(item.ispvp==1)?nowServer+Math.round(unsafeWindow.cowracing.data.pvp.racedayremain+60):nowServer+Math.round(item["race_remain"]);
                                                    //zum Testen
/*
                                                    iTime=NEVER;
                                                    tempZoneProductionData[1]++;
                                                    tempZoneProductionDataSlot[1]++;
*/
                                                } else {
                                                    if(item.ispvp==1){
                                                        iProd=null;
                                                        iTime=nowServer+Math.round(unsafeWindow.cowracing.data.pvp.racedayremain+60); // Math.round, because it's sometimes returned as string
                                                    } else {
                                                        iTime=NEVER;
                                                        tempZoneProductionData[1]++;
                                                        tempZoneProductionDataSlot[1]++;
                                                    }
                                                }
                                                tempZoneProductionData[2]++;
                                                tempZoneProductionDataSlot[2]++;

                                                if(!tempZoneProductionData[0][0][iProd]) {
                                                    tempZoneProductionData[0][0][iProd]=[];
                                                }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                    tempZoneProductionDataSlot[0][0][iProd]=[];
                                                }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                            }
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                        zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                        showGoToVetFarmi(); // Determine, if Discharge-Sick-Animals-Icon is shown
                                    }
                                break;}
                            case 9:{ // fishing food
                                /*
                                console.log("=== START LESE Fishing ===");
                                console.log(print_r(unsafeWindow.fishing, "", true, "\n"));
                                console.log("=== END LESE Fishing ===");
                                */
                                zones.setBonus(zoneNrF,0);
                                if((!currBlock)&&(unsafeWindow.fishing)){
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    if (!zones.getBuilding(zoneNrF)){
                                        zones.setBuilding(zoneNrF,"fl9");
                                    }
                                    //Fishing Production
                                    for(var slot=1;slot<=4;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        if(slot >= 3 && unsafeWindow.fishing.data.data.slots[slot]["block"]) { // slot blocked
                                            zones.setBlock(zoneNrS,"b");
                                        } else if(unsafeWindow.fishing.data.production[slot]){ // production running
                                            item=unsafeWindow.fishing.data.production[slot]["1"];
                                            iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                            if(isNaN(iProd)){ iProd=null; }
                                            if(iProd!=null) { // production in slot is ready (item["remain"] == 0) or busy (item["remain"] > 0)
                                                iTime=nowServer+Math.round(item["remain"]); // Math.round, because it's sometimes returned as string
                                            }else{
                                                iTime=NEVER;
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                            }
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                            if(iProd!=null){
                                                iAmount=prodYield[0][iProd];
                                                iPoints=iAmount*prodPoints[0][iProd];
                                                if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            }
                                        } else { // slot empty
                                            tempZoneProductionData[1]++;
                                            tempZoneProductionDataSlot[1]++;
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }

                                    //Block fishing
                                    /*
                                    for (slot=5;slot<=8;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        zones.setBlock(zoneNrS,"blpqs");
                                    }*/

                                    //fishing _ fisherman (slot 5 bis slot 8)
                                    for(var slot=1;slot<=4;slot++){
                                        zoneNrS=zoneNrF+"."+(slot+4);
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        if ((slot >= 1 && unsafeWindow.fishing.data.data.fishingslots[slot].block) ||
                                            (slot == 1 && !unsafeWindow.fishing.data.data.fishingslots[slot]) ){
                                            zones.setBlock(zoneNrS,"b");
                                        } else {
                                            item = unsafeWindow.fishing.data.data.fishingslots[slot];
                                            iAmount = 0;
                                            iPoints = 0;
                                            iProd=0;
                                            if(item.remain>0){
                                                iTime=nowServer+Math.round(item.remain); // Math.round, because it's sometimes returned as string
                                            } else {
                                                iTime=NEVER;
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                            }

                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;

                                            if(!tempZoneProductionData[0][0][iProd]) {
                                                tempZoneProductionData[0][0][iProd]=[];
                                            }
                                            tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            if(!tempZoneProductionDataSlot[0][0][iProd]) {
                                                tempZoneProductionDataSlot[0][0][iProd]=[];
                                            }
                                            tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }

                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                    showGoToVetFarmi(); // Determine, if Discharge-Sick-Animals-Icon is shown
                                }

                            break;}

                            case 11:{ // scouts
/*
                                console.log("=== START LESE Scouts ===");
                                console.log(print_r(unsafeWindow.farmersmarket_data.scouts, "", true, "\n"));
                                console.log("=== END LESE Scouts ===");
*/
                                zones.setBonus(zoneNrF,0);
                                if((!currBlock)&&(unsafeWindow.scouts)){
                                    tempZoneProductionData=[[{},{}],0,0,true];
                                    if (!zones.getBuilding(zoneNrF)){
                                        zones.setBuilding(zoneNrF,"fl11");
                                    }
                                    //Scouts Production
                                    for(var slot=1;slot<=4;slot++){
                                        zoneNrS=zoneNrF+"."+slot;
                                        zones.setBlock(zoneNrS,"");
                                        tempZoneProductionDataSlot=[[{},{}],0,0,true];
                                        if(slot >= 2 && unsafeWindow.scouts.data.data.slots[slot]["block"]) { // slot blocked
                                            zones.setBlock(zoneNrS,"b");
                                        } else if(unsafeWindow.scouts.data.production[slot]){ // production running
                                            item=unsafeWindow.scouts.data.production[slot]["1"];
                                            iProd=(item["pid"]?parseInt(item["pid"],10):null);
                                            if(isNaN(iProd)){ iProd=null; }
                                            if(iProd!=null) { // production in slot is ready (item["remain"] == 0) or busy (item["remain"] > 0)
                                                if (item["remain"] == 0) {
                                                    iTime=Math.round(item["startdate"])+Math.round(item["duration"])
                                                } else {
                                                    iTime=nowServer+Math.round(item["remain"]); // Math.round, because it's sometimes returned as string
                                                }
                                            }else{
                                                iTime=NEVER;
                                                tempZoneProductionData[1]++;
                                                tempZoneProductionDataSlot[1]++;
                                            }
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                            if(iProd!=null){
                                                iAmount=prodYield[0][iProd];
                                                iPoints=iAmount*prodPoints[0][iProd];
                                                if(!tempZoneProductionData[0][0][iProd]){ tempZoneProductionData[0][0][iProd]=[]; }
                                                tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                                if(!tempZoneProductionDataSlot[0][0][iProd]){ tempZoneProductionDataSlot[0][0][iProd]=[]; }
                                                tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                            }
                                        } else { // slot empty
                                            tempZoneProductionData[1]++;
                                            tempZoneProductionDataSlot[1]++;
                                            tempZoneProductionData[2]++;
                                            tempZoneProductionDataSlot[2]++;
                                        }
                                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                                    }
                                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                                    showGoToVetFarmi(); // Determine, if Discharge-Sick-Animals-Icon is shown
                                }

                            break;}

                            default: currBlock="blpqs"; // Block farm
                            }
                            zones.setBlock(zoneNrF,currBlock);
                        }
                    }
                }
            }
            handleQuestDataVeterinary();
            handleQuestDataBreed();
            handleQuestDataButterfly();
            handleQuestDataCowRacing();

            /*for (var t in unsafeWindow.fishing.data.config.products){
                var string='"'+t+'":';
                for (var u in unsafeWindow.fishing.data.config.products[t].needs.products){
                    string = string+'[[0,'+u+','+unsafeWindow.fishing.data.config.products[t].needs.products[u]+'],'
                }
                string=string+']';
                console.log(string);
            }*/
            handleQuestDataFishing();
            handleQuestDataScouts();

            calcTotalZones();
        } catch (err) { GM_logError("doFarmersMarketData", "", "err_trace=" + err_trace, err); }
    };

    unsafeOverwriteFunction("farmersMarketHandler", function(response) {
        try {
            unsafeWindow._farmersMarketHandler(response);
        } catch (err) { GM_logError("_farmersMarketHandler", "", "", err); }
        try {
            doFarmersMarketData();

            // This snippet is executed (at least) at start up and when a farmersmarket farmi is handled
            totalFarmis[3] = {}; // Reset foodworld farmi requests before re-reading them
            for (var i in unsafeWindow.farmersmarket_data.farmis) {
                if (!unsafeWindow.farmersmarket_data.farmis.hasOwnProperty(i)) { continue; }
                var farmi = unsafeWindow.farmersmarket_data.farmis[i];
                for (var j = 0; j < farmi.cart.length; j++) {
                    var pId = farmi.cart[j].pid;
                    if (!totalFarmis[3][pId]) { totalFarmis[3][pId] = 0; }
                    totalFarmis[3][pId] += farmi.cart[j].amount;
                }
            }

            if ((USERLEVEL >= 31) && (unsafeWindow.pets) && (unsafeWindow.pets.data.daily == 1)) {
                showGoToBuyPetsParts();
            }
        } catch (err) { GM_logError("farmersMarketHandler", "", "", err); }
    });


    function doFarmersMarket() {
        try {
            var div, div1, divZone;
            var zoneNrF;
            for (var w = 1; w <= 11; w++) {
                zoneNrF = "farmersmarket-" + w;
                divZone = $("farmersmarket_pos" + w);
                if (!divZone.classList.contains("listenerMouseOver")) {
                    divZone.classList.add("listenerMouseOver");
                    divZone.addEventListener("mouseout", function() {
                        hideBlase();
                        hideLagerZeitZiel();
                    }, false);
                    divZone.addEventListener("mouseover", function() {
                        var help = /^farmersmarket_pos(\d+)$/.exec(this.id);
                        help = "farmersmarket-" + help[1];
                        showBlase(help);
                        showLagerZeitZiel(help);
                    }, true);
                }
                if (div = $("farmersmarket_pos" + w + "_progress")) {
                    if (!div.classList.contains("listenerMouseOver")) {
                        div.classList.add("listenerMouseOver");
                        div.addEventListener("mouseover", function(event) {
                            var help = /^farmersmarket_pos(\d+)_progress$/.exec(this.id);
                            help = "farmersmarket-" + help[1];
                            toolTip.show(event, toolTipZoneProduction(help));
                        }, false);
                    }
                }
                switch (w) {
                    case 1: // Flower meadow
                        // Production
                        if (!(div = $("farmersmarket_pos" + w + "_running"))) {
                            if (div1 = $("farmersmarket_pos" + w + "_progress")) {
                                div1.style.display = "block";
                                div = createElement("div", { "id": "farmersmarket_pos" + w + "_running", "style": "position:absolute;right:0px;top:10px;" }, div1);
                            }
                        }
                        if (div) {
                            div.setAttribute("class", "v" + zones.getMainproduct(zoneNrF));
                        }
                        break;
                }

            }
            div = null;
        } catch (err) { GM_logError("doFarmersMarket", "", "", err); }
    }

    if($("farmersmarket_pos1")){ doFarmersMarket(); }
    unsafeOverwriteFunction("setFarmersMarket",function(){
        try{
            unsafeWindow._setFarmersMarket();
        }catch(err){GM_logError("_setFarmersMarket","","",err);}
        try{
            doFarmersMarket();
        }catch(err){GM_logError("setFarmersMarket","","",err);}
    });
    unsafeOverwriteFunction("initFlowerArea",function(){
        try{
            unsafeWindow._initFlowerArea();
        }catch(err){GM_logError("_initFlowerArea","","",err);}
        try{
            showLagerZeitZiel("farmersmarket-1");
            raiseEvent("gameFarmersmarketOpened1");
        }catch(err){GM_logError("initFlowerArea","","",err);}
    });
    unsafeOverwriteFunction("closeFlowerArea",function(){
        try{
            unsafeWindow._closeFlowerArea();
        }catch(err){GM_logError("_closeFlowerArea","","",err);}
        try{
            hideLagerZeitZiel("farmersmarket-1");
        }catch(err){GM_logError("closeFlowerArea","","",err);}
    });
    unsafeOverwriteFunction("initNursery",function(){
        try{
            unsafeWindow._initNursery();
        }catch(err){GM_logError("_initNursery","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened2");
        }catch(err){GM_logError("initNursery","","",err);}
    });
    unsafeOverwriteFunction("dialogNursery",function(mode,c,t,h){
        try{
            unsafeWindow._dialogNursery(mode,c,t,h);
        }catch(err){GM_logError("_dialogNursery","","",err);}
        try{
            switch(mode){
            case "production": raiseEvent("gameFarmersmarketSlotOpened");
            case "production_commit": raiseEvent("gameFarmersmarketDialogCommit");
            }
        }catch(err){GM_logError("dialogNursery","","",err);}
    });
    unsafeOverwriteFunction("dialogFlowerArea",function(mode,l){
        try{
            unsafeWindow._dialogFlowerArea(mode,l);
        }catch(err){GM_logError("_dialogFlowerArea","","",err);}
        try{
            switch(mode){
            case "autoplant": raiseEvent("gameFarmersmarketDialogStart");
            }
        }catch(err){GM_logError("dialogFlowerArea","","",err);}
    });
    /**********************************************************
    * Monsterfruchtzucht / monster fruit culture
    **********************************************************/
    unsafeOverwriteFunction("initMegaFruit",function(a){
        try{
             unsafeWindow._initMegaFruit(a);
        }catch(err){GM_logError("initMegaFruit","","",err);}
        try{
            doFarmersMarketData();
            raiseEvent("gameFarmersmarketOpened3");
        }catch(err){GM_logError("initMegaFruit","","",err);}

    });

    unsafeOverwriteFunction("showNeedsMegaFruit",function(d){
        try{
             unsafeWindow._showNeedsMegaFruit(d);
        }catch(err){GM_logError("showNeedsMegaFruit","","",err);}
        try{
            raiseEvent("gameShowNeedsMegaFruit");
        }catch(err){GM_logError("showNeedsMegaFruit","","",err);}

    });
    //dialogMegaFruit('need', 1)
    unsafeOverwriteFunction("dialogMegaFruit",function(r,v){
        try{
             unsafeWindow._dialogMegaFruit(r,v);
        }catch(err){GM_logError("dialogMegaFruit","","",err);}
        try{
            console.log("-------dialogMegaFruit---------");
            console.log(r);
            console.log("-------dialogMegaFruit--------");
            switch (r) {
                case 'need':
                        raiseEvent("gameNeedMegaFruit");
                    break;
                default:
            }
        }catch(err){GM_logError("dialogMegaFruit","","",err);}
    });

    /**********************************************************
    * Bergstation / hillwalk
    **********************************************************/
    unsafeOverwriteObjFunction("hillwalk","build",function(){
        try{
             unsafeWindow.hillwalk._build();
        }catch(err){GM_logError("hillwalk.openHillwalks","","",err);}
        try{
            for (var d in unsafeWindow.farms_data.farms[unsafeWindow.farm]) {
                if(!unsafeWindow.farms_data.farms[unsafeWindow.farm].hasOwnProperty(d)){ continue; }
                if (unsafeWindow.farms_data.farms[unsafeWindow.farm][d]["buildingid"]==22) {
                    var zoneNr=parseInt(d,10);
                    var zoneNrF=zoneNr+6*(unsafeWindow.farm-1);
                    var tempZoneProductionData=[[{}],0,0,true];

                    zones.setBlock(zoneNrF,"b");
                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                    tempZoneProductionData=null;
                }
            }
            //raiseEvent("gameOpenHillwalks");
        }catch(err){GM_logError("hillwalk.openHillwalks","","",err);}

    });

    /**********************************************************
    * Tierzucht / Animal breeding 13102016
    **********************************************************/
    //Open Farmersmarket Pos4

/*
    unsafeOverwriteObjFunction("pets","response",function(b,a,c){
        try{
            alert("resp");
             unsafeWindow.pets._response(b,a,c);
        }catch(err){GM_logError("pets.response","","",err);}
        try{

            switch (a) {
                case 'pets_harvest_production':
                    raiseEvent("gameFarmersmarketCropped");
                    break;
                case 'pets_start_production':
                    //alert("start");
                    raiseEvent("gameFarmersmarketStarted");
                    break
            }

        }catch(err){GM_logError("pets.response","","",err);}

    });*/

    unsafeOverwriteObjFunction("pets","buildProductionSlots",function(){
        try{
             unsafeWindow.pets._buildProductionSlots();
        }catch(err){GM_logError("pets.buildProductionSlots","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened4");
        }catch(err){GM_logError("buildProductionSlotsResponse","","",err);}

    });

    unsafeOverwriteObjFunction("pets","harvestProduction",function(b,a){
        try{
            unsafeWindow.pets._harvestProduction(b,a);
        }catch(err){GM_logError("pets.harvestProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketCropped");
        }catch(err){GM_logError("harvestProductionResponse","","",err);}

    });

    unsafeOverwriteObjFunction("pets","productionSelection",function(r){
        try{
            unsafeWindow.pets._productionSelection(r);
        }catch(err){GM_logError("pets.productionSelection","","",err);}
        try{
            raiseEvent("gameFarmersmarketSlotOpened");
        }catch(err){GM_logError("productionSelectionResponse","","",err);}
    });

    unsafeOverwriteObjFunction("pets","productionSelectionNavi",function(b,c){
        try{
            unsafeWindow.pets._productionSelectionNavi(b,c);
        }catch(err){GM_logError("pets.productionSelectionNavi","","",err);}
        try{
            raiseEvent("gameProductionSelectionNavi");
        }catch(err){GM_logError("productionSelectionNaviResponse","","",err);}
    });

    unsafeOverwriteObjFunction("pets","productionSelectionCommit",function(b){
        try{
            unsafeWindow.pets._productionSelectionCommit(b);
        }catch(err){GM_logError("pets.productionSelectionCommit","","",err);}
        try{
            raiseEvent("gameProductionSelectionCommit");
        }catch(err){GM_logError("productionSelectionCommitResponse","","",err);}
    });

   unsafeOverwriteObjFunction("pets","startProduction",function(a){
        try{
            unsafeWindow.pets._startProduction(a);
        }catch(err){GM_logError("pets.startProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketStarted");
        }catch(err){GM_logError("startProductionCommitResponse","","",err);}
    });

    var autoPartsRedeem=false;
    unsafeOverwriteObjFunction("pets","parts",function(){
        try{
            unsafeWindow.pets._parts();
        }catch(err){GM_logError("pets.parts","","",err);}
        try{
            if(unsafeWindow.pets.data.packs.length===undefined){
                if(unsafeWindow.pets&&unsafeWindow.pets.data.packs){
                    var container = $("pets_parts");
                    var newNode = createElement("div",{"id":"divGame","class":"","style":"position:absolute;top:-50px;height:25px;width:100%;background-color:#c3a75e"});
                    var newtable=createElement("table",{"border":"0","class":"","style":"width:75%"},newNode);

                    var newtr=createElement("tr",{},newtable);
                    createElement("td",{},newtr,"Tierteile-Pakete einlösen:");
                    var newtd = createElement("td",{},newtr);
                    var button=createElement("button", {"class":"link","style":""}, newtd, (!autoPartsRedeem)?"Start":"Stop");

                    button.addEventListener("click",function(){
                        if (!autoPartsRedeem) {
                            autoPartsRedeem = true;
                            this.innerText="Stop";
                            unsafeWindow.pets.openPack(Object.keys(unsafeWindow.pets.data.packs)[0]);
                        } else {
                            this.innerText="Start";
                            autoPartsRedeem = false;
                        }

                    },false);
                    window.setTimeout(function(){
                        if (autoPartsRedeem) {
                            if(unsafeWindow.pets.data.packs.length===undefined){
                                unsafeWindow.pets.openPack(Object.keys(unsafeWindow.pets.data.packs)[0]);
                            } else {
                                autoPartsRedeem = false;
                            }
                        }
                    },1000);

                    button=null;
                    container.insertBefore(newNode, container.firstChild.nextSibling);
                    container=null;button=null;help=null;
                }
            }
            raiseEvent("gamegoToOpenPetsParts");
        }catch(err){GM_logError("gamegoToOpenPetsPartsResponse","","",err);}
    });

    unsafeOverwriteObjFunction("pets","partsBuy",function(){
        try{
            unsafeWindow.pets._partsBuy();
        }catch(err){GM_logError("pets.partsBuy","","",err);}
        try{
            raiseEvent("gamegoToBuyPetsParts");
        }catch(err){GM_logError("gamegoToBuyPetsPartsResponse","","",err);}
    });

    unsafeOverwriteObjFunction("pets","partsBuyCommit",function(c,d){
        try{
            unsafeWindow.pets._partsBuyCommit(c,d);
        }catch(err){GM_logError("pets.partsBuyCommit","","",err);}
        try{
            raiseEvent("gamepartsBuyCommit");
        }catch(err){GM_logError("gamepartsBuyCommitResponse","","",err);}
    });

    unsafeOverwriteObjFunction("pets","partsBuyFire",function(b,a){
        try{
            unsafeWindow.pets._partsBuyFire(b,a);
        }catch(err){GM_logError("pets.partsBuyFire","","",err);}
        try{
            hideGoToBuyPetsParts();
            raiseEvent("gamepartsBuyFire");
        }catch(err){GM_logError("gamepartsBuyFireResponse","","",err);}
    })
    // Slot Futter, Spielzeug, Kuscheltier  öffnen
    unsafeOverwriteObjFunction("pets","needSlot",function(l){
        try{
             unsafeWindow.pets._needSlot(l);
        }catch(err){GM_logError("pets.needSlot","","",err);}
        try{
            raiseEvent("gameAnimalBreedingOpenSlot");
        }catch(err){GM_logError("needSlotResponse","","",err);}

    });
    // Auswahl für Futter, Spielzeug, Kuscheltier  öffnen
    unsafeOverwriteObjFunction("pets","needSelection",function(a){
        try{
             unsafeWindow.pets._needSelection(a);
        }catch(err){GM_logError("pets.needSelection","","",err);}
        try{
            raiseEvent("gameAnimalBreedingNeedSelection");
        }catch(err){GM_logError("needSelectionResponse","","",err);}

    });
    // Futter, Spielzeug, Kuscheltier für Slot auswählen
    unsafeOverwriteObjFunction("pets","needSelectionSet",function(r){
        try{
             unsafeWindow.pets._needSelectionSet(r);
        }catch(err){GM_logError("pets.needSelectionSet","","",err);}
        try{
            raiseEvent("gameAnimalBreedingneedSelectionSet");
        }catch(err){GM_logError("needSelectionSetResponse","","",err);}

    });

    //Nächstes Auswahlfenster
    unsafeOverwriteObjFunction("pets","needSelectionNavi",function(b,c){
        try{
            unsafeWindow.pets._needSelectionNavi(b,c);
        }catch(err){GM_logError("pets.needSelectionNavi","","",err);}
        try{
            raiseEvent("gameNeedSelectionNavi");
        }catch(err){GM_logError("needSelectionNaviResponse","","",err);}
    });

    // Slot Futter, Spielzeug, Kuscheltier starten
    unsafeOverwriteObjFunction("pets","care",function(){
        try{
             unsafeWindow.pets._care();
        }catch(err){GM_logError("pets.care","","",err);}
        try{
            raiseEvent("gameAnimalBreedCare");
            doFarmersMarketData();
        }catch(err){GM_logError("careResponse","","",err);}

    });
    //Tieraufzucht beenden
    unsafeOverwriteObjFunction("pets","finish",function(){
        try{
             unsafeWindow.pets._finish();
        }catch(err){GM_logError("pets.finish","","",err);}
        try{
            hideGoToAnimalBreedingReady();
        }catch(err){GM_logError("careResponse","","",err);}

    });

    //zu den Aufzuchtslots wechsel (Hinweisfenster Tierpfleger entfernen)
    unsafeOverwriteObjFunction("pets","move",function(){
        try{
            if (!unsafeWindow.pets.data.data.pharmacist_remember_box)
                unsafeWindow.pets.data.data.pharmacist_remember_box = 1;
            unsafeWindow.pets._move();
        }catch(err){GM_logError("pets.move","","",err);}
        try{
        }catch(err){GM_logError("_pets.move","","",err);}

    });

    unsafeOverwriteObjFunction("pets","openPack",function(a){
        try{
            unsafeWindow.pets._openPack(a);
        }catch(err){GM_logError("pets.openPack","","",err);}
        try{
            if (autoPartsRedeem) {
                window.setTimeout(function(){
                    unsafeWindow.pets.parts();
                    unsafeWindow.pets.surpriseFly();
                },1000);
            }
        }catch(err){GM_logError("pets.openPack","","",err);}
    });
    //*************************************************************************

    unsafeOverwriteFunction("initVet",function(){
        try{
            unsafeWindow._initVet();
        }catch(err){GM_logError("_initVet","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened5");

            valVetAutostart = GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetAutostart", 0);

            var div = $("farmersmarket_pos5_inner"); // Vet-Dialog

            // Outer frame for autostart functionality
            var frame=createElement("div", {
                "style":"position:absolute;top:47px;left:25%;padding-left: 4px;background: url('http://mff.wavecdn.de/mff/megafruit_time_bar.png') 100% 20px / 200%;border: 1px solid black;border-radius: 5px;"
            },div,getText("veterinaryRoleAutostart")+": ");

            // Create combobox
            var selectAutostart = createElement("select", {
                "id": "vetAutostartSelect",
                "size":"1",
                "name": "vetAutostart"
            }, frame, false);

            createElement("option", {"value":0}, selectAutostart, getText("no")); // Add 'no' element to combobox
            for (var P in unsafeWindow.vet_data.role) {
                createElement("option", {"value":P}, selectAutostart, unsafeWindow.t_vet_role_name[P]); // Add role to combobox
            }

            selectAutostart.addEventListener("change", function(e) {
                valVetAutostart = e.target.selectedIndex;
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetAutostart", valVetAutostart);
            });
            selectAutostart.value = valVetAutostart; // Init combobox on startup

        }catch(err){GM_logError("initVet","","",err);}
    });
    unsafeOverwriteFunction("vetDialog",function(mode,c,t,h){
        try{
            unsafeWindow._vetDialog(mode,c,t,h);
        }catch(err){GM_logError("_vetDialog","","",err);}
        try{
            switch(mode){
            case "production_select": raiseEvent("gameFarmersmarketSlotOpened");break;
            case "production_select_confirm": raiseEvent("gameFarmersmarketDialogCommit");break;
            case "quests": { //grünen Balken (Anzeige des Lagerbestands) im Tierarzt-Questfenster
                try {
                    var cand=$("vet_questentry_info").getElementsByClassName("questboxbarout");
                    for(var i=0;i<cand.length;i++){
                        var questWare = parseInt(cand[i].parentNode.children[1].className.replace("kp",""),10);
                        var menge = [0,0,0]; //given,stock,total
                        for (var v in questData["veterinary"]["1"]["data"][0]) {
                            if (!questData["veterinary"]["1"]["data"][0].hasOwnProperty(v)){ continue; }
                            if (questData["veterinary"]["1"]["data"][0][v][1]==questWare) {
                                menge[2]=questData["veterinary"]["1"]["data"][0][v][2];
                            }
                        }
                        menge[0]=((questData["veterinary"]["1"]["given"][0]&&questData["veterinary"]["1"]["given"][0][questWare])?parseInt(questData["veterinary"]["1"]["given"][0][questWare],10):0);
                        menge[1]=Math.min(menge[2]-menge[0],prodStock[0][questWare]);
                        createElement("div",{"style":"width:"+Math.floor(200*menge[1]/menge[2])+"px;left:"+Math.floor(200*(menge[0])/menge[2])+"px;","class":"questboxbarinPoss"},cand[i]);
                    }
                } catch(err){ GM_logError("showQuestBox","","",err); }
                break;
                }
            case "role_reward": {
                var btn = $("globalbox_button1");
                if (btn && valVetAutostart) {
                    click(btn); // Close reward box
                }
                break;
                }
            case "selectrole": {
                if (valVetAutostart) {
                    unsafeWindow.vetSetRole(valVetAutostart); // Start next role
                }
                break;
                }
            }
        }catch(err){GM_logError("vetDialog","","",err);}
    });

    valVetAutoSet= GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetAutoSet", true);
    unsafeOverwriteFunction("setVetAnimalQueueSelect",function(a){
        try{
            unsafeWindow._setVetAnimalQueueSelect(a);
        }catch(err){GM_logError("_setVetAnimalQueueSelect","","",err);}
        try{
            // Get first free slot (bench)
            var div=$("vet_animal_slots").querySelector(".vet_animal_slot_hover");
            if(valVetAutoSet && div!=null) { // Check, if auto set is enabled in options
                click(div); // CLick slot
            }
        }catch(err){GM_logError("setVetAnimalQueueSelect","","",err);}
    });

    valVetNoCoinDrugs= GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVetNoCoinDrugs", true);
    unsafeOverwriteFunction("showVetMedicalRecord",function(h){
        // showVetMedicalRecord is also called in vetDiseaseSetDrug
        // We need to know, if the frame is already visible (and thus only redrawn) to prevent an infinite loop
        var vetAnimalRecord=$("vet_animal_record");
        var freshlyOpened=vetAnimalRecord.style.display!="block";

        try{
            unsafeWindow._showVetMedicalRecord(h);
        }catch(err){GM_logError("_showVetMedicalRecord","","",err);}
        try{
            if(freshlyOpened) { // Only initiate setting drugs, when called for the first time
                var vet_data=unsafeWindow.vet_data;
                var n = vet_data.animals.slots[h]; // {id:38226, remain: NaN}
                var e = vet_data.animals.queue[n.id]; // {id, diseases:[{id, phase},...]}
                for (var c = 0; c < e.diseases.length; c++) {
                    var b = e.diseases[c].id; // b = diseaseId
                    for (var l in vet_data.drugs) { // l = drugId
                        // If flag is set, ignore coin drugs
                        if(valVetNoCoinDrugs && vet_data.drugs[l].coins) {
                            continue;
                        }

                        // Is drug l curing disease b AND is our vet level high enough for drug l?
                        if(unsafeWindow.in_array(b, vet_data.drugs[l].diseases) && vet_data.drugs[l].level <= vet_data.info.level) {
                            // Enough of that drug in stock?
                            if (prodStock[0][l]>=e.diseases[c].phase){
                                unsafeWindow.vetDiseaseSetDrug(h, b, l);
                                raiseEvent("gameShowVetMedicalRecord");
                                break;
                            }
                        }
                    }
                }
            }
        }catch(err){GM_logError("showVetMedicalRecord","","",err);}
    });

    unsafeOverwriteFunction("updateVetAnimalQueue",function(){
        try{
            unsafeWindow._updateVetAnimalQueue();
        }catch(err){GM_logError("_updateVetAnimalQueue","","",err);}
        try{
            var vet_data=unsafeWindow.vet_data;
            for (var b in vet_data.animals.queue) { // b=AnimalId
                var r = vet_data.animals.queue[b]; // r=Animal-Object
                var div=$("vet_animal_queue_item_tt"+b);
                if(div) { // Is div one the four queuing animals
                    var times=[];
                    for (var j = 0; j < r.diseases.length; j++) {
                        var d=r.diseases[j]; // d=Disease-Object {id:int, phase:int}
                        var disDiv=div.childNodes[j]; // Disease-div
                        disDiv.setAttribute("style","margin-bottom:2px; width:212px;");
                        disDiv.firstElementChild.setAttribute("style","float: left; margin-right: 5px; margin-top: 6px;");

                        var oldChild = disDiv.removeChild(disDiv.lastChild); // Remove clear-div, we'll append that later
                        var newDiv=createElement("div",{"style":"float:left; width:212px;"},disDiv);
                        for (var l in vet_data.drugs) { // l = drugId
                            // If flag is set, ignore coin drugs
                            if(valVetNoCoinDrugs && vet_data.drugs[l].coins) {
                                continue;
                            }

                            // Check, if drug l cures disease d AND if level is high enough
                            if(unsafeWindow.in_array(d.id, vet_data.drugs[l].diseases) && vet_data.drugs[l].level <= vet_data.info.level) {
                                var drugDiv=createElement("div",{"style":"margin-top:3px;"},newDiv);
                                produktPic(0,l,drugDiv);
                                var time=vet_data.drugs[l]["times"][d.id];
                                // Push time of first matching drug into array
                                if(j==times.length && prodStock[0][l]>=d.phase) {
                                    times.push(time);
                                }
                                // Withdraw time bonus
                                if (vet_data.quest && vet_data.quest.bonus_all && vet_data.quest.bonus_all.treatment_reduce) {
                                    time=Math.ceil(time-((time/100)*vet_data.quest.bonus_all.treatment_reduce));
                                }
                                var style=prodStock[0][l]<d.phase?"text-decoration:line-through;":""; // Strike-through drugs that are out of stock
                                createElement("span",{"style":style},drugDiv,prodName[0][l]+" ("+getTimeStr(time,true)+"h)");
                            }
                        }
                        disDiv.appendChild(oldChild); // Reappend clear-div
                    }

                    var resDiv=div.querySelector(".vet_animal_queue_item_tt_reward");
                    var oldChild = resDiv.removeChild(resDiv.lastChild);
                    var sum = times.reduce(function(pv, cv) { return pv + cv; }, 0); // Sum up times
                    if (vet_data.quest && vet_data.quest.bonus_all && vet_data.quest.bonus_all.treatment_reduce) {
                        sum=Math.ceil(sum-((sum/100)*vet_data.quest.bonus_all.treatment_reduce));
                    }
                    createElement("div",{"style":"float:right;font-weight:bold;"},resDiv,"&Sigma; "+getTimeStr(sum,true)+"h");
                    resDiv.appendChild(oldChild);
                }
            }
        }catch(err){GM_logError("updateVetAnimalQueue","","",err);}
    });

    //Apotheker entfernen / remove pharmacist
    unsafeOverwriteFunction("moveVet",function(){
        try{
            if (!unsafeWindow.vet_data.info.vet_pharmacist_remember_box)
                unsafeWindow.vet_data.info.vet_pharmacist_remember_box = 1;
            unsafeWindow._moveVet();
        }catch(err){GM_logError("_moveVet","","",err);}
        try{

        }catch(err){GM_logError("_moveVet","","",err);}
    });

    /**********************************************************
    * Wettessen / Speed eating
    **********************************************************/
    //Open Farmersmarket Pos6
    unsafeOverwriteFunction("initFoodcontest",function(a){
        try{
             unsafeWindow._initFoodcontest(a);
        }catch(err){GM_logError("initFoodcontest","","",err);}
        try{
            doFarmersMarketData();
            raiseEvent("gameFarmersmarketOpened6");
        }catch(err){GM_logError("initFoodcontest","","",err);}

    });

    /**********************************************************
    * Butterfly
    **********************************************************/
    //Open Farmersmarket Pos7
    unsafeOverwriteObjFunction("butterfly","init",function(){
        try{
             doFarmersMarketData();
             unsafeWindow.butterfly._init();
        }catch(err){GM_logError("butterfly.init","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened7");
        }catch(err){GM_logError("butterfly.init","","",err);}

    });
    unsafeOverwriteObjFunction("butterfly","careBreedCommit",function(n){
        try{
             unsafeWindow.butterfly._careBreedCommit(n);
        }catch(err){GM_logError("butterfly.careBreedCommit","","",err);}
        try{
            raiseEvent("gameButterflycareBreedCommit");
        }catch(err){GM_logError("butterfly.careBreedCommit","","",err);}

    });

    unsafeOverwriteObjFunction("butterfly","careBreed",function(a){
        try{
             unsafeWindow.butterfly._careBreed(a);
        }catch(err){GM_logError("butterfly.careBreed","","",err);}
        try{
            raiseEvent("gameButterflyCare");
            doFarmersMarketData();
        }catch(err){GM_logError("butterfly.careBreed","","",err);}

    });

    unsafeOverwriteObjFunction("butterfly","slotHover",function(c,b,a){
        try{
             unsafeWindow.butterfly._slotHover(c,b,a);
        }catch(err){GM_logError("butterfly.slotHover","","",err);}
        try{
            //c = slot;
            var item = unsafeWindow.butterfly;
            if(b==1 && !a && item.data.data.breed[c]) {
                var decay=1;
                var feedcount=parseInt(item.data.data.breed[c].count) - parseInt(item.data.config.butterflies[item.data.data.breed[c].butterfly].care_count1);
                if(feedcount>0){
                    var m=((feedcount*100)/item.data.config.butterflies[item.data.data.breed[c].butterfly].care_count2);
                    m=Math.max(0,(100-m));
                    for(var s in item.data.config.decay) {
                        if(parseInt(m)>=parseInt(s)) {
                            decay=item.data.config.decay[s]
                        }
                    }
                    var div = $("butterfly_slot"+c+"_tt");
                    var bonus = 1;
                    if (item.data.data.breed[c].deco){
                        if (item.data.config.butterflies[item.data.data.breed[c].butterfly].rarity == item.data.config.deco[item.data.data.breed[c].deco].bonus.rarity) {
                            bonus = item.data.config.deco[item.data.data.breed[c].deco].bonus.multi_blossoms;
                        } else {
                            bonus = item.data.config.deco[item.data.data.breed[c].deco].multi_blossoms;
                        }
                    }
                    var blossoms = Math.ceil((item.data.config.butterflies[item.data.data.breed[c].butterfly].reward.blossoms)*decay);
                    blossoms = Math.ceil(blossoms*bonus);
                    var blossomsForH = blossoms / (item.data.data.breed[c].duration /3600)

                    /*var blossomsForAll = 0;
                    for (var i = parseInt(item.data.config.butterflies[item.data.data.breed[c].butterfly].care_count1);i<parseInt(item.data.data.breed[c].count);i++){
                        blossomsForAll += item.data.data.breed[c].care.entries[i].reward.blossoms;
                    }*/
                    var blossomsForAll = 0;
                    for (var i = parseInt(item.data.config.butterflies[item.data.data.breed[c].butterfly].care_count1);i< Math.min(parseInt(item.data.data.breed[c].count),item.data.data.breed[c].care.entries.length);i++){
                        blossomsForAll += item.data.data.breed[c].care.entries[i].reward.blossoms;
                    }
                    var blossomsForAllH=blossomsForAll/((item.data.data.breed[c].breedend-item.data.data.breed[c].createdate)/3600);

                    if (!$("divButterfly"+c)) {
                        newdiv=createElement("div",{"id":"divButterfly"+c,"style":"color:red;font-weight:bold;"},div,blossomsForH.toFixed(2) + " " + getText("blossomsForHour") + ", " + item.data.data.breed[c].duration /3600 + getText("shortHours"));

                        createElement("div",{"style":"color:red;font-weight:bold;"},div,blossomsForAllH.toFixed(2) + " " + getText("blossomsForHour") + ", " + getFormattedDateStr(item.data.data.breed[c].createdate)+ ", "+ getDaytimeStr(item.data.data.breed[c].createdate));
                    }
                }
            }
        }catch(err){GM_logError("butterfly.slotHover","","",err);}
    });

    /**********************************************************
    * Kuh Rennen / cowracing
    **********************************************************/
    unsafeOverwriteObjFunction("cowracing","build",function(){
        try{
             doFarmersMarketData();
             unsafeWindow.cowracing._build();
        }catch(err){GM_logError("cowracing.build","","",err);}
        try{
        }catch(err){GM_logError("cowracing.build","","",err);}

    });
    //Open Farmersmarket Pos8
    unsafeOverwriteObjFunction("cowracing","buildProductionSlots",function(){
        try{
             unsafeWindow.cowracing._buildProductionSlots();
        }catch(err){GM_logError("cowracing.buildProductionSlots","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened8");
        }catch(err){GM_logError("buildProductionSlotsResponse","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","harvestProduction",function(b,a){
        try{
            unsafeWindow.cowracing._harvestProduction(b,a);
        }catch(err){GM_logError("cowracing.harvestProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketCropped");
        }catch(err){GM_logError("harvestProductionResponse","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","productionSelection",function(r){
        try{
            unsafeWindow.cowracing._productionSelection(r);
        }catch(err){GM_logError("cowracing.productionSelection","","",err);}
        try{
            raiseEvent("gameFarmersmarketSlotOpened");
        }catch(err){GM_logError("productionSelectionResponse","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","productionSelectionCommit",function(b){
        try{
            unsafeWindow.cowracing._productionSelectionCommit(b);
        }catch(err){GM_logError("cowracing.productionSelectionCommit","","",err);}
        try{
            raiseEvent("gameProductionSelectionCommit");
        }catch(err){GM_logError("productionSelectionCommitResponse","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","productionSelectionNavi",function(b,c){
        try{
            unsafeWindow.cowracing._productionSelectionNavi(b,c);
        }catch(err){GM_logError("cowracing.productionSelectionNavi","","",err);}
        try{
            raiseEvent("gameProductionSelectionNavi");
        }catch(err){GM_logError("productionSelectionNaviResponse","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","startProduction",function(a){
        try{
            unsafeWindow.cowracing._startProduction(a);
        }catch(err){GM_logError("cowracing.startProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketStarted");
        }catch(err){GM_logError("startProductionCommitResponse","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","setCowSlot",function(a){
        try{
            unsafeWindow.cowracing._setCowSlot(a);
        }catch(err){GM_logError("cowracing.setCowSlot","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened8");
            raiseEvent("gameCowRacingOpenCow");
        }catch(err){GM_logError("gameCowRacingOpenCow","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","feedSelection",function(){
        try{
            unsafeWindow.cowracing._feedSelection();
        }catch(err){GM_logError("cowracing.feedSelection","","",err);}
        try{
            raiseEvent("gameCowRacingOpenFeedSeceltion");
        }catch(err){GM_logError("gameCowRacingOpenFeedSeceltion","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","feedSelectionNavi",function(b,c){
        try{
            unsafeWindow.cowracing._feedSelectionNavi(b,c);
        }catch(err){GM_logError("cowracing.feedSelectionNavi","","",err);}
        try{
            raiseEvent("gameCowRacingfeedSelectionNavi");
        }catch(err){GM_logError("gameCowRacingfeedSelectionNavi","","",err);}
    });

    // Kuh füttern
    unsafeOverwriteObjFunction("cowracing","feedCow",function(r){
        try{
             unsafeWindow.cowracing._feedCow(r);
        }catch(err){GM_logError("cowracing.feedCow","","",err);}
        try{
            raiseEvent("gameCowRacingFeedCow");
        }catch(err){GM_logError("gameCowRacingFeedCow","","",err);}

    });

    //Nächstes Auswahlfenster
    unsafeOverwriteObjFunction("cowracing","itemShop",function(d){
        try{
            unsafeWindow.cowracing._itemShop(d);
        }catch(err){GM_logError("cowracing.itemShop","","",err);}
        try{
            var div = $('cowracing_itemshop').children[0].querySelectorAll(".link");
            if(div.length>0){
                for(var i=0;i<div.length;i++){
                    var number = div[i].querySelector(".item").className.match(/[0-9]+/)[0];
                    var divAppend =  $('cowracing_itemshop').children[1].querySelector('div[onclick*="cowracing.itemShopBuyCommit('+number+')"]');
                    div[i].querySelector(".ttbox").appendChild(divAppend.children[2].children[0].cloneNode(true));
                    div[i].querySelector(".ttbox").children[0].lastChild.remove();
                    div[i].querySelector(".ttbox").children[0].lastChild.remove();
                }
                div[0].parentNode.style.overflow="visible"

                var weather = { "normal":"-150px", "rain":"-100px", "mud":"0px", "cold":"-200px", "heat":"-50px"}
                var newdiv=createElement("div",{"style":"background:url("+GFX+"cowracing/WeatherIcons_50x50.png); background-position: "+weather[unsafeWindow.cowracing.data.data.cows[unsafeWindow.cowracing.currentCowSlot].lanestatus]+" 0px;width:50px;height:50px;position:absolute;top:5px;left:5px"
                },$('cowracing_itemshop').children[0],"");
                newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,"Next Race"); },false);
            }
            raiseEvent("gameCowRacingOpenItemShhop")
        }catch(err){GM_logError("cowracing.itemShop","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","unequipItem",function(b){
        try{
             unsafeWindow.cowracing._unequipItem(b);
        }catch(err){GM_logError("cowracing.gameCowRacingunequipItem","","",err);}
        try{
            raiseEvent("gameCowRacingUnequipItem");
        }catch(err){GM_logError("gameCowRacingUnequipItem","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","equipItem",function(a){
        try{
             unsafeWindow.cowracing._equipItem(a);
        }catch(err){GM_logError("cowracing.gameCowRacingequipItem","","",err);}
        try{
            raiseEvent("gameCowRacingEquipItem");
        }catch(err){GM_logError("gameCowRacingEquipItem","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","itemShopBuyCommit",function(b){
        try{
             unsafeWindow.cowracing._itemShopBuyCommit(b);
        }catch(err){GM_logError("cowracing.gameCowRacingitemShopBuyCommit","","",err);}
        try{
            raiseEvent("gameCowRacingitemShopBuyCommit");
        }catch(err){GM_logError("gameCowRacingitemShopBuyCommit","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","buyItem",function(a){
        try{
             unsafeWindow.cowracing._buyItem(a);
        }catch(err){GM_logError("cowracing.gameCowRacingbuyItem","","",err);}
        try{
            raiseEvent("gameCowRacingBuyItem");
        }catch(err){GM_logError("gameCowRacingitemShopBuyCommit","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","raceSelection",function(){
        try{
             unsafeWindow.cowracing._raceSelection();
        }catch(err){GM_logError("cowracing.gameCowRacingraceSelection","","",err);}
        try{
            raiseEvent("gameCowRacingOpenCowRacingSelection");
        }catch(err){GM_logError("gameCowRacingOpenCowRacingSelection","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","startRace",function(a){
        try{
             unsafeWindow.cowracing._startRace(a);
        }catch(err){GM_logError("cowracing.gameCowRacingstartRace","","",err);}
        try{
            raiseEvent("gameCowRacingOpenStartCowracing");
        }catch(err){GM_logError("gameCowRacingOpenCowRacingSelection","","",err);}

    });

    unsafeOverwriteObjFunction("cowracing","response",function(c,b,d){
        try{
             unsafeWindow.cowracing._response(c,b,d);
        }catch(err){GM_logError("cowracing.gameCowRacingstartRace","","",err);}
        try{
            switch (b) {
                case 'cowracing_startrace': {
                    doFarmersMarketData();
                    break;
                }
            }
        }catch(err){GM_logError("gameCowRacingOpenCowRacingSelection","","",err);}
    });

    unsafeOverwriteObjFunction("cowracing","move",function(b){
        try{
            if(b==3&&unsafeWindow.cowracing.data.data.queue_remain&&unsafeWindow.cowracing.data.data.queue_remain<0&&unsafeWindow.cowracing.data.data.pharmacist_remember_box)
                unsafeWindow.cowracing.data.data.pharmacist_remember_box = 0;
            unsafeWindow.cowracing._move(b);
        }catch(err){GM_logError("cowracing.move","","",err);}

    });

    /**********************************************************
    * Angeln / fishing
    **********************************************************/
    unsafeOverwriteObjFunction("fishing","init",function(){
        try{
             doFarmersMarketData();

             if (unsafeWindow.fishing.data.data.queue && unsafeWindow.fishing.data.data.queue.start && unsafeWindow.fishing.data.data.queue_remain < 0 && unsafeWindow.fishing.data.data.queue_remember) {
                unsafeWindow.fishing.data.data.queue_remember = 0
             }
             unsafeWindow.fishing._init();
        }catch(err){GM_logError("fishing.init","","",err);}
        try{
            //raiseEvent("gameFarmersmarketOpened9");
        }catch(err){GM_logError("fishing.init","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","buildProduction",function(){
        try{
             unsafeWindow.fishing._buildProduction();
        }catch(err){GM_logError("fishing.buildProduction","","",err);}
        try{
            //raiseEvent("gameFishingBuildProduction");
            raiseEvent("gameFarmersmarketOpened9");
        }catch(err){GM_logError("fishing.buildProduction","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","buildPier",function(){
        try{
             unsafeWindow.fishing._buildPier();
        }catch(err){GM_logError("fishing.buildPier","","",err);}
        try{
            raiseEvent("gameFishingBuildPier");
        }catch(err){GM_logError("fishing.buildPier","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","updateFishingSlot",function(e){
        try{
             unsafeWindow.fishing._updateFishingSlot(e);
        }catch(err){GM_logError("fishing.buildPier","","",err);}
        try{
            raiseEvent("gameFishingBuildProduction");
        }catch(err){GM_logError("fishing.buildPier","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","showReward",function(){
        try{
             unsafeWindow.fishing._showReward();
        }catch(err){GM_logError("fishing.showReward","","",err);}
        try{
            raiseEvent("gameFishingFinishFishing");
        }catch(err){GM_logError("fishing.showReward","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","goodbyeFish",function(){
        try{
             unsafeWindow.fishing._goodbyeFish();
        }catch(err){GM_logError("fishing.goodbyeFish","","",err);}
        try{
            raiseEvent("gameFishingGoodbyeFish");
        }catch(err){GM_logError("fishing.goodbyeFish","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","startFishingSelection",function(r){
        try{
             unsafeWindow.fishing._startFishingSelection(r);
        }catch(err){GM_logError("fishing.startFishingSelection","","",err);}
        try{
            raiseEvent("gameFishingStartFishingSelection");
        }catch(err){GM_logError("fishing.startFishingSelection","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","startFishing",function(){
        try{
             unsafeWindow.fishing._startFishing();
        }catch(err){GM_logError("fishing.startFishing","","",err);}
        try{
            doFarmersMarketData();
            raiseEvent("gameFishingStartFishing");
        }catch(err){GM_logError("fishing.startFishing","","",err);}

    });

    unsafeOverwriteObjFunction("fishing","harvestProduction",function(b, a){
        try{
             unsafeWindow.fishing._harvestProduction(b, a);
        }catch(err){GM_logError("fishing.harvestProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketCropped");
        }catch(err){GM_logError("fishing.harvestProduction","","",err);}
    });

    unsafeOverwriteObjFunction("fishing","productionSelection",function(c){
        try{
             unsafeWindow.fishing._productionSelection(c);
        }catch(err){GM_logError("fishing.productionSelection","","",err);}
        try{
            raiseEvent("gameFarmersmarketSlotOpened");
        }catch(err){GM_logError("fishing.productionSelection","","",err);}
    });

    unsafeOverwriteObjFunction("fishing","productionSelectionNavi",function(b, c){
        try{
             unsafeWindow.fishing._productionSelectionNavi(b, c);
        }catch(err){GM_logError("fishing.productionSelectionNavi","","",err);}
        try{
            raiseEvent("gameProductionSelectionNavi");
        }catch(err){GM_logError("fishing.productionSelectionNavi","","",err);}
    });

    unsafeOverwriteObjFunction("fishing","productionSelectionCommit",function(b){
        try{
            unsafeWindow.fishing._productionSelectionCommit(b);
        }catch(err){GM_logError("fishing.productionSelectionCommit","","",err);}
        try{
            raiseEvent("gameProductionSelectionCommit");
        }catch(err){GM_logError("fishing.productionSelectionCommit","","",err);}
    });

    unsafeOverwriteObjFunction("fishing","startProduction",function(a){
        try{
            unsafeWindow.fishing._startProduction(a);
        }catch(err){GM_logError("fishing.startProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketStarted");
        }catch(err){GM_logError("startProductionCommitResponse","","",err);}
    });

    //Open Farmersmarket Pos8
    /*
    unsafeOverwriteObjFunction("fishing","buildProductionSlots",function(){
        try{

             unsafeWindow.fishing._buildProductionSlots();
        }catch(err){GM_logError("fishing.buildProductionSlots","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened9");
        }catch(err){GM_logError("buildProductionSlotsResponse","","",err);}

    });
    */

    /**********************************************************
    * Pfadfinder / scouts
    **********************************************************/
    unsafeOverwriteObjFunction("scouts","build",function(){
        try{

             doFarmersMarketData();
             unsafeWindow.scouts._build();
        }catch(err){GM_logError("scouts.build","","",err);}
        try{
        }catch(err){GM_logError("scouts.build","","",err);}

    });

    //Open Farmersmarket Pos11
    unsafeOverwriteObjFunction("scouts","buildProduction",function(){
        try{
             unsafeWindow.scouts._buildProduction();
        }catch(err){GM_logError("scouts.buildProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketOpened11");
        }catch(err){GM_logError("scouts.buildProduction","","",err);}

    });

    unsafeOverwriteObjFunction("scouts","harvestProduction",function(b, a){
        try{
             unsafeWindow.scouts._harvestProduction(b, a);
        }catch(err){GM_logError("scouts.harvestProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketCropped");
        }catch(err){GM_logError("scouts.harvestProduction","","",err);}
    });

    unsafeOverwriteObjFunction("scouts","productionSelection",function(c){
        try{
             unsafeWindow.scouts._productionSelection(c);
        }catch(err){GM_logError("scouts.productionSelection","","",err);}
        try{
            raiseEvent("gameFarmersmarketSlotOpened");
        }catch(err){GM_logError("scouts.productionSelection","","",err);}
    });

    unsafeOverwriteObjFunction("scouts","productionSelectionCommit",function(b){
        try{
            unsafeWindow.scouts._productionSelectionCommit(b);
        }catch(err){GM_logError("scouts.productionSelectionCommit","","",err);}
        try{
            raiseEvent("gameProductionSelectionCommit");
        }catch(err){GM_logError("scouts.productionSelectionCommit","","",err);}
    });

    unsafeOverwriteObjFunction("scouts","productionSelectionNavi",function(b, c){
        try{
             unsafeWindow.scouts._productionSelectionNavi(b, c);
        }catch(err){GM_logError("scouts.productionSelectionNavi","","",err);}
        try{
            raiseEvent("gameProductionSelectionNavi");
        }catch(err){GM_logError("scouts.productionSelectionNavi","","",err);}
    });

    unsafeOverwriteObjFunction("scouts","startProduction",function(a){
        try{
            unsafeWindow.scouts._startProduction(a);
        }catch(err){GM_logError("scouts.startProduction","","",err);}
        try{
            raiseEvent("gameFarmersmarketStarted");
        }catch(err){GM_logError("scouts.startProduction","","",err);}
    });

    /**********************************************************
    * Obststand / m1          map_stall1             Map
    * Obststand / m2          map_stall2             Map
    **********************************************************/
    function doMapStall(){
        try {
            var err_trace="doMapStall";
            var nowServer=unsafeWindow.Zeit.Server;
            var item,zoneNrF,zoneNrS,tempZoneProductionData,tempZoneProductionDataSlot,iProd,iTime,iWaterTime,iPoints,iAmount,currBlock;
            // if(BUILDING_SLOTS[building]){
            for (var nr = 1;nr<=2;nr++) {
                if(unsafeWindow.stall && unsafeWindow.stall.data.data[nr]){
                    zoneNrF = "map_stall"+nr;
                    zones.setBonus(zoneNrF,0);
                    item = unsafeWindow.stall;
                    tempZoneProductionData=[[{},{}],0,0,true];

                    for(var slot=1;slot<=BUILDING_SLOTS["m"+nr];slot++){
                        zoneNrS=zoneNrF+"."+slot;
                        zones.setBlock(zoneNrS,"");
                        tempZoneProductionDataSlot=[[{},{}],0,0,true];/*
                        console.log("+++++++++++++++++++++++++++++++");
                        console.log(implode(item.data.data[1].slots[slot]));
                        console.log("++++++++++++++++++++++++++++++++++++++++++")*/
                        if (item.data.data[nr].slots.hasOwnProperty(slot)) {
                            if(!item.data.data[nr].slots[slot].hasOwnProperty("amount") ||
                                item.data.data[nr].slots[slot].amount/item.data.config.level[nr][item.data.data[nr].level].fillsum <=0.66
                            ){
                                iTime=nowServer-100; // TODO:
                                tempZoneProductionData[1]++;
                                tempZoneProductionDataSlot[1]++;
                            } /*else if(item.data.data[1].slots[slot].length==0 ||
                                item.data.data[1].slots[slot].amount/item.data.config.level[item.data.data[1].level].fillsum <=0.60){
                                iTime = nowServer+1800;
                            }*/ else {
                                iTime=parseInt(item.data.data[nr].farmi_last,10)+1800;
                                //iTime = nowServer+3600;
                            }
                            iProd=item.data.data[nr].slots[slot].pid; iAmount=0; iPoints=0;
                            tempZoneProductionData[2]++;
                            tempZoneProductionDataSlot[2]++;

                            if(!tempZoneProductionData[0][0][iProd]){
                                tempZoneProductionData[0][0][iProd]=[];
                            }
                            tempZoneProductionData[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                            if(!tempZoneProductionDataSlot[0][0][iProd]){
                                tempZoneProductionDataSlot[0][0][iProd]=[];
                            }
                            tempZoneProductionDataSlot[0][0][iProd].push([iAmount,iPoints,iTime,NEVER]);
                            zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());

                        } else {
                            //locked
                            zones.setBlock(zoneNrS,"b");
                        }
                    }
                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                    zones.setBlock(zoneNrF,"");
                } else {
                    zoneNrF = "map_stall"+nr;
                    zones.setBlock(zoneNrF,"blpqs");
                }
            }
            calcTotalZones();
        } catch (err) {
            GM_logError("doFarmersMarketData", "", "err_trace=" + err_trace, err); }
    };

    unsafeOverwriteObjFunction("stall","open",function(c){
        try{
             unsafeWindow.stall._open(c);
        }catch(err){GM_logError("stall.openMapStall","","",err);}
        try{
            raiseEvent("gameOpenMapStall"+c);
        }catch(err){GM_logError("openMapStall1","","",err);}
    });

    unsafeOverwriteObjFunction("stall","response",function(b,a,c){
        try{
             unsafeWindow.stall._response(b,a,c);
        }catch(err){GM_logError("stall.response","","",err);}
        try{
            switch (a) {
                case "stall_clear_slot":
                    raiseEvent("gameMapStall1_ClearSlot");
                    break;
                case "stall_fill_slot":
                    doMapStall();
                    raiseEvent("gameMapStall_fillSlotCommit");
                    break;
                case "stall_refill_slot":
                    doMapStall();
                    raiseEvent("gameMapStall_fillSlotCommit");
                    break;
                default:

            }

        }catch(err){GM_logError("stall.response_2","","",err);}
    });

    unsafeOverwriteObjFunction("stall","fillSlotCommit",function(b,l){
        try{
             unsafeWindow.stall._fillSlotCommit(b,l);
        }catch(err){GM_logError("stall.fillSlotCommit","","",err);}
        try{
            raiseEvent("gameMapStall1_fillSlotCommit");
        }catch(err){GM_logError("stall.fillSlotCommit","","",err);}
    });

    unsafeOverwriteObjFunction("stall","refillSlotCommit",function(b,m){
        try{
             unsafeWindow.stall._refillSlotCommit(b,m);
        }catch(err){GM_logError("stall.refillSlotCommit","","",err);}
        try{
            raiseEvent("gameMapStall1_refillSlotCommit");
        }catch(err){GM_logError("stall.refillSlotCommit","","",err);}
    });

    var notstartStallInformer = 0;
    unsafeOverwriteObjFunction("stall","informer",function(c){
        try{
             unsafeWindow.stall._informer(c);
        }catch(err){GM_logError("stall.openMapStall","","",err);}
        try{
            if (notstartStallInformer++==0) {
                doMapStall();
            } else if (notstartStallInformer>=600) {
                notstartStallInformer = 0;
            }

        }catch(err){GM_logError("openMapStall1","","",err);}
    });

    /**********************************************************
    * Vehicle Farm 5 und 6
    **********************************************************/
    unsafeOverwriteFunction("openMap",function(){
        try{
            unsafeWindow._openMap();
        }catch(err){GM_logError("openMap","","",err);}
        try{
            raiseEvent("gamegoToMap");
        }catch(err){GM_logError("openMap","","",err);}
    });

    unsafeOverwriteFunction("mapCalcVehicleSlot",function(d){
        try{
            unsafeWindow._mapCalcVehicleSlot(d);
        }catch(err){GM_logError("_mapCalcVehicleSlot","","",err);}
        try{
            if($("globalbox")){
                var vehicleLocation=unsafeWindow.farms_data.map.vehicles[unsafeWindow.map_current_route][unsafeWindow.map_current_vehicle].current;
                var valueMin = 0;
                if (prodTyp[0][d]=="ex" && vehicleLocation==5){
                    valueMin = valMinExFruitsFarms5*120/prodPlantSize[0][d];
                } else if (prodTyp[0][d]=="alpin" && vehicleLocation==6) {
                    valueMin = valMinAlpinFarm6*120/prodPlantSize[0][d];
                }
                if (valueMin>0) {
                    if (prodStock[vehicleLocation][d]-$("map_vehicle_slot_fill_input").value < valueMin){
                        $("map_vehicle_slot_fill_input").value=Math.max(prodStock[vehicleLocation][d]-valueMin,0);
                        var container = $("globalbox_content");
                        var newdiv=createElement("div",{"style":"color:red;font-weight:bold;"},container,getText("remainFarm").replace(/%1%/,valueMin).replace(/%2%/,vehicleLocation));
                        setTimeout(function (){
                            newdiv.parentNode.removeChild(newdiv);
                        }, 3000);
                    }
                }
            }
        }catch(err){GM_logError("mapCalcVehicleSlot","","",err);}
    });

    unsafeOverwriteFunction("mapDialog",function(m,J,K){
        try{
             unsafeWindow._mapDialog(m,J,K);
        }catch(err){GM_logError("mapDialog","","",err);}
        try{
            switch (m) {
                case 'openVehicleSheet':
                    raiseEvent("gameMapVehicle"+J);
                    break;
                case 'fillVehicleSlot':
                    raiseEvent("gameFillVehicleSlot"+J);
                    break;
                case 'fillVehicleSlot_product':
                    raiseEvent("gameFillVehicleSlotProduct"+J)
                    break
                case 'send_vehicle':
                    raiseEvent("gameSendVehicle");
                    break;
                default:
            }
        }catch(err){GM_logError("initFoodcontest","","",err);}
    });

/*    unsafeOverwriteFunction("openMap",function(){
        try{
            unsafeWindow._openMap();
        }catch(err){GM_logError("openMap","","",err);}
        try{
            raiseEvent("gamegoToMap");
        }catch(err){GM_logError("openMap","","",err);}
    });*/

    /*mapSetVehicleSlot*/


    // events forestry ==============================================================================
    err_trace="events forestry";

    /*
    $("globalcommitbox").addEventListener ("DOMAttrModified", function(event){
        try{
        var help;
        if ((this==event.target)&&(this.style.display == "block") && (help=$("forestry_questentry_value"))){
            var max = $("globalcommitbox").innerHTML.match(/chkForestryQuestEntryValue\(\d+,\d+,(\d+)\)/i);
            GM_log("max:"+implode(max));
            if (max && max[1]){
                help.value = max[1];
                keyup(help);
            }
        }
    }catch(err){GM_logError("globalcommitbox","","",err);}
    },false);

    Arrays:
    forestry_area_run       : >0 if growing
    forestry_area_time      : seconds till end of growing
    forestry_area_watertime : seconds till next watering (<=0 if water needed)
    forestry_area_name      : Name of tree if growing
    forestry_area_pid       : tree id {1,2,3,...}
    */
/*
    unsafeOverwriteFunction("forestryAjaxAction",function(action,position,pid,slot){
        // GM_log("forestryAjaxAction action="+action+" position="+position+" pid="+pid+" slot="+slot);
        // GM_log("currentslot="+unsafeWindow.currentslot);
        // open menu again
        // if((position==1)||(position==2)){
        if(position==2){
            if((action=="startproduction")||(action=="cancelproduction")||(action=="cropproduction")){
                document.addEventListener("gameOpenForestry",function(position){ return function(){
                    document.removeEventListener("gameOpenForestry",arguments.callee,false);
                    var div=$("forestry_building_click"+position);
                    if(div){ click(div); }
                    div=null;
                }}(position),false);
            }
        }
        unsafeWindow._forestryAjaxAction(action,position,pid,slot);
    });
*/
    unsafeOverwriteFunction("initForestryResponse",function(request,mode,C,r,type){
        try{
            if(DEVMODE_FUNCTION){ var trackingHandle = tracking.start("berater","initForestryResponse"); }
            unsafeWindow._initForestryResponse(request,mode,C,r,type);
            // initForestryResponse(request,uprack,upmenu,action,pos,tutorialstep,position);
            var result = checkRequest(request);
            if(result && result[0]!=0){
                unsafeWindow.farm=""; //Hack for the scripts
                unsafeWindow.city=""; //Hack for the scripts
                // GM_log("forestry: result:\n"+implode(result));
                if(unsafeWindow.forestry_unlock){
                    try{
                        /* forestry_production_products{stock}{iProd}
                        {0} = 36000 // Time
                        {1}{1}{1} = 30 //points you get with harwisting this product
                        {1}{1}{2} = 1 //amount it will produce
                        {1}{1}{3} = 1 //stock number
                        {1}{1}{4}{0} = 1 //campain number after which it can be used
                        {1}{1}{4}{1} = 3 //quest number after which it can be used
                        {1}{1}{5} = 21 //What can i make of this: stock 2 =[{0:product,1:amount}]; stock 1 = product; stock 3,4 = 0;
                        {1}{1}{6} = 0 //What do i need for this: stock 4 =[{0:product,1:amount}]; stock 1 to 3 = 0
                        {1}{1}{7} = 3 //something with the price.. but this could change dayly
                        {1}{1}{8} = 0 //stock 5: [prod,amount] to be payed to get this forestry_area[][block] of the field.
                        {1}{1}{9} = Fijnspar //NAME
                        {1}{1}{10}{0} = 1 //only at stock 1
                        {1}{1}{10}{1} = 2 //only at stock 1
                        {1}{1}{11} = 0 ->stock 3: fid needed to produce
                        {1}{1}{12} = 0 //item for in the farmbuilding
                        */
                        //make prodName[1] && prodYield[1] && prodRequire[1] = [[type,fId,amount]]
                        var store,stock,fId,help,building;
                        for(var stock in result[4]){ //forestry_production_products==initForestryResponce->result[4]
                            if (!result[4].hasOwnProperty(stock)){ continue; }
                            for(var fId in result[4][stock]){
                                if (!result[4][stock].hasOwnProperty(fId)){ continue; }
                                help=result[4][stock][fId];
                                // if (!prodName[1][fId]){
                                //  prodName[1][fId] = help[9]; // set prodName[1]
                                //  //GM_log("initForestryResponse ADD prodName production fId:"+fId+" name:"+prodName[1][fId]);
                                //  bChanged=true;
                                // }
                                prodTyp[1][fId]="f"+stock;
                                prodPoints[1][fId]=help[1];
                                //GM_log("prodYield fId:"+fId+" [5]:"+typeof help[5]);
                                building=getForestryUserBuilding(stock-1);
                                prodStockMax[1][fId]=building?unsafeWindow.forestry_user_buildings[building]["capacity"]:0;
                                if(stock==1){
                                    prodYield[1][fId]=1;
                                    prodYield[1][help[5]]=1;
                                    delete prodRequire[1][fId]; //[[1,parseInt(fId,10),1]];
                                    prodRequire[1][help[5]]=[[1,parseInt(fId,10),1]];
                                    prodGrowTime[1][fId]=help[0]/60;
                                }else if(stock==2){//forestry
                                    // [4]{2}{23}[5][0][0] = 47 //id
                                    // [4]{2}{23}[5][0][1] = 7 //#
                                    // for(var i=0;i<help[5].length;i++){
                                        //prodYield[1][help[5][i][0]]=help[5][i][1];
                                        //prodRequire[1][help[5][i][0]]=[[1,parseInt(fId,10),1]];
                                    // }
                                }else if(stock==3){//sawmill
                                    prodYield[1][fId]=help[2];
                                    prodRequire[1][fId]=[[1,help[11],1]];
                                    building=getForestryUserBuilding(1);
                                    if(!prodGrowTime[1][fId]){
                                        if(building&&unsafeWindow.forestry_user_buildings[building]["boni"]){
                                            prodGrowTime[1][fId]=((help[0]*100)/(100-unsafeWindow.forestry_user_buildings[building]["boni"]))/60;
                                        }else{
                                            prodGrowTime[1][fId]=help[0]/60;
                                        }
                                    }
                                }else if(stock==4){//carpentry
                                    //[4]{4}{101}[6][0][0] = 41 //id
                                    //[4]{4}{101}[6][0][1] = 4 //#
                                    prodYield[1][fId]=1;
                                    prodRequire[1][fId]=new Array();
                                    for(var i=0;i<help[6].length;i++){

                                        prodRequire[1][fId].push([1,help[6][i][0],help[6][i][1]]);
                                    }
                                    building=getForestryUserBuilding(2);
                                    if(!prodGrowTime[1][fId]){
                                        if(building&&unsafeWindow.forestry_user_buildings[building]["boni"]){
                                            prodGrowTime[1][fId]=((help[0]*100)/(100-unsafeWindow.forestry_user_buildings[building]["boni"]))/60;
                                        }else{
                                            prodGrowTime[1][fId]=help[0]/60;
                                        }
                                    }
                                }
                            }
                        }
                        stock=null;fId=null;help=null;
                        // prodPoints[1].sortObj();
                        // GM_log("initForestryResponse prodPoints:"+implode(prodPoints,"prodPoints"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_prodPoints",implode(prodPoints,"initForestryResponse/prodPoints"));
                        // prodTyp[1].sortObj();
                        // GM_log("initForestryResponse prodTyp:"+implode(prodTyp,"prodTyp"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_prodTyp",implode(prodTyp,"initForestryResponse/prodTyp"));
                        // prodYield[1].sortObj();
                        // GM_log("initForestryResponse prodYield:"+implode(prodYield,"prodYield"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodYield",implode(prodYield,"initForestryResponse/prodYield"));
                        // prodRequire[1].sortObj();
                        // GM_log("initForestryResponse prodRequire:"+implode(prodRequire,"prodRequire"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_prodRequire",implode(prodRequire,"initForestryResponse/prodRequire"));
                        // prodGrowTime[1].sortObj();
                        // GM_log("initForestryResponse prodGrowTime:"+implode(prodGrowTime,"prodGrowTime"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodGrowTime",implode(prodGrowTime,"initForestryResponse/prodGrowTime"));
                        // prodStockMax[1].sortObj();
                        // GM_log("initForestryResponse prodStockMax:"+implode(prodStockMax,"prodStockMax"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStockMax",implode(prodStockMax,"initForestryResponse/prodStockMax"));
                        // make prodName[1] && forestry_stock
                        prodStock[1]=new Object();
                        for(store in result[3]){ //forestry_stock
                            if (!result[3].hasOwnProperty(store)){ continue; }
                            for(fId in result[3][store]){
                                if (!result[3][store].hasOwnProperty(fId)){ continue; }
                                // if (!prodName[1][fId]){
                                //  prodName[1][fId] = result[3][store][fId]["name"]; // set prodName[1]
                                //  //GM_log("initForestryResponse ADD prodName stock fId:"+fId+" name:"+prodName[1][fId]);
                                //  bChanged=true;
                                // }
                                if(!prodStock[1][fId]) prodStock[1][fId]=0;
                                prodStock[1][fId] += parseInt(result[3][store][fId]["amount"],10);
                            }
                        }
                        for(fId in prodName[1]){
                            if (!prodName[1].hasOwnProperty(fId)){ continue; }
                            if(!prodStock[1][fId]){ prodStock[1][fId]=0; }
                        }
                        //GM_log("initForestryResponse prodStock:"+implode(prodStock,"prodStock"));
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"initForestryResponse/prodStock"));

                        for(fId in prodName[1]){
                            if(!prodName[1].hasOwnProperty(fId)){continue;}

                            stock=prodTyp[1][fId].replace("f","");
                            if(!!prodTyp[1][fId]&&!(result[4][stock]&&result[4][stock][fId])&&!prodBlock[1][fId].match(/b/)){
                                prodBlock[1][fId]+="b";
                            }
                        }
                        store=null;fId=null;
                        // prodStock[1].sortObj();
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"initForestryResponse/prodStock"));

                        // Forestry Farmis
                        totalFarmis[1] = new Object();
                        for (var farmi in result[5]) {
                            if (!result[5].hasOwnProperty(farmi)) { continue; }
                            for (var i in result[5][farmi]["products"]) {
                                if (!result[5][farmi]["products"].hasOwnProperty(i)) { continue; }

                                fId = result[5][farmi]["products"][i]["product"];
                                if (!totalFarmis[1][fId]) { totalFarmis[1][fId] = 0; }
                                totalFarmis[1][fId] += parseInt(result[5][farmi]["products"][i]["amount"], 10);
                            }
                        }
                        GM_setValueCache(COUNTRY + "_" + SERVER + "_" + USERNAME + "_totalFarmis", implode(totalFarmis, "initForestryResponse/totalFarmis"));

                    }catch(err){GM_logError("initForestryResponse","","",err);}
                    var zoneNrF;
                    switch(type){
                    case 1: zoneNrF="sawmill"; break;
                    case 2: zoneNrF="carpentry"; break;
                    }
                    updateProductDataForestry();
                    doForestry();
                    switch(mode){
                    case "cropproduction": raiseEvent("game"+zoneNrF.capitalize()+"Cropped"); break;
                    case "startproduction": raiseEvent("game"+zoneNrF.capitalize()+"Started"); break;
                    default: raiseEvent("gameOpenForestry");
                    }
                }
                calcProdMinRack();
            }
            if(DEVMODE_FUNCTION){ tracking.end("berater",trackingHandle); }
        }catch(err){GM_logError("initForestryResponse","","",err);}
    });

    /*
    var container = $("forestry_sawmill_productbox");
    var treeContainer, el1, el2;
    // Redesign sawmill
    for(var treeId=1;treeId<=5;treeId++){
        treeContainer = createElement("div",{"id":"forestry_sawmill_productbox_tree"+treeId,"style":"height:40px;"},container);
        el1 = createElement("div",{"id":"forestry_sawmill_productbox_log"+treeId,"class":"forestry_slot_product f_symbol"+(20+treeId),"style":"display:block;border-right:2px solid black;"},treeContainer);
        createElement("div",{"id":"forestry_sawmill_productbox_log"+treeId+"_amount","style":"position:absolute;top:-13px;"},el1)
        for(var i=-2;i<=0;i++){
            if(el1=$("forestry_slot_products"+(treeId*3+i))){
                treeContainer.appendChild(el1);
                createElement("div",{"id":"forestry_slot_products"+(treeId*3+i)+"_amount","style":"position:absolute;top:-13px;"},el1);
                if(el2=$("forestry_slot_products_name"+(treeId*3+i))){
                    el1.addEventListener("mouseover",function(){
                        // $(this.id+"_endtime").innerHTML=0;
                        var nr=this.id.replace("forestry_slot_products","");
                        var div=$("forestry_slot_products"+nr+"_endtime");
                        if(!div){
                            if(div=$("forestry_slot_products_name"+nr)){
                                div=createElement("div",{},div);
                                createElement("img",{"src":GFX+"adtime.gif","style":"width:14px;height:14px;vertical-align:text-bottom;margin-right:5px;"},div);
                                div=createElement("div",{"id":"forestry_slot_products"+nr+"_endtime","style":"display:inline-block;"},div);
                            }
                        }
                        if(div){
                            var iProd = parseInt(/f_symbol(\d+)/.exec(this.getAttribute("class"))[1],10);
                            var iTime=calcProductionTime("sawmill",1,iProd,1-zones.getBonus("sawmill")/100);
                            div.innerHTML=getDaytimeStr(now+iTime)+"&nbsp;"+getText("shortOClock");
                            iProd=null;iTime=null;
                        }
                        nr=null;div=null;
                    },false);
                }
            }
        }
    }
    // Redesign Carpentry
    for(var i=1;i<=20;i++){
        el1=$("forestry_productiondialog_content_item_amount"+i);
        if(el1){
            el1.style.width = "150px";
            container = el1.parentNode; // $("forestry_productiondialog_content_item_con"+i);
            container.style.position = "relative";
            container.style.height = "28px";
            container.style.marginBottom = "5px";
            container.className = "hoverBgLightbrown";
            container.addEventListener("mouseover",function(evt){
                try{
                    var prod = parseInt(/f_symbol(\d+)/.exec($(this.id.replace("forestry_productiondialog_content_item_con","forestry_productiondialog_content_item")).getAttribute("class"))[1],10);
                    var container,newTable,newTr,newTd;
                    container=createElement("div");
                    newTable=createElement("table",{},container);
                    // name
                    newTr=createElement("tr",{},newTable);
                    newTd=createElement("th",{"colspan":"2"},newTr,prodName[1][prod]);
                    if(prodTyp[1][prod]=="f5"){
                        newTr=createElement("tr",{},newTable);
                        newTd=createElement("td",{"colspan":"2","style":"font-weight:bold;"},newTr,unsafeWindow.forestry_production_farmhouseitem_info_head);
                    }else{
                        // rack amount
                        newTr=createElement("tr",{},newTable);
                        newTd=createElement("td",{},newTr,getText("stock"));
                        newTd=createElement("td",{},newTr,numberFormat(prodStock[1][prod]));
                    }
                    toolTip.show(evt,container.innerHTML);
                }catch(err){ GM_logError("carpentryItem.mouseover","","prod="+prod,err); }
            },false);
            // createElement("div",{"id":"forestry_productiondialog_content_item_rackamount"+i,"style":"position:absolute;top:25px;left:0px;"},container,"0");
            el1=insertAfter(createElement("div",{"class":"forestry_productiondialog_content_item_main_amount","style":"width:150px;"}),el1);
            el2=createElement("div",{"style":"display:inline-block;height:15px;width:15px;margin-right:1px;"},el1);
            createElement("img",{"src":GFX+"lager/wachstum.gif","style":"width:14px;height:14px;vertical-align:text-bottom;"},el2);
            createElement("div",{"id":"forestry_productiondialog_content_item_times"+i,"style":"display:inline-block;width:58px;"},el1,"0");
            el2=createElement("div",{"style":"display:inline-block;height:15px;width:15px;margin-left:2px;margin-right:1px;"},el1);
            createElement("img",{"src":GFX+"adtime.gif","style":"width:14px;height:14px;vertical-align:text-bottom;"},el2);
            createElement("div",{"id":"forestry_productiondialog_content_item_endtimes"+i,"style":"display:inline-block;width:58px;"},el1,"0");
        }
    }
    container=null;treeContainer=null;el1=null;el2=null;
    */
    // Redesign Forest Stock
    var div,div2,span,iProd,iTime;
    for(var v=1;v<=10;v++){
        if(div=$("f_stock_item"+v)){
            iProd=parseInt(/f_symbol(\d+)/.exec(div.firstElementChild.className)[1],10);
            if(iProd&&(div=$("f_stock_growing_"+v))){
                iTime=calcProductionTime("forest",1,iProd,1-zones.getBonus("forest")/100);
                div.innerHTML=getTimeStr(iTime,true)+"&nbsp;"+getText("shortHours");
                div.parentNode.parentNode.style.height="44px";
                div2=createElement("div",{"style":"float:left;height:15px;width:15px;margin-right:5px;"},div.parentNode);
                createElement("img",{"src":GFX+"adtime.gif","style":"width:14px;height:14px;"},div2);
                div2=createElement("div",{"class":"forestry_stockitem_time"},div.parentNode);
                span=createElement("span",{},div2);
                clocks.add("forestItem_"+iProd,span,iTime);
                createElement("span",{},div2,"&nbsp;"+getText("shortOClock"));
                createElement("div",{"class":"clear"},div.parentNode);
            }
        }
    }

    unsafeOverwriteFunction("showForestryProductionBox",function(type){
        try{
            unsafeWindow._showForestryProductionBox(type);
        }catch(err){GM_logError("_showForestryProductionBox","","",err);}
        try{
            GM_logInfo("showForestryProductionBox","type="+type,"","Begin",1);
            switch(type){
            case 1:{// sawmill
                var container,prod,classStr,flagDisplay,div;
                var zoneNrF="sawmill";
                for (var slot=1;slot<=3;slot++){
                    try{
                        if ( $("forestry_building_inner_slot_locked"+slot).style.display=="block"){
                            continue;
                        }
                        container = $("forestry_building_inner_slot"+slot);
                        classStr = container.children[0].children[0].getAttribute("class");
                        prod = parseInt(/fbig(\d+)/.exec(classStr)[1],10);
                        div=createElement("div", {
                            "style": " position:absolute;bottom: 60px; left: 110px;"
                        }, container, getText("inStock")+": "+numberFormat(prodStock[1][prod]));
                        div=createElement("div", {
                            "style": " position:absolute;bottom: 75px; left: 110px;"
                        }, container);
                        pointsFormat(prodPoints[1][prod], "div", div);
                    }
                    catch(err){ GM_logError("showForestryProductionBox","type="+type,"zoneNrF="+zoneNrF+" slot="+slot,err); }
                }
                //auto-cropping
                for(var slot=1;slot<=3;slot++){
                    try{
                        if((top.unsafeData.autoAction==null) && valAutoCrop["forestry"] && (div=$("forestry_slot_crop"+slot)) && (div.style.display=="block")){
                            top.unsafeData.autoAction="berater: sawmill crop";
                            document.addEventListener("gameOpenGlobalCommitBox",function(){
                                document.removeEventListener("gameOpenGlobalCommitBox",arguments.callee,false);
                                window.setTimeout(function(){
                                    click($("globalcommitboxfooter").firstElementChild);
                                    top.unsafeData.autoAction=null;
                                },500);
                            });
                            window.setTimeout(function(div){ click(div); },500,div);
                        }
                        div=null;
                    }catch(err){ GM_logError("showForestryProductionBox","type="+type,"zoneNrF="+zoneNrF+" slot="+slot,err); }
                }
                container=null;prod=null;classStr=null;flagDisplay=null;
                raiseEvent("gameSawmillOpened");
            break;}
            case 2:{ // carpentry
                var container,prod,classStr,flagDisplay,div;
                var zoneNrF="carpentry";
                for (var slot=1;slot<=3;slot++){
                    try{
                        if ( $("forestry_building_inner_slot_locked"+slot).style.display=="block"){
                            continue;
                        }
                        container = $("forestry_building_inner_slot"+slot);
                        classStr = container.children[0].children[0].getAttribute("class");
                        prod = parseInt(/fbig(\d+)/.exec(classStr)[1],10);
                        div=createElement("div", {
                            "style": " position:absolute;bottom: 60px; left: 110px;"
                        }, container, getText("inStock")+": "+numberFormat(prodStock[1][prod]));
                        div=createElement("div", {
                            "style": " position:absolute;bottom: 75px; left: 110px;"
                        }, container);
                        pointsFormat(prodPoints[1][prod], "div", div);
                    }
                    catch(err){ GM_logError("showForestryProductionBox","type="+type,"zoneNrF="+zoneNrF+" slot="+slot,err); }
                }
                //auto-cropping
                for(var slot=1;slot<=3;slot++){
                    try{
                        if((top.unsafeData.autoAction==null) && valAutoCrop["forestry"] && (div=$("forestry_slot_crop"+slot)) && (div.style.display=="block")){
                            top.unsafeData.autoAction="berater: carpentry crop";
                            document.addEventListener("gameOpenGlobalCommitBox",function(){
                                document.removeEventListener("gameOpenGlobalCommitBox",arguments.callee,false);
                                window.setTimeout(function(){
                                    click($("globalcommitboxfooter").firstElementChild);
                                    top.unsafeData.autoAction=null;
                                },500);
                            });
                            window.setTimeout(function(div){ click(div); },500,div);
                        }
                        div=null;
                    }catch(err){ GM_logError("showForestryProductionBox","type="+type,"slot="+slot,err); }
                }
                container=null;icon=null;prod=null;help=null;
                raiseEvent("gameCarpentryOpened");
            break;}
            }
        }catch(err){GM_logError("showForestryProductionBox","type="+type,"",err);}
    });
    unsafeOverwriteFunction("showForestrySelection",function(type,slot){
        try{
            unsafeWindow._showForestrySelection(type,slot);
        }catch(err){GM_logError("_showForestrySelection","","",err);}
        try{
            if(!type){ type=1; }
            if(!slot){ slot=1; }
            var container,div;
            var zoneNrF,iProd,iTime;
            switch(type){
            case 1: zoneNrF="sawmill"; break;
            case 2: zoneNrF="carpentry"; break;
            }
            container=$("forestry_selectproduction_scrollcontent");
            for(var i=container.childElementCount-1;i>=0;i--){
                div=container.children[i].firstElementChild;
                iProd=parseInt(/f_symbol(\d+)/.exec(div.className)[1],10);
                iTime=calcProductionTime(zoneNrF,1,iProd,1-zones.getBonus(zoneNrF)/100);
                div2=createElement("div",{"style":"float:left;margin-right:10px;"});
                div.parentNode.insertBefore(div2,div);
                div.removeAttribute("style");
                div2.appendChild(div);
                createElement("div",{},div2,numberFormat(prodStock[1][iProd]));
                div=container.children[i].children[1].children[1];
                div.innerHTML="";
                div.style.height="14px";
                div2=createElement("div",{"class":"forestry_growing"},div);
                createElement("div",{"style":"float:left;margin-right:5px;"},div,getTimeStr(iTime,true)+"&nbsp;"+getText("shortHours"));
                div2=createElement("div",{"style":"float:left;height:15px;width:15px;margin-right:5px;"},div);
                createElement("img",{"src":GFX+"adtime.gif","style":"width:14px;height:14px;"},div2);
                div2=createElement("div",{"style":"float:left;"},div);
                clocks.add("forestrySelection_"+iProd,div2,iTime);
            }
            raiseEvent("game"+zoneNrF.capitalize()+"SlotOpened");
        }catch(err){GM_logError("showForestrySelection","","",err);}
    });
    unsafeOverwriteFunction("showForestryBuildingInner",function(type){
        try{
            unsafeWindow._showForestryBuildingInner(type);
        }catch(err){GM_logError("_showForestryBuildingInner","","",err);}
        try{
            switch(type){
            case 1:{// sawmill
                raiseEvent("gameSawmillOpened");
            break;}
            case 2:{ // carpentry
                raiseEvent("gameCarpentryOpened");
            break;}
            }
        }catch(err){GM_logError("showForestryBuildingInner","","",err);}
    });
    /*
    createElement("div",{"id":"analyzediv","style":"position: fixed; top: 0px; right: 0px; z-index: 995; display: block;","class":"blackbox"},ALL);
    $("analyzediv").addEventListener("click",function(){this.innerHTML="";},false);
    unsafeOverwriteFunction("forestrySetStatus",function(position,status,product){
        unsafeWindow._forestrySetStatus(position,status,product);
        var str = 'forestry_area_run       = '+unsafeWindow.forestry_area_run      [position]+'<br>'+
                  'forestry_area_time      = '+unsafeWindow.forestry_area_time     [position]+'<br>'+
                  'forestry_area_watertime = '+unsafeWindow.forestry_area_watertime[position]+'<br>'+
                  'forestry_area_name      = '+unsafeWindow.forestry_area_name     [position]+'<br>'+
                  'forestry_area_pid       = '+unsafeWindow.forestry_area_pid      [position];
        for(var j = 0 ; j < unsafeWindow.forestry_area.length ; j++)    {
            if(unsafeWindow.forestry_area[j])   {
                if(unsafeWindow.forestry_area[j]['position'] == position){
                    str ="forestry_area["+j+"]="+implode(unsafeWindow.forestry_area[j]);
                }
            }
        }
        GM_log(str);
        $("analyzediv").innerHTML=str;
    });
    */


    function doForestry(){
    try{
        gameLocation.set("forestry");
        var nowServer=unsafeWindow.Zeit.Server;
        var zoneNrF,zoneNrS,tempZoneProductionData,tempZoneProductionDataSlot,currBlock,currBonus;
        // GM_log("forestry_slots:\n"+print_r(unsafeWindow.forestry_slots,"",true,"\n"));
        // Sawmill and carpentry
        var err_trace="forestry_user_buildings";
        if(unsafeWindow.forestry_user_buildings){
            var res,iProd,iAmount,iPoints,iTime,maxCapacity,iSlotCount;
            for(var building in unsafeWindow.forestry_user_buildings){ //forestry_user_buildings==initForestryResponce->result[2]
                if(!unsafeWindow.forestry_user_buildings.hasOwnProperty(building)){continue;}
                switch(building){
                case "1": zoneNrF="sawmill";break;
                case "2": zoneNrF="carpentry";break;
                default: continue;
                }
                // GM_log("forestry_user_buildings["+building+"]:\n"+print_r(unsafeWindow.forestry_user_buildings[building],"",true,"\n"));
                //building=getForestryUserBuilding(i);
                currBlock=(unsafeWindow.forestry_user_buildings[building]["locked"]?"q":"");
                zones.setBlock(zoneNrF,currBlock);
                if(iSlotCount=zones.isMultiSlot(zoneNrF)){
                    if(!currBlock){
                        for(var slot=1;slot<=iSlotCount;slot++){
                            zoneNrS=zoneNrF+"."+slot;
                            zones.setBlock(zoneNrS,((slot==1)||(unsafeWindow.forestry_slots[building]&&unsafeWindow.forestry_slots[building][slot]))?"":"b");
                        }
                    }
                }else{
                    iSlotCount=0;
                }
                if(!currBlock){
                    zones.setBonus(zoneNrF,unsafeWindow.forestry_user_buildings[building]["boni"]?unsafeWindow.forestry_user_buildings[building]["boni"]:0);
                    // maxCapacity=unsafeWindow.forestry_user_buildings[building]?unsafeWindow.forestry_user_buildings[building]["capacity"]:100;
                    res=(unsafeWindow.forestry_user_buildings[building]&&unsafeWindow.forestry_user_buildings[building]["slots"])?unsafeWindow.forestry_user_buildings[building]["slots"]:{};

                    tempZoneProductionData=[[{},{}],0,0,true];
                    for(var slot=1;slot<=(iSlotCount==0?1:iSlotCount);slot++){
                        GM_logInfo("doForestry","","zoneNrF="+zoneNrF+" slot="+slot+" res["+slot+"]="+implode(res[slot],"doForestry/res"),"Loop",0);
                        if(iSlotCount>0){
                            zoneNrS=zoneNrF+"."+slot;
                        }else{
                            zoneNrS=zoneNrF;
                        }
                        if(!zones.getBlock(zoneNrS)){
                            tempZoneProductionDataSlot=[[{},{}],0,0,true];
                            if(res[slot]){
                                iProd=(res[slot]["productid"]?parseInt(res[slot]["productid"],10):null);
                                if(isNaN(iProd)){ iProd=null; }
                                if((iProd!=null)&&(res[slot]["ready"]==2)){ // production busy
                                    iTime=nowServer+res[slot]["remain"];
                                }else if((iProd!=null)&&(res[slot]["ready"]==1)){ // production ready
                                    iTime=nowServer;
                                }else{
                                    iTime=NEVER;
                                    tempZoneProductionData[1]++;
                                    tempZoneProductionDataSlot[1]++;
                                }
                                tempZoneProductionData[2]++;
                                tempZoneProductionDataSlot[2]++;
                                if(iProd!=null){
                                    iAmount=prodYield[1][iProd];
                                    iPoints=iAmount*prodPoints[1][iProd];
                                    if(!tempZoneProductionData[0][1][iProd]){ tempZoneProductionData[0][1][iProd]=[]; }
                                    tempZoneProductionData[0][1][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                    if(!tempZoneProductionDataSlot[0][1][iProd]){ tempZoneProductionDataSlot[0][1][iProd]=[]; }
                                    tempZoneProductionDataSlot[0][1][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                }
                            }
                            if(iSlotCount>0){
                                zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                            }
                        }
                    }
                    zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                    //auto-cropping
                    if(iSlotCount=0){
                        var div;
                        if((top.unsafeData.autoAction==null) && valAutoCrop["forestry"] && (zones.getEndtime(zoneNrF)<=unsafeWindow.Zeit.Server) && (div=$("forestry_building_click"+building))){
                            top.unsafeData.autoAction="berater: forestry building crop";
                            document.addEventListener("gameOpenGlobalCommitBox",function(){
                                document.removeEventListener("gameOpenGlobalCommitBox",arguments.callee,false);
                                window.setTimeout(function(){
                                    click($("globalcommitboxfooter").firstElementChild);
                                    top.unsafeData.autoAction=null;
                                },500);
                            });
                            window.setTimeout(function(div){ click(div); },500,div);
                        }
                        div=null;
                    }
                    createZoneTimer("zoneTimer_"+zoneNrF,zoneNrF,"zonetimer","position:absolute;top:5px;left:50px;",$("forestry_building"+building));
                }
            }
            building=null;res=null;iProd=null;iTime=null;maxCapacity=null;
        }
        // Forest
        zoneNrF="forest";
        err_trace="forest";
        if(unsafeWindow.forestry_unlock){
            var res,zoneNrF,iProd,iProd2,iTime,iWaterTime,building,maxCapacity,div;
            //GM_log("doForestry zoneNrF:"+zoneNrF);
            //maxCapacity=((building=getForestryUserBuilding(1))&&unsafeWindow.forestry_user_buildings[building])?unsafeWindow.forestry_user_buildings[building]['capacity']:100;
            tempZoneProductionData=[[{},{}],BUILDING_SIZE["forest"],BUILDING_SIZE["forest"],true];
            zones.setBlock(zoneNrF,"");
            currBonus=((div=$("forestry_forest_button1_info_locked"))&&(div.style.display=="block")?0:5);
            if(questData["forestry"]["1"]["nr"]>75){ currBonus+=5; }
            zones.setBonus(zoneNrF,currBonus);
            for(var slot in unsafeWindow.forestry_area){ //forestry_area==initForestryResponce->result[1]
                if(!unsafeWindow.forestry_area.hasOwnProperty(slot)){continue;}
                // GM_log("doFestry zoneNrF:"+zoneNrF+" slot:"+slot+" res:"+implode(res,"res"));
                res=unsafeWindow.forestry_area[slot];
                iProd=parseInt(res["productid"],10); // the saplings
                if(unsafeWindow.forestry_production_products[res["category"]]){
                    iProd2=unsafeWindow.forestry_production_products[res["category"]][iProd][5]; // the tree
                }else{
                    iProd2=null;
                }
                if(res["category"]==0){ // garbage
                    if(!tempZoneProductionData[0][1][iProd]){ tempZoneProductionData[0][1][iProd]=0; }
                    tempZoneProductionData[0][1][iProd]++;
                    tempZoneProductionData[1]--;
                    tempZoneProductionData[2]--;
                }else{
                    if(res["block"]>0){ //production has animal on it
                        tempZoneProductionData[1]--;
                        iTime=NEVER;
                        iWaterTime=NEVER;
                    }else if(res["ready"]){
                        tempZoneProductionData[1]--;
                        if(res["ready"]==2){ //production busy, "duration" is reduced by watering
                            iTime=parseInt(res["duration"],10)+parseInt(res["createdate"],10);
                            if(zones.getBonus(zoneNrF)>0){
                                iWaterTime=parseInt(res["waterdate"],10);
                                iWaterTime=((iWaterTime==0)?parseInt(res["createdate"],10):(iWaterTime+86400<iTime?iWaterTime+86400:NEVER));
                            }else{
                                iWaterTime=NEVER;
                            }
                        }else if(res["ready"]==1){ //production ready
                            iTime=parseInt(res["duration"],10)+parseInt(res["createdate"],10);
                            iWaterTime=NEVER;
                        }else{
                            // does this case exist?
                            iTime=NEVER;
                            iWaterTime=NEVER;
                        }
                    }else{
                        iTime=NEVER;
                        iWaterTime=NEVER;
                    }
                    iAmount=prodYield[1][iProd];
                    iPoints=iAmount*prodPoints[1][iProd];
                    if(tempZoneProductionData[0][1][iProd]){
                        var notfound=true;
                        for(var i=0;i<tempZoneProductionData[0][1][iProd].length;i++){
                            if((tempZoneProductionData[0][1][iProd][i][2]==iTime)&&(tempZoneProductionData[0][1][iProd][i][3]==iWaterTime)){
                                tempZoneProductionData[0][1][iProd][i][0]+=iAmount;
                                tempZoneProductionData[0][1][iProd][i][1]+=iPoints;
                                notfound=false;break;
                            }
                        }
                        if(notfound){ tempZoneProductionData[0][1][iProd].push([iAmount,iPoints,iTime,iWaterTime]); }
                    }else{
                        tempZoneProductionData[0][1][iProd]=[[iAmount,iPoints,iTime,iWaterTime]];
                    }
                    if(iProd2!=null){
                        iAmount=prodYield[1][iProd2];
                        iPoints=iAmount*prodPoints[1][iProd2];
                        if(tempZoneProductionData[0][1][iProd2]){
                            var notfound=true;
                            for(var i=0;i<tempZoneProductionData[0][1][iProd2].length;i++){
                                if((tempZoneProductionData[0][1][iProd2][i][2]==iTime)&&(tempZoneProductionData[0][1][iProd2][i][3]==iWaterTime)){
                                    tempZoneProductionData[0][1][iProd2][i][0]+=iAmount;
                                    tempZoneProductionData[0][1][iProd2][i][1]+=iPoints;
                                    notfound=false;break;
                                }
                            }
                            if(notfound){ tempZoneProductionData[0][1][iProd2].push([iAmount,iPoints,iTime,iWaterTime]); }
                        }else{
                            tempZoneProductionData[0][1][iProd2]=[[iAmount,iPoints,iTime,iWaterTime]];
                        }
                    }
                }
            }
            zones.setProduction(zoneNrF,tempZoneProductionData.clone());
            // auto-watering
            if((top.unsafeData.autoAction==null)&&valAutoWater["forestry"]&&(zones.getWatertime(zoneNrF)<=unsafeWindow.Zeit.Server)&&(zones.getBonus(zoneNrF)>0)&&(zones.getProduction(zoneNrF)[1]==0)&&(div=$("forestry_forest_button1"))){
                top.unsafeData.autoAction="berater: forest water";
                window.setTimeout(function(div){
                    click(div);
                    top.unsafeData.autoAction=null;
                },500,div);
            }
            //auto-cropping
            if((top.unsafeData.autoAction==null)&&valAutoCrop["forestry"]&&(zones.getEndtime(zoneNrF)<=unsafeWindow.Zeit.Server) && (!((div=$("forestry_forest_button2_premium"))&&(div.style.display=="block")))&&(div=$("forestry_forest_button2"))){
                top.unsafeData.autoAction="berater: forest crop";
                window.setTimeout(function(div){
                    click(div);
                    top.unsafeData.autoAction=null;
                },500,div.firstElementChild);
            }
            //zonetimer
            div=$("forestry_forest");
            createZoneTimer("zoneTimer_"+zoneNrF,zoneNrF,"zonetimer","position:absolute;top:-20px;right:0;",div);
            if(zones.getBonus(zoneNrF)>0){ createZoneTimer("zoneTimerWater_"+zoneNrF,zoneNrF,"zoneTimerWater","position:absolute;top:-40px;right:0;",div); }
            // stock
            unsafeWindow.forestrySetStockItem(1,Math.max(1,unsafeWindow.forestry_plant),Math.max(1,unsafeWindow.forestry_plant));
            for(var v=1;v<=9;v++){
                if(div=$("f_stock_item"+v)){
                    iProd=parseInt(/f_symbol(\d+)/.exec(div.firstElementChild.className)[1],10);
                    if(iProd&&(div=$("f_stock_growing_"+v))){
                        iTime=calcProductionTime("forest",1,iProd,1-zones.getBonus("forest")/100);
                        div.innerHTML=getTimeStr(iTime,true)+"&nbsp;"+getText("shortHours");
                    }
                }
            }
            // farmies
            for(var i=0;i<unsafeWindow.forestry_farmis.length;i++){
                // GM_log("unsafeWindow.forestry_farmis["+i+"]:\n"+print_r(unsafeWindow.forestry_farmis[i],"",true,"\n"));
                iTime=[0,0];
                for(var j=0;j<unsafeWindow.forestry_farmis[i]["products"].length;j++){
                    iProd = unsafeWindow.forestry_farmis[i]["products"][j]["product"];
                    if(prodTyp[1][iProd]=="f3"){
                        iTime[0]+=calcProductionTime("sawmill",1,iProd,1-zones.getBonus("sawmill")/100)*unsafeWindow.forestry_farmis[i]["products"][j]["amount"]/prodYield[1][iProd];
                    } else if(prodTyp[1][iProd]=="f4"){
                        iTime[1]+=calcProductionTime("carpentry",1,iProd,1-zones.getBonus("carpentry")/100)*unsafeWindow.forestry_farmis[i]["products"][j]["amount"]/prodYield[1][iProd];
                    }
                    if(typeof prodRequire[1][iProd]=="object"){
                        for(var k=0;k<prodRequire[1][iProd].length;k++){
                            iProd2=prodRequire[1][iProd][k];
                            if(prodTyp[iProd2[0]][iProd2[1]]=="f3"){
                                iTime[0]+=calcProductionTime("sawmill",iProd2[0],iProd2[1],1-zones.getBonus("sawmill")/100)*unsafeWindow.forestry_farmis[i]["products"][j]["amount"]*iProd2[2]/prodYield[iProd2[0]][iProd2[1]];
                            } else if(prodTyp[iProd2[0]][iProd2[1]]=="f4"){
                                iTime[1]+=calcProductionTime("carpentry",iProd2[0],iProd2[1],1-zones.getBonus("carpentry")/100)*unsafeWindow.forestry_farmis[i]["products"][j]["amount"]*iProd2[2]/prodYield[iProd2[0]][iProd2[1]];
                            }
                        }
                    }
                }
                div=$("forestry_farmi_info"+(1+i));
                if(div&&div.parentNode){
                    newDiv=$("forestry_farmi_info"+(i+1)+"_createdate");
                    if(!newDiv){
                        newDiv=createElement("div",{"id":"forestry_farmi_info"+(i+1)+"_createdate"});
                        div.insertBefore(newDiv,div.firstElementChild);
                    }
                    newDiv.innerHTML=getDateStr(unsafeWindow.forestry_farmis[i]["createdate"]);
                }
                div=$("forestry_farmi_info_price"+(1+i));
                if(div&&div.parentNode){
                    newDiv=$("forestry_farmi_info"+(i+1)+"_time_sawmill");
                    if(!newDiv){
                        newDiv=createElement("div",{"id":"forestry_farmi_info"+(i+1)+"_time_sawmill"});
                        div.parentNode.parentNode.insertBefore(newDiv,div.parentNode);
                    }
                    newDiv.innerHTML=getText("sawmill")+": "+getTimeStr(iTime[0],true)+"&nbsp;"+getText("shortHours");
                    newDiv=$("forestry_farmi_info"+(i+1)+"_time_carpentry");
                    if(!newDiv){
                        newDiv=createElement("div",{"id":"forestry_farmi_info"+(i+1)+"_time_carpentry"});
                        div.parentNode.parentNode.insertBefore(newDiv,div.parentNode);
                    }
                    newDiv.innerHTML="("+getText("carpentry")+": "+getTimeStr(iTime[1],true)+"&nbsp;"+getText("shortHours")+")";
                    newDiv=$("forestry_farmi_info_price"+(i+1)+"_norm");
                    if(!newDiv){
                        newDiv=createElement("span",{"id":"forestry_farmi_info_price"+(i+1)+"_norm","style":"font-size:8pt;"},div.parentNode);
                    }
                    newDiv.innerHTML="&nbsp;("+moneyFormatInt(unsafeWindow.forestry_farmis[i]["price"]*86400/iTime[0])+"/d)";
                }
                div=$("forestry_farmi_info_points"+(1+i));
                if(div&&div.parentNode){
                    div.innerHTML=numberFormat(unsafeWindow.forestry_farmis[i]["points"]);
                    newDiv=$("forestry_farmi_info_points"+(i+1)+"_norm");
                    if(!newDiv){
                        newDiv=createElement("span",{"id":"forestry_farmi_info_points"+(i+1)+"_norm","style":"font-size:8pt;"},div.parentNode);
                    }
                    newDiv.innerHTML="&nbsp;("+numberFormat(unsafeWindow.forestry_farmis[i]["points"]*86400/iTime[0])+"/d)";
                }
            }
            res=null;pos=null;iProd=null;iProd2=null;iTime=null;iWaterTime=null;iStock=null;building=null;maxCapacity=null;
        }else{
            zones.setBlock(zoneNrF,"q");
            zones.setBonus(zoneNrF,0);
        }
        zoneNrF=null;tempZoneProductionData=null;tempZoneProductionDataSlot=null;
        calcTotalZones();
        err_trace="saving";
        publishProductData();
    }catch(err){GM_logError("doForestry","","err_trace="+err_trace,err);}
    }

    function forestryScrapTreeLog(step,treeId,amount){
    try{
        // GM_log("forestryScrapTreeLog BEGIN step="+step+" treeId="+treeId);
        var action=null,listeningEvent=null;
        switch(step){
        case 1: // click the production icon
            if(amount>0){
                GM_logInfo("forestryScrapTreeLog","step="+step+" treeId="+treeId+" amount="+amount,"","Scrapping Tree Log: tree "+treeId+", left "+amount); // TODO text
                listeningEvent="gameOpenGlobalCommitBox";
                action=function(){ click($("forestry_slot_products"+(3*treeId-2))); };
            }
        break;
        case 2: // click OK. sawmill will be reopened
            listeningEvent="gameSawmillOpened";
            action=function(){ click($("globalcommitboxfooter").children[0]); };
        break;
        case 3: // click Abort
            listeningEvent="gameOpenGlobalCommitBox";
            action=function(){ click($("forestry_slot_cancel"+unsafeWindow.currentslot)); };
        break;
        case 4: // click OK. sawmill will be reopened
            listeningEvent="gameSawmillOpened";
            action=function(){ click($("globalcommitboxfooter").children[0]); };
        break;
        case 5: // open production menu again
            amount--;step=0;
            listeningEvent="gameSawmillSlotOpened";
            action=function(){ click($("forestry_slot"+unsafeWindow.currentslot)); };
        break;
        }
        if(listeningEvent){
            document.addEventListener(listeningEvent,function(listeningEvent,step,treeId,amount){
                return function(){
                    document.removeEventListener(listeningEvent,arguments.callee,false);
                    window.setTimeout(function(){ forestryScrapTreeLog(step+1,treeId,amount); },300);
                };
            }(listeningEvent,step,treeId,amount),false);
        }
        if(action){ action(); }
        listeningEvent=null;action=null;
    }catch(err){GM_logError("forestryScrapTreeLog","step="+step+" treeId="+treeId+" amount="+amount,"",err);}
    }

    unsafeOverwriteFunction("forestryBuySlotResponse",function(request,b){
        try{
            unsafeWindow._forestryBuySlotResponse(request,b);
        }catch(err){GM_logError("_forestryBuySlotResponse","","",err);}
        try{
            var result = checkRequest(request);
            if(result){
                GM_logInfo("forestryBuySlotResponse","","result="+implode(result,"forestryBuySlotResponse/result"),"Begin",1);
                doForestry();
                calcProdMinRack();
            }
        }catch(err){GM_logError("forestryBuySlotResponse","","",err);}
    });
    unsafeOverwriteFunction("initCampaignsResponse",function(request,update){
        try{
            unsafeWindow._initCampaignsResponse(request,update);
        }catch(err){GM_logError("_initCampaignsResponse","","",err);}
        try{
            var result = checkRequest(request);
            if(result&&result[0]!=0){
                GM_logInfo("initCampaignsResponse","","","Begin",1);
                // GM_log("initCampaignsResponse result="+implode(result));
                // GM_log("campaign: result:"+print_r(result));
                for(campaign in QUESTS["forestry"]){
                    if(!QUESTS["forestry"].hasOwnProperty(campaign)){continue;}
                    if(result[1][campaign]){
                        if(result[1][campaign]==0){
                            // campaign not available
                            var newforestryQuestNr = 0;
                            if(questData["forestry"][campaign]["nr"]!=newforestryQuestNr){
                                GM_logInfo("initCampaignsResponse","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"forestry"+campaign)).replace(/%2%/,newforestryQuestNr));
                                questData["forestry"][campaign]["nr"]=newforestryQuestNr;
                                if(questData["forestry"][campaign]["calcTo"]!=0){
                                    setCalcToQuest("forestry",campaign,0);
                                }
                            }
                        }else{
                            // quest available
                            /*
                            GM_log("initCampaignsResponse\ncampaign="+campaign+"\nresult[1][campaign]:\n"+print_r(result[1][campaign],"",true,"\n"));
                            [1]{1}{1}[0]{8} = 300
                            [1]{1}{1}[0]{6} = 2000
                            [1]{1}{entries}{1}[0]{productid} = 8
                            [1]{1}{entries}{1}[0]{sum} = 300
                            [1]{1}{entries}{1}[0]{type} = 1

                            [1]{1}{1}[0]{24} = 1800
                            [1]{1}{1}[1]{21} = 12
                            [1]{1}{1}[1]{41} = 10
                            [1]{1}{entries}{1}[0]{productid} = 24
                            [1]{1}{entries}{1}[0]{sum} = 1800
                            [1]{1}{entries}{1}[0]{type} = 1
                            [1]{1}{entries}{2}[0]{productid} = 21
                            [1]{1}{entries}{2}[0]{sum} = 12
                            [1]{1}{entries}{2}[0]{type} = 2
                            [1]{1}{entries}{2}[1]{productid} = 41
                            [1]{1}{entries}{2}[1]{sum} = 9
                            [1]{1}{entries}{2}[1]{type} = 2
                            */
                            // Time
                            if(result[1][campaign]["remain"]){
                                questData["forestry"][campaign]["time"] = now+result[1][campaign]["remain"];
                            }else if(now<questData["forestry"][campaign]["time"]){
                                questData["forestry"][campaign]["time"] = now;
                            }
                            // Given
                            questData["forestry"][campaign]["given"] = new Object();
                            if(result[1][campaign]["entries"]){
                            for(var t in result[1][campaign]["entries"]){
                                if(!result[1][campaign]["entries"].hasOwnProperty(t)){continue;}
                                for(var i=0;i<result[1][campaign]["entries"][t].length;i++){
                                    var prod = result[1][campaign]["entries"][t][i]["productid"];
                                    var type = parseInt(t,10)-1;
                                    if(!questData["forestry"][campaign]["given"][type]){ questData["forestry"][campaign]["given"][type] = new Object(); }
                                    if(!questData["forestry"][campaign]["given"][type][prod]){ questData["forestry"][campaign]["given"][type][prod] = 0; }
                                    questData["forestry"][campaign]["given"][type][prod] += parseInt(result[1][campaign]["entries"][t][i]["sum"],10);
                                }
                            }
                            }
                            // Number
                            var newforestryQuestNr = parseInt(result[1][campaign]["questid"],10);
                            if((questData["forestry"][campaign]["nr"]!=newforestryQuestNr)||(typeof questData["forestry"][campaign]["nr"]!=typeof newforestryQuestNr)){
                                GM_logInfo("initCampaignsResponse","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"forestry"+campaign)).replace(/%2%/,newforestryQuestNr));
                                questData["forestry"][campaign]["nr"]=newforestryQuestNr;
                                if((0<questData["forestry"][campaign]["calcTo"])&&(questData["forestry"][campaign]["calcTo"]<questData["forestry"][1]["nr"])){
                                    setCalcToQuest("forestry",campaign,questData["forestry"][campaign]["nr"]);
                                }
                            }
                            // Data
                            calcQuestData("forestry",campaign);
                        }
                    }else{
                        // all quests solved
                        var newforestryQuestNr = QUESTS["forestry"][campaign].length;
                        if(questData["forestry"][campaign]["nr"]!=newforestryQuestNr){
                            GM_logInfo("initCampaignsResponse","","",getText("questSetXToNrY").replace(/%1%/,getText("quest"+"forestry"+campaign)).replace(/%2%/,newforestryQuestNr));
                            questData["forestry"][campaign]["nr"]=newforestryQuestNr;
                            if(questData["forestry"][campaign]["calcTo"]!=0){
                                setCalcToQuest("forestry",campaign,0);
                            }
                        }
                    }
                }
                handleQuestLine();
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(questData,"initCampaignsResponse/questData"));
                unsafeData.questData=questData.clone();
                //GM_log("onclick:"+$('forestry_quest_entry' + forestryCampaignNr + '_' + questData["forestry"][1]["nr"] + '_1_6').onclick);

                //make prodName[1] && forestry_stock
                    //GM_log("initCampaignsResponse bChanged:"+ bChanged+" prodName:"+implode(prodName));
                try{
                    var store, fId, bChanged=false;
                    prodStock[1]= new Object();
                    for(store in result[3]){ //forestry_stock
                        if (!result[3].hasOwnProperty(store)){ continue; }
                        for(fId in result[3][store]){
                            if (!result[3][store].hasOwnProperty(fId)){ continue; }
                            // if (!prodName[1][fId]){
                            //  prodName[1][fId] = result[3][store][fId]["name"]; // set prodName[1]
                            //  //GM_log("initCampaignsResponse ADD prodName stock fId:"+fId+" name:"+prodName[1][fId]);
                            //  bChanged=true;
                            // }
                            if(!prodStock[1][fId]) prodStock[1][fId]=0;
                            prodStock[1][fId] += parseInt(result[3][store][fId]["amount"],10);
                        }
                    }
                    for(fId in prodName[1]){
                        if (!prodName[1].hasOwnProperty(fId)){ continue; }
                        if(!prodStock[1][fId]){ prodStock[1][fId]=0; }
                    }
                    store=null;fId=null;
                    // GM_log("initCampaignsResponse bChanged:"+ bChanged+" prodName:"+implode(prodName));
                    if(bChanged){
                        // prodName[1].sortObj();
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_prodName",implode(prodName,"initCampaignsResponse/prodName"));
                    }
                    // prodStock[1].sortObj();
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"initCampaignsResponse/prodStock"));
                }catch(err){GM_logError("initCampaignsResponse","","",err);}
                updateProductDataForestry();
                calcProdMinRack();
                raiseEvent("gameOpenCampaign");
            }
        }catch(err){GM_logError("initCampaignsResponse","","",err);}
    });

    // events city 1 ==============================================================================
    err_trace="events city 1";
    unsafeOverwriteFunction("cityActionResponse",function(request,mode,f,e,d,c){
        try{
            unsafeWindow._cityActionResponse(request,mode,f,e,d,c);
        }catch(err){GM_logError("_cityActionResponse","mode="+mode,"",err);}
        try{
            var result = checkRequest(request);
            if((result!=0)&&(result[0]!=0)){
                switch(mode){
                case "windmillinit": raiseEvent("gameOpenWindmill"); break;
                case "windmillcrop": raiseEvent("gameWindmillCropped"); break;
                case "windmillstartproduction": raiseEvent("gameWindmillStarted"); break;
                }
            }
        }catch(err){GM_logError("cityActionResponse","mode="+mode,"",err);}
    });
    unsafeOverwriteFunction("cityArrived",function(d){
        try{
            unsafeWindow._cityArrived(d);
        }catch(err){GM_logError("_cityArrived","","",err);}
        try{
            gameLocation.set("city",unsafeWindow.city);
            raiseEvent("gameCity"+unsafeWindow.city);
        }catch(err){GM_logError("cityArrived","","",err);}
    });

    // Werbung
    unsafeOverwriteFunction("fillAdColumn",function(){
        try{
            unsafeWindow._fillAdColumn();
        }catch(err){GM_logError("_fillAdColumn","","",err);}
        try{
            var images=$("adzonetooltip1").getElementsByTagName("img");
            if(COUNTRY=="SE"){
                $("adzonetooltip1").firstElementChild.innerHTML=$("adzonetooltip1").firstElementChild.innerHTML.replace(/\.(\d\d) /,",$1 ");
            }
            var preis=parseFloat(/&nbsp;(.*)/.exec($("adzonetooltip1").firstElementChild.innerHTML)[1].replace(regDelimThou,"").replace(regDelimDeci,"."),10);
            createElement("div",{},$("adzonetooltip1"),"<img width='12' height='12' src='"+images[0].getAttribute("src")+"'>/<img width='12' height='12' src='"+images[2].getAttribute("src")+"'>&nbsp;"+moneyFormatInt(preis/8));

            var preis=gut[0]*parseInt(/&nbsp;(\d*)/.exec($("adzonetooltip2").firstElementChild.innerHTML)[1],10);
            createElement("div",{},$("adzonetooltip2"),"<img width='12' height='12' src='"+images[0].getAttribute("src")+"'>/<img width='12' height='12' src='"+images[2].getAttribute("src")+"'>&nbsp;"+moneyFormatInt(preis/16));
            $("adzonetooltip2").firstElementChild.innerHTML +="&nbsp;("+moneyFormatInt(preis)+")";

            var preis=gut[0]*parseInt(/&nbsp;(\d*)/.exec($("adzonetooltip3").firstElementChild.innerHTML)[1],10);
            createElement("div",{},$("adzonetooltip3"),"<img width='12' height='12' src='"+images[0].getAttribute("src")+"'>/<img width='12' height='12' src='"+images[2].getAttribute("src")+"'>&nbsp;"+moneyFormatInt(preis/24));
            $("adzonetooltip3").firstElementChild.innerHTML +="&nbsp;("+moneyFormatInt(preis)+")";
            images=null;
        }catch(err){GM_logError("fillAdColumn","","",err);}
    });

    // Marktschreier
    unsafeOverwriteFunction("openMarktschreiberResponse",function(response){
        try{
            unsafeWindow._openMarktschreiberResponse(response);
        }catch(err){GM_logError("_openMarktschreiberResponse","","",err);}
        try{
            var div,container;
            container=$("marktschreierinnercontent");
            for(var v=0;v<container.childElementCount;v++){
                if(container.children[v].nodeName=="DIV"){
                    div=container.children[v].getElementsByTagName("div")[1];
                    var player=(/\?to=(.*)';/).exec(div.getElementsByTagName("img")[0].getAttribute("onclick"))[1];
                    stats(player,div);
                }
            }
            div=null;container=null;
        }catch(err){GM_logError("openMarktschreiberResponse","","",err);}
    });
    // Competition
    unsafeOverwriteFunction("setCityWBWContentResponse",function(request){
        try{
            unsafeWindow._setCityWBWContentResponse(request);
        }catch(err){GM_logError("_setCityWBWContentResponse","","",err);}
        try{
            var result=checkRequest(request);
            if(result){
            window.setTimeout(function(result){
                if(result[1]['open']==1){
                    var product=parseInt(result[1]['wettbewerb_produkt'],10);
                    GM_setValue(COUNTRY+"_"+SERVER+"_competition",implode([product,result[1]['wettbewerb_ende']],"setCityWBWContentResponse/competition"));
                }else{
                    var help=explode(GM_getValue(COUNTRY+"_"+SERVER+"_competition"),"setCityWBWContentResponse/competition",[]);
                    if(help[1]==result[1]["wettbewerb_ende"]){
                        var product=help[0];
                    }else{
                        var product=-1;
                    }
                }
                if(product>-1){
                    $('localwbwproduct').innerHTML='<div class="kp' + product + '" style="position:absolute; width:15px; height:15px;"></div>';
                    $('localwbwproductname').innerHTML=prodName[0][product];
                }

                cand=document.querySelectorAll("#wbwcontent2ranking>div");
                var newdiv,c,sum=0;
                for(var v=1;v<cand.length;v++){
                    newdiv=cand[v].getElementsByTagName("div");
                    igm(newdiv[2].innerHTML.replace(/&nbsp;.*/,""),newdiv[2]);
                    newdiv[newdiv.length-2].style.textAlign="right";
                    c=parseInt(newdiv[newdiv.length-2].innerHTML,10);
                    newdiv[newdiv.length-2].innerHTML=numberFormat(c);
                    sum += c;
                }
                if(cand.length>1){ cand[1].style.borderBottom="1px solid black"; }
                if(cand.length>15){ cand[15].style.borderBottom="1px solid black"; }
                if(cand.length>50){ cand[50].style.borderBottom="1px solid black"; }
                newdiv=null;
                $("localwbwproductname").innerHTML += "&nbsp;(∑&nbsp;"+numberFormat(sum)+")";
                if(result[1]['open']!=1){
                    nextproduct=parseInt(result[1]['wettbewerb_produkt'],10);
                    if(nextproduct>0){
                        $("localwbwproductname").innerHTML += "&nbsp;(&rarr;"+prodName[0][nextproduct]+"?)";
                    }
                }
            },0,result);
        }
        }catch(err){GM_logError("setCityWBWContentResponse","","",err);}
    });

    // events city 2 ==============================================================================
    err_trace="events city 2";
    if(USERLEVEL>=8){
        // arrival in city2
        err_trace="events city 2: arrival in city2";
        document.addEventListener("gameCity2",function(){
            try{
                createZoneTimer("zoneTimer_windmill","windmill","zonetimer","position:absolute;top:80px;left:0px;",$("cityzone_2_1"));

/*
            //QUESTS["forestry"]["campaign"]["nr"][[type,id,amount],waittime,points,more|undefined]
            //more:
            //0,id of type 1 product
            //1,id of type 2 product
            //2,special name
            // Generate QUESTS["forestry"]
                var cand,camp,qnr,inf,maxi,help,help2, forest_quest=new Array(),foresty_prods_after_quest=new Object();
                var cells = $("forestry_questlist_container").querySelectorAll("div[id^=\"forestry_questlist_item\"]");
                for(var i=0;i<cells.length;i++){
                    inf = cells[i].id.replace("forestry_questlist_item","").split("_");
                    camp = inf[0];
                    qnr = inf[1];
                    if (!forest_quest[camp]) forest_quest[camp]= new Array();
                    if (!forest_quest[camp][qnr]) forest_quest[camp][qnr]= [[],,0,[]];
                    cand = $("forestry_quest_require"+camp+"_"+qnr);
                    for(var k=0;k<cand.childElementCount;k=k+2){
                        inf = cand.children[k].id.replace("forestry_quest_entry","").split("_");
                        maxi = $("forestry_quest_amount_max"+camp+"_"+qnr+"_"+inf[2]+"_"+inf[3]).innerHTML;
                        forest_quest[camp][qnr][0].push([parseInt(inf[2],10)-1,parseInt(inf[3],10),parseInt(maxi,10)]);
                        //$("forestry_tt_"+camp+"_"+qnr+"_"+inf[2]+"_"+inf[3])
                    }
                    cand = $("forestry_quest_reward"+camp+"_"+qnr);
                    for(var k=1;k<cand.childElementCount;k++){
                        cand2 = cand.children[k];
                        if(cand2.childElementCount==1){
                            forest_quest[camp][qnr][3].push([2,cand2.children[0].innerHTML]);
                        }else if(cand2.childElementCount==3){
                            if(help = cand2.children[0].className.match(/kp(\d+)/i)){//Not used yet
                                maxi = cand2.children[1].innerHTML.match(/&nbsp;(\d+)x ([A-z]*)/i);
                                forest_quest[camp][qnr][3].push([0,parseInt(help[1],10),parseInt((maxi&&maxi[1]?maxi[1]:1),10)]);
                            }else if(help = cand2.children[0].className.match(/f_m_symbol(\d+)/i)){
                                maxi = cand2.children[1].innerHTML.match(/&nbsp;(\d+)x ([A-z]*)/i);
                                forest_quest[camp][qnr][3].push([1,parseInt(help[1],10),parseInt((maxi&&maxi[1]?maxi[1]:1),10)]);
                                foresty_prods_after_quest[parseInt(help[1],10)]= qnr;
                            }else if(help=cand2.children[1].innerHTML.match(/\&nbsp;(\d+)\&nbsp;punten/i)){
                                forest_quest[camp][qnr][2]=parseInt(help[1],10);
                            }else{
                                forest_quest[camp][qnr][3].push([2,cand2.children[1].innerHTML]);
                            }
                        }
                    }
                }
                cells=null;cand=null;inf=null;help=null;cand2=null;
                GM_log("forest_quest"+implode(forest_quest));
                GM_log("foresty_prods_after_quest"+implode(foresty_prods_after_quest));
*/

            //make forestry naming
            /*
                var cand,camp,qnr,inf,maxi,help,help2,bChanged=false;
                var cells = $("forestry_questlist_container").querySelectorAll("div[id^=\"forestry_questlist_item\"]");
                for(var i=0;i<cells.length;i++){
                    inf = cells[i].id.replace("forestry_questlist_item","").split("_");
                    camp = inf[0];
                    qnr = inf[1];
                    cand = $("forestry_quest_require"+camp+"_"+qnr);
                    for(var k=0;k<cand.childElementCount;k=k+2){
                        inf = cand.children[k].id.replace("forestry_quest_entry","").split("_");
                        if(inf[2]==2){
                            prodName[1][inf[3]] = $("forestry_tt_"+camp+"_"+qnr+"_"+inf[2]+"_"+inf[3]).innerHTML; // set prodName[1]
                            //GM_log("gameCity2 ADD prodName quest1 fId:"+inf[3]+" name:"+prodName[1][inf[3]]);
                            bChanged=true;
                        }
                    }
                    cand = $("forestry_quest_reward"+camp+"_"+qnr);
                    for(var k=0;k<cand.childElementCount;k=k+2){
                        inf = cand.children[k].id.replace("forestry_quest_entry","").split("_");
                        if(inf[2]==2){
                            prodName[1][inf[3]] = $("forestry_tt_"+camp+"_"+qnr+"_"+inf[2]+"_"+inf[3]).innerHTML; // set prodName[1]
                            //GM_log("gameCity2 ADD prodName quest2 fId:"+inf[3]+" name:"+prodName[1][inf[3]]);
                            bChanged=true;
                        }
                    }
                    cand = $("forestry_quest_reward"+camp+"_"+qnr);
                    for(var k=1;k<cand.childElementCount;k++){
                        cand2 = cand.children[k];
                        if(cand2.childElementCount==3){
                            if(help = cand2.children[0].className.match(/f_m_symbol(\d+)/i)){
                                maxi = cand2.children[1].innerHTML.match(/&nbsp;((\d+)?x?\s?)?(.*)/i); //OLD &nbsp;((\d+)x\s)?([A-z\s]*)/i);
                                if(maxi[3]){
                                    prodName[1][help[1]] = maxi[3]; // set prodName[1]
                                    //GM_log("gameCity2 ADD prodName quest3 fId:"+help[1]+" name:"+prodName[1][help[1]]+" maix:"+implode(maxi));
                                    bChanged=true;
                                }
                            }
                        }
                    }
                }

                cells=null;cand=null;inf=null;help=null;
                //GM_log("gameCity2 bChanged:"+ bChanged+" prodName:"+implode(prodName));
                if(bChanged){
                    prodName[1].sortObj();
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_prodName",implode(prodName));
                }
                */
            }catch(err){GM_logError("gameCity2.listener","","",err);}
        },false);
        // windmill production
        err_trace="events city 2: windmillSlots";
        unsafeOverwriteFunction("windmillSlots",function(){
            try{
                unsafeWindow._windmillSlots();
            }catch(err){ GM_logError("_windmillSlots","","",err); }
            try{
                var zoneNrF="windmill";
                var zoneNrS;
                zones.setBlock(zoneNrF,"");
                var tempZoneProductionData,tempZoneProductionDataSlot,iProd,iAmount,iPoints,iTime,currBlock;
                var iPrTyp=3;
                tempZoneProductionData=[[],0,0,true];
                tempZoneProductionData[0][iPrTyp]={};
                for(var slot=1;slot<=2;slot++){
                    zoneNrS=zoneNrF+"."+slot;
                    currBlock=(((slot==2)&&(unsafeWindow.windmill_slotremain<=0))?"b":"");
                    zones.setBlock(zoneNrS,currBlock);
                    if(!currBlock){
                        tempZoneProductionDataSlot=[[],0,0,true];
                        tempZoneProductionDataSlot[0][iPrTyp]={};
                        if(unsafeWindow.windmill_slots[slot]){
                            iProd=(unsafeWindow.windmill_slots[slot]["formula"]?parseInt(unsafeWindow.windmill_slots[slot]["formula"],10):null);
                            if(isNaN(iProd)){ iProd=null; }
                            if((iProd!=null)&&(unsafeWindow.windmill_slots[slot]["end"])){ // production ready or busy
                                iTime=parseInt(unsafeWindow.windmill_slots[slot]["end"],10);
                            }else{ // no production
                                iTime=NEVER;
                                tempZoneProductionData[1]++;
                                tempZoneProductionDataSlot[1]++;
                            }
                            // iAmount=(res[slot]["amount"]?res[slot]["amount"]:null);
                            tempZoneProductionData[2]++;
                            tempZoneProductionDataSlot[2]++;
                            if(iProd!=null){
                                iAmount=prodYield[iPrTyp][iProd];
                                iPoints=iAmount*prodPoints[iPrTyp][iProd];
                                if(!tempZoneProductionData[0][iPrTyp][iProd]){ tempZoneProductionData[0][iPrTyp][iProd]=[]; }
                                tempZoneProductionData[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
                                tempZoneProductionDataSlot[0][iPrTyp][iProd]=[];
                                tempZoneProductionDataSlot[0][iPrTyp][iProd].push([iAmount,iPoints,iTime,NEVER]);
                            }
                        }
                        zones.setProduction(zoneNrS,tempZoneProductionDataSlot.clone());
                    }
                }
                zones.setProduction(zoneNrF,tempZoneProductionData.clone());
                calcTotalZones();
                publishProductData();
            }catch(err){ GM_logError("windmillSlots","","",err); }
        });
        // windmill stock
        err_trace="events city 2: windmillStock";
        unsafeOverwriteFunction("windmillStock",function(){
            try{
                unsafeWindow._windmillStock();
            }catch(err){GM_logError("_windmillStock","","",err);}
            try{
                for(var i=0;i<prodStock[2].length;i++){
                    prodStock[2][i]=0;
                }
                if (unsafeWindow.windmill_stock) {
                    for (var prodId in unsafeWindow.windmill_stock) {
                        prodStock[2][parseInt(prodId,10)]=parseInt(unsafeWindow.windmill_stock[prodId]["amount"],10);
                    }
                }
                //updateProductDataWindmill();
                unsafeData.prodStock = prodStock.clone();
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"windmillStock/prodStock"));
            }catch(err){ GM_logError("windmillStock","","",err); }
        });
        // windmill dialog
        err_trace="events city 2: windmillDialog";
        unsafeOverwriteFunction("windmillDialog",function(mode,q,a){
            try{
                unsafeWindow._windmillDialog(mode,q,a) ;
            }catch(err){ GM_logError("_windmillDialog","","",err); }
            try{
                switch(mode){
                case "windmillstartproduction": {
                    raiseEvent("gameWindmillDialogStart");
                break; }
                case "windmillstartproductioncommit": {
                    var currAmount,currProd;
                    if (unsafeWindow.formulas[0][a] && unsafeWindow.formulas[0][a][3].length) {
                        var m = unsafeWindow.formulas[0][a][3];
                        for (var b = 0; b < m.length; b++) {
                            currProd= m[b][0];
                            currAmount= m[b][1];
                            if(prodStock[0][currProd]-currAmount<prodMinRack[0][currProd]){
                                createElement("div",{"class":"blackbox alertbox","style":"position:absolute;left:0;top:240px;"},$("windmill_paper_headline"),getText("alertWillLowRack"));
                                break;
                            }
                        }
                    }
                    raiseEvent("gameWindmillDialogCommit");
                break; }
                }
            }catch(err){GM_logError("windmillDialog","","",err);}
        });

        // Clothing donation
        /*
         * Contribution/Author: Moe
         */
        err_trace="events city 2: showClothingDonation";
        unsafeOverwriteFunction("showClothingDonation",function(){
            try{
                unsafeWindow._showClothingDonation() ;
            }catch(err){GM_logError("_showClothingDonation","","",err);}
            try{
                var data = unsafeWindow.clothingdonation_data.data.data;
                var goodsValue = [0,0];
                var div;
                var prodId;
                // input
                var container=$("clothingdonation_inner_left_inner");
                for (var b in data["in"]) {
                    prodId=parseInt(b,10);
                    div=container.querySelector(".l"+prodId).nextElementSibling;
                    div.parentNode.setAttribute("prod",prodId);
                    div.parentNode.setAttribute("class","link");
                    div.parentNode.addEventListener("click",function(event){ showMarket(this.getAttribute("prod")); },false);
                    div.parentNode.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                    if(gut[prodId]){
                        goodsValue[0]+=data["in"][b].amount*gut[prodId];
                        div.innerHTML+="<br>"+moneyFormatInt(data["in"][b].amount*gut[prodId]);
                    }else{
                        goodsValue[0]=0;
                        break;
                    }
                }
                createElement("div",{"class":"blackbox","style":"position:absolute;top:70px;left:5px;;"},container,goodsValue[0]>0?moneyFormatInt(goodsValue[0]):"---");
                // output
                container=$("clothingdonation_inner_right_inner");
                for (var b in data["out"]) {
                    prodId=parseInt(b,10);
                    div=container.querySelector(".l"+prodId).nextElementSibling;
                    div.parentNode.setAttribute("prod",prodId);
                    div.parentNode.setAttribute("class","link");
                    div.parentNode.addEventListener("click",function(event){ showMarket(this.getAttribute("prod")); },false);
                    div.parentNode.addEventListener("mouseover",function(event){ showGoToMarketToolTip(event,this.getAttribute("prod")); },false);
                    if(gut[prodId]){
                        goodsValue[1]+=data["out"][b].amount*gut[prodId];
                        div.innerHTML+="<br>"+moneyFormatInt(data["out"][b].amount*gut[prodId]);
                    }else{
                        goodsValue[1]=0;
                        break;
                    }
                }
                createElement("div",{"class":"blackbox","style":"position:absolute;top:70px;right:5px;;"},container,goodsValue[0]>0?moneyFormatInt(goodsValue[1]):"---");
                // Level percent
                div=$("clothingdonation_level_percentage");
                if(!div){
                    div=createElement("div",{"id":"clothingdonation_level_percentage","class":"blackbox","style":"position:absolute;top:5px;right:100px;;"},$("clothingdonation_levelouter"));
                }
                div.innerHTML = numberFormat(unsafeWindow.clothingdonation_data.data.percent)+"%";
                div=null; container=null;

                var button=createElement("button", {"class":"link button_new","style":"position:absolute;bottom:42px;left:0px;"}, $("clothingdonation_inner"), getText("clothingDonationLog"));
                button.addEventListener("click",function(){unsafeWindow.buildInfoPanel("clothingDonation");},false);
                button=null;

                clothingDataAvailable(unsafeWindow.clothingdonation_data.data, goodsValue);
            }catch(err){ GM_logError("showClothingDonation","","prodId="+prodId,err); }
        });

        // Recipedealer
        err_trace="events city 2: Recipedealer";
        document.addEventListener("gameUpdateFormuladealerOffers", function(event){
            var newdiv,newtable,newtr,newtd;
            for(var v=1;v<4;v++){
                newdiv=$("formuladealerproduct"+v);
                newdiv.setAttribute("class","");

                newdiv=newdiv.getElementsByTagName("div")[0];
                var str=newdiv.getAttribute("class");
                newdiv.setAttribute("class","link "+str);
                var formula=parseInt(str.replace("fm",""),10);

                newdiv=$("formuladealerproduct"+v+"berater");
                if(newdiv){
                    newdiv.innerHTML="";
                }else{
                    newdiv=createElement("div",{"id":"formuladealerproduct"+v+"berater","class":"blackbox","style":"position:absolute;top:70px;"},$("formuladealerproduct"+v));
                }
                var sum=0;

                newtable=createElement("table",{"cellspacing":"0","style":"text-align:right;"},newdiv);
                newtr=createElement("tr",{"class":"hoverBgCc9"},newtable);
                newtr.addEventListener("mouseover",function(event){ toolTip.show(event,getText("price")); },false);
                createElement("td",{},newtr,"-");
                newtd=createElement("td",{},newtr);
                if(unsafeWindow.formulas[0][formula][6]>0){
                    newtd.innerHTML=numberFormat(unsafeWindow.formulas[0][formula][6]);
                    sum -= unsafeWindow.formulas[0][formula][6];
                }else if(unsafeWindow.formulas[0][formula][7]>0){
                    newtd.innerHTML=numberFormat(unsafeWindow.formulas[0][formula][7]*gut[0]);
                    sum -= unsafeWindow.formulas[0][formula][7]*gut[0];
                }
                var sum1=0;
                str='<table>';
                str += '<tr><th colspan="4" class="lightBg">'+getText("ingredients")+'</th></tr>';
                for(var w=0;w<unsafeWindow.formulas[0][formula][3].length;w++){
                    sum1 += unsafeWindow.formulas[0][formula][3][w][1]*gut[unsafeWindow.formulas[0][formula][3][w][0]];
                    str += '<tr><td>'+produktPic(0,unsafeWindow.formulas[0][formula][3][w][0],createElement("div")).parentNode.innerHTML+'</td>';
                    str += '<td style="text-align:right;">'+numberFormat(unsafeWindow.formulas[0][formula][3][w][1])+'&nbsp;'+"×"+'</td>';
                    str += '<td style="text-align:right;">'+moneyFormat(gut[unsafeWindow.formulas[0][formula][3][w][0]])+'&nbsp;=</td>';
                    str += '<td style="text-align:right;">'+moneyFormatInt(unsafeWindow.formulas[0][formula][3][w][1]*gut[unsafeWindow.formulas[0][formula][3][w][0]])+'</td></tr>';
                }
                str += '</table>';

                newtr=createElement("tr",{"class":"hoverBgCc9","mouseOverText":str},newtable);
                newtr.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
                createElement("td",{},newtr,"-");
                createElement("td",{},newtr,numberFormat(sum1));
                sum -= sum1;

                if(unsafeWindow.formulas[0][formula][5][0]!=0){
                    sum1=unsafeWindow.formulas[0][formula][5][0][1]*gut[unsafeWindow.formulas[0][formula][5][0][0]];
                    sum += sum1;
                    str='<table>';
                    str += '<tr><th colspan="3" class="lightBg">'+getText("gain")+'</th></tr>';
                    str += '<tr><td>'+produktPic(0,unsafeWindow.formulas[0][formula][5][0][0],createElement("div")).parentNode.innerHTML+'</td>';
                    str += '<td style="text-align:right;">'+numberFormat(unsafeWindow.formulas[0][formula][5][0][1])+'&nbsp;'+"×"+'</td>';
                    str += '<td style="text-align:right;">'+moneyFormat(gut[unsafeWindow.formulas[0][formula][5][0][0]])+'</td>';
                    str += '</table>';
                    newtr=createElement("tr",{"class":"hoverBgCc9","mouseOverText":str},newtable);
                    newtr.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
                    createElement("td",{},newtr,"+");
                    createElement("td",{},newtr,numberFormat(sum1));
                }
                if(unsafeWindow.formulas[0][formula][5][1]!=0){
                    var c=0;
                    for(var i=0;i<ALL_ZONES["farm"].length;i++){
                        var zoneNr=ALL_ZONES["farm"][i];
                        if((!zones.getBlock(zoneNr))&&(zones.getBuilding(zoneNr)==1)){
                            c += Math.ceil(calcGrowTimes(60*prodGrowTime[0][unsafeWindow.formulas[0][formula][5][1][0]],unsafeWindow.formulas[0][formula][5][1][2],1-(zones.getBonus(zoneNr)/100)))*BUILDING_SIZE["1"]/prodPlantSize[0][unsafeWindow.formulas[0][formula][5][1][0]];
                        }
                    }
                    sum1=c*unsafeWindow.formulas[0][formula][5][1][1]*gut[unsafeWindow.formulas[0][formula][5][1][0]];
                    sum += sum1;
                    str='<table>';
                    str += '<tr><th colspan="4" class="lightBg">'+getText("gain")+'</th></tr>';
                    str += '<tr><td>'+produktPic(0,unsafeWindow.formulas[0][formula][5][1][0],createElement("div")).parentNode.innerHTML+'</td>';
                    str += '<td style="text-align:right;">'+numberFormat(c)+'&nbsp;'+"×"+'</td>';
                    str += '<td style="text-align:right;">'+numberFormat(unsafeWindow.formulas[0][formula][5][1][1])+'&nbsp;'+"×"+'</td>';
                    str += '<td style="text-align:right;">'+moneyFormat(gut[unsafeWindow.formulas[0][formula][5][1][0]])+'</td>';
                    str += '</table>';
                    newtr=createElement("tr",{"class":"hoverBgCc9","mouseOverText":str},newtable);
                    newtr.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
                    createElement("td",{},newtr,"+");
                    createElement("td",{},newtr,numberFormat(sum1));
                }

                newtr=createElement("tr",{},newtable);
                createElement("td",{"colspan":"2","style":"border-top:1px solid black;"},newtr,numberFormat(sum));
                if(unsafeWindow.formulas[0][formula][5][2]!=0){
                    var c=0;
                    for(var i=0;i<ALL_ZONES["farm"].length;i++){
                        var zoneNr=ALL_ZONES["farm"][i];
                        if((!zones.getBlock(zoneNr))&&(zones.getBuilding(zoneNr)==1)){
                        c += Math.ceil(calcGrowTimes(60*prodGrowTime[0][unsafeWindow.formulas[0][formula][5][2][0]],unsafeWindow.formulas[0][formula][5][2][2],1-(zones.getBonus(zoneNr)/100)))*BUILDING_SIZE["1"]/prodPlantSize[0][unsafeWindow.formulas[0][formula][5][2][0]];
                        }
                    }
                    sum1=c*unsafeWindow.formulas[0][formula][5][2][1];
                    str='<table>';
                    str += '<tr><th colspan="2" class="lightBg">'+getText("points")+'</th></tr>';
                    str += '<tr><td style="text-align:right;">'+numberFormat(c)+'&nbsp;'+"×"+'</td>';
                    str += '<td style="text-align:right;">'+pointsFormat(unsafeWindow.formulas[0][formula][5][2][1],"span",createElement("div")).parentNode.innerHTML+'</td>';
                    str += '</table>';
                    newtr=createElement("tr",{"class":"hoverBgCc9","mouseOverText":str},newtable);
                    newtr.addEventListener("mouseover",function(event){ toolTip.show(event,this.getAttribute("mouseOverText")); },false);
                    newtd=createElement("td",{"colspan":"2"},newtr);
                    pointsFormat(sum1,"div",newtd);
                }

                newtr=createElement("tr",{"class":"hoverBgCc9"},newtable);
                newtd=createElement("td",{"colspan":"2"},newtr);
                pointsFormat(unsafeWindow.formulas[0][formula][8],"div",newtd);
            }

            // Powerups
            if(unsafeWindow.poweruprack){
                newdiv=$("powerups");
                if(newdiv){
                    newdiv.innerHTML="";
                }else{
                    createElement("div",{id:"powerupsbackground",style:"background-color:black;width:560px;right:0;opacity:0.5;position:absolute;bottom:0;height:80px;"},$("formuladealer"));
                    newdiv=createElement("div",{id:"powerups",style:"height:80px;bottom:0;right:0;position:absolute;vertical-align:top;"},$("formuladealer"));
                }
                var newRID;
                for(var v in unsafeWindow.poweruprack){
                    if(!unsafeWindow.poweruprack.hasOwnProperty(v)){continue;}
                    aMount=parseInt(unsafeWindow.poweruprack[v]["rack"],10);
                    rId=parseInt(unsafeWindow.poweruprack[v][0],10);
                    newRID=createElement("div",{onmouseout:"$('formuladealerproductinfo').innerHTML=''; hideDiv('formuladealerproductinfo');",onmouseover:"$('formuladealerproductinfo').innerHTML=showFormulaInfos("+rId+"); showDiv('formuladealerproductinfo');",style:"height: 25px; width: 25px; position: relative; margin-top: 7px; float: right; margin-right: 10px;"});
                    newdiv.insertBefore(newRID, newdiv.firstElementChild);
                    createElement("div", {"class":"fmm"+rId},newRID);
                    createElement("div", {style:"position:absolute;bottom:-2px;right:-2px;font-weight:normal;color:white;"},newRID,aMount);
                }
                newRID=null;
            }
            newdiv=null;newtable=null;newtr=null;newtd=null;
        },false);
        unsafeOverwriteFunction("setFormulaDealerFormulas",function(){
            try{
                unsafeWindow._setFormulaDealerFormulas();
            }catch(err){GM_logError("_setFormulaDealerFormulas","","",err);}
            try{
                raiseEvent("gameUpdateFormuladealerOffers");
            }catch(err){GM_logError("setFormulaDealerFormulas","","",err);}
        });
        unsafeOverwriteFunction("setFormulaDealerRack",function(rack){
            try{
                unsafeWindow._setFormulaDealerRack(rack);
            }catch(err){GM_logError("_setFormulaDealerRack","","",err);}
            try{
                for(var i=0;i<prodStock[2].length;i++){
                    prodStock[2][i]=0;
                }
                for(var i=0;i<rack.length;i++){
                    prodStock[2][parseInt(rack[i]["fid"],10)]=parseInt(rack[i]["amount"],10);
                }
                unsafeData.prodStock = prodStock.clone();
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_prodStock",implode(prodStock,"setFormulaDealerRack/prodStock"));
                raiseEvent("gameUpdateFormuladealerRack");
            }catch(err){GM_logError("setFormulaDealerRack","","",err);}
        });

        // Lottery
        err_trace="events city 2: Lottery";
        // lotteryLog[]=[day,id of daily lot,exchanged products|null|undefined,id's of bought lots|undefined]
        lotteryLog=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog"),"do_main/lotteryLog",[]);
        if(!(lotteryLog instanceof Array)){ lotteryLog = []; }
        function setLotteryLogId(){
            lotteryLog.sort(sortObjFunctions["date"]);
            for(lotteryLogId=lotteryLog.length-1;lotteryLogId>=0;lotteryLogId--){
                if(lotteryLog[lotteryLogId][0]==todayServerStr){ return; }
            }
            lotteryLog.push([todayServerStr]);
            setLotteryLogId();
        }
        setLotteryLogId();
        if($top("lotterycontainer")){
            function showGoToLottery(){
                nodes["goToLottery"]=new Object();
                nodes["goToLottery"]["node"]=createElement("div",{"id":"divGoToLottery","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"city/city2_back2.jpg') 440px 430px;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;","mouseOverText":getText("goToLottery")},$("fixedDivRight"));
                nodes["goToLottery"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("goToLottery")); },false);
                nodes["goToLottery"]["node"].addEventListener("click",function(event){ showLottery(); },false);
                raiseEvent("gameLotteryDailyLotAvailable");
            }
            if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLastLot")!=todayStr){ showGoToLottery(); }

            function hideGoToLottery(){
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLastLot",todayStr);
                if(nodes["goToLottery"]){
                    if(nodes["goToLottery"]["node"]){ removeElement(nodes["goToLottery"]["node"]); }
                    delete nodes["goToLottery"];
                }
            }

            unsafeOverwriteFunction("updateLotRack",function(){
                try{
                    unsafeWindow._updateLotRack();
                }catch(err){GM_logError("_updateLotRack","","",err);}
                window.setTimeout(function(){
                try{
                    if(unsafeData.lotteryCollectForPrize){
                        var lotteryCollectForPrize=unsafeData.lotteryCollectForPrize.clone();
                    }else{
                        var lotteryCollectForPrize=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryCollectForPrize"),"updateLotRack/lotteryCollectForPrize",{});
                    }
                    if (!lotteryCollectForPrize["total"]){ lotteryCollectForPrize["total"]=new Array(); }
                    var newdiv;
                    var lrack=$("lotsrack");
                    for(var v=0;v<lrack.childElementCount;v++){
                        var lotid=lrack.children[v].style.backgroundImage.match(/lot_(\d+).png/i)[1];
                        if (!lotteryCollectForPrize["total"][lotid]){ lotteryCollectForPrize["total"][lotid]=0; }
                        //if (!$("lotlack"+lotid)){
                        newdiv=createElement("div",{"id":"lotlack"+lotid,"style":"position:absolute;right:8px;top:5px;font-size:14px;font-weight:bold;color:#fff;padding:2px;"},lrack.children[v]);
                        var help=(unsafeWindow.lotrack[lotid]?unsafeWindow.lotrack[lotid]:0)-lotteryCollectForPrize["total"][lotid];
                        if(help<=0){
                            newdiv.innerHTML=help;
                            newdiv.style.backgroundColor="#AA0000";
                        }else{
                            newdiv.innerHTML=+help;
                            newdiv.style.backgroundColor="green";
                        }
                    }
                    lrack=null;
                    newdiv=null;

                }catch(err){GM_logError("updateLotRack","","",err);}
                },0);
            });
            unsafeOverwriteFunction("updateLotteryPrizes",function(item){
                try{
                    unsafeWindow._updateLotteryPrizes(item);
                }catch(err){GM_logError("_updateLotteryPrizes","","",err);}
                window.setTimeout(function(){
                try{
                    if(unsafeData.lotteryCollectForPrize){
                        var lotteryCollectForPrize=unsafeData.lotteryCollectForPrize.clone();
                    }else{
                        var lotteryCollectForPrize=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryCollectForPrize"),"updateLotteryPrizes/lotteryCollectForPrize",{});
                    }
                    // delete collecting of missing prizes
                    for(var v in lotteryCollectForPrize){
                        if(!lotteryCollectForPrize.hasOwnProperty(v)){ continue; }
                        if(isNaN(v)){ continue; }
                        if(!unsafeWindow.lotteryprizes[v]){
                            lotteryCollectForPrize[v]=false;
                            //Calc new totals
                            lotteryCollectForPrize["total"]=new Array();
                            for(var prizeId in unsafeWindow.lotteryprizes){
                                if(!unsafeWindow.lotteryprizes.hasOwnProperty(prizeId)){ continue; }
                                if (lotteryCollectForPrize[prizeId]){
                                    for(var v in unsafeWindow.lotteryprizes[prizeId][1]){
                                        if(!unsafeWindow.lotteryprizes[prizeId][1].hasOwnProperty(v)){ continue; }
                                        var flid=unsafeWindow.lotteryprizes[prizeId][1][v][0];
                                        if (!lotteryCollectForPrize["total"][flid]) lotteryCollectForPrize["total"][flid]=0;
                                        lotteryCollectForPrize["total"][flid] += unsafeWindow.lotteryprizes[prizeId][1][v][1];
                                        flid=null;
                                    }
                                    v=null;
                                }
                            }
                        }
                    }

                    var divLotteryprizes=$("lotteryprizes");
                    var cell;
                    for(var v=0;v<divLotteryprizes.childElementCount;v++){
                        if(!divLotteryprizes.children[v].id.match(/lotteryprize\d+/)){ continue; }
                        var prizeId=parseInt(divLotteryprizes.children[v].id.replace("lotteryprize",""),10);
                        if (lotteryCollectForPrize[prizeId]===undefined){ lotteryCollectForPrize[prizeId]=false; }
                        cell=createElement("input",{"id":"inputLotteryCollectForPrize"+prizeId,"class":"link","type":"checkbox","checked":lotteryCollectForPrize[prizeId],"style":"position:absolute;top:35px;left:10px;"},divLotteryprizes.children[v].firstElementChild);
                        cell.addEventListener("click",function(){
                            var prizeId=parseInt(this.id.replace("inputLotteryCollectForPrize",""),10);
                            var lotteryCollectForPrize=unsafeData.lotteryCollectForPrize.clone();
                            lotteryCollectForPrize[prizeId]=this.checked;

                            //Calc new totals
                            lotteryCollectForPrize["total"]=new Array();
                            for(var prizeId in unsafeWindow.lotteryprizes){
                                if(!unsafeWindow.lotteryprizes.hasOwnProperty(prizeId)){ continue; }
                                if (lotteryCollectForPrize[prizeId]){
                                    for(var v in unsafeWindow.lotteryprizes[prizeId][1]){
                                        if(!unsafeWindow.lotteryprizes[prizeId][1].hasOwnProperty(v)){ continue; }
                                        var flid=unsafeWindow.lotteryprizes[prizeId][1][v][0];
                                        if (!lotteryCollectForPrize["total"][flid]) lotteryCollectForPrize["total"][flid]=0;
                                        lotteryCollectForPrize["total"][flid] += unsafeWindow.lotteryprizes[prizeId][1][v][1];
                                        flid=null;
                                    }
                                    v=null;
                                }
                            }
                            prizeId=null;
                            // lotteryCollectForPrize.sortObj();
                            GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryCollectForPrize", implode(lotteryCollectForPrize,"updateLotteryPrizes/lotteryCollectForPrize"));
                            unsafeData.lotteryCollectForPrize=lotteryCollectForPrize.clone();
                            unsafeWindow.updateLotRack();
                        },false);
                        // position:absolute; top:0px; left:0px; width:40px; height:40px;
                        // mouseover-div
                        cell=divLotteryprizes.children[v].children[1].firstElementChild;
                        for(var w=0;w<unsafeWindow.lotteryprizes[prizeId][1].length;w++){
                            var help=(unsafeWindow.lotrack[unsafeWindow.lotteryprizes[prizeId][1][w][0]]?unsafeWindow.lotrack[unsafeWindow.lotteryprizes[prizeId][1][w][0]]:0);
                            // cell.children[w].children[1].innerHTML += "<br>"+help;
                            help=Math.min(100,Math.round(100*help/unsafeWindow.lotteryprizes[prizeId][1][w][1]));
                            createElement("div",{"style":"position:absolute;top:0;left:0;height:5px;width:"+help+"%;background:green;"},cell.children[w]);
                            createElement("div",{"style":"position:absolute;top:0;right:0;height:5px;width:"+(100-help)+"%;background:#c00;"},cell.children[w]);
                        }
                    }
                    divLotteryprizes=null;
                    cell=null;
                    unsafeData.lotteryCollectForPrize=lotteryCollectForPrize.clone();
                }catch(err){GM_logError("updateLotteryPrizes","","",err);}
                },0);
            });
            unsafeOverwriteFunction("initLotteryResponse",function(response){
                try{
                    unsafeWindow._initLotteryResponse(response);
                }catch(err){GM_logError("_initLotteryResponse","","",err);}
                window.setTimeout(function(response){
                    try{
                        // [1(isOk), [...](lotrack), 1(dailyLotTaken), 0(id), {...}(lotteryprizes), 0(won products)]
                        if(response[2]!=0){
                            hideGoToLottery();
                        }
                        // Log-Button
                        var button=createElement("button",{"class":"link button_new","style":"position:absolute;bottom:120px;right:30px;"},$("lotterycontainer"),getText("lotteryLog"));
                        button.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("lottery"); },false);
                        button=null;
                        //unsafeWindow.updateLotRack();
                        raiseEvent("gameLotteryOpen");
                    }catch(err){GM_logError("initLotteryResponse","","",err);}
                },0,response);
            });
            unsafeOverwriteFunction("dailyLotResponse",function(response){
                try{
                    unsafeWindow._dailyLotResponse(response);
                }catch(err){GM_logError("_dailyLotResponse","","",err);}
                try{
                    hideGoToLottery();
                    if(response[3]){
                        lotteryLog[lotteryLogId][1]=response[3];
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog",implode(lotteryLog,"dailyLotResponse/lotteryLog"));
                        raiseEvent("gameLotteryGotDailyLot");
                    }
                }catch(err){GM_logError("dailyLotResponse","","",err);}
            });
            unsafeOverwriteFunction("showLotDecision",function(lotid){
                try{
                    unsafeWindow._showLotDecision(lotid);
                }catch(err){GM_logError("_showLotDecision","","",err);}
                window.setTimeout(function(lotid){
                try{
                    if(unsafeData.lotteryCollectForPrize){
                        var lotteryCollectForPrize=unsafeData.lotteryCollectForPrize.clone();
                    }else{
                        var lotteryCollectForPrize=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryCollectForPrize"),"showLotDecision/lotteryCollectForPrize",{});
                    }
                    if(!lotteryCollectForPrize["total"]){ lotteryCollectForPrize["total"]=new Array(); }
                    if(!lotteryCollectForPrize["total"][lotid]){ lotteryCollectForPrize["total"][lotid]=0; }
                    var newdiv=createElement("div",{"id":"currentlotAdvise","style":"position:absolute;right:8px;top:5px;font-size:14px;font-weight:bold;color:#fff;padding:2px;"},$("currentlot"));
                    var help=(unsafeWindow.lotrack[lotid]?unsafeWindow.lotrack[lotid]:0)-lotteryCollectForPrize["total"][lotid];
                    if(help<=0){
                        newdiv.innerHTML=help;
                        newdiv.style.backgroundColor="#AA0000";
                    }else{
                        newdiv.innerHTML=+help;
                        newdiv.style.backgroundColor="green";
                    }
                    newdiv=null;
                    raiseEvent("gameLotteryGotLot");
                }catch(err){GM_logError("showLotDecision","","",err);}
                },0,lotid);
            });
            unsafeOverwriteFunction("lotGetPrizeResponse",function(response){
                try{
                    unsafeWindow._lotGetPrizeResponse(response);
                }catch(err){GM_logError("_lotGetPrizeResponse","","",err);}
                try{
                    if(response[5]){
                        lotteryLog[lotteryLogId][2]=response[5];
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog",implode(lotteryLog,"lotGetPrizeResponse/lotteryLog"));
                        raiseEvent("gameLotteryGotPrize");
                    }
                }catch(err){GM_logError("lotGetPrizeResponse","","",err);}
            });
            unsafeOverwriteFunction("buyNewLotResponse",function(response){
                try{
                    unsafeWindow._buyNewLotResponse(response);
                }catch(err){GM_logError("_buyNewLotResponse","","",err);}
                try{
                    if(response[5]&response[3]){
                        lotteryLog[lotteryLogId][3].push(response[3]);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog",implode(lotteryLog,"buyNewLotResponse/lotteryLog"));
                        raiseEvent("gameLotteryGotPrize");
                    }
                }catch(err){GM_logError("buyNewLotResponse","","",err);}
            });
        }

        // Veterinary (Treatment of sick animals)
        err_trace="Vet Farmi";
        valVet= GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valVet", unsafeWindow.farmersmarket_data.vet);
        function showGoToVetFarmi(){
            try{
                var showIcon = false;
                if (unsafeWindow.farmersmarket_data.vet) {
                    var farmis = unsafeWindow.farmersmarket_data.vet.animals.slots;
                    for(var i = 1; i <= 3; i++) {
                        if (farmis[i] && farmis[i]["remain"] < 0) {
                            showIcon = true;
                            break;
                        }
                    }
                }

                if(valVet && showIcon){
                    if(!nodes["goToVetFarmi"]){
                        nodes["goToVetFarmi"]=new Object();
                        nodes["goToVetFarmi"]["node"]=createElement("div",{
                            "id":"goToVetFarmi",
                            "style":"height:70px;width:70px;background:url('"+GFX+"vet_cashup.png') -13px -10px / 270%;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;",
                            "class":"link blinking"
                        },$("fixedDivRight"));
                        nodes["goToVetFarmi"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("goToVet")); },false);
                        nodes["goToVetFarmi"]["node"].addEventListener("click",function(event){ goToVet(); },false);
                        raiseEvent("gameVetFarmiAvailable");
                    }
                } else {
                    hideGoToVetFarmi();
                }
            }catch(err){GM_logError("showGoToVetFarmi","","",err);}
        }
        function hideGoToVetFarmi(){
            try{
                if(nodes["goToVetFarmi"]){
                    if(nodes["goToVetFarmi"]["node"]){ removeElement(nodes["goToVetFarmi"]["node"]); }
                    delete nodes["goToVetFarmi"];
                }
            }catch(err){GM_logError("hideGoToVetFarmi","","",err);}
        }

        // doFarmersmarketData was moved to here, so data is ready for showGoToVetFarmi
        if(unsafeWindow.farmersmarket_data){
            doFarmersMarketData();
        }

        window.setTimeout(function(){
            if (unsafeWindow.sushibar && unsafeWindow.sushibar.data && unsafeWindow.sushibar.data.config) {
                doSushiBar();
            }
        },2000);

        /*
        if(USERLEVEL>=8 && unsafeWindow.stall && unsafeWindow.stall.data.data){
            doMapStall();
        } else {
            window.setTimeout(autoMapStall,2000);
        }*/

        // Clothing Donation
        /*
         * Contribution/Author: Moe
         */
        err_trace="Clothing Donation";
        valClothingDonation= GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valClothingDonation", USERLEVEL >= 38);
        logClothingDonation = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logClothingDonation"),"do_main/logClothingDonation",[]);
        if (!(logClothingDonation instanceof Array)){ logClothingDonation = []; }

        function showGoToClothingDonation(){
        try{
            if(USERLEVEL >= 38 && valClothingDonation) {
                var latestLog = logClothingDonation[0];
                var showIcon = !latestLog; // No log entry yet => Show icon
                if (latestLog) {
                    var entryDate = Math.max(latestLog["createdate"], latestLog["gambleInfo"][0]["gambledate"]);
                    if (entryDate + 6*3600 < now) {
                        // Last entry older than 6 hours => Show Icon
                        showIcon = true;
                    } else if (latestLog["gambleInfo"][0]["gain"] && latestLog["gambleInfo"][0]["gain"] > 0) {
                        // Last entry has positive gain => Show Icon
                        showIcon = true;
                    } else {
                        // Last entry younger than 6 hours, negative gain => Do not show icon
                    }
                }

                if (showIcon && !nodes["goToClothingDonation"]) {
                    // Let's draw the quick link icon
                    nodes["goToClothingDonation"]=new Object();
                    nodes["goToClothingDonation"]["node"]=createElement("div",{"id":"divGoToClothingDonation","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"city/clothingdonation.jpg') 80px 1px / 150%;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                    nodes["goToClothingDonation"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event, getText("goToClothingDonation")); },false);
                    nodes["goToClothingDonation"]["node"].addEventListener("click",function(event){ goToClothingDonation();},false);
                    raiseEvent("gameClothingDonationAvailable");
                }
            } else {
                hideGoToClothingDonation();
            }
        }catch(err){GM_logError("showGoToClothingDonation","","",err);}
        }

        function hideGoToClothingDonation(){
        try{
            if(nodes["goToClothingDonation"]){
                if(nodes["goToClothingDonation"]["node"]) {
                    removeElement(nodes["goToClothingDonation"]["node"]);
                }
                delete nodes["goToClothingDonation"];

                $("clothingdonation_donatebutton").classList.remove('blinking');
                $("clothingdonation_gamblebutton").classList.remove('blinking');
            }
        }catch(err){GM_logError("hideGoToClothingDonation","","",err);}
        }

        function clothingDataAvailable(data, goodsValue) {
            var needSave = false;
            var latestLog = logClothingDonation[0];

            // Is current (donation) data new?
            if (!latestLog || latestLog["createdate"] < parseInt(data.createdate, 10)) {
                // No log entry or new donation => insert new log entry
                latestLog = {
                        createdate: parseInt(data.createdate, 10),
                        in: data.data.in,
                        gambleInfo: [{gambledate: parseInt(data.gambledate, 10), out: data.data.out, gain: goodsValue[1] - goodsValue[0]}]
                }
                logClothingDonation.unshift(latestLog);
                needSave = true;
            } else if (latestLog["createdate"] == parseInt(data.createdate, 10) &&
                        latestLog["gambleInfo"][0]["gambledate"] < parseInt(data.gambledate, 10)) {
                // Same (donation) data, but new gamble info => insert only gamble info
                latestLog["gambleInfo"].unshift({gambledate: parseInt(data.gambledate, 10), out: data.data.out, gain: goodsValue[1] - goodsValue[0]});
                needSave = true;
            } else if (latestLog["createdate"] == parseInt(data.createdate, 10) &&
                        latestLog["gambleInfo"][0]["gambledate"] == parseInt(data.gambledate, 10) &&
                        (goodsValue[1] - goodsValue[0]) != latestLog["gambleInfo"][0]["gain"]) {
                // Same (donation) data, same gamble info, different gain => update gain
                latestLog["gambleInfo"][0]["gain"] = goodsValue[1] - goodsValue[0];
                needSave = true;
            }

            if (needSave) {
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logClothingDonation",implode(logClothingDonation,"clothingDataAvailable/logClothingDonation"));
            }

            if (goodsValue[0] < goodsValue[1]) {
                // Value of donation is less than value of reward => Animate (only) Donate-Button!
                $("clothingdonation_donatebutton").classList.add('blinking');
                $("clothingdonation_gamblebutton").classList.remove('blinking');
            } else if (data.gambleremain < 1) {
                // No positive gain, but we haven't gambled within the last six hours => Animate (only) Gamble-Button!
                $("clothingdonation_gamblebutton").classList.add('blinking');
                $("clothingdonation_donatebutton").classList.remove('blinking');
            } else {
                // We shouldn't donate, we can't gamble, so we hide the icon
                hideGoToClothingDonation();
            }

            unsafeData.latestClothingDonationLog = latestLog; // Make latest log available for automat
            raiseEvent("gameClothingDonationResponse");
        }

        // On load, check, if we need to show the icon
        if (USERLEVEL >= 38) {
            showGoToClothingDonation();
        }

        // Donkey Waltraud
        err_trace="Donkey Waltraud";
        // logDonkey[]=[day,points,[received gifts]]
        // same pattern as QUESTS
        logDonkey=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logDonkey"),"do_main/logDonkey",[]);
        if(!(logDonkey instanceof Array)){ logDonkey = []; }
        logDonkeyId={};
        for(var v=logDonkey.length-1;v>=0;v--){
            logDonkeyId[logDonkey[v][0]]=v;
        }
        function showGoToDonkey(){
        try{
            if(unsafeWindow.donkey_isset&&(undefined===logDonkeyId[todayServerStr])){
                if(!nodes["goToDonkey"]){
                    nodes["goToDonkey"]=new Object();
                    nodes["goToDonkey"]["node"]=createElement("div",{"id":"divGoToDonkey","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"donkey_dialog.gif') 65px -15px / 300%;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                    nodes["goToDonkey"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("goToDonkey")); },false);
                    nodes["goToDonkey"]["node"].addEventListener("click",function(event){ goToDonkey(); },false);
                    raiseEvent("gameDonkeyAvailable");
                }
            }
        }catch(err){GM_logError("showGoToDonkey","","",err);}
        }
        function hideGoToDonkey(){
        try{
            if(nodes["goToDonkey"]){
                if(nodes["goToDonkey"]["node"]){ removeElement(nodes["goToDonkey"]["node"]); }
                delete nodes["goToDonkey"];
            }
        }catch(err){GM_logError("hideGoToDonkey","","",err);}
        }
        unsafeOverwriteFunction("showDonkey",function(a){
            try{
                unsafeWindow._showDonkey(a);
            }catch(err){GM_logError("_showDonkey","","",err);}
            try{
                showGoToDonkey();
            }catch(err){GM_logError("showDonkey","","",err);}
        });
        unsafeOverwriteFunction("dailyDonkeyResult",function(response){
            try{
                unsafeWindow._dailyDonkeyResult(response);
                raiseEvent("gameDonkeyResponse");
            }catch(err){GM_logError("_dailyDonkeyResult","","",err);}
            try{
                if (response[0]!=2) {
                    hideGoToDonkey();
                    var newElem=[todayServerStr,0,[]];
                    newElem[1]=response[1];
                    if(response[7]>0){
                        newElem[2].push([5,1]);
                    }else if(response[2]>0){
                        newElem[2].push([1,0,0,1]);
                    }else if(response[4]>0){
                        newElem[2].push([13,response[4]]);
                    }else if(response[6]>0){
                        newElem[2].push([12,response[6]]);
                    }else if(response[5]>0){
                        newElem[2].push([1,0,response[5],1]);
                    }else if(response[3]){
                        for(pid in response[3]){
                            if(!response[3].hasOwnProperty(pid)){ continue; }
                            newElem[2].push([1,0,parseInt(pid,10),response[3][pid]]);
                        }
                    }
                    logDonkey.push(newElem);
                    logDonkeyId[todayServerStr]=logDonkey.length-1;
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_logDonkey",implode(logDonkey,"dailyDonkeyResult/logDonkey"));
                }
            }catch(err){GM_logError("dailyDonkeyResult","","",err);}
        });
        showGoToDonkey();
    }

    unsafeOverwriteFunction("showFarmDog",function(){
        try{
            unsafeWindow._showFarmDog();
        }catch(err){GM_logError("showFarmDog","","",err);}
        try{
            raiseEvent("gameOpenFarmDog");
        }catch(err){GM_logError("showFarmDog","","",err);}
    });

    /**********************************************************
    * Events Daily Login Bonus
    **********************************************************/
    unsafeOverwriteObjFunction("loginbonus","build",function(){
        try{
            raiseEvent("gameSetDailyLoginProduct");
            unsafeWindow.loginbonus._build();
        }catch(err){GM_logError("loginbonus.build","","",err);}
        try{
            raiseEvent("gamegoToOpenDailyLoginBonus");
        }catch(err){GM_logError("loginbonus.build","","",err);}

    }, true);

    unsafeOverwriteObjFunction("loginbonus","getReward",function(){
        try{
             unsafeWindow.loginbonus._getReward();
        }catch(err){GM_logError("loginbonus.getReward","","",err);}
        try{
            raiseEvent("gameDailyLoginBonusgetReward");
        }catch(err){GM_logError("loginbonus.getReward","","",err);}

    }, true);


    /**********************************************************
    * Events Olympia
    **********************************************************/
    //Open OlympiaRun olympia.action('olympia_init')
    /*unsafeOverwriteObjFunction("olympia","action",function(a,b){
        try{
             unsafeWindow.olympia._action(a,b);
        }catch(err){GM_logError("olympia.action","","",err);}
        try{
            raiseEvent("gamegoToOpenOlympiaRun");
        }catch(err){GM_logError("olympia.action_Response","","",err);}

    });*/

    //olympia.prototype.response(b,a,c)
    unsafeOverwriteObjFunction("olympia","init",function(){
        try{
             unsafeWindow.olympia._init();
        }catch(err){GM_logError("olympia.action","","",err);}
        try{
            raiseEvent("gamegoToOpenOlympiaRun");
        }catch(err){GM_logError("olympia.action_Response","","",err);}

    }, true);

    //olympia.prototype.dialog(l,c)
    unsafeOverwriteObjFunction("olympia","dialog",function(l,c){
        try{
             unsafeWindow.olympia._dialog(l,c);
        }catch(err){GM_logError("olympia.dialog","","",err);}
        try{
            raiseEvent("gameOlympiaOpenDialog");
        }catch(err){GM_logError("olympia.dialog_Response","","",err);}

    }, true);
    //olympia.prototype.entry(a)
    unsafeOverwriteObjFunction("olympia","entry",function(a){
        try{
             unsafeWindow.olympia._entry(a);
        }catch(err){GM_logError("olympia.entry","","",err);}
        try{
            raiseEvent("gameOlympiaEntry");
        }catch(err){GM_logError("olympia.entry_Response","","",err);}

    }, true);

    /**********************************************************
    * Events Siebenschlaefer
    **********************************************************/
    unsafeOverwriteObjFunction("loginevent","init",function(){
        try{
             unsafeWindow.loginevent._init();
        }catch(err){GM_logError("loginevent.init","","",err);}
        try{
            raiseEvent("gamegoToOpenSiebenSchlaeferRun");
        }catch(err){GM_logError("loginevent.init","","",err);}

    }, true);

    unsafeOverwriteObjFunction("loginevent","getday",function(){
        try{
             unsafeWindow.loginevent._getday();
        }catch(err){GM_logError("loginevent.getday","","",err);}
        try{
            raiseEvent("gamePressEventButton");
        }catch(err){GM_logError("loginevent.getday","","",err);}

    }, true);

    /**********************************************************
    * Events DeliveryEvent
    **********************************************************/
    unsafeOverwriteObjFunction("deliveryevent","init",function(){
        try{
             unsafeWindow.deliveryevent._init();
        }catch(err){GM_logError("deliveryevent.init","","",err);}
        try{
            raiseEvent("gamegoToOpenDeliveryevent");
        }catch(err){GM_logError("deliveryevent.init","","",err);}

    }, true);

    unsafeOverwriteObjFunction("deliveryevent","startTourCheckCommit",function(c){
        try{
             unsafeWindow.deliveryevent._startTourCheckCommit(c);
        }catch(err){GM_logError("deliveryevent.startTourCheckCommit","","",err);}
        try{
            raiseEvent("gamePressSpotButton");
        }catch(err){GM_logError("deliveryevent.startTourCheckCommit","","",err);}

    }, true);

    unsafeOverwriteObjFunction("deliveryevent","startTour",function(a){
        try{
             unsafeWindow.deliveryevent._startTour(a);
        }catch(err){GM_logError("deliveryevent.startTour","","",err);}
        try{
            raiseEvent("gameDeliveryStart");
        }catch(err){GM_logError("deliveryevent.startTour","","",err);}

    }, true);

    /**********************************************************
    * Events Alien Invasion
    **********************************************************/
    if($top("battle_link")){
        if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_battleLastDailyBonus")!=todayStr){
            unsafeData.battleDailyBonusDone=false;
        } else {
            unsafeData.battleDailyBonusDone=true;
        }

        unsafeOverwriteObjFunction("battle","response",function(d,c,e){
            try{
                 unsafeWindow.battle._response(d,c,e);
            }catch(err){GM_logError("battle.gotoBattle","","",err);}
            try{
                raiseEvent("gamegoToBattle");
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_battleLastDailyBonus",todayStr);
                unsafeData.battleDailyBonusDone=true;
            }catch(err){GM_logError("battle.gotoBattle","","",err);}
        }, true);

        unsafeOverwriteObjFunction("battle","fire",function(a){
            try{
                if (zielwasser) {
                    var x = Math.floor(Math.random() * (10 - -10 + 1)) + -10;
                    a = (unsafeWindow.battle.data.config.ammo[unsafeWindow.battle.currentAmmo].hotzone_height / 2) + unsafeWindow.battle.offset + x;
                }
                    unsafeWindow.battle._fire(a);
            }catch(err){GM_logError("battle.fire","","",err);}
            try{
            }catch(err){GM_logError("battle.fire","","",err);}
        }, true);

        var zielwasser = false;

        unsafeOverwriteObjFunction("battle","update",function(){
            try{
                unsafeWindow.battle._update();
            }catch(err){GM_logError("battle.fire","","",err);}
            try{

                var frame=createElement("div", {
                    "style":"width:150px;height:32px;right:100px; top:50px; padding-left:10px;position:absolute;z-index:100;background-color:#FEE5AA;border: 1px solid black;border-radius: 5px;"},
                    $("battle_inner"),"Zielwasser: ");
                inp=createElement("input",{"class":"link","type":"checkbox","checked":zielwasser},frame);

                inp.addEventListener("click",function(){
                    zielwasser = this.checked;
                },false);
            }catch(err){GM_logError("battle.fire","","",err);}
        }, true);
    }

    /**********************************************************
    * Events xMasCalendar
    **********************************************************/
    if($top("calendar_link")){
        if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_xMasCalendarLastDailyBonus")!=todayStr){
            unsafeData.xMasCalendarDailyDone=false;
        } else {
            unsafeData.xMasCalendarDailyDone=true;
        }

        unsafeOverwriteObjFunction("calendar","response",function(b,a,c){
            try{
                 unsafeWindow.calendar._response(b,a,c);
            }catch(err){GM_logError("calendar.gotoXMasCalendar","","",err);}
            try{
                if(b.reward){
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_xMasCalendarLastDailyBonus",todayStr);
                    unsafeData.xMasCalendarDailyDone=true;
                    raiseEvent("xMasCalendarDone");
                } else {
                    if(unsafeWindow.calendar&&unsafeWindow.calendar.data.data.days[unsafeWindow.calendar.data.day]){
                        unsafeData.xMasCalendarDailyDone=true;
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_xMasCalendarLastDailyBonus",todayStr);
                    }
                }
            }catch(err){GM_logError("calendar.gotoXMasCalendar","","",err);}
        }, true);

        unsafeOverwriteObjFunction("calendar","build",function(){
            try{
                 unsafeWindow.calendar._build();
            }catch(err){GM_logError("xMasCalendar.build","","",err);}
            try{
                raiseEvent("gamegoToOpeXMasCalendar");
            }catch(err){GM_logError("xMasCalendar.build","","",err);}
        }, true);
    }

    /**********************************************************
    * Events oktoberfest
    **********************************************************/
    if($top("oktoberfest_link")){
        if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_oktoberfestBonus")!=todayStr){
            unsafeData.oktoberfestBonus=false;
        } else {
            unsafeData.oktoberfestBonus=true;
        }

        unsafeOverwriteObjFunction("oktoberfest","response",function(b,a,c){
            try{
                 unsafeWindow.oktoberfest._response(b,a,c);
            }catch(err){GM_logError("oktoberfest._response","","",err);}
            try{

                if (!unsafeWindow.oktoberfest.data.login && !unsafeData.oktoberfestBonus) {
                    GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_oktoberfestBonus",todayStr);
                    unsafeData.oktoberfestBonus=true;
                }

            }catch(err){GM_logError("oktoberfest._response","","",err);}
        }, true);

        unsafeOverwriteObjFunction("oktoberfest","login",function(){
            try{
                 unsafeWindow.oktoberfest._login();
            }catch(err){GM_logError("oktoberfest.login","","",err);}
            try{
                GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_oktoberfestBonus",todayStr);
                unsafeData.oktoberfestBonus=true;

                if((help=$("globalbox")) && (help.style.display == "block")) {
                    window.setTimeout(function() {
                        unsafeWindow.hideDiv('globalbox');
                        unsafeWindow.hideDiv('globaltransp');
                    },1000);
                }

            }catch(err){GM_logError("oktoberfest.login","","",err);}
        }, true);
    }

    //*********************************************************************************************
    // Geburtstagsspiel
    //*********************************************************************************************
    var tinkergameAnzahl=0;
    var tinkergameSelect;
    function doTinkergame(){
        try{
            if (tinkergameAnzahl>0) {
                unsafeWindow.tinkergame.exchangePrize(selectPaket.value);
                tinkergameAnzahl--;
                document.addEventListener("tinkergame_paket",function(){
                    document.removeEventListener("tinkergame_paket",arguments.callee,false);
                    if((help=$("globalbox")) && (help.style.display == "block")) {
                        unsafeWindow.hideDiv('globalbox');
                        unsafeWindow.hideDiv('globaltransp');
                    }
                    window.setTimeout(function(){
                        doTinkergame();
                    },1000);
                });

            }
        }catch(err){GM_logError("doTinkergame","","",err);}
    }

    unsafeOverwriteObjFunction("tinkergame","exchangePrize",function(a){
        try{
            unsafeWindow.tinkergame._exchangePrize(a);
        }catch(err){GM_logError("tinkergameExchangePrize","","",err);}
        try{
            window.setTimeout(function(){
                raiseEvent("tinkergame_paket");
            },1000);
        }catch(err){GM_logError("tinkergameExchangePrize","","",err);}
    });

    unsafeOverwriteObjFunction("tinkergame","open",function(){
        try{
             unsafeWindow.tinkergame._open();

        }catch(err){GM_logError("tinkergame.open","","",err);}
        try{
            var item = unsafeWindow.farms_data.map;
            var container = $("tinkergame_main");
            var newNode = createElement("div",{"id":"divGame","class":"","style":"height:25px"});
            var newtable=createElement("table",{"border":"0","class":"","style":"width:75%"},newNode);

            var newtr=createElement("tr",{},newtable);
            createElement("td",{},newtr,"Paket:");
            var newtd = createElement("td",{},newtr);
            var selectPaket = createElement("select", {
                "id": "selectPaket",
                "size":"1",
                "name": "selection",
                "style": "margin: 0px 0px 0px 10px"
            }, newtd, false);

            createElement("option", {"value":2}, selectPaket, "Produktpaket");
            createElement("option", {"value":11}, selectPaket, "Joghurt");
            createElement("option", {"value":12}, selectPaket, "Ziegenmilch");
            createElement("option", {"value":13}, selectPaket, "Angorawolle");
            createElement("option", {"value":14}, selectPaket, "Ketchup");
            createElement("option", {"value":15}, selectPaket, "Biosprit");

            createElement("td",{},newtr, "Anzahl:");
            newtd = createElement("td",{},newtr);
            var inputAnzahl = createElement("input",{
                "id":"anzahl",
                "value":tinkergameAnzahl,
                "size":"5px",
                "style":"text-align:center;"
            },newtd);

            newtd = createElement("td",{},newtr);

            var button=createElement("button", {"class":"link","style":""}, newtd, "Start");
            button.addEventListener("click",function(){
                if (inputAnzahl.value > 0 && selectPaket.value) {
                    tinkergameAnzahl=inputAnzahl.value;
                    tinkergameSelect=selectPaket.value;
                    doTinkergame();
                }
            },false);

            button=null;
            container.insertBefore(newNode, container.firstChild.nextSibling);
            container=null;button=null;help=null;

        }catch(err){GM_logError("tinkergame.open","","",err);}
    });


    //*********************************************************************************************
    // buyPetsParts
    //*********************************************************************************************
    //22102016
    function showGoToMonsterFruitCultureReady(){
        try{
            if(!nodes["goToMonsterFruitCultureReady"]){
                nodes["goToMonsterFruitCultureReady"]=new Object();
                nodes["goToMonsterFruitCultureReady"]["node"]=createElement("div",{"id":"divGoToMonsterFruitCultureReady","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"megafruit_harvest_button2.png') 0px 0px;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                nodes["goToMonsterFruitCultureReady"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("showGoToMonsterFruitCultureReady")); },false);
                nodes["goToMonsterFruitCultureReady"]["node"].addEventListener("click",function(event){ goToMonsterFruitCultureReady(); },false);
            }
        }catch(err){GM_logError("showGoToMonsterFruitCultureReady","","",err);}
    }

    function hideGoToMonsterFruitCultureReady(){
        try{
            if(nodes["goToMonsterFruitCultureReady"]){
                if(nodes["goToMonsterFruitCultureReady"]["node"]){ removeElement(nodes["goToMonsterFruitCultureReady"]["node"]); }
                delete nodes["goToMonsterFruitCultureReady"];
            }
        }catch(err){GM_logError("hideGoToMonsterFruitCultureReady","","",err);}
    }


    function showGoToBuyPetsParts(){
        try{
            if(unsafeWindow.pets&&(unsafeWindow.pets.data.daily==1)){
                if(!nodes["goTobuyPetsParts"]){
                    nodes["goTobuyPetsParts"]=new Object();
                    nodes["goTobuyPetsParts"]["node"]=createElement("div",{"id":"divGoTobuyPetsParts","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"breed/PuzzlePieces_00.png') -10px -14px;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                    nodes["goTobuyPetsParts"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("goTobuyPetsParts")); },false);
                    nodes["goTobuyPetsParts"]["node"].addEventListener("click",function(event){ goToBuyPetsParts(); },false);
                }
            } else {
                hideGoToBuyPetsParts();
            }
        }catch(err){GM_logError("showGoToBuyPetsParts","","",err);}
    }

    function hideGoToBuyPetsParts(){
        try{
            if(nodes["goTobuyPetsParts"]){
                if(nodes["goTobuyPetsParts"]["node"]){ removeElement(nodes["goTobuyPetsParts"]["node"]); }
                delete nodes["goTobuyPetsParts"];
            }
        }catch(err){GM_logError("hideGoToBuyPetsParts","","",err);}
    }

    function showGoToAnimalBreedingReady(){
        try{
            if(!nodes["goToAnimalBreedingReady"]){
                nodes["goToAnimalBreedingReady"]=new Object();
                nodes["goToAnimalBreedingReady"]["node"]=createElement("div",{"id":"divGoToAnimalBreedingReady","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"breed/production_ready.gif') -10px -14px;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                nodes["goToAnimalBreedingReady"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("showGoToAnimalBreedingReady")); },false);
                nodes["goToAnimalBreedingReady"]["node"].addEventListener("click",function(event){ goToAnimalBreedingReady(); },false);
            }
        }catch(err){GM_logError("showGoToAnimalBreedingReady","","",err);}
    }

    function hideGoToAnimalBreedingReady(){
        try{
            if(nodes["goToAnimalBreedingReady"]){
                if(nodes["goToAnimalBreedingReady"]["node"]){ removeElement(nodes["goToAnimalBreedingReady"]["node"]); }
                delete nodes["goToAnimalBreedingReady"];
            }
        }catch(err){GM_logError("hideGoToAnimalBreedingReady","","",err);}
    }

    function showGoToSpeedEatingReady(){
        try{
            if(!nodes["goToSpeedEatingReady"]){
                nodes["goToSpeedEatingReady"]=new Object();
                nodes["goToSpeedEatingReady"]["node"]=createElement("div",{"id":"divGoToSpeedEatingReady","class":"link blinking","style":"height:70px;width:70px;background:url('"+GFX+"eater_middle_eat2.gif') 0px 0px;border:2px solid black;border-radius:35px;margin-bottom:5px;opacity:1;"},$("fixedDivRight"));
                nodes["goToSpeedEatingReady"]["node"].addEventListener("mouseover",function(event){ toolTip.show(event,getText("showGoToSpeedEatingReady")); },false);
                nodes["goToSpeedEatingReady"]["node"].addEventListener("click",function(event){ goToSpeedEatingReady(); },false);
            }
        }catch(err){GM_logError("showGoToSpeedEatingReady","","",err);}
    }

    function hideGoToSpeedEatingReady(){
        try{
            if(nodes["goToSpeedEatingReady"]){
                if(nodes["goToSpeedEatingReady"]["node"]){ removeElement(nodes["goToSpeedEatingReady"]["node"]); }
                delete nodes["goToSpeedEatingReady"];
            }
        }catch(err){GM_logError("hideGoToSpeedEatingReady","","",err);}
    }

    // on load execute ============================================================================
    err_trace="on load execute";
    newdiv1=$("buildingmain");
    var newdiv2;

    // TODO! farm is already filled
    unsafeWindow.farmBuildPositions();
    unsafeWindow.farmMove(1);
    calcFarmiCost();
    calcTotalFarmis();
    calcProdMinRackInit(); // this calls finally doBuyNotepad, doFarmis
    //doFarmis();
    saveProductData();
    if(unsafeWindow.showQuests){ //FastFix2012/01/18
        unsafeWindow.showQuests(); //TODO review
    }

    if(COUNTRY=="SE"){ $("bar").innerHTML=$("bar").innerHTML.replace(/\.(\d\d) /,",$1 "); }
    GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_bargeld",$("bar").innerHTML.replace(" "+getText("gamecurrency"),"").replace(regDelimThou,"").replace(regDelimDeci,"."));

    err_trace="global timer";
    if(USERLEVEL>=8){
        createZoneTimer("globalZoneTimer_windmill","windmill","zonetimer","position:relative;",$("timeHolder"));
    }
    if(unsafeWindow.forestry_unlock!=undefined){
        createZoneTimer("globalZoneTimer_forest","forest","zonetimer","position:relative;",$("timeHolder"));
        if(zones.getBonus("forest")>0){ createZoneTimer("globalZoneTimerWater_forest","forest","zoneTimerWater","position:relative;",$("timeHolder")); }
        createZoneTimer("globalZoneTimer_sawmill","sawmill","zonetimer","position:relative;",$("timeHolder"));
        createZoneTimer("globalZoneTimer_carpentry","carpentry","zonetimer","position:relative;",$("timeHolder"));
    }
    for(var v=1;v<=4;v++){
        createZoneTimer("globalZoneTimer_foodworld-"+v,"foodworld-"+v,"zonetimer","position:relative;",$("timeHolder"));
    }
    for(var v=1;v<=11;v++){
        if (v==10) {continue;}
        createZoneTimer("globalZoneTimer_farmersmarket-"+v,"farmersmarket-"+v,"zonetimer","position:relative;",$("timeHolder"));
    }

    // looping ====================================================================================
    err_trace = "looping";

    function loop1() {
        if (DEVMODE_FUNCTION) {
            var trackingHandle = tracking.start("berater", "loop1");
        }
        try {
            // timeMeasureStart("loop1");
            // test session
            if (unsafeWindow.rid != GM_getValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_session", "")) {
                unsafeWindow.initZones(1);
            } else {
                GM_setValue2(COUNTRY + "_" + SERVER + "_sessionlost", false, 74);
            }

            now = Math.floor((new Date()).getTime() / 1000);
            todayStr = getDateStr(now, 2, false);
            nowServerOff = unsafeWindow.Zeit.Server + valServerTimeOffset;
            var help = getDateStr(nowServerOff, 2, false);

            if (help != todayServerStr) {
                todayServerStr = help;
                setLevelLogId();
                setLotteryLogId();
                getDailyRanking();
                showGoToLottery();
                raiseEvent("gameNewDay");
            }
            /*
            console.log("++++++++++++++++++++++++++++++++++++++++++++++++++++");
            console.log(implode(unsafeWindow.job_data));
            console.log("++++++++++++++++++++++++++++++++++++++++++++++++++++");
            */
            try {
                // Summer 2017
                var  specialoffer = unsafeWindow.specialoffer;
                if (specialoffer && specialoffer.data && specialoffer.data.today) {
                    specialoffer.daily();
                    div = $("specialoffer");
                    if (div) {
                        unsafeWindow.hideDiv('globalbox');
                        unsafeWindow.hideDiv('globaltransp');
                    }
                }
            }catch(err){ GM_logError("Specialoffer","","",err); }

            if (GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valTurnOffUpjersNews",true)) {
              var div = $("newsbox");
              if (div && div.style.display == "block") {
                  // GM_logInfo("Hide newsbox", "", "", "Hid Newsbox", 0);
                  unsafeWindow.setNewsUnread(1); //hideDiv("newsbox")
              }
            }

            if (USERLEVEL >= 38) {
                showGoToClothingDonation();
            }

            // clock
            nodes["serverTime"]["node"].innerHTML = todayServerStr + "&nbsp;" + getDaytimeStr(nowServerOff);
            if (valSessionEndtime) {
                nodes["sessionTimeLeft"]["node"].innerHTML = "(" + getTimeStr(valSessionEndtime - now) + ")";
            }
            if (DEVMODE) {
                nodes["sessionTimeNow"]["node"].innerHTML = "(" + getDaytimeStr(now) + ")";
            }

            // questline
            updateQuestLineTimer();

            // powerupsymbols
            for (var v = nodes["containerPowerupSymbols"]["node"].childElementCount - 1; v >= 0; v--) {
                help = parseInt(nodes["containerPowerupSymbols"]["node"].children[v].getAttribute("end"), 10) - unsafeWindow.Zeit.Server;
                if (help > 0) {
                    nodes["containerPowerupSymbols"]["node"].children[v].lastElementChild.innerHTML = getTimeStr(help);
                } else {
                    removeElement(nodes["containerPowerupSymbols"]["node"].children[v]);
                }
            }

            // timers
            timer.run();
            clocks.run();

            // slots
            var readyZoneAdded = 0;
            for (var i in ALL_SLOTS) {
                if (!ALL_SLOTS.hasOwnProperty(i)) {
                    continue;
                }
                if (!zones.getBlock(i)) {
                    readyZoneAdded += zones.checkReady(i);
                }
            }

            if (readyZoneAdded > 0) {
                GM_logInfo("loop1", "", "readyZone=" + implode(unsafeData.readyZone, "loop1/readyZone"), "Zone ready", 0);
                raiseEvent("gameZoneReady");
                // GM_log("unsafeData.readyZone:\n"+print_r(unsafeData.readyZone,"",true,"\n"));
            }
            if (-1 == totalEndtime) {
                help = getText("cropped").toUpperCase();
            } else if (totalEndtime + unsafeWindow.Zeit.Verschiebung <= now) {
                help = getText("finished").toUpperCase();
            } else {
                help = getTimeStr(totalEndtime + unsafeWindow.Zeit.Verschiebung - now);
            }
            var cell;
            if ((cell = $("mainmenue2_incoming")) && (cell.style.display == "block")) {
                help += " - !";
            } else if ((cell = $("mainmenue3_incoming")) && (cell.style.display == "block")) {
                help += " - !";
            }
            cell = null;
            document.title = help + documentTitle;

            // raising events of other pages
            var raisedEvents = explode(GM_getValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_raisedEvents"), "loop1/raisedEvents", {});
            for (var v in raisedEvents) {
                if (!raisedEvents.hasOwnProperty(v)) {
                    continue;
                }
                raiseEvent(v);
                GM_setValue(COUNTRY + "_" + SERVER + "_" + USERNAME + "_raisedEvents", "{}");
            }
            // timeMeasureStop("loop1"); // 4ms
        } catch (err) { GM_logError("loop1", "", "", err); }
        if (DEVMODE_FUNCTION) {
            tracking.end("berater", trackingHandle);
        }
    }

    function loop60(){
        unsafeWindow.updateMenu();
    }

    window.setInterval(loop1,1000);
    window.setInterval(loop60,60000);

    // First run
    if (GM_getValue("tutorial",0)==0){
        unsafeWindow.show_page('help');
    }
    newinput=null;newdiv=null;newdiv1=null;newbutton=null;newimg=null;
}catch(err){ GM_logError("do_main","","err_trace="+err_trace,err); }
}

//***********************************************************************************************************


//***********************************************************************************************************

function do_hilfe(){
    var canddiv=new Array();
    for(var v=0;v<ALL.childElementCount;v++){ if(ALL.children[v].id=="") canddiv.push(ALL.children[v]); }
    canddiv[1].id="helpmenu";
    canddiv[1].style.left="0";
    canddiv[1].style.width="155px";
    canddiv[1].style.overflowX="hidden";
    canddiv[1].style.overflowY="auto";
    canddiv[2].id="helpbody";
    canddiv=$("helpmenu").getElementsByTagName("div");
    for(var v=0;v<canddiv.length;v++){ if(canddiv[v].getAttribute("class")=="list_header"){ break; }}
    var newdiv=createElement("div",{"id":"helpmenuLinks","style":"margin-bottom:10px;"});
    $("helpmenu").insertBefore(newdiv,canddiv[v]);
    newdiv=createElement("div",{},newdiv);
    var newa=createElement("a",{"class":"list_header","href":"#"},newdiv,getText("adviser"));
    newa.addEventListener("click",function(){
        try{
            var div,help,i=0;
            var container=$("helpbody");
            container.innerHTML="";
            div=createElement("div",{"class":"tnormal"},container);
            createElement("b",{},div,getText("adviser"));
            while(help=getText("help_"+(i++))){
                div=createElement("div",{"class":"tmenu"},container);
                if(help[0]){ createElement("b",{},div,help[0]); }
                if(help[1]){ createElement("p",{},div,help[1]); }
            }
            container=null;div=null;
        }catch(err){GM_logError("help.click","","",err);}
    },false);
    if (GM_getValue("tutorial",0)==0){
        click(newa);
        GM_setValue("tutorial",1);
    }

    switch(pageZusatz["item"]){
    case "18":{ // Questlist
        loadProductData();
        top.unsafeData.questData=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData"),"help/questData",INIT_questData);
        var nodes = {};
        nodes["helpbody"]=$("helpbody");
        nodes["questinfos_select"]=createElement("select",{"id":"questinfos_select","class":"link"},nodes["helpbody"].children[0]);
        nodes["questinfos_select"].addEventListener("click",function(){
            for(var v=0;v<this.childElementCount;v++){
                if(this.children[v].value==this.value){
                    $("questinfos_"+this.children[v].value).style.display="block";
                    do_hilfe_questlist(this.children[v].value);
                }else{
                    $("questinfos_"+this.children[v].value).style.display="none";
                }
            }
        },false);
        nodes["questinfos"]=$("questinfos");
        removeElement(nodes["questinfos"].children[nodes["questinfos"].childElementCount-1]);

        /*
        var normal_quest=new Array();
        var cand, canddiv, qnr=0, prodId, amount;
        for(var v=0;v<$("questinfos").childElementCount;v++){
            try{
                cand = $("questinfos").children[v];
                if(cand.childElementCount<2){
                    GM_log("Questlist: "+implode(normal_quest));
                    normal_quest=new Array();
                    continue;
                }
                qnr = parseInt(cand.children[0].innerHTML.replace(".",""),10);
                if(!normal_quest[qnr]){ normal_quest[qnr]= new Array(); }
                if(!normal_quest[qnr][0]){ normal_quest[qnr][0] = new Array(); }
                if(!normal_quest[qnr][3]){ normal_quest[qnr][3] = new Array(); }

                canddiv=cand.children[1];//.getElementsByTagName("div");
                for(var k=0;k<canddiv.childElementCount;k++){
                    prodId = parseInt(canddiv.children[k].children[0].getAttribute("class").replace("kp",""),10);
                    amount = parseInt(canddiv.children[k].children[1].innerHTML.replace(/[x*|&nbsp;|\.]/gi,""),10);
                    normal_quest[qnr][0].push([0,prodId,amount]);
                }

                normal_quest[qnr][1] = (v<100?1:2);

                for(var k=0;k<cand.children[2].childElementCount;k++){
                    canddiv = cand.children[2].children[k];
                    if(canddiv.innerHTML.indexOf("points.gif")>=0){
                        normal_quest[qnr][2] = parseInt(canddiv.innerHTML.replace(/.*&nbsp;/,"").replace(/\./g,""),10);
                    }else if(canddiv.innerHTML.indexOf("money.gif")>=0){
                        //normal_quest[qnr][3].push([0,parseInt(canddiv.innerHTML.replace(/.*&nbsp;/,"").replace(/\./g,""),10)]);
                        normal_quest[qnr][3]=[0,parseInt(canddiv.innerHTML.replace(/.*&nbsp;/,"").replace(/\./g,""),10)];
                    }else if(canddiv.innerHTML.indexOf("adbonus.gif")>=0){
                        //normal_quest[qnr][3].push([5,1]);
                        normal_quest[qnr][3]=[5,1];
                    }else if(canddiv.className.indexOf("kp")>=0 && cand.children[2].children[k+1].innerHTML.toLowerCase().indexOf("minuten")>=0){  //change to language where reading
                        //normal_quest[qnr][3].push([4,parseInt(canddiv.className.replace("kp",""),10),parseInt(cand.children[2].children[k+1].innerHTML.replace(/[A-z ] /,""),10)]);
                        normal_quest[qnr][3]=[4,parseInt(canddiv.className.replace("kp",""),10),parseInt(cand.children[2].children[k+1].innerHTML.replace(/[A-z ] /,""),10)];
                        k++;
                    }else if(canddiv.innerHTML.toLowerCase().indexOf("boerderij")>=0){ //change to language where reading
                        //normal_quest[qnr][3].push([3,parseInt(canddiv.innerHTML.replace(/\.[A-z ] /,""),10)]);
                        normal_quest[qnr][3]=[3,parseInt(canddiv.innerHTML.replace(/\.[A-z ] /,""),10)];
                    }else if(canddiv.innerHTML.toLowerCase().indexOf("voorraadkast")>=0){  //change to language where reading
                        //normal_quest[qnr][3].push([2,parseInt(canddiv.innerHTML.replace(/\.[A-z ] /,""),10)]);
                        normal_quest[qnr][3]=[2,parseInt(canddiv.innerHTML.replace(/\.[A-z ] /,""),10)];
                    }else if(canddiv.className.indexOf("kp")>=0){
                        //normal_quest[qnr][3].push([1,parseInt(canddiv.className.replace("kp",""),10)]);
                        normal_quest[qnr][3]=[1,parseInt(canddiv.className.replace("kp",""),10)];
                    }
                }
                if(normal_quest[qnr][3].length==0){ delete normal_quest[qnr][3];}
            }catch(err){GM_logError("at","","qnr="+qnr+" k="+k+" cand.innerHTML="+cand.innerHTML,err);}
        }
        GM_log("Questlist: "+implode(normal_quest));
        */

        var line,cell,help;
        var type,prod,amount,item,questCurr,quCamp=1,quNr=0;
        // initial prepare of the tables
        nodes["questinfos_"+quCamp]=createElement("div",{"id":"questinfos_"+quCamp,"style":"color:black;display:block;height:325px;overflow-x:hidden;overflow-y:scroll;"},nodes["helpbody"]);
        createElement("option",{"value":quCamp},nodes["questinfos_select"],quCamp);
        //*task_new_quest*/ var ALL_GEN_QUESTS="";
        while(nodes["questinfos"].childElementCount>0){
            line=nodes["questinfos"].children[0];
            if(line.childElementCount==0){
                quCamp++;
                nodes["questinfos_"+quCamp]=createElement("div",{"id":"questinfos_"+quCamp,"style":"color:black;display:none;height:325px;overflow-x:hidden;overflow-y:scroll;"},nodes["helpbody"]);
                createElement("option",{"value":quCamp},nodes["questinfos_select"],quCamp);
                quNr=0;
                removeElement(line);
            } else {
                quNr++;
                if(QUESTS["main"][quCamp]&&QUESTS["main"][quCamp][quNr]){
                    line.addEventListener("click",function(){
                        var quCamp=this.parentNode.id.replace("questinfos_","");
                        top.unsafeData.questData["main"][quCamp]["nr"]=parseInt(this.children[0].innerHTML,10);
                        GM_setValueCache(COUNTRY+"_"+SERVER+"_"+USERNAME+"_questData",implode(top.unsafeData.questData,"do_hilfe/questData"));
                        do_hilfe_questlist(quCamp);
                        if((0<top.unsafeData.questData["main"][quCamp]["calcTo"])&&(top.unsafeData.questData["main"][quCamp]["calcTo"]<top.unsafeData.questData["main"][quCamp]["nr"])){
                            setCalcToQuest("main",quCamp,top.unsafeData.questData["main"][quCamp]["nr"]);
                        }
                    },false);
                    questCurr=QUESTS["main"][quCamp][quNr];
                    for(var j=0;j<questCurr[0].length;j++){
                        if(typeof questCurr[0][j][0]=="object"){
                            for(var k=0;k<questCurr[0][j].length;k++){
                                if(isNaN(NPC[questCurr[0][j][k][0]][questCurr[0][j][k][1]])){
                                    questCurr[0][j][k][3]=Math.round(questCurr[0][j][k][2]*gut[questCurr[0][j][k][1]]*100)/100;
                                }else{
                                    questCurr[0][j][k][3]=Math.round(questCurr[0][j][k][2]*Math.min(gut[questCurr[0][j][k][1]],NPC[questCurr[0][j][k][0]][questCurr[0][j][k][1]])*100)/100;
                                }
                                questCurr[0][j][k][4]=true;
                                for(var l=0;l<k;l++){
                                    if(questCurr[0][j][l][3]>questCurr[0][j][k][3]){ questCurr[0][j][l][4]=false; }
                                    else { questCurr[0][j][k][4]=false; }
                                }
                            }
                        }else{
                            if(isNaN(NPC[questCurr[0][j][0]][questCurr[0][j][1]])){
                                questCurr[0][j][3]=Math.round(questCurr[0][j][2]*gut[questCurr[0][j][1]]*100)/100;
                            }else{
                                questCurr[0][j][3]=Math.round(questCurr[0][j][2]*Math.min(gut[questCurr[0][j][1]],NPC[questCurr[0][j][0]][questCurr[0][j][1]])*100)/100;
                            }
                            questCurr[0][j][4]=true;
                        }
                    }
                    for(var i=0;i<line.children[1].childElementCount;i++){
                        cell = line.children[1].children[i];
                        cell.style.backgroundColor = "";
                        type=0;
                        prod=parseInt(cell.children[0].getAttribute("class").replace("kp",""),10);
                        amount=parseInt(cell.children[1].innerHTML.replace(/&nbsp;/g,"").replace("x",""),10);
                        item=null;
                        for(var j=0;j<questCurr[0].length;j++){
                            if(typeof questCurr[0][j][0]=="object"){
                                for(var k=0;k<questCurr[0][j].length;k++){
                                    if((type==questCurr[0][j][k][0])&&(prod==questCurr[0][j][k][1])){ item=questCurr[0][j][k]; }
                                }
                            }else{
                                if((type==questCurr[0][j][0])&&(prod==questCurr[0][j][1])){ item=questCurr[0][j]; }
                            }
                        }
                        if(item){
                            if(!item[4]){
                                cell.children[1].style.textDecoration="line-through";
                                cell.children[2].style.textDecoration="line-through";
                            }
                            cell.setAttribute("value",implode(item,"do_hilfe/item"));
                            cell.addEventListener("mouseover",function(event){
                                var help=explode(this.getAttribute("value"),"questlist/mouseover",[]);
                                toolTip.show(event,numberFormat(help[2])+" "+prodName[help[0]][help[1]]+" ("+moneyFormatLimit(help[3]/help[2],100)+") = "+moneyFormatLimit(help[3],10000));
                            },false);
                            if(amount!=item[2]){
                                GM_logWarning("do_hilfe","","quCamp="+quCamp+" quNr="+quNr+" product="+prodName[type][prod]+" data="+numberFormat(item[2])+" read="+numberFormat(amount),"Amount of product wrong!");
                            }
                        }else{
                            GM_logWarning("do_hilfe","","quCamp="+quCamp+" quNr="+quNr+" product="+prodName[type][prod]+" i="+i+" prod="+prod,"Data of product unknown!");
                        }
                        if(amount>=10000){ cell.children[1].innerHTML="&nbsp;"+numberFormat(amount/1000)+"k&nbsp;"; }
                        else { cell.children[1].innerHTML="&nbsp;"+numberFormat(amount)+"&nbsp;"; }
                        if(prodBlock[type][prod]){ cell.children[2].style.backgroundColor="red"; }
                        createElement("span",{"style":"color:red;"},cell.children[2]);
                    }
                }else{
                    GM_logWarning("do_hilfe","","quCamp="+quCamp+" quNr="+quNr,"Quest unknown!");
                    //*task_new_quest*/ var GEN_QUESTS=[[],,0];
                    //*task_new_quest*/ for(var i=0;i<line.children[1].childElementCount;i++){
                    //*task_new_quest*/     cell = line.children[1].children[i];
                    //*task_new_quest*/     type=0;
                    //*task_new_quest*/     prod=parseInt(cell.children[0].getAttribute("class").replace("kp",""),10);
                    //*task_new_quest*/     amount=parseInt(cell.children[1].innerHTML.replace(/&nbsp;/g,"").replace("x",""),10);
                    //*task_new_quest*/     GEN_QUESTS[0].push([type,prod,amount]);
                    //*task_new_quest*/ }
                    //*task_new_quest*/ GEN_QUESTS[2]=line.children[2].innerHTML;
                    //*task_new_quest*/ ALL_GEN_QUESTS+="GEN_QUESTS main."+quCamp+"."+quNr+"="+implode(GEN_QUESTS)+"\n";
                }
                nodes["questinfos_"+quCamp].appendChild(line);
            }
        }
        //*task_new_quest*/ GM_log(ALL_GEN_QUESTS);
        removeElement(nodes["helpbody"].getElementsByTagName("table")[0]);

        createElement("div",{"id":"questcalculation","style":"position:fixed;top:7px;right:3px;width:80px;"},nodes["helpbody"]);
        var newsel=createElement("select",{"id":"selectQuestCalcTo","style":"position:absolute;top:7px;left:0;width:50px;height:18px;"},$("questcalculation"));
        createElement("div",{"id":"queststocks","style":"position:absolute;top:28px;left:0;width:80px;height:220px;border:1px solid #6c441e;overflow-y:auto;overflow-x:hidden;"},$("questcalculation"));
        var newinp=createElement("input",{"id":"questvsrack","type":"checkbox","class":"link","checked":true,"style":"position:absolute;top:250px;right:3px;"},$("questcalculation"));
        newdiv.addEventListener("mouseover",function(event){ toolTip.show(event,getText("showMissingProducts")); },false);
        newinp.addEventListener("click",function(){change($("selectQuestCalcTo"));},false);
        newsel.addEventListener("change",function(){
            var questinfos_select=$("questinfos_select");
            for(var v=0;v<questinfos_select.childElementCount;v++){
                if($("questinfos_"+questinfos_select.children[v].value).style.display=="block"){
                    top.unsafeData.setCalcToQuest("main",questinfos_select.children[v].value,this.value);
                    fill_hilfe_calcToQuest(questinfos_select.children[v].value);
                    break;
                }
            }
            questinfos_select=null;
        },false);

        function fill_hilfe_calcToQuest(quCamp){
            var cell=$("queststocks");
            cell.innerHTML="";
            var prd=new Object();
            var cand,prod,help=null;
            for(var v=top.unsafeData.questData["main"][quCamp]["nr"]-1;v<top.unsafeData.questData["main"][quCamp]["calcTo"];v++){
                cand=$("questinfos_"+quCamp).children[v].children[1];
                for(var i=0;i<cand.childElementCount;i++){
                    help=cand.children[i].getAttribute("value");
                    if(help){
                        help=explode(help,"fill_hilfe_calcToQuest");
                        if(help[4]){
                            if (!prd[help[1]]){ prd[help[1]]=0; }
                            prd[help[1]] += help[2];
                        }
                    }
                }
            }
            var counter=0;
            for(var v=0;v<prodNameSort[0].length;v++){
                prod = prodNameSort[0][v];
                //if ($("questvsrack").checked && (prodStock[0][v] > prd[v])) continue;
                if((!prodBlock[0][prod].match(/t/))&&(!prodBlock[0][prod].match(/l/))&&prd[prod]){
                    var newdiv=createElement("div",{"style":"display:inline-block;width:100%;background-color:"+(prodBlock[0][prod]?"red":((counter%2)?"#ad9e7d;":"#a59574;"))},cell);
                    produktPic(0,prod,newdiv);
                    if($("questvsrack").checked){
                        if(prodStock[0][prod] < prd[prod]){
                            createElement("span",{"style":"color:"+(prodBlock[0][prod]?"black":"red")+ ";"},newdiv,"-"+numberFormat(prd[prod]-prodStock[0][prod]));
                        }else{
                            createElement("span",{"style":"color:black;"},newdiv,+numberFormat(prodStock[0][prod]-prd[prod]));
                        }
                    }else{
                        createElement("span",{"style":"color:black;"},newdiv,numberFormat(prd[prod]));
                    }
                    counter++;
                }
            }
            cell=null;newdiv=null;v=null;prd=null;counter=null;cand=null;help=null;prod=null;
        }

        function do_hilfe_questlist(quCamp){
            var questinfos=$("questinfos_"+quCamp);
            var line;
            for(var v=0;v<top.unsafeData.questData["main"][quCamp]["nr"]-1;v++){
                line=questinfos.children[v];
                if(line.style.opacity!="0.5"){ line.style.opacity="0.5"; }
                if(line.getAttribute("class")!="hoverBgCc9"){ line.setAttribute("class","hoverBgCc9"); }
                // cand=line.getElementsByTagName("div");
                // if(cand[1].style.backgroundColor!=""){ cand[1].style.backgroundColor=""; }
                // if(cand[2].style.backgroundColor!=""){ cand[2].style.backgroundColor=""; }
                // if(cand[5].style.backgroundColor!=""){ cand[5].style.backgroundColor=""; }
                // if(cand[6].style.backgroundColor!=""){ cand[6].style.backgroundColor=""; }
            }

            if(top.unsafeData.questData["main"][quCamp]["nr"]<=questinfos.childElementCount){
                var newsel=$("selectQuestCalcTo");
                newsel.innerHTML="";
                var prodcounter=new Object();
                createElement("option",{"value":0},newsel,"--");
                for(var v=top.unsafeData.questData["main"][quCamp]["nr"]-1;v<questinfos.childElementCount;v++){
                    createElement("option",{"value":v+1},newsel,v+1);
                    line = questinfos.children[v];
                    if(line.style.opacity!="1"){ line.style.opacity="1"; }
                    if(line.getAttribute("class")!="hoverBgCc9"){ line.setAttribute("class","hoverBgCc9"); }
                    for(var i=0;i<line.children[1].childElementCount;i++){
                        help=line.children[1].children[i].getAttribute("value");
                        if(help){
                            help=explode(help,"do_hilfe_questlist",[]);
                            if(help[4]){
                                if(!prodBlock[help[0]][help[1]]){
                                    if (!prodcounter[help[1]]){ prodcounter[help[1]]=0; }
                                    prodcounter[help[1]] += help[2];
                                    if(v==top.unsafeData.questData["main"][quCamp]["nr"]-1){
                                        if(top.unsafeData.questData["main"][quCamp]["given"][help[0]]&&top.unsafeData.questData["main"][quCamp]["given"][help[0]][help[1]]){
                                            prodcounter[help[1]] -= top.unsafeData.questData["main"][quCamp]["given"][help[0]][help[1]];
                                        }
                                    }
                                    if(prodStock[help[0]][help[1]] < prodcounter[help[1]]){
                                        if(prodcounter[help[1]]-prodStock[help[0]][help[1]]>10000){
                                            line.children[1].children[i].children[2].children[0].innerHTML = "&nbsp;(" + numberFormat((prodcounter[help[1]]-prodStock[help[0]][help[1]])/1000) + "k)";
                                        }else{
                                            line.children[1].children[i].children[2].children[0].innerHTML = "&nbsp;(" + numberFormat(prodcounter[help[1]]-prodStock[help[0]][help[1]]) + ")";
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                questinfos.children[top.unsafeData.questData["main"][quCamp]["nr"]-1].setAttribute("class","divCurrentQuest");
                if(questinfos.children[top.unsafeData.questData["main"][quCamp]["nr"]-2]){
                    questinfos.scrollTop=questinfos.children[top.unsafeData.questData["main"][quCamp]["nr"]-2].offsetTop;
                }
                if(top.unsafeData.questData["main"][quCamp]["calcTo"]>0){
                    newsel.value=Math.max(top.unsafeData.questData["main"][quCamp]["nr"],Math.min(questinfos.childElementCount,top.unsafeData.questData["main"][quCamp]["calcTo"]));
                }
                fill_hilfe_calcToQuest(quCamp);
                newsel=null;
            }else{
                questinfos.scrollTop=questinfos.lastChildElement.offsetTop;
            }
            questinfos=null;line=null;
        }
        do_hilfe_questlist("1");

        line=null;cell=null;help=null;
        newsel=null;prodcounter=null;newinp=null;
    break; }
    }

    newdiv=null;newa=null;canddiv=null;
}

//***********************************************************************************************************

function do_multiframe(){
    if($top("multiframe")){
        if(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valDrag",false)){ makeDraggable(ALL,true,true,"multiframe"); }
    }
}

//***********************************************************************************************************
// Dragging
var valMouseXY=["",0,0,0,0];
var dragPos=new Object();
var doDrag=new Object();
function makeDraggable(appendTo,doDragX,doDragY,dragObjId){
    if(typeof(doDragX)!="boolean") doDragX=true;
    if(typeof(doDragY)!="boolean") doDragY=true;
    if(typeof(dragObjId)!="string") dragObjId=appendTo.id;
    //GM_log("makeDraggable:"+appendTo+":"+doDragX+":"+doDragY+":"+dragObjId);
    doDrag[dragObjId]=[doDragX,doDragY];
    var help=GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_dragPos_"+dragObjId,"");
    var dragObj=$top(dragObjId);
    if (help){
        dragPos[dragObjId]=help.split("|");
        if(doDragX) dragObj.style.left=dragPos[dragObjId][0]+"px";
        if(doDragY) dragObj.style.top=dragPos[dragObjId][1]+"px";
        dragObj.style.margin="";
        dragObj.style.marginLeft="";
        dragObj.style.marginTop="";
    }else{
        x=parseInt(dragObj.style.left+"0",10)+parseInt(dragObj.style.marginLeft+"0",10);
        y=parseInt(dragObj.style.top+"0",10)+parseInt(dragObj.style.marginTop+"0",10);
        if(doDragX) dragObj.style.left=x+"px";
        if(doDragY) dragObj.style.top=y+"px";
        dragObj.style.margin="";
        dragObj.style.marginLeft="";
        dragObj.style.marginTop="";
        dragPos[dragObjId]=[x,y];
    }

    var newdiv=createElement("div",{"id":dragObjId+"Drag","style":"cursor:move;position:absolute;top:0;left:0;width:10px;height:20px;background-color:blue;opacity:0.4;"},appendTo);
    newdiv.addEventListener("mousedown", function(event){
        valMouseXY=[this.id.replace("Drag",""),"x","y"];
        top.window.addEventListener("mousemove", mousemoveDrag ,false);
        top.window.addEventListener("mouseup", mouseupDrag ,false);
        var dragObj=$top(valMouseXY[0]);
        createElement("div",{"id":"divDragHelper","style":"position:absolute;display:block;z-index:200;height:"+dragObj.style.height+";width:"+dragObj.style.width+";top:"+dragObj.style.top+";left:"+dragObj.style.left+";background-color:blue;"},dragObj.parentNode);
        dragObj=null;
    },false);
    dragObj=null;newdiv=null;
}
mousemoveDrag = function(event){
//GM_log("mousemoveDrag");
    if (valMouseXY[0] != ""){
        if(valMouseXY[1]=="x") valMouseXY=[valMouseXY[0],event.pageX,event.pageY]; // init
        var dragObj=$top(valMouseXY[0]);
        var divDragHelper=$top("divDragHelper");
        if(doDrag[valMouseXY[0]][0]){
            dragObj.style.left=(parseInt(dragObj.style.left+"0",10) + (event.pageX - valMouseXY[1]))+'px';
            divDragHelper.style.left=dragObj.style.left;
        }
        if(doDrag[valMouseXY[0]][1]){
            dragObj.style.top= (parseInt(dragObj.style.top+"0",10) + (event.pageY - valMouseXY[2]))+'px';
            divDragHelper.style.top=dragObj.style.top;
        }
        valMouseXY=[valMouseXY[0],event.pageX,event.pageY];
        dragObj=null;divDragHelper=null;
    }
};
mouseupDrag = function(event){
//GM_log("mouseupDrag");
    top.window.removeEventListener("mousemove", mousemoveDrag ,false);
    if (valMouseXY[0] != ""){
        var dragObj=$top(valMouseXY[0]);
        dragPos[valMouseXY[0]]=[parseInt(dragObj.style.left+"0",10),parseInt(dragObj.style.top+"0",10)];
        GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_dragPos_"+valMouseXY[0],dragPos[valMouseXY[0]].join("|"));
        removeElement($top("divDragHelper"));
        dragObj=null;
    }
    valMouseXY=["",0,0,0,0];
    top.window.removeEventListener("mouseup", mouseupDrag ,false);
};

//***********************************************************************************************************
function resetVariables(){
/*
    createElement("div",{"id":"transp100","mode":"","style":"z-index:100;background-color:black;opacity:0.7;position:absolute;top:0;left:0;width:100%;height:100%;display:block;"},$("main_container"));
    newdiv=createElement("div",{"id":"infoPanel","mode":"","style":"position:absolute;top:50px;left:240px;width:660px;height:580px;background-color:#b8a789;z-index:101;display:block;"},$("main_container"));
    createElement("img",{"src":GFX+"guild/help_back.jpg","style":"position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1;"},newdiv);
    createElement("div",{"id":"infoPanelInner","class":"tnormal","style":"position:absolute;width:595px;height:89%;margin:5%;overflow:auto;"},newdiv);
    var newimg=createElement("img",{"id":"infoPanelClose","class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:8px;width:20px;height:20px;"},newdiv);
    newimg.addEventListener("click",function(){
        $("transp100").style.display = "none";
        $("infoPanel").style.display = "none";
    },false);

    try{
        var loginStr = new Array(new Object(), new Object(), new Object(), new Object());//[0]=global,[1]=server,[2]=user,[3]=vars over
        var listVars = cloneInto(GM_listValues(), unsafeWindow);
        var found = false;
        try{logindata=explode(GM_getValue("logindata"),"resetVariables\logindata");
            for(var v=0;v<logindata.length;v++){
                loginStr[0][logindata[v][0]]=true;
                loginStr[1][logindata[v][0]+"_"+logindata[v][1]]=true;
                loginStr[2][logindata[v][0]+"_"+logindata[v][1]+"_"+logindata[v][2]]=true;
            }
            loginStr[0].sortObj();
            GM_log("loginStr[0]:"+implode(loginStr[0]));
            loginStr[1].sortObj();
            GM_log("loginStr[1]:"+implode(loginStr[1]));
            loginStr[2].sortObj();
            GM_log("loginStr[2]:"+implode(loginStr[2]));

            for(var v in listVars){
                if(!listVars.hasOwnProperty(v)){continue;}
                found=false;
                for(var elm in loginStr[2]){
                    if(!loginStr[2].hasOwnProperty(elm)){continue;}
                    if(help=listVars[v].match(new RegExp("^"+elm+"_(.*)"))){
                        found=true;
                        loginStr[3][help[1]]=true;
                    }
                }
                if(!found){
                    for(var elm in loginStr[1]){
                        if(!loginStr[1].hasOwnProperty(elm)){continue;}
                        if(help=listVars[v].match(new RegExp("^"+elm+"_[^_]*_(.*)"))){
                            found=true;
                            loginStr[3][help[1]]=true;
                        }
                    }
                }
                if(found){
                    delete listVars[v];
                }
            }
            loginStr[3].sortObj();
            GM_log("loginStr[3]:"+implode(loginStr[3]));
            listVars.sort();
            GM_log("listVars:"+implode(listVars));

        }catch(err){GM_log("1:"+err);}
    }catch(err){GM_log("2:"+err);}
    return false;
*/
    if(confirm("Do you really want to reset zone data?")){
        var help=cloneInto(GM_listValues(), unsafeWindow);
        var help2;
        for(var v=0;v<help.length;v++){
            if(help[v].match(/_gut$/)){if(GM_getValue(help[v],"").indexOf("|")>0){ GM_deleteValue(help[v]); }}
            if(help[v].match(/_gutBeob$/)){if(GM_getValue(help[v],"").indexOf("|")>0){ GM_deleteValue(help[v]); }}

            if(help[v].match(/_prodName$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodNameSort$/)){GM_deleteValue(help[v]);}

            if(help[v].match(/_valGlobalTimeAdd$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_lodgeQuestData$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodStock$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodMinRack$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodMinRackInit$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_totalForestryFarmis$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodYield$/)){GM_deleteValue(help[v]);}
            if(help[v].match(/_prodRequire$/)){GM_deleteValue(help[v]);}

            if(help[v].match(/_changedata$/)){GM_deleteValue(help[v]);}
        }
        // GM_log(print_r(total));
        GM_deleteValue("loginbusy");
        if(GAMEPAGES[COUNTRY]){
            location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1";
        }
    }
}
function manageVariables(){
    // 1: historic data - not reproducible!
    // 2: collectable data
    // 3: options, settings
    // 4: temporary data = 2?
    // 5: useless, old data
    function buildManageVariables(){
    try{
        var container=$("divManageVariablesInner");
        container.innerHTML="";
        var containerPart = createElement("div",{"style":"height:10%;"},container);
        createElement("div",{"style":"font-weight:bold;"},containerPart,"Variable Management "+getText("adviser"));

        var newinput=createElement("select",{"class":"link"},containerPart);
        createElement("option",{"value":"GLOBAL"},newinput,"GLOBAL");
        createElement("option",{"value":"ALL"},newinput,"ALL");
        createElement("option",{"value":"UNKNOWN"},newinput,"UNKNOWN");
        createElement("option",{"value":"USELESS"},newinput,"USELESS");
        newinput.addEventListener("click",function(){
            buildExportTable(this.value);
        },false);

        var variables = {};
        variables["GLOBAL"] = [];
        var help = cloneInto(GM_listValues(), unsafeWindow);
        help.sort();
        var help2;
        for(var v=0;v<help.length;v++){
            help2 = (/^([A-Z]{2}_\d+_.+?_)(.*)$/).exec(help[v]); // COUNTRY_SERVER_USER_...
            if(!help2){ help2 = (/^([A-Z]{2}_\d+_)(.*)$/).exec(help[v]); // COUNTRY_SERVER_...
                if(!help2){ help2 = (/^([A-Z]{2}_)(.*)$/).exec(help[v]); // COUNTRY_...
            }   }

            if(help2){
                if(!variables[help2[1]]){
                    variables[help2[1]] = [];
                    createElement("option",{"value":help2[1]},newinput,help2[1]);
                }
                variables[help2[1]].push(help2[2]);
            } else {
                variables["GLOBAL"].push(help[v]); // GLOBAL
            }
        }

        newinput=createElement("button",{"class":"link","style":"margin-left:20px;"},containerPart,"Select all"); //TODO text
        newinput.addEventListener("click",function(){
            var container=$("divManageVariablesInner");
            var rows = container.children[1].getElementsByTagName("tr");
            var checkedNew;
            if(this.innerHTML=="Select all"){ //TODO text
                checkedNew = true;
                this.innerHTML="Unselect all"; //TODO text
            } else {
                checkedNew = false;
                this.innerHTML="Select all"; //TODO text
            }
            for (var v=0;v<rows.length;v++){
                rows[v].children[0].children[0].checked = checkedNew;
            }

        },false);

        newinput=createElement("button",{"class":"link","style":"margin-left:20px;"},containerPart,getText("delete"));
        newinput.addEventListener("click",function(){
            var container=$("divManageVariablesInner");
            var rows = container.children[1].getElementsByTagName("tr");
            var variables = [];
            var acc, varname;
            var str = getText("deleteFollowingData")+": ";
            for (var v=0;v<rows.length;v++){
                if(rows[v].children[0].children[0].checked){
                    acc = rows[v].children[1].innerHTML;
                    varname = rows[v].children[2].innerHTML;
                    variables.push(acc+varname);
                    if(variables.length<11){ str += "\n"+acc+varname; }
                }
            }
            if(variables.length>0){
                if(variables.length>10){ str += "\n..." }
                if(confirm(str)){
                    for (var v=0;v<variables.length;v++){
                        GM_deleteValue(variables[v]);
                    }
                    buildManageVariables();
                }
            } else {
                alert(getText("nothingSelected"));
            }
        },false);

        newinput=createElement("button",{"class":"link","style":"margin-left:20px;"},containerPart,getText("createStorageString"));
        newinput.addEventListener("click",function(){
            var container=$("divManageVariablesInner");
            var rows = container.children[1].getElementsByTagName("tr");
            var variables = [];
            var acc, varname;
            for (var v=0;v<rows.length;v++){
                if(rows[v].children[0].children[0].checked){
                    acc = rows[v].children[1].innerHTML;
                    varname = rows[v].children[2].innerHTML;
                    variables.push([acc+varname,GM_getValue(acc+varname)]);
                }
            }
            if(variables.length>0){
                prompt(getText("copyToTextFile"), implode(variables,"manageVariables/variables"));
            } else {
                alert(getText("nothingSelected"));
            }
        },false);

        newinput=createElement("button",{"class":"link","style":"margin-left:20px;"},containerPart,getText("importStorageString"));
        newinput.addEventListener("click",function(){
            var data = prompt("Enter storage string"); //TODO text
            if(data){
                try{
                    data = explode(data,"buildImportTable/storageString");
                    buildImportTable(data);
                }catch(err){ alert(getText("importStorageStringError")+"\n"+err); }
            }
        },false);

        containerPart = createElement("div",{"style":"height:90%;overflow-y:scroll;"},container);
        function buildExportTable(filter){
        try{
            var container=$("divManageVariablesInner");
            container.children[1].innerHTML = "";
            var newtable=createElement("table",{"border":"1","class":"hoverRowBgCc9","style":"width:100%"},container.children[1]);
            var newtr,newtd;
            var help3=cloneInto(GM_listValues(), unsafeWindow);
            var help=[],help2;
            for(var v=0;v<help3.length;v++){
                help2 = (/^([A-Z]{2}_\d+_.+?_)(.*)$/).exec(help3[v]); // COUNTRY_SERVER_USER_...
                if(help2){
                    help[v] = [help2[1],help2[2],"USER"];
                } else {
                    help2 = (/^([A-Z]{2}_\d+_)(.*)$/).exec(help3[v]); // COUNTRY_SERVER_...
                    if(help2){
                        help[v] = [help2[1],help2[2],"SERVER"];
                    } else {
                        help2 = (/^([A-Z]{2}_)(.*)$/).exec(help3[v]); // COUNTRY_...
                        if(help2){
                            help[v] = [help2[1],help2[2],"COUNTRY"];
                        } else {
                            help[v] = ["",help3[v],"GLOBAL"];
                        }
                    }
                }
            }
            help.sort(function(a,b){
                if(a[0]==b[0]){ return ((a[1]>b[1])-(a[1]<b[1])); }
                          else{ return ((a[0]>b[0])-(a[0]<b[0])); }
            });

            for(var v=0;v<help.length;v++){
                switch(filter){
                case "ALL": break;
                case "GLOBAL":if(help[v][0]!=""){ continue; } break;
                case "UNKNOWN":if(VARIABLES[help[v][2]][help[v][1]]){ continue; } break;
                case "USELESS":if((!VARIABLES[help[v][2]][help[v][1]])||(VARIABLES[help[v][2]][help[v][1]][1]!=5)){ continue; } break;
                default: if(help[v][0]!=filter){ continue; }
                }

                help[v][4] = GM_getValue(help[v][0]+help[v][1]);
                help[v][3] = "s";
                // if(help[v][4]==""){ help[v][4]=" "; }
                if(typeof help[v][4]=="number"){ help[v][3]="n"; }
                else if(typeof help[v][4]=="boolean"){ help[v][3]="b"; }
                else{   // help[v][4] = help[v][4].replace(/(:+)/g,":");
                        if(help[v][4].length>100){
                            help[v][4] = help[v][4].substr(0,97)+"...";
                        }
                    }

                newtr=createElement("tr",{},newtable);
                newtd = createElement("td",{},newtr);
                createElement("input",{"type":"checkbox","class":"link","checked":false},newtd);
                createElement("td",{},newtr,help[v][0]);
                createElement("td",{},newtr,help[v][1]);
                createElement("td",{},newtr,help[v][3]);
                if(VARIABLES[help[v][2]][help[v][1]]){
                    createElement("td",{},newtr,VARIABLES[help[v][2]][help[v][1]][0]);
                    createElement("td",{},newtr,[,"historic data - not reproducible!","collectable data","options, settings","temporary data","useless, old data"][VARIABLES[help[v][2]][help[v][1]][1]]);
                } else {
                    createElement("td",{},newtr,"unknown");
                    createElement("td",{},newtr,"");
                }
                createElement("td",{},newtr,help[v][4]);

            }
            container=null;newtable=null;newtr=null;newtd=null;
        }catch(err){ GM_logError("buildExportTable","","",err); }
        }
        buildExportTable("GLOBAL");

        function buildImportTable(data){
        try{
            var container=$("divManageVariablesInner");
            container.children[1].innerHTML = "";
            var newinput=createElement("button",{"class":"link"},container.children[1],"SAVE !");
            newinput.addEventListener("click",function(){
                var container=$("divManageVariablesInner");
                var rows = container.children[1].getElementsByTagName("tr");
                var variables = [];
                var acc, varname;
                for (var v=0;v<rows.length;v++){
                    if(rows[v].children[0].children[0].checked){
                        GM_setValue(data[v][0]+data[v][1],data[v][3]);
                    }
                }
                buildManageVariables();
            },false);
            var newtable=createElement("table",{"border":"1","class":"hoverRowBgCc9","style":"width:100%"},container.children[1]);
            var newtr,newtd;
            var help2;
            var dataLevel;
            for(var v=0;v<data.length;v++){
                help2 = (/^([A-Z]{2}_\d+_.+?_)(.*)$/).exec(data[v][0]); // COUNTRY_SERVER_USER_...
                if(help2){
                    dataLevel = "USER";
                    data[v] = [help2[1],help2[2],"s",data[v][1]];
                } else {
                    help2 = (/^([A-Z]{2}_\d+_)(.*)$/).exec(data[v][0]); // COUNTRY_SERVER_...
                    if(help2){
                        dataLevel = "SERVER";
                        data[v] = [help2[1],help2[2],"s",data[v][1]];
                    } else {
                        help2 = (/^([A-Z]{2}_)(.*)$/).exec(data[v][0]); // COUNTRY_...
                        if(help2){
                            dataLevel = "COUNTRY";
                            data[v] = [help2[1],help2[2],"s",data[v][1]];
                        } else {
                            dataLevel = "GLOBAL";
                            data[v] = ["",data[v][0],"s",data[v][1]];
                        }
                    }
                }
                if(typeof data[v][3]=="number"){ data[v][2]="n"; }
                else if(typeof data[v][3]=="boolean"){ data[v][2]="b"; }

                newtr=createElement("tr",{},newtable);
                newtd = createElement("td",{},newtr);
                createElement("input",{"type":"checkbox","class":"link","checked":true},newtd);
                createElement("td",{},newtr,data[v][0]);
                createElement("td",{},newtr,data[v][1]);
                createElement("td",{},newtr,data[v][2]);
                if(VARIABLES[dataLevel][data[v][1]]){
                    createElement("td",{},newtr,VARIABLES[dataLevel][data[v][1]][0]);
                    createElement("td",{},newtr,[,"historic data - not reproducible!","collectable data","options, settings","temporary data","useless, old data"][VARIABLES[dataLevel][data[v][1]][1]]);
                } else {
                    createElement("td",{},newtr,"unknown");
                    createElement("td",{},newtr,"");
                }
                if(data[v][3].length>100){
                    createElement("td",{},newtr,data[v][3].substr(0,97)+"...");
                } else {
                    createElement("td",{},newtr,data[v][3]);
                }
            }
            container=null;newtable=null;newtr=null;newtd=null;newinput=null;
        }catch(err){ GM_logError("buildImportTable","","",err); }
        }

        container=null;containerPart=null;newselect=null;
        newdiv=null;newinput=null;
    }catch(err){ GM_logError("buildManageVariables","","",err); }
    }

    if($("divManageVariables")){ return false; }
    var newdiv=createElement("div",{"id":"divManageVariables","mode":"","style":"position:fixed;top:0;left:0;width:100%;height:100%;background-color:#b8a789;z-index:1000;display:block;"},ALL);
    createElement("img",{"src":GFX+"guild/help_back.jpg","style":"position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1;"},newdiv);
    createElement("div",{"id":"divManageVariablesInner","class":"tnormal","style":"position:absolute;top:6%;left:5%;width:90%;height:88%;overflow:auto;"},newdiv);
    var newimg=createElement("img",{"id":"infoPanelClose","class":"link","src":GFX+"close.jpg","style":"position:absolute;top:8px;right:8px;width:20px;height:20px;"},newdiv);
    newimg.addEventListener("click",function(){ removeElement(this.parentNode); },false);
    newdiv = null;newimg=null;
    buildManageVariables();
}

function do_login(){
    try{
        if(top!=self){ return; }
        if((location.pathname.match(/^\/login\.php$/))&&(pageZusatz["logout"]=="1")){
            GM_logInfo("do_login","","location.href="+location.href,"Logout-page found. Return to login-page."); // TODO text
            if(GAMEPAGES[COUNTRY]){
                window.setTimeout(function(){ location.href="http://www."+GAMEPAGES[COUNTRY]+"/login.php?start=1"; },1000); // go to login-page after logout (old page)
            }
        }else if($("login_container")){
            do_login_old();
        }else if($("loginbar")){
            GM_logInfo("do_login","","location.href="+location.href+" pagedata="+implode(pagedata,"do_login/pagedata"),getText("loginPageFound"));
            // account data
            var logindata=explode(GM_getValue("logindata"),"do_login/logindata",[]);
            var c=0;
            var servers=new Object(); // servers["language_serverNr"]=[logindataNr,logindataNr,...]
            for(var v=0;v<logindata.length;v++){
                if(logindata[v][4]){
                    c++;
                    if(!servers[logindata[v][0]+"_"+logindata[v][1]]){ servers[logindata[v][0]+"_"+logindata[v][1]]=new Array(); }
                    servers[logindata[v][0]+"_"+logindata[v][1]].push(v);
                }
            }
            // listener login-form to store username
            $("loginelements").querySelector("#loginbutton").parentNode.addEventListener("submit",function(){
                try{
                    var currServer=this.querySelector("#loginserver").value;
                    var currUser=this.querySelector("#loginusername").value.toLowerCase();
                    GM_logInfo("loginform.submit","","server="+currServer+" user="+currUser,getText("loginSubmitted"));
                    GM_setValueCache(COUNTRY+"_"+currServer+"_username",currUser.toLowerCase());
                }catch(err){ GM_logError("loginform.submit","","server="+currServer+" user="+currUser,err); }
            },false);
            // listener portal login-form to store username
            $("portal").querySelector("#portalmiddle").parentNode.addEventListener("submit",function(){
                try{
                    var currServer=this.querySelector("#portalserver").value;
                    var currUser=this.querySelector("#portalusername").value.toLowerCase();
                    GM_logInfo("portalform.submit","","server="+currServer+" user="+currUser,getText("loginPortalSubmitted"));
                    GM_setValueCache(COUNTRY+"_"+currServer+"_username",currUser.toLowerCase());
                }catch(err){ GM_logError("portalform.submit","","server="+currServer+" user="+currUser,err); }
            },false);
            // execute login
            function submit_login(accNr){
                window.setTimeout(function(){
                    try{
                        reloader.start("submitLogin",20,getText("loginSubmitted")); // no reloader.stop because new page has to load
                        var logindata=explode(GM_getValue("logindata"),"submit_login/logindata",[]);
                        if(logindata[accNr][0]==COUNTRY){
                            if(logindata[accNr][5]){
                                click($("portalicon"));
                                var login_container=$("portal");
                                login_container.querySelector("#portalserver").value=logindata[accNr][1];
                                login_container.querySelector("#portalusername").value=logindata[accNr][2];
                                login_container.querySelector("#portalpassword").value=enc(logindata[accNr][3],-4242);
                                GM_setValueCache(COUNTRY+"_"+logindata[accNr][1]+"_username",logindata[accNr][2].toLowerCase());
                                click(login_container.querySelector("#portalbutton"));
                                login_container=null;
                            }else{
                                var login_container=$("loginelements");
                                login_container.querySelector("#loginserver").value=logindata[accNr][1];
                                login_container.querySelector("#loginusername").value=logindata[accNr][2];
                                login_container.querySelector("#loginpassword").value=enc(logindata[accNr][3],-4242);
                                GM_setValueCache(COUNTRY+"_"+logindata[accNr][1]+"_username",logindata[accNr][2].toLowerCase());
                                click(login_container.querySelector("#loginbutton"));
                                login_container=null;
                            }
                        }else if(GAMEPAGES[logindata[accNr][0]]){
                            var help=explode(GM_getValue(logindata[accNr][0]+"_pagedataLogin"),"submit_login/pagedataLogin",{});
                            if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                                help["dologin"]=new Object();
                            }
                            help["dologin"][accNr]=true;
                            GM_setValue(logindata[accNr][0]+"_pagedataLogin",implode(help,"submit_login/help"));
                            location.href="http://www."+GAMEPAGES[logindata[accNr][0]]+"/login.php?start=1";
                        }
                    }catch(err){ GM_logError("submit_login","accNr="+accNr,"",err); }
                },0);
            }
            var currDoLogin=null;
            var currDoServer=null;
            var pagedata=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"do_login/pagedataLogin",{});
            if(pagedata["doserver"]){
                if(typeof pagedata["doserver"]=="object"){
                    for(var v in pagedata["doserver"]){
                        if(!pagedata["doserver"].hasOwnProperty(v)){ continue; }
                        currDoServer=v;
                        delete pagedata["doserver"][v];
                        break;
                    }
                    if(pagedata["doserver"].isEmpty()){ delete pagedata["doserver"]; }
                }else{
                    delete pagedata["doserver"];
                }
            }else if(pagedata["dologin"]){
                if(typeof pagedata["dologin"]=="object"){
                    for(var v in pagedata["dologin"]){
                        if(!pagedata["dologin"].hasOwnProperty(v)){ continue; }
                        currDoLogin=v;
                        delete pagedata["dologin"][v];
                        break;
                    }
                    if(pagedata["dologin"].isEmpty()){ delete pagedata["dologin"]; }
                }else{
                    delete pagedata["dologin"];
                }
            }
            GM_setValue(COUNTRY+"_pagedataLogin",implode(pagedata,"do_login/pagedata"));
            if(currDoServer!=null){
                var help=GM_getValue(COUNTRY+"_"+currDoServer+"_username","");
                for(var v=0;v<logindata.length;v++){
                    if((logindata[v][4])&&(logindata[v][0]==COUNTRY)&&(logindata[v][1]==currDoServer)&&(logindata[v][2].toLowerCase()==help)){
                        currDoLogin=v;
                        break;
                    }
                }
                if(currDoLogin!=null){
                    for(var v=0;v<logindata.length;v++){
                        if((logindata[v][4])&&(logindata[v][0]==COUNTRY)&&(logindata[v][1]==currDoServer)){
                            currDoLogin=v;
                            break;
                        }
                    }
                }
            }
            if(currDoLogin!=null){
                submit_login(currDoLogin);
            }else{
                var newdiv,newbutton;
                // Buttons
                newdiv=createElement("div",{"id":"divBeraterButtons"},ALL);
                newdiv.addEventListener("mouseover",function(event){
                    var node=event.target;
                    var mouseOverText=node.getAttribute("mouseOverText");
                    while((node!=this)&&(!mouseOverText)){
                        node=node.parentNode;
                        mouseOverText=node.getAttribute("mouseOverText");
                    }
                    if(mouseOverText){ toolTip.show(event,mouseOverText); }
                    node=null;mouseOverText=null;
                },false);
                newdiv.addEventListener("click",function(){
                    if($("divInfo")){ click($("divInfo")); }
                },false);
                // Button manage accounts
                newbutton=createElement("div",{"class":"link beraterButtonIcon hoverBgGreen","mouseOverText":getText("accounts")},newdiv);
                createElement("img",{"src":IMAGES["settings"],"style":"position:relative;top:-3px;left:-1px;;width:32px;height:32px;"},newbutton);
                newbutton.addEventListener("click",function(){ unsafeWindow.buildInfoPanel("menu","accounts"); },false);
                // Button manage variables
                newbutton=createElement("div",{"class":"link beraterButtonIcon hoverBgGold","mouseOverText":getText("manageVariables")+" ("+getText("adviser")+")"},newdiv);
                createElement("img",{"src":IMAGES["floppyDisk"],"style":"position:relative;top:3px;left:3px;;width:24px;height:24px;"},newbutton);
                newbutton.addEventListener("click",manageVariables,false);
                // Buttons accounts
                newdiv=createElement("div",{"style":"position:absolute;left:50%;margin-left:250px;top:205px;height:263px;overflow-x:hidden;overflow-y:auto;padding-right:17px;"},$("content"));
                for(var v=0;v<logindata.length;v++){ if(logindata[v][4]){
                    newbutton=createElement("div",{"class":"link loginbutton hoverBgLightblue","id":"autologin"+v},newdiv,getText("server")+"&nbsp;"+logindata[v][1]+"."+logindata[v][0]+":&nbsp;"+logindata[v][2]);
                    newbutton.addEventListener("click",function(){
                        if($("divInfo")){ click($("divInfo")); }
                        submit_login(this.id.replace("autologin",""));
                    },false);
                }}
                // Autologin
                var lastbusy=GM_getValue("loginbusy",0);
                if (isNaN(lastbusy) || now<lastbusy){ lastbusy=0; }
                if (GM_getValue("valAutoLogin",true) && (c>0) && (now-lastbusy>15)){
                    GM_setValue("loginbusy",now);
                    newdiv=createElement("div",{"id":"divInfo","class":"round transp shadow","style":"position:absolute;left:50%;margin-left:-150px;top:470px;height:130px;width:300px;z-index:200;"},$("content"));
                    createElement("div",{"class":"buttontext4","style":""},newdiv,getText("autologinChecking").replace(/%1%/,"5"));
                    newdiv.addEventListener("click",function(){
                        removeElement(this);
                    },false);
                    for(var v in servers){
                        if(!servers.hasOwnProperty(v)){ continue; }
                        GM_setValue(v+"_sessionlost",true);
                    }
                    var counter=5;
                    function autologinLoop(){
                        counter -= 0.5;
                        if(!$("divInfo")){ return false; }
                        if(counter>0){
                            $("divInfo").firstElementChild.innerHTML=getText("autologinChecking").replace(/%1%/,Math.ceil(counter));
                            var c=0;
                            for(var v in servers){
                                if(!servers.hasOwnProperty(v)){ continue; }
                                if (GM_getValue(v+"_sessionlost",true)){
                                    c++;
                                }else{
                                    var help=GM_getValue(v+"_username","");
                                    for(var w=0;w<servers[v].length;w++){
                                        $("autologin"+servers[v][w]).style.backgroundColor=(logindata[servers[v][w]][2].toLowerCase()==help?"#00ff00":"#008800");
                                    }
                                    //delete servers[v];
                                }
                            }
                            if(c==0){ counter=0; }
                            window.setTimeout(autologinLoop,500);
                        }else{
                            var c=null;
                            for(var v in servers){
                                if(!servers.hasOwnProperty(v)){ continue; }
                                if (GM_getValue(v+"_sessionlost",true)){
                                    if (c==null){
                                        c=servers[v][0];
                                    }else if(GAMEPAGES[logindata[servers[v][0]][0]]){
                                        var help=explode(GM_getValue(logindata[servers[v][0]][0]+"_pagedataLogin"),"autologinLoop/pagedataLogin",{});
                                        if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                                            help["dologin"]=new Object();
                                        }
                                        help["dologin"][servers[v][0]]=true;
                                        GM_setValue(logindata[servers[v][0]][0]+"_pagedataLogin",implode(help,"do_login/help"));
                                        window.open("http://www."+GAMEPAGES[logindata[servers[v][0]][0]]+"/login.php?start=1");
                                    }
                                }
                            }

                            if (c==null){
                                // all logged in
                                $("divInfo").firstElementChild.innerHTML=getText("autologinAllOk");
                                window.setTimeout(function(){
                                    for(var v in servers){
                                        if(!servers.hasOwnProperty(v)){ continue; }
                                        for(var w=0;w<servers[v].length;w++){
                                            $("autologin"+servers[v][w]).style.backgroundColor="white";
                                        }
                                        GM_setValue(v+"_sessionlost",true);
                                    }
                                    now=Math.floor((new Date()).getTime()/1000);
                                    GM_setValue("loginbusy",now);
                                    counter=5;
                                    autologinLoop();
                                },5000);
                            }else{
                                GM_setValue("loginbusy",0);
                                submit_login(c);
                            }
                        }
                    }
                    window.setTimeout(autologinLoop,500);
                }
                newdiv=null;newbutton=null;
            }
        }
    }catch(err){ GM_logError("do_login","","",err); }
}
function do_login_old(){
    try{
        GM_logInfo("do_login_old","","location.href="+location.href,"Old login-page found");
        //paypal
        //var newform=createElement("form",{"id":"paypalForm","action":"https://www.paypal.com/cgi-bin/webscr","method":"post","style":"position:absolute;top:30px;left:117px;"},ALL);
        //createElement("input",{"type":"hidden","name":"cmd","value":"_donations"},newform);
        //createElement("input",{"type":"hidden","name":"business","value":"jessicakanaan@web.de"},newform);
        //createElement("input",{"type":"hidden","name":"lc","value":((LANGUAGE=="de")?"DE":"US")},newform);
        //createElement("input",{"type":"hidden","name":"item_name","value":"MyFreeFarm Script"},newform);
        //createElement("input",{"type":"hidden","name":"no_note","value":"0"},newform);
        //createElement("input",{"type":"hidden","name":"currency_code","value":"EUR"},newform);
        //createElement("input",{"type":"hidden","name":"bn","value":"PP-DonationsBF:btn_donate_LG.gif:NonHostedGuest"},newform);
        //createElement("input",{"type":"image","border":"0","src":"https://www.paypal.com/"+((LANGUAGE=="de")?"de_DE/DE":"en_US")+"/i/btn/btn_donate_LG.gif","name":"submit",alt:"PayPal"},newform);
        //createElement("img",{"alt":"","border":"0","src":"https://www.paypal.com/en_US/i/scr/pixel.gif","width":"1","height":"1"},newform);
        //newform=null;

        //login
        var logindata=explode(GM_getValue("logindata"),"do_login_old/logindata",[]);
        var c=0;
        var servers=new Object(); // servers["language_serverNr"]=[logindataNr,logindataNr,...]
        for(var v=0;v<logindata.length;v++){
            if(logindata[v][4]){
                c++;
                if(!servers[logindata[v][0]+"_"+logindata[v][1]]){ servers[logindata[v][0]+"_"+logindata[v][1]]=new Array(); }
                servers[logindata[v][0]+"_"+logindata[v][1]].push(v);
            }
        }

        $("login_container").querySelector("#submitlogin").addEventListener("click",function(){
            try{
                var login_container=$("login_container");
                var currServer=login_container.querySelector("#loginserver").value;
                var currUser=login_container.querySelector("#loginusername").value.toLowerCase();
                GM_setValueCache(COUNTRY+"_"+currServer+"_username",currUser.toLowerCase());
                login_container=null;
            }catch(err){ GM_logError("login_container.submitlogin.click","","",err); }
        },false);

        function submit_login(accNr){
            window.setTimeout(function(){
                try{
                    var logindata=explode(GM_getValue("logindata"),"submit_login/logindata",[]);
                    if(logindata[accNr][0]==COUNTRY){
                        var login_container=$("login_container");
                        login_container.querySelector("#loginserver").value=logindata[accNr][1];
                        login_container.querySelector("#loginusername").value=logindata[accNr][2];
                        login_container.querySelector("#loginpassword").value=enc(logindata[accNr][3],-4242);
                        GM_setValueCache(COUNTRY+"_"+logindata[accNr][1]+"_username",logindata[accNr][2].toLowerCase());
                        click(login_container.querySelector("#submitlogin"));
                        login_container=null;
                    }else if(GAMEPAGES[logindata[accNr][0]]){
                        var help=explode(GM_getValue(logindata[accNr][0]+"_pagedataLogin"),"submit_login/pagedataLogin",{});
                        if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                            help["dologin"]=new Object();
                        }
                        help["dologin"][accNr]=true;
                        GM_setValue(logindata[accNr][0]+"_pagedataLogin",implode(help,"submit_login/help"));
                        location.href="http://www."+GAMEPAGES[logindata[accNr][0]]+"/login.php?start=1";
                    }
                }catch(err){ GM_logError("submit_login","accNr="+accNr,"",err); }
            },0);
        }

        var currDoLogin=null;
        var currDoServer=null;
        var pagedata=explode(GM_getValue(COUNTRY+"_pagedataLogin"),"do_login_old/pagedataLogin",{});
        GM_logInfo("do_login_old","","location.href="+location.href+" pagedata="+implode(pagedata,"do_login_old/pagedata"),"");
        if(pagedata["doserver"]){
            if(typeof pagedata["doserver"]=="object"){
                for(var v in pagedata["doserver"]){
                    if(!pagedata["doserver"].hasOwnProperty(v)){ continue; }
                    currDoServer=v;
                    delete pagedata["doserver"][v];
                    break;
                }
                if(pagedata["doserver"].isEmpty()){ delete pagedata["doserver"]; }
            }else{
                delete pagedata["doserver"];
            }
        }else if(pagedata["dologin"]){
            if(typeof pagedata["dologin"]=="object"){
                for(var v in pagedata["dologin"]){
                    if(!pagedata["dologin"].hasOwnProperty(v)){ continue; }
                    currDoLogin=v;
                    delete pagedata["dologin"][v];
                    break;
                }
                if(pagedata["dologin"].isEmpty()){ delete pagedata["dologin"]; }
            }else{
                delete pagedata["dologin"];
            }
        }
        GM_setValue(COUNTRY+"_pagedataLogin",implode(pagedata,"do_login_old/pagedata"));

        if(currDoServer!=null){
            var help=GM_getValue(COUNTRY+"_"+currDoServer+"_username","");
            for(var v=0;v<logindata.length;v++){
                if((logindata[v][4])&&(logindata[v][0]==COUNTRY)&&(logindata[v][1]==currDoServer)&&(logindata[v][2].toLowerCase()==help)){
                    currDoLogin=v;
                    break;
                }
            }
            if(currDoLogin!=null){
                for(var v=0;v<logindata.length;v++){
                    if((logindata[v][4])&&(logindata[v][0]==COUNTRY)&&(logindata[v][1]==currDoServer)){
                        currDoLogin=v;
                        break;
                    }
                }
            }
        }

        if(currDoLogin!=null){
            submit_login(currDoLogin);
        }else{
            var newdiv=createElement("div",{"style":"position:relative;top:-400px;left:300px;"},$("login_container"));
            var newbutton;

            newbutton=createElement("div",{"id":"GM_manageVariables","style":"position:absolute;top:-200px;"},newdiv);
            newbutton=createElement("div",{"class":"link loginbutton hoverBgLightblue","style":"background-color:orange;"},newbutton,getText("manageVariables")+" ("+getText("adviser")+")");
            newbutton.addEventListener("click",function(){
                if($("divInfo")){ click($("divInfo")); }
                manageVariables();
            },false);


            for(var v=0;v<logindata.length;v++){ if(logindata[v][4]){
                newbutton=createElement("div",{"class":"link loginbutton hoverBgLightblue","id":"autologin"+v},newdiv,getText("server")+"&nbsp;"+logindata[v][1]+"."+logindata[v][0]+":&nbsp;"+logindata[v][2]);
                newbutton.addEventListener("click",function(){
                    if($("divInfo")){ click($("divInfo")); }
                    submit_login(this.id.replace("autologin",""));
                },false);
            }}

            //Autologin
            var lastbusy=GM_getValue("loginbusy",0);
            if (isNaN(lastbusy) || now<lastbusy){ lastbusy=0; }
            if (GM_getValue("valAutoLogin",true) && (c>0) && (now-lastbusy>15)){
                GM_setValue("loginbusy",now);
                newdiv=createElement("div",{"id":"divInfo","style":"position:absolute;top:190px;left:455px;height:200px;width:280px;background-color:#842;border:4px solid black;z-index:200;"},$("main_container"),"<h1>"+getText("autologinChecking").replace(/%1%/,"5")+"</h1>");
                newdiv.addEventListener("click",function(){
                    removeElement(this);
                },false);

                for(var v in servers){
                    if(!servers.hasOwnProperty(v)){ continue; }
                    GM_setValue(v+"_sessionlost",true);
                }
                var counter=5;
                function autologinLoop(){
                    counter -= 0.5;
                    if(!$("divInfo")){ return false; }
                    if(counter>0){
                        $("divInfo").innerHTML="<h1>"+getText("autologinChecking").replace(/%1%/,Math.ceil(counter))+"</h1>";
                        var c=0;
                        for(var v in servers){
                            if(!servers.hasOwnProperty(v)){ continue; }
                            if (GM_getValue(v+"_sessionlost",true)){
                                c++;
                            }else{
                                var help=GM_getValue(v+"_username","");
                                for(var w=0;w<servers[v].length;w++){
                                    $("autologin"+servers[v][w]).style.backgroundColor=(logindata[servers[v][w]][2].toLowerCase()==help?"#00ff00":"#008800");
                                }
                                //delete servers[v];
                            }
                        }
                        if(c==0){ counter=0; }
                        window.setTimeout(autologinLoop,500);
                    }else{
                        var c=null;
                        for(var v in servers){
                            if(!servers.hasOwnProperty(v)){ continue; }
                            if (GM_getValue(v+"_sessionlost",true)){
                                if (c==null){
                                    c=servers[v][0];
                                }else if(GAMEPAGES[logindata[servers[v][0]][0]]){
                                    var help=explode(GM_getValue(logindata[servers[v][0]][0]+"_pagedataLogin","{}"),"autologinLoop/pagedataLogin",{});
                                    if(!(help["dologin"]&&(typeof help["dologin"]=="object"))){
                                        help["dologin"]=new Object();
                                    }
                                    help["dologin"][servers[v][0]]=true;
                                    GM_setValue(logindata[servers[v][0]][0]+"_pagedataLogin",implode(help,"do_login_old/help"));
                                    window.open("http://www."+GAMEPAGES[logindata[servers[v][0]][0]]+"/login.php?start=1");
                                }
                            }
                        }

                        if (c==null){
                            // all logged in
                            $("divInfo").innerHTML="<h1>"+getText("autologinAllOk")+"</h1>";
                            window.setTimeout(function(){
                                for(var v in servers){
                                    if(!servers.hasOwnProperty(v)){ continue; }
                                    for(var w=0;w<servers[v].length;w++){
                                        $("autologin"+servers[v][w]).style.backgroundColor="white";
                                    }
                                    GM_setValue(v+"_sessionlost",true);
                                }
                                now=Math.floor((new Date()).getTime()/1000);
                                GM_setValue("loginbusy",now);
                                counter=5;
                                autologinLoop();
                            },5000);
                        }else{
                            GM_setValue("loginbusy",0);
                            submit_login(c);
                        }
                    }
                }
                window.setTimeout(autologinLoop,500);
            }
            newdiv=null;newbutton=null;
        }
    }catch(err){ GM_logError("do_login_old","","",err); }
}
//***********************************************************************************************************

// Starting the script

function scriptStart(){
try{
    var err_trace="Init";
    reloader.stop("pageLoad");
    reloader.start("scriptLoad",10,getText("userscriptNotStarted"));
    err_trace="CSS";
    {
    GM_addStyle(
        "input:hover{background-color:#cc9!important;}\
        input:focus{background-color:lightblue!important;}\
        button:hover{background-color:#cc9!important;}\
        button:hover{background-color:#cc9!important;}\
        .white,.white td,.white th,.white div,.white span,.white a {color:white;}\
        .black,.black td,.black th,.black div,.black span,.black a {color:black;}\
        .grey,.grey td,.grey th,.grey div,.grey span,.grey a {color:grey;}\
        .red,.red td,.red th,.red div,.red span,.red a {color:red;}\
        th{font-weight:bold;border-bottom:1px dashed black;background-color:#b69162;}\
        th.lightBg{background-color:#d5c0a5!important;}\
        .borderTop1dashedWhite,.borderTop1dashedWhite>td,.borderTop1dashedWhite>th{border-top:1px dashed white!important;}\
        .borderTop1dashedBlack,.borderTop1dashedBlack>td,.borderTop1dashedBlack>th{border-top:1px dashed black!important;}\
        .borderBottom1White,.borderBottom1White>td,.borderBottom1White>th{border-bottom:1px solid white!important;}\
        .borderBottom1Black,.borderBottom1Black>td,.borderBottom1Black>th{border-bottom:1px solid black!important;}\
        .borderBottom1dashedBlack,.borderBottom1dashedBlack>td,.borderBottom1dashedBlack>th{border-bottom:1px dashed black!important;}\
        .borderBottom1dashedGrey,.borderBottom1dashedGrey>td,.borderBottom1dashedGrey>th{border-bottom:1px dashed grey!important;}\
        .blinking{animation-name:blink;animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:normal;animation-delay:0;animation-play-state:running;animation-fill-mode:forwards;}\
        @keyframes blink{0%{opacity:1;}90%{opacity:0.4;}100%{opacity:1;}}\
        .rotating{animation-name:rotate;animation-duration:3s;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:normal;animation-delay:0;animation-play-state:running;animation-fill-mode:forwards;}\
        @keyframes rotate{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}"
    );
    GM_addStyle(
        ".alertbox{color:white;background-color:red;font-weight:bold;}\
        .alertbubble{position:absolute;top:0;left:0;width:340px;padding:30px;background-color:yellow;border:3px solid black;border-radius:10px;z-index:1000;}\
        .sortableColAsc{background-color:lightblue!important;}\
        .sortableColDesc{background-color:lightblue!important;}\
        .hoverBlack:hover,div.hoverBlack:hover div{color:black!important;}\
        .hoverRowBgCc9 tr:hover{background-color:#cc9!important;}\
        .hoverRowBgLightblue>tr:hover{background-color:lightblue!important;}\
        .hoverRowBgLightbrown>tr:hover{background-color:#e4b55d!important;}\
        .hoverBgBlue:hover{background-color:blue!important;}\
        .hoverBgCc9:hover{background-color:#cc9!important;}\
        .hoverBgDarkgreen:hover{background-color:#084200!important;}\
        .hoverBgGreen:hover{background-color:green!important;}\
        .hoverBgGold:hover{background-color:gold!important;}\
        .hoverBgLightblue:hover{background-color:lightblue!important;}\
        .hoverBgLightbrown:hover{background-color:#e4b55d!important;}\
        .hoverBgRed:hover{background-color:red!important;}\
        .hoverBgBlack:hover{background-color:black!important;}\
        .hoverNoTextDecoration:hover,td.hoverNoTextDecoration:hover,span.hoverNoTextDecoration:hover{text-decoration:none!important;}"
    );
    GM_addStyle(
        ".v97{background-position: -240px -120px!important;}\n" // Bugfix Poinsettia (Weihnachtsstern)
        +".v104{background-position: -180px -300px!important;}\n" // Bugfix Daffodil (Osterglocke)
        +".v107{background-position: -240px -300px!important;}\n" // Bugfix Grapes (Weintrauben)
        +".v129{background-position: 0px -390px!important;}\n" // Bugfix Tea (Tee)
        +".v158{background-position: 0px -480px!important;}\n" // Bugfix Tulips (Tulpen)
    );
    GM_addStyle(
        ".playerMsg{float:left;margin-right:7px;background-image:url('"+GFX+"guild/mail.gif');background-position:0px -3px;}\
        .playerMsg div{width:15px;height:12px;opacity:0.5;}\
        .playerMsg div:hover{background-color:blue;}\
        .playerContract{float:left;margin-right:5px;background-image:url('"+GFX+"guild/contract.gif');background-position:-2px 0px;}\
        .playerContract div{width:11px;height:15px;opacity:0.5;}\
        .playerContract div:hover{background-color:blue;}\
        .playerStats{float:left;margin-right:5px;background-image:url('"+GFX+"stadt/stats_sf_black.gif');background-repeat:no-repeat;background-position:0px 2px;}\
        .playerStats div{position:relative;top:1px;width:11px;height:9px;opacity:0.5;border-radius:5px;}\
        .playerStats div:hover{background-color:blue;}\
        .naviItem{float:left;padding:5px;text-align:center;font-weight:bold;border-radius:5px;background-color:#C3A75E;margin-right:5px;}\
        .naviItem:hover{background-color:white;}\
        .naviItemActive{float:left;padding:5px;text-align:center;font-weight:bold;border-radius:5px;background-color:#C3A75E;margin-right:5px;background-color:white;}\
        .naviItemInactive{float:left;padding:5px;text-align:center;font-weight:bold;border-radius:5px;background-color:#C3A75E;margin-right:5px;color:grey;}"
    );
    removeAllCSS(/reallocatebuilding_symbol_tt/);
    GM_addStyle(
        ".rackcat1v,.rackcat1v_active{background:url("+GFX+"rack_sort_top.png);width:27px;height:39px;}\
        .rackcat1v{background-position:0px 0px;}\
        .rackcat1v:hover{background-position:0px -39px;}\
        .rackcat1v_active{background-position:0px -78px;}\
        .rackcat1e,.rackcat1e_active{background:url("+GFX+"rack_sort_top.png);width:26px;height:39px;}\
        .rackcat1e{background-position:-27px 0px;}\
        .rackcat1e:hover{background-position:-27px -39px;}\
        .rackcat1e_active{background-position:-27px -78px;}\
        .rackcat21,.rackcat21_active{background:url("+GFX+"rack_sort_top.png);width:27px;height:20px;}\
        .rackcat21{background-position:-106px 0px;}\
        .rackcat21:hover{background-position:-106px -39px;}\
        .rackcat21_active{background-position:-106px -78px;}\
        .rackcat22,.rackcat22_active{background:url("+GFX+"rack_sort_top.png);width:27px;height:19px;}\
        .rackcat22{background-position:-106px -20px;}\
        .rackcat22:hover{background-position:-106px -59px;}\
        .rackcat22_active{background-position:-106px -98px;}\
        .rackcat23,.rackcat23_active{background:url("+GFX+"rack_sort_top.png);width:26px;height:20px;}\
        .rackcat23{background-position:-133px 0px;}\
        .rackcat23:hover{background-position:-133px -39px;}\
        .rackcat23_active{background-position:-133px -78px;}\
        .rackcat24,.rackcat24_active{background:url("+GFX+"rack_sort_top.png);width:26px;height:19px;}\
        .rackcat24{background-position:-133px -20px;}\
        .rackcat24:hover{background-position:-133px -59px;}\
        .rackcat24_active{background-position:-133px -98px;}\
        .rackcat30fl,.rackcat30fl_active{background:url("+GFX+"rack_sort_top.png);width:27px;height:39px;}\
        .rackcat30fl{background-position:-212px 0px;}\
        .rackcat30fl:hover{background-position:-212px -39px;}\
        .rackcat30fl_active{background-position:-212px -78px;}\
        .rackcat30fla,.rackcat30fla_active{background:url("+GFX+"rack_sort_top.png);width:26px;height:39px;}\
        .rackcat30fla{background-position:-239px 0px;}\
        .rackcat30fla:hover{background-position:-239px -39px;}\
        .rackcat30fla_active{background-position:-239px -78px;}\
        .rackcat60hr,.rackcat60hr_active{background:url('"+IMAGES["racksortVeterinary"]+"');width:27px;height:39px;}\
        .rackcat60hr{background-position:0px 0px;}\
        .rackcat60hr:hover{background-position:0px -39px;}\
        .rackcat60hr_active{background-position:0px -78px;}\
        .rackcat60md,.rackcat60md_active{background:url('"+IMAGES["racksortVeterinary"]+"');width:26px;height:39px;}\
        .rackcat60md{background-position:-26px 0px;}\
        .rackcat60md:hover{background-position:-26px -39px;}\
        .rackcat60md_active{background-position:-26px -78px;}\
        .rackcat60breed,.rackcat60breed_active{background:url("+GFX+"rack_sort_left11.png);width:26px;height:39px;}\
        .rackcat60breed{background-position:0px -562px;}\
        .rackcat60breed:hover{background-position:-36px -562px;}\
        .rackcat60breed_active{background-position:-72px -562px;}\
        .rackcat60cow,.rackcat60cow_active{background:url("+GFX+"rack_sort_left11.png);width:36px;height:47px;}\
        .rackcat60cow{background-position:0px -656px;}\
        .rackcat60cow:hover{background-position:-36px -656px;}\
        .rackcat60cow_active{background-position:-72px -656px;}\
        .rackcat60fish,.rackcat60fish_active{background:url("+GFX+"rack_sort_left11.png);width:36px;height:47px;}\
        .rackcat60fish{background-position:0px -706px;}\
        .rackcat60fish:hover{background-position:-36px -706px;}\
        .rackcat60fish_active{background-position:-72px -706px;}\
        .rackcat60scouts,.rackcat60scouts_active{background:url("+GFX+"rack_sort_left11.png);width:36px;height:47px;}\
        .rackcat60scouts{background-position:0px -796px;}\
        .rackcat60scouts:hover{background-position:-36px -796px;}\
        .rackcat60scouts_active{background-position:-72px -796px;}\;"
    );

    // temporary hack
    // GM_addStyle(
        // "#farm_speedlinks{width:600px;height:40px; top:-20px;background:none;}\
        // .speedlink{float:left; margin:0 3px 0 0;}\
        // .speedlink:after {clear: both;}\
        // #infoPanelHeader .speedlink{float:left; display:block!important; margin:0 3px 0 0;}\
        // #weatherlink{z-index:100;}"
    // );
    // Script elements
    GM_addStyle(
        ".farmiInfo{position:absolute;height:35px;top:-47px;border-radius:5px;padding:5px;color:black;font-size:0.8em;}\
        .farmiMiniInfo{position:absolute;top:0px;right:15px;height:7px;width:7px;display:block;border-radius:5px;}\
        .foodworldfarmiMiniInfo{position:absolute;top:55px;right:15px;height:7px;width:7px;display:block;border-radius:5px;}\
        .questboxbarinPoss{position:absolute;top:0px;height:15px;background-color:green;opacity:0.5;}\
        .fieldReady{background:url('"+GFX+"incoming.gif');position:absolute;top:30px;display:block!important;width:24px;height:57px;}\
        .fieldWaterReady{background:url('"+GFX+"garten/gegossen_static.gif') -20px 0px no-repeat;position:absolute;top:60px;display:block!important;width:40px;height:40px;transform:scale(2,2);}\
        .beraterButtonIcon{margin:3px;width:30px;height:30px;overflow:hidden;background-color:#936b52;border:1px groove #4d240e;border-radius: 20px;}\
        .beraterButtonIcon:hover{transform:scale(1.1);}\
        .trasnformScale80{transform:scale(0.8);}\
        .opener{background:url('"+GFX+"questbarcontrols.png') 0px 0px no-repeat;width:20px;height:20px;}\
        .leftarrow{height:26px;width:35px;border-radius:15px;background:url('"+IMAGES["leftarrow"]+"');}\
        .leftarrow:hover{background:url('"+IMAGES["leftarrow_dark"]+"');}\
        .rightarrow{height:26px;width:35px;border-radius:15px;background:url('"+IMAGES["rightarrow"]+"');}\
        .rightarrow:hover{background:url('"+IMAGES["rightarrow_dark"]+"');}\
        .openBook{height:32px;width:32px;background:url('"+IMAGES["openBook"]+"');}\
        .openBook:hover{background:url('"+IMAGES["openBookGold"]+"');}\
        .formattedRackItem{position:absolute;top:3px;left:0;width:40px;font-size:7pt;color:#555555;text-align:center;}\
        .farmicart_missing td{color:red!important;}\
        .border1 td,.border1 th{border:1px solid black;}\
        .borderTop2 td,.borderTop2 th{border-top:2px solid black;}\
        .borderBottom2 td,.borderBottom2 th{border-bottom:2px solid black;}\
        .fontWeightBold td,.fontWeightBold th{font-weight:bold;}\
        .questlineicon1{background:url('"+GFX+"questlineicons.gif') no-repeat scroll 0 0 transparent;float:left;height:19px;left:2px;position:absolute;top:2px;width:19px;}\
        .questboxlinecontent:hover{background-color:#8F6803;}\
        .quests_status_bar_main1{background:url('"+GFX+"questbar_main1.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_main1_active{background:url('"+GFX+"questbar_main1.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0); filter: hue-rotate(45deg);}\
        .quests_status_bar_main2{background:url('"+GFX+"questbar_main2.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_main2_active{background:url('"+GFX+"questbar_main2.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0); filter: hue-rotate(45deg);}\
        .quests_status_bar_main3{background:url('"+GFX+"questbar_main3.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_main3_active{background:url('"+GFX+"questbar_main3.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0); filter: hue-rotate(45deg);}\
        .quests_status_bar_main4{background:url('"+GFX+"questbar_main4.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_main4_active{background:url('"+GFX+"questbar_main4.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0); filter: hue-rotate(45deg);}\
        .quests_status_bar_main5{background:url('"+GFX+"questbar_main5.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_main5_active{background:url('"+GFX+"questbar_main5.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0); filter: hue-rotate(45deg);}\
        .quests_status_bar_butterfly1{background:url('"+IMAGES["questButterfly"]+"') no-repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_butterfly1_active{background:url('"+IMAGES["questButterflyActive"]+"') no-repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_breed1{background:url('"+GFX+"breed/Heart_00.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);background-size: 30px 30px;}\
        .quests_status_bar_breed1_active{background:url('"+GFX+"breed/Heart_00.png') no-repeat scroll 0 0 rgba(116, 160, 43, 0.85);background-size: 30px 30px;}\
        .quests_status_bar_cow1{background:url('"+GFX+"cowracing/CowHead_Holstein.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);background-size: 30px 30px;}\
        .quests_status_bar_cow1_active{background:url('"+GFX+"cowracing/CowHead_Holstein.png') no-repeat scroll 0 0 rgba(116, 160, 43, 0.85);background-size: 30px 30px;}\
        .quests_status_bar_fishing1{background:url('"+GFX+"fishing/Angelfeature_Reihenproduktion_65x65.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);background-size: 68px}\
        .quests_status_bar_fishing1_active{background:url('"+GFX+"fishing/Angelfeature_Reihenproduktion_65x65.png') no-repeat scroll 0 0 rgba(116, 160, 43, 0.85);background-size: 68px;}\
        .quests_status_bar_forestry1{background:url('"+GFX+"questbar_forestry1.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_forestry1_active{background:url('"+IMAGES["questForestry1Active"]+"') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_forestry2{background:url('"+GFX+"questbar_forestry2.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_forestry2_active{background:url('"+IMAGES["questForestry2Active"]+"') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_foodworld1{background:url('"+GFX+"questbar_foodworld1.png') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_foodworld1_active{background:url('"+IMAGES["questFoodworldActive"]+"') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_infinite1{background:url('"+GFX+"infinitequestline/Quest_Button_Rosi_60x60.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);background-size: 37px}\
        .quests_status_bar_infinite1_active{background:url('"+GFX+"infinitequestline/Quest_Button_Rosi_60x60.png') no-repeat scroll 0 0 rgba(116, 160, 43, 0.85);background-size: 37px;}\
        .quests_status_bar_scouts1{background:url('"+GFX+"scouts/Pfadfinder_Reihenproduktion.png') no-repeat scroll 0 0 rgba(0, 0, 0, 0);background-size: 37px}\
        .quests_status_bar_scouts1_active{background:url('"+GFX+"scouts/Pfadfinder_Reihenproduktion.png') no-repeat scroll 0 0 rgba(116, 160, 43, 0.85);background-size: 37px;}\
        .quests_status_bar_veterinary1{background:url('"+IMAGES["questVeterinary"]+"') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .quests_status_bar_veterinary1_active{background:url('"+IMAGES["questVeterinaryActive"]+"') repeat scroll 0 0 rgba(0, 0, 0, 0);}\
        .category_f1,.category_f2,.category_f3,.category_f4,.category_f5,.category_f1_active,.category_f2_active,.category_f3_active,.category_f4_active,.category_f5_active{width:25px;height:25px;margin:1px;border-radius:9px;}\
        .category_f1,.category_f2,.category_f3,.category_f4,.category_f5{border:2px solid #808080;background:url('"+GFX+"forestry/forestry_symbols6.gif') top left no-repeat;}\
        .category_f1{background-position:-100px 0px;}\
        .category_f2{background-position:-25px -25px;}\
        .category_f3{background-position:-100px -100px;}\
        .category_f4{background-position:-25px -150px;}\
        .category_f5{background-position:0px -175px;}\
        .category_f1_active,.category_f2_active,.category_f3_active,.category_f4_active,.category_f5_active{border:2px solid black;}\
        .category_f1_active{background:url('"+IMAGES["category_f1_active"]+"') top left no-repeat;}\
        .category_f2_active{background:url('"+IMAGES["category_f2_active"]+"') top left no-repeat;}\
        .category_f3_active{background:url('"+IMAGES["category_f3_active"]+"') top left no-repeat;}\
        .category_f4_active{background:url('"+IMAGES["category_f4_active"]+"') top left no-repeat;}\
        .category_f5_active{background:url('"+IMAGES["category_f5_active"]+"') top left no-repeat;}\
        .category_r0,.category_r1,.category_r2,.category_r0_active,.category_r1_active,.category_r2_active{width:42px;height:42px;margin:1px;border-radius:23px;}\
        .category_r0,.category_r1,.category_r2{border:2px solid #808080;;}\
        .category_r0{background:url('"+GFX+"powerup1.png') top left no-repeat;background-position:-9px -23px}\
        .category_r1{background:url('"+GFX+"powerup2.png') top left no-repeat;background-position:-9px -23px}\
        .category_r2{background:url('"+GFX+"powerup3.png') top left no-repeat;background-position:-9px -23px}\
        .category_r0_active,.category_r1_active,.category_r2_active{border:2px solid black;}\
        .category_r0_active{background:url('"+IMAGES["category_r0_active"]+"') top left no-repeat;}\
        .category_r1_active{background:url('"+IMAGES["category_r1_active"]+"') top left no-repeat;}\
        .category_r2_active{background:url('"+IMAGES["category_r2_active"]+"') top left no-repeat;}\
        .category_f1:hover,.category_f2:hover,.category_f3:hover,.category_f4:hover,.category_f5:hover,.category_r0:hover,.category_r1:hover,.category_r2:hover,.category_f1_active:hover,.category_f2_active:hover,.category_f3_active:hover,.category_f4_active:hover,.category_f5_active:hover,.category_r0_active:hover,.category_r1_active:hover,.category_r2_active:hover{transform:scale(1.1);}\
        .zoneBg70_1,.zoneBg70_2,.zoneBg70_3,.zoneBg70_4,.zoneBg70_5,.zoneBg70_6,.zoneBg70_7,.zoneBg70_8,.zoneBg70_9,.zoneBg70_10,.zoneBg70_11,.zoneBg70_12,.zoneBg70_13,.zoneBg70_14,.zoneBg70_15,.zoneBg70_16,.zoneBg70_17,.zoneBg70_18,.zoneBg70_fl1,.zoneBg70_fl2,.zoneBg70_fw1,.zoneBg70_fw2,.zoneBg70_fw3,.zoneBg70_fw4,.zoneBg70_sawmill,.zoneBg70_carpentry{width:70px;height:70px;}\
        .zoneBg70_1,.zoneBg70_2,.zoneBg70_3,.zoneBg70_4,.zoneBg70_5,.zoneBg70_6,.zoneBg70_7,.zoneBg70_8,.zoneBg70_9,.zoneBg70_10,.zoneBg70_11,.zoneBg70_12,.zoneBg70_13,.zoneBg70_14,.zoneBg70_15,.zoneBg70_16,.zoneBg70_17,.zoneBg70_18{background:url('"+GFX+"maps/buildings18.gif') top left no-repeat;background-size: 420px 280px;}\
        .zoneBg70_1{background-position:0px 0px;}\
        .zoneBg70_2{background-position:-70px 0px;}\
        .zoneBg70_3{background-position:-140px 0px;}\
        .zoneBg70_4{background-position:-210px 0px;}\
        .zoneBg70_5{background-position:-280px 0px;}\
        .zoneBg70_6{background-position:-350px 0px;}\
        .zoneBg70_7{background-position:0px -139px;}\
        .zoneBg70_8{background-position:-350px -70px;}\
        .zoneBg70_9{background-position:-70px -139px;}\
        .zoneBg70_10{background-position:-140px -138px;}\
        .zoneBg70_11{background-position:-210px -138px;}\
        .zoneBg70_12{background-position:-280px -138px;}\
        .zoneBg70_13{background-position:-350px -138px;}\
        .zoneBg70_14{background-position:0px -209px;}\
        .zoneBg70_15{background-position:-70px -209px;}\
        .zoneBg70_16{background-position:-140px -209px;}\
        .zoneBg70_17{background-position:-210px -209px;}\
        .zoneBg70_18{background-position:-280px -209px;}\
        .zoneBg70_fl1{background:url('"+GFX+"farm99_pos1.gif') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_fl2{background:url('"+GFX+"farm99_pos2.png') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_fw1{background:url('"+GFX+"foodworld/building1_5.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_fw2{background:url('"+GFX+"foodworld/building2_5.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_fw3{background:url('"+GFX+"foodworld/building3_5.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_fw4{background:url('"+GFX+"foodworld/building4_5.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_sawmill{background:url('"+GFX+"forestry/building1.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .zoneBg70_carpentry{background:url('"+GFX+"forestry/building2.jpg') no-repeat;background-position:0px 0px;background-size: 70px 70px;}\
        .smallStatistic{position:relative;display:inline-block;height:214px;margin:5px;background-color:#bbe;}\
        #imgNeedWater1,#imgNeedWater2,#imgNeedWater3,#imgNeedWater4,#imgNeedWater5,#imgNeedWater6{position:absolute;right:25px;height:63px;width:63px;}\
        #zoneinfo1,#zoneinfo2,#zoneinfo3,#zoneinfo4,#zoneinfo5,#zoneinfo6{border:2px solid #6c441e;border-radius:10px;z-index:3;position:absolute;left:120px;top:20px;}\
        #divErnteInfo{position:relative;float:left;top:120px;left:620px;padding:2px;border:2px inset white;background-color:#FFB876;display:none;}\
        #divRightBorder>div{z-index:2;position:relative!important;top:0!important;margin-top:5px;}\
        #buyNotepad,#marketoffersNotepad{white-space:nowrap;vertical-align:top;border:2px inset black;background-color:white;padding:3px;max-height:200px;;overflow:hidden;overflow-y:scroll;}\
        #zoneNavi{position:absolute;top:9px;right:50px;z-index:25;}\
        #zoneNavi div{float:left;}\
        #divBeraterButtons{-moz-user-select:none;position:fixed;left:0;top:80px;width:40px;border:1px groove #4D240E;border-radius:0 10px 10px 0;z-index:500;background:url(\""+GFX+"guild/help_back.jpg\") -25px -25px;}\
        .clearFilter{width:14px;height:13px;background:url(\""+GFX+"market/filter_del.gif\");}\
        .loginbutton{background-color:white;color:black;text-align:center;font-weight:bold;width:250px;line-height:20px;margin:3px;border:3px solid #6c441e;border-radius:10px;}"
    );
    // Game elements
    //22102016
    GM_addStyle(
        ".friendslineoptions{width:72px!important;}\
        .forestry_slot_product{margin:15px 0 0 20px!important;}\
        .forestry_sawmill_productbox{width:272px!important;height:208px!important;padding:10px!important;}\
        .rackitem_tt_sack,.rackitem_tt_box,.rackitem_tt_bottle,.rackitem_tt_karton,.rackitem_tt_tupper{z-index:110!important;}\
        .farm_button_destruct{display:none!important;}\
        .farm_button_gardenspeedup{left:5px!important;}\
        .farm_button_infinitequestlinebonus{left:65px!important;}\
        .farm_button_tt{width:150px!important;}\
        .farm_button_tt{display:none!important;}\
        .quests_status_bar_item_tt{display:none!important;}\
        .farm_production_timer{opacity:1!important;}\
        .farmersmarket_pos_timer{opacity:1!important;}\
        #cartsubmit{font-weight:bold!important;}\
        #customerline2{z-index:19!important;}\
        #transp8{display:none!important;}\
        #buildinginfo1,#buildinginfo2,#buildinginfo3,#buildinginfo4,#buildinginfo5,#buildinginfo6{display:none!important;}\
        #buildinginfo_right3,#buildinginfo_right6{display:none!important;}\
        #buildinginfo_left0,#buildinginfo_left1,#buildinginfo_left2,#buildinginfo_left4,#buildinginfo_left5{display:none!important;}\
        #updateinfo1,#updateinfo2,#updateinfo3,#updateinfo4,#updateinfo5,#updateinfo6{display:none!important;}\
        #autoplantinfo1,#autoplantinfo2,#autoplantinfo3,#autoplantinfo4,#autoplantinfo5,#autoplantinfo6{display:none!important;}\
        #speedupgardenbuttoninfo1,#speedupgardenbuttoninfo2,#speedupgardenbuttoninfo3,#speedupgardenbuttoninfo4,#speedupgardenbuttoninfo5,#speedupgardenbuttoninfo6{display:none!important;}\
        #bulldozetooltip1,#bulldozetooltip2,#bulldozetooltip3,#bulldozetooltip4,#bulldozetooltip5,#bulldozetooltip6{display:none!important;}\
        #emptyfieldtooltip1,#emptyfieldtooltip2,#emptyfieldtooltip3,#emptyfieldtooltip4,#emptyfieldtooltip5,#emptyfieldtooltip6{display:none!important;}\
        #timeevent1,#timeevent2,#timeevent3,#timeevent4,#timeevent5,#timeevent6{display:none!important;}\
        #friendslist{width:280px!important;}\
        #friendlistinfoblock li:hover{background-color:#e4b55d;}\
        #speedlinks,#cityline{display:block!important;}\
        #rackItems{-moz-user-select:none;}\
        #traveltransp,#questline,#questlineopener,#speedlinks,#guildlink,#guildlink_tt,#cityline,#farmtooltip1,#farmtooltip2,#farmtooltip3,#citytooltip1,#citytooltip2{z-index:110!important;}\
        #zone1,#zone2,#zone3,#zone4,#zone5,#zone6{z-index:1;}\
        #zoneupdatebutton1,#zoneupdatebutton2,#zoneupdatebutton3,#zoneupdatebutton4,#zoneupdatebutton5,#zoneupdatebutton6{position:absolute;left:5px;top:72px;}\
        #lager_wachsezeit,#lager_ertrag,#lager_ist1,#lager_ist2,#lager_zeit,#lager_ernte{margin:0 0 0 5px!important;}\
        #memory_pack{left:50px!important;top:10px!important;z-index:2!important;}\
        #questboxlineinfo1,#questboxlineinfo2{display:none!important;}\
        #questboxline{position:relative!important;top:0!important;}\
        #game_control{display:none!important;}\
        #food_cart_products{top:250px!important;left:115px!important;}\
        #cartcontent{width:400px!important;}\
        #gardencancel{right:5px!important;top:5px!important;}\
        #rankingcontent{line-height:12px;}\
        #marketheader .naviitem_tt{top:-10px!important;}\
        .help_content{margin:20px 0 0 0;width: 345px;!important}\
        .rahmen_hoch{position:absolute;height:640px!important;}\
        #questbarcontrol{top:0px!important;}\
        #reallocatebuilding_symbol{top:10px!important;}\
        #reallocateanimals_symbol{top:35px!important;}\
        #job_overview_link{top:60px!important;}\
        #pets_parts_link{top:65px!important;}\
        #cropbonus_symbol{top:101px!important;}\
        #specialbonus_link{top:20px!important;left:-30px!important}\
        #whatsup_link{top:-30px!important;left:-135px!important}\
        #poweruptimes{top:310px!important;}\
        #carpentrybonus_symbol{top:186px!important;}\
        #farm_production_checker_icon{position:absolute!important;top:240px!important;}\
        #map_stock_overview_link{position:absolute!important;top:372px!important;}\
        #loginbonus_symbol{position:absolute!important;top:430px!important;}\
        #weatherlink{top:-88px!important;}\
        #farm_speedlinks{top:11px!important;}\
        #specialoffer_link{top:-37px!important;}\
        #teaser_links{top:-40px!important;-65px !important}"
    );
    GM_addStyle(
         ".market_buy{width:30px!important;}\n"
        +".market_delicon{height:15px!important;}" // Bugfix. Game-CSS sets 16px=dis-harmonic to class market_carticon.
        +".market_noicon{height:15px!important;}" // Bugfix. Game-CSS sets 16px=dis-harmonic to class market_carticon.
    );
    GM_addStyle(".divCurrentQuest{background-color:lightblue!important;}");

    if(!GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valGamecursor",true)){
        GM_addStyle(
            "BODY,.normal,.normal2{cursor:default;}\
            .link{cursor:pointer!important;}\
            TEXTAREA,.text,.text2{cursor:text!important;}"
        );
    }
    }
    // **************************************************
    // ChangeData Global
    // -->> add var to delete also to resetVariables
    err_trace="ChangeData Global";
    try{
        var changedata = GM_getValue("changedata",0);
        switch(changedata){
        case 1:case 2:{
            function old_enc(str) {
                var encoded = "";
                for (i=0; i<str.length;i++) {
                    encoded = encoded+String.fromCharCode(str.charCodeAt(i)^123);
                }
                return encoded;
            }
            var logindata = explode(GM_getValue("logindata"),"changedataGlobal/1/logindata",[]);
            for(var v=0;v<logindata.length;v++){
                logindata[v][3] = enc(old_enc(logindata[v][3]),4242);
            }
            GM_setValue("logindata",implode(logindata,"changedataGlobal/1/logindata"));
        }
        case 3:{
            var help=cloneInto(GM_listValues(), unsafeWindow);
            var help2;
            for(var v=help.length-1;v>=0;v--){
                if(help2=/^([a-z]{2})(_.*)$/.exec(help[v])){
                    GM_setValue(help2[1].toUpperCase()+help2[2],GM_getValue(help[v]));
                    GM_deleteValue(help[v]);
                }
            }
            var help = explode(GM_getValue("logindata",[]),"changedataGlobal/3/logindata",[]);
            for(var v=help.length-1;v>=0;v--){
                help[v][0] = help[v][0].toUpperCase();
            }
            GM_setValue("logindata",implode(help,"changedataGlobal/3/help"));
        }
        }
        if(changedata<4){ GM_setValue("changedata",4); }
    }catch(err){GM_logError("changedata global","","",err);}
    // **************************************************

    err_trace="Location exec";
    var loc=new RegExp("s(\\d+)\\."+GAMEPAGES[COUNTRY].replace(/\./g,"\\."),"i").exec(location.hostname);
    if(loc){
        SERVER=loc[1];
        PAGE=location.pathname.replace(/^\//,"").replace(/\.php.*$/,"");
        GM_logInfo("scriptStart","","PAGE="+PAGE+" location.pathname:"+location.pathname,"",0);

        err_trace="User";
        USERNAME=GM_getValue(COUNTRY+"_"+SERVER+"_username","");
        unsafeData.username=USERNAME;
        FARMNAME=$top("username")?$top("username").innerHTML:GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmname","");
        npcSaison=explode(GM_getValue(COUNTRY+"_"+SERVER+"_NpcSaison"),"npcSaison",null);
        if(npcSaison==null){
            npcSaison=INIT_NPC_SAISON.clone();
            GM_setValue(COUNTRY+"_"+SERVER+"_NpcSaison",implode(npcSaison,"scriptStart/npcSaison"));
        }
        css_styles = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles"),"css_styles",INIT_CSS_STYLES);
        //GM_log("css_styles length:"+css_styles.length()+" :"+implode(css_styles));
        var changeFlag=false;
        for(tag in INIT_CSS_STYLES){
            if(!INIT_CSS_STYLES.hasOwnProperty(tag)){ continue; }
            if(!css_styles[tag]){
                changeFlag=true;
                css_styles[tag]=INIT_CSS_STYLES[tag];
            }
        }
        if(changeFlag){ GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"scriptStart/css_styles")); }
        changeFlag=null;
        GM_addStyle(
            ".zoneTimer{z-index:3;position:absolute;padding:2px;margin:1px;"+css_styles["timer"][1]+"}\
            .zoneTimerWater{z-index:3;position:absolute;padding:2px;margin:1px;"+css_styles["watertimer"][1]+"}\
            .zoneTimerReady{z-index:3;position:absolute;padding:2px;margin:1px;"+css_styles["timer_ready"][1]+"}\
            .lowrack{"+css_styles["lowrack"][1]+"}\
            .farmicart_lowrack td{"+css_styles["farmicart_lowrack"][1]+"}\
            .systemMsg_marketsale{"+css_styles["systemMsg_marketsale"][1]+"}\
            .systemMsg_contractsale{"+css_styles["systemMsg_contractsale"][1]+"}\
            #timeHolder{"+css_styles["timeholder"][1]+"}"
        );

        // **************************************************
        // ChangeData server
        // -->> add var to delte also to resetVariables
        err_trace="ChangeData server";
        try{
            changedata = GM_getValue(COUNTRY+"_"+SERVER+"_changedata",0);
            // switch(changedata){
            // case 1:case 2: case 3:case 4:case 5:case 6:{
            // }
            // }
            if(changedata<7){ GM_setValue(COUNTRY+"_"+SERVER+"_changedata",7); }
        }catch(err){GM_logError("changedata server","","",err);}

        // ChangeData account
        err_trace="ChangeData account";
        try{
            changedata = GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_changedata",0);
            switch(changedata){
            case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:
            case 11:case 12:case 13:case 14:{
                css_styles = INIT_CSS_STYLES;
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"ChangeData/11/css_styles"));
            }
            case 15:case 16:case 17:{
                css_styles["timeholder"] = INIT_CSS_STYLES["timeholder"];
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"ChangeData/15/css_styles"));
            }
            case 18:{
                for(tag in css_styles){
                    if(!css_styles.hasOwnProperty(tag)){ continue; }
                    css_styles[tag][1]=css_styles[tag][1].replace(/-moz-border-radius/g,"border-radius");
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"ChangeData/18/css_styles"));
            }
            case 19:{
                // Converting object "kauf" to array
                var old_obj = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_kauf"),"ChangeData/19/kauf",{});
                var new_arr = [];
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    old_obj[id].splice(0,0,parseInt(id,10));
                    new_arr.push(old_obj[id]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_kauf",implode(new_arr,"ChangeData/19/kauf"));
                // Converting object "farmiLog" to array
                var old_obj=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmiLog"),"ChangeData/19/farmiLog",[]);
                var new_arr = [];
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    old_obj[id].splice(0,0,parseInt(id,10));
                    new_arr.push(old_obj[id]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_farmiLog",implode(new_arr,"ChangeData/19/farmiLog"));
                // Converting object "clubmemberLog" to array
                var old_obj=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_clubmemberLog"),"ChangeData19/clubmemberLog",{});
                var new_arr = [];
                for(var name in old_obj){
                    if(!old_obj.hasOwnProperty(name)){ continue; }
                    var new_arr_name = [name,[]];
                    for(var date in old_obj[name]){
                        if(!old_obj[name].hasOwnProperty(date)){ continue; }
                        var new_arr_date = [date,old_obj[name][date][0],[]];
                        for(var prod in old_obj[name][date][1]){
                            if(!old_obj[name][date][1].hasOwnProperty(prod)){ continue; }
                            new_arr_date[2].push([parseInt(prod,10),old_obj[name][date][1][prod]]);
                        }
                        new_arr_name[1].push(new_arr_date);
                    }
                    new_arr.push(new_arr_name);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_clubmemberLog",implode(new_arr,"ChangeData/19/clubmemberLog"));
            }
            case 20:{
                // Converting object "lotteryLog" to array
                var old_obj = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog"),"ChangeData20/lotteryLog",{});
                var new_arr = [];
                var day;
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    if(id.match(/\d+\.\d+\.\d+/)){
                        day=id;
                    }else if(id.match(/\d+\.\d+/)){
                        day=/(\d+)\.(\d+)/.exec(id);
                        if(day[1].length==1){
                            day=day[2]+"-0"+day[1];
                        }else{
                            day=day[2]+"-"+day[1];
                        }
                    }else{
                        continue;
                    }
                    old_obj[id].splice(0,0,day);
                    new_arr.push(old_obj[id]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_lotteryLog",implode(new_arr,"ChangeData/20/lotteryLog"));
                // Converting object "levelLog" to array
                var old_obj = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog"),"ChangeData/20/levelLog",{});
                var new_arr = [];
                var day;
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    if(id.match(/\d+\.\d+\.\d+/)){
                        day=id;
                    }else if(id.match(/\d+\.\d+/)){
                        day=/(\d+)\.(\d+)/.exec(id);
                        if(day[1].length==1){
                            day=day[2]+"-0"+day[1];
                        }else{
                            day=day[2]+"-"+day[1];
                        }
                    }else{
                        continue;
                    }
                    old_obj[id].splice(0,0,day);
                    new_arr.push(old_obj[id]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_levelLog",implode(new_arr,"ChangeData/20/levelLog"));
            }
            case 21:{
                // Converting object "vertraegeIn" to array
                var old_obj = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_vertraegeIn"),"ChangeData21/vertraegeIn",{});
                var new_arr = [];
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    old_obj[id].splice(0,0,parseInt(id,10));
                    new_arr.push(old_obj[id]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_vertraegeIn",implode(new_arr,"ChangeData/21/vertraegeIn"));
                // Converting object "vertraegeOut" to array
                var old_obj = explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_vertraegeOut"),"ChangeData/21/vertraegeOut",{});
                var new_arr = [];
                for(var id in old_obj){
                    if(!old_obj.hasOwnProperty(id)){ continue; }
                    new_arr.push([,old_obj[id]]);
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_vertraegeOut",implode(new_arr,"ChangeData/21/vertraegeOut"));
            }
            case 22:{
                css_styles["timer_ready"] = INIT_CSS_STYLES["timer_ready"];
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_css_styles",implode(css_styles,"ChangeData/22/css_styles"));
            }
            case 23:{
                var data=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones"),"zones.init/data",{});
                if(data["megafield"]){
                    delete data["megafield"];
                }
                if(data["windmill"]){
                    delete data["windmill"];
                }
                GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_zones",implode(data,"zones.save/data"));
            }
            }
            if(changedata<24){ GM_setValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_changedata",24); }
            changedata = null;
        }catch(err){GM_logError("changedata account","","",err);}

        // **************************************************

        //Hotkeys
        err_trace="Hotkeys";
        if (GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_valHotkey",true)){
            window.addEventListener("keydown",function(event){
                if(event.keyCode==27){  // Esc
                    if(unsafeWindow.city){ top.window.wrappedJSObject.initCity(unsafeWindow.city); event.preventDefault(); }
                    else{ top.window.wrappedJSObject.showMain(); event.preventDefault(); }
                    closeInfoPanel();
                }
                if (event.altKey){
                switch (event.keyCode){
                case hotkeymap["prevPage"]: if(($top("zoneNavi"))&&($top("zoneNavi").firstElementChild)){ click($top("zoneNavi").firstElementChild); event.preventDefault();}
                        else if($top("prevPage")){ click($top("prevPage")); event.preventDefault();}
                        else if($("prevPage")){ click($("prevPage")); event.preventDefault();}
                break;
                case hotkeymap["nextPage"]: if(($top("zoneNavi"))&&($top("zoneNavi").lastChild)){ click($top("zoneNavi").lastChild); event.preventDefault();}
                        else if($top("nextPage")){ click($top("nextPage")); event.preventDefault();}
                        else if($("nextPage")){ click($("nextPage")); event.preventDefault();}
                break;
                case hotkeymap["farm1"]: top.window.wrappedJSObject.initZones(1); top.window.wrappedJSObject.showMain(); event.preventDefault(); break; // 1:Farm 1
                case hotkeymap["farm2"]: if(parseInt(top.window.wrappedJSObject.farmamount,10)>1){ top.window.wrappedJSObject.initZones(2); top.window.wrappedJSObject.showMain(); event.preventDefault(); } break; // 2:Farm 2
                case hotkeymap["farm3"]: if(parseInt(top.window.wrappedJSObject.farmamount,10)>2){ top.window.wrappedJSObject.initZones(3); top.window.wrappedJSObject.showMain(); event.preventDefault(); } break; // 3:Farm 3
                case hotkeymap["guild"]: top.window.wrappedJSObject.showMain(); top.window.wrappedJSObject.initGuild(); event.preventDefault(); break; // 4:Club
                case hotkeymap["city1"]:
                    if($top("speedlink_city1")){ click($top("speedlink_city1")); }
                    else{
                        if($top("citymaincontainer").style.display=="block"){
                            if($top("cityzone_2_3")){ click($top("cityzone_2_3")); }
                        }else{
                            click($top("mainmenue1"));
                        }
                    }
                    event.preventDefault(); break; // 5:Dorf1
                case hotkeymap["city2"]:
                    if($top("speedlink_city2")){ click($top("speedlink_city2")); }
                    else{
                        if($top("citymaincontainer").style.display=="block"){
                            if($top("cityzone_1_9")){ click($top("cityzone_1_9")); }
                        }else{
                            click($top("mainmenue1"));
                            var gotocitytimeout=window.setInterval(function(){
                                if($top("cityzone_1_9")){
                                    click($top("cityzone_1_9"));
                                    clearTimeout(gotocitytimeout);
                                }
                            },200);
                        }
                    }
                    event.preventDefault(); break; // 6:Dorf2
                case hotkeymap["farmiLog"]: click($top("customerstats")); event.preventDefault(); break; // F:FarmiLog
                case hotkeymap["help"]: click($top("mainmenue5")); event.preventDefault(); break; // H:Hilfe
                case hotkeymap["market"]: showMarket(); event.preventDefault(); break; // M:Markt
                case hotkeymap["marketstand"]: showMarketStall(); event.preventDefault(); break; // ,:Marktstand
                case hotkeymap["messages"]: click($top("mainmenue2")); event.preventDefault(); break; // N:Nachrichten
                case hotkeymap["options"]: click($top("berateroptionen")); event.preventDefault(); break; // O:Optionen
                case hotkeymap["profit"]: click($top("profitcalc")); event.preventDefault(); break; // P:Profit
                case hotkeymap["seedVendor"]: showSeedVendor(); event.preventDefault(); break; // S:Seed vendor
                case hotkeymap["overview"]: click($top("titlepig")); event.preventDefault(); break; // U:Uebersicht
                case hotkeymap["contract"]: click($top("mainmenue3")); event.preventDefault(); break; // V:Vertrag
                case hotkeymap["systemMessage"]: if (GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_nachrichten_doread","")){
                            var help=explode(GM_getValue(COUNTRY+"_"+SERVER+"_"+USERNAME+"_nachrichten_doread"),"eventListener@keydown/nachrichten_doread",[]);
                            showMessage("system","1",help[help.length-1],0);
                        }else{
                            showMultiframePage("nachrichten/system.php");
                        } event.preventDefault(); break; // X:next Message/Systemmessages
                }
                }
            },false);
        }

        err_trace="Page switch";
        GM_logInfo("scriptStart","","PAGE="+PAGE,"Loading page",0);
        switch (PAGE){
            case "stadt/shop":          do_shop();break;
            case "stadt/stats":         do_stats();break;
            case "stadt/wettbewerb":    do_wettbewerb();break;
            case "main":                do_main();break;
//            case "vertraege/new":       do_multiframe();do_vertraege_head();do_vertraege_new();break;  // function substituted
//            case "vertraege/overview":  do_multiframe();do_vertraege_head();do_vertraege_overview();break;  // function substituted
//            case "vertraege/show":      do_multiframe();do_vertraege_head();do_vertraege_show();break;  // function substituted
            case "nutzer/profil":       do_multiframe();break;
            case "nutzer/usecoins":     do_multiframe();break;
            case "hilfe":               do_multiframe();do_hilfe();break;
            case "login":               do_login();break;
        }
    }else{
        do_login();
    }
    window.setTimeout(function(){
        unsafeData.beraterDone=true;
        raiseEvent("beraterDone");
    },100);
    reloader.stop("scriptLoad");
}catch(err){ GM_logError("scriptStart","","err_trace="+err_trace+" location.href="+location.href,err); }
}
function scriptInit(){
// This function is executed on start of the script. This can be before the document is loaded completely.
try{
    var err_trace="Init";
    unsafeData.beraterVersion=VERSION;
    err_trace="Localization";
    if(top.unsafeData.COUNTRY){
        COUNTRY=top.unsafeData.COUNTRY;
        LANGUAGE=top.unsafeData.LANGUAGE;
        delimThou=top.unsafeData.delimThou;
        regDelimThou=top.unsafeData.regDelimThou;
        regDelimThouShift=top.unsafeData.regDelimThouShift;
        regDelimThouDelete=top.unsafeData.regDelimThouDelete;
        delimDeci=top.unsafeData.delimDeci;
        regDelimDeci=top.unsafeData.regDelimDeci;
        dateFormatDM=top.unsafeData.dateFormatDM;
        dateFormatDMY=top.unsafeData.dateFormatDMY;
    }else{
        if(location.hostname.match(/^(|www\.|s\d+\.)myfreefarm.de$/)){
            COUNTRY="DE";
            LANGUAGE="de";
        }else if(location.hostname.match(/^(|www\.|s\d+\.)au\.myfreefarm.com$/)){
            COUNTRY="AU";
            LANGUAGE="en";
            delimThou=",";
            regDelimThou=",";
            regDelimThouShift="([\\d,])(\\d),(\\d{1,2}\\D)";
            regDelimThouDelete="(\\d),(,*)(\\d{1,2}\\D)";
            delimDeci=".";
            regDelimDeci="\\.";
        }else if(location.hostname.match(/^(|www\.|s\d+\.)myfreefarm.ir$/)){
            COUNTRY="IR";
            LANGUAGE="en";
            delimThou=",";
            regDelimThou=",";
            regDelimThouShift="([\\d,])(\\d),(\\d{1,2}\\D)";
            regDelimThouDelete="(\\d),(,*)(\\d{1,2}\\D)";
            delimDeci=".";
            regDelimDeci="\\.";
        }else if(location.hostname.match(/^(|www\.|s\d+\.)myfreefarm.co.nz$/)){
            COUNTRY="NZ";
            LANGUAGE="en";
            delimThou=",";
            regDelimThou=",";
            regDelimThouShift="([\\d,])(\\d),(\\d{1,2}\\D)";
            regDelimThouDelete="(\\d),(,*)(\\d{1,2}\\D)";
            delimDeci=".";
            regDelimDeci="\\.";
        }else if(location.hostname.match(/^(|www\.|s\d+\.)myfreefarm.co.uk$/)){
            COUNTRY="UK";
            LANGUAGE="en";
            delimThou=",";
            regDelimThou=",";
            regDelimThouShift="([\\d,])(\\d),(\\d{1,2}\\D)";
            regDelimThouDelete="(\\d),(,*)(\\d{1,2}\\D)";
            delimDeci=".";
            regDelimDeci="\\.";
        }else if(location.hostname.match(/^(|www\.|s\d+\.)myfreefarm.com$/)){
            COUNTRY="US";
            LANGUAGE="en";
            delimThou=",";
            regDelimThou=",";
            regDelimThouShift="([\\d,])(\\d),(\\d{1,2}\\D)";
            regDelimThouDelete="(\\d),(,*)(\\d{1,2}\\D)";
            delimDeci=".";
            regDelimDeci="\\.";
        }else{
            GM_logWarning("scriptStart","","","!");
        }
        top.unsafeData.COUNTRY=COUNTRY;
        top.unsafeData.LANGUAGE=LANGUAGE;
        top.unsafeData.delimThou=delimThou;
        top.unsafeData.regDelimThou=regDelimThou;
        top.unsafeData.regDelimThouShift=regDelimThouShift;
        top.unsafeData.regDelimThouDelete=regDelimThouDelete;
        top.unsafeData.delimDeci=delimDeci;
        top.unsafeData.regDelimDeci=regDelimDeci;
        top.unsafeData.dateFormatDM=dateFormatDM;
        top.unsafeData.dateFormatDMY=dateFormatDMY;
    }
    err_trace="COUNTRY error";
    if(!COUNTRY||!GAMEPAGES[COUNTRY]||!location.hostname.match(GAMEPAGES[COUNTRY])){
        createElement("div",{"style":"position:absolute;top:0;left:0;width:340px;padding:30px;background-color:yellow;border:3px solid black;border-radius:10px;z-index:1000;font-family:Verdana,sans-serif;color:#000000;font-size:12pt;font-weight:bold;"},document.getElementsByTagName("body")[0],"You have to install a language pack. Download one at <a href='https://openuserjs.org/group/MyFreeFarm'>openuserjs.org</a>.")
        throw("Language pack is missing");
    }
    err_trace="Texts";
    if(undefined===top.unsafeData.text){
        top.unsafeData.text=new Object();
    }
    text=top.unsafeData.text;
    if(undefined===text["de"]){
        text["de"]=new Object();
        text["de"]["msgContentContractsale"]="(.+) hat einen Vertrag von dir unterzeichnet!<br><br> Folgende Produkte wurden verkauft:<br>(.+?)<br> Die Vertragssumme von (.+?)&nbsp;kT wurde deinem Konto gutgeschrieben\\.";
        //text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(.+?)\\s*<br>"; // Original
        //text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*((\\w+)(\\s*)(\\w*))";  // Versuch 1 - Musteranpassung hier
        //text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(.+?)\\s*"; // Versuch 2
        //text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(\[A-Z])(\[a-zäöüß]+)";  // Versuch 3
        //text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(\[A-Z])\\w+";  // Versuch 4
        text["de"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(\[a-zA-Z0-9äöüß]+)(\\s*)(\[a-zA-Z0-9äöüß]*)";  // Versuch 5
        text["de"]["msgContentMarketsale"]="(.+) hat am Marktplatz (\\d+)x (.+?) von dir<br> f&uuml;r (.+?) kT gekauft\\.";
        text["de"]["msgSubjectCoins"]="Du hast Coins erhalten";
        text["de"]["msgSubjectCongratulation"]="Herzlichen Gl&uuml;ckwunsch!";
        text["de"]["msgSubjectCongratulation2"]="Gl&uuml;ckwunsch";
        text["de"]["msgSubjectContractReject"]="Ein Vertrag wurde abgelehnt";
        text["de"]["msgSubjectContractsale"]="Ein Vertrag wurde angenommen";
        text["de"]["msgSubjectContractCancel"]="Ein Vertrag wurde annulliert";
        text["de"]["msgSubjectContractNew"]="Neuer Vertrag";
        text["de"]["msgSubjectFriend"]="^(.+) möchte dich als Freund hinzufügen$";
        text["de"]["msgSubjectFriendEnd"]="^(.+) hat die Freundschaft aufgelöst$";
        text["de"]["msgSubjectPresent"]="Geschenk für Dich";
        text["de"]["msgSubjectLevel"]="Du bist ein Level aufgestiegen!";
        text["de"]["msgSubjectMarketsale"]="^Marktplatz&nbsp;.+ kT&nbsp;\(.+x .+\)$";
        text["de"]["msgSubjectPremium"]="Premium Erinnerung";
        text["de"]["msgSubjectQuest"]="^.+ abgeschlossen$";
        text["de"]["msgSubjectWeed1"]="Oh nein!";
        text["de"]["msgSubjectWeed2"]="Au Weia!";
        text["de"]["above"]="davor";
        text["de"]["absolute"]="Menge total";
        text["de"]["accountActive"]="Account aktiv";
        text["de"]["accounts"]="Accounts";
        text["de"]["activation"]="Freischaltung";
        text["de"]["additionalFarmi"]="%1% Zusatzfarmi täglich";
        text["de"]["additionalForestFarmiSlot"]="%1% Zusatzplatz in der Waldfarmi-Warteschlange";
        text["de"]["additionalLogCapacity"]="Erhöhung der Lagerkapazität Stämme um %1%";
        text["de"]["advertisingEnds"]="Werbung endet heute";
        text["de"]["adviser"]="Berater";
        text["de"]["afterFee"]="abzgl Gebühr";
        text["de"]["alertSetPriceNone"]="Möchtest du wirklich keinen Preis für %PRODUCT% setzen?";
        text["de"]["alertSetPriceOverNPC"]="Möchtest du wirklich den Preis %PRICE% für %PRODUCT% setzen?<br>Dieser ist höher als der NPC-Preis %NPC%.";
        text["de"]["alertSetPriceOverObs"]="Möchtest du wirklich den Preis %PRICE% für %PRODUCT% setzen?<br>Dieser ist viel höher als der beobachtete Preis %OBS%.";
        text["de"]["alertSetPriceUnderObs"]="Möchtest du wirklich den Preis %PRICE% für %PRODUCT% setzen?<br>Dieser ist viel niedriger als der beobachtete Preis %OBS%.";
        text["de"]["alertWillLowRack"]="Achtung! Dies wird deinen Lagerbestand unter den Minimalwert bringen!";
        text["de"]["all"]="Alle";
        text["de"]["autologinAllOk"]="Alle Accounts eingeloggt.";
        text["de"]["autologinChecking"]="Ermittle aktive Sessions.<br>Bitte %1% Sekunden warten<br>...";
        text["de"]["blossomsForHour"]="Blüten pro Stunde"
        text["de"]["bonus"]="Bonus";
        text["de"]["boughtTickets"]="Gekaufte Tickets";
        text["de"]["breed"]="Tieraufzucht";
        text["de"]["buildingNameX"]="%1% zum Kauf frei";
        text["de"]["butterfly"]="Schmetterling";
        text["de"]["buy"]="Kauf";
        text["de"]["buyers"]="Käufer";
        //22102016
        text["de"]["buyPetsParts"]="Tierpuzzle-Teile";
        text["de"]["calcTo"]="Berechne bis";
        text["de"]["carpentry"]="Schreinerei";
        text["de"]["city"]="Stadt";
        text["de"]["change"]="Änderung";
        text["de"]["clearFilter"]="Filter entfernen";
        text["de"]["click"]="Klick";
        text["de"]["clickAlt"]="Alt+Klick";
        text["de"]["clickCtrl"]="Strg+Klick";
        text["de"]["clickDouble"]="Doppel-Klick";
        text["de"]["clickToChange"]="Klick um zu ändern";
        text["de"]["clothingDonationLog"]="Kleiderspende Log";
        text["de"]["commission"]   = "Gebühr";
        text["de"]["coins"]=unsafeWindow.t_coins;
        text["de"]["confirmUseObservedPrices"]="Es werden die beobachteten Preise eingetragen. Die eigenen gehen dabei verloren ...";
        text["de"]["confirmChangelogVersion"]="Du hast eine neue Version des Berater-Scriptes installiert.<br>Die Version %1% beinhaltet folgende Änderungen:";
        text["de"]["contract"]="Vertrag";
        text["de"]["contractsReceived"]="Erhaltene Verträge";
        text["de"]["contractsSent"]="Gesendete Verträge";
        text["de"]["copyToTextFile"]="Kopiere diesen Satz in eine Text-Datei";
        text["de"]["couldNotGetRank"]="Dein Platz konnte nicht bestimmt werden.";
        text["de"]["couldNotGetUpdateInfoOfX"]="Update-Informationen für %1% konnten nicht bestimmt werden."
        text["de"]["cow"]="Kuhrennen";
        text["de"]["cowracing"]="%1%. Kuh-Rennstall";
        text["de"]["createStorageString"]="Erstelle Speicher-Satz";
        text["de"]["cropped"]="Geerntet";
        text["de"]["currentOffers"]="Aktuelle Angebote";
        text["de"]["dailyRuns"]="Tägl Läufe";
        text["de"]["dailyTicket"]="Tägliches Ticket";
        text["de"]["dailyYield"]="Tägl Ertrag";
        text["de"]["date"]="Datum";
        text["de"]["day"]="Tag";
        text["de"]["day0"]="Heute";
        text["de"]["day1"]="Morgen";
        text["de"]["day2"]="Übermorgen";
        text["de"]["default"]="Default";
        text["de"]["delete"]="Löschen";
        text["de"]["deleteFollowingData"]="Lösche folgende Daten";
        text["de"]["demand"]="Forderung";
        text["de"]["detail"]="Detail";
        text["de"]["difficulty"]="Schwierigkeit";
        text["de"]["donkey"]="Waltraud";
        text["de"]["donation"]="Spende";
        text["de"]["duration"]="Dauer";
        text["de"]["editPrice"]="Preis ändern";
        text["de"]["emptyField"]="Feld leer!";
        text["de"]["end"]="Ende";
        text["de"]["exchangedLots"]="Eingelöste Lose";
        text["de"]["farm"]="Farm";
        text["de"]["farmersmarket"]=unsafeWindow.t_farmers_market;
        text["de"]["farmX"]="%1%. Farm";
        text["de"]["farmi"]="Farmi";
        text["de"]["farmis"]="Farmis";
        text["de"]["farmpedia"]=">>> INHALTSVERZEICHNIS <<<";
        text["de"]["farmpediaUrl"]="http://board.myfreefarm.de/viewtopic.php?p=55566#p55566";
        text["de"]["farmzone"]="Bauplatz %1% der %2%. Farm";
        text["de"]["feed"]="Futter";
        text["de"]["fields"]="Felder";
        text["de"]["filter"]="Filter";
        text["de"]["filterForX"]="Nach %1% filtern";
        text["de"]["finished"]="Fertig";
        text["de"]["fish"]="Angeln";
        text["de"]["foodworld"]=unsafeWindow.foodworld_title;
        text["de"]["forest"]="Wald";
        text["de"]["forestry"]="Baumerei";
        text["de"]["formatNumbers"]="Formatiere Zahlen";
        text["de"]["formulaType"]=["Prod","+val","+pts"];
        text["de"]["fl1"]="Blumenwiese";
        text["de"]["fl2"]="Blumenwerkstatt";
        text["de"]["fl3"]="Monsterfruchtzucht";
        text["de"]["fl4"]="Tieraufzucht";
        text["de"]["fl5"]="Tierarzt";
        text["de"]["fl6"]="Wettmampfen";
        text["de"]["fl7"]="Schmetterlingshaus";
        text["de"]["fl8"]="KuhRennen";
        text["de"]["fl9"]="Angelstation";
        text["de"]["fl11"]="Pfadfinder";
        text["de"]["fw1"]="Getränkebude";
        text["de"]["fw2"]="Imbissbude";
        text["de"]["fw3"]="Konditorei";
        text["de"]["fw4"]="Eiscafe";
        text["de"]["m1"]="Obststand I";
        text["de"]["m2"]="Obststand II";
        text["de"]["gamecurrency"]=unsafeWindow.gamecurrency?unsafeWindow.gamecurrency:"kT";
        text["de"]["gain"]="Erzeugnis";
        text["de"]["general"]="Allgemein";
        text["de"]["given"]="Gegeben";
        text["de"]["goods"]="Waren";
        text["de"]["showGoToAnimalBreedingReady"]="Tieraufzucht fertig!";
        text["de"]["showGoToMonsterFruitCultureReady"]="Monsterfruchtzucht fertig!";
        text["de"]["showGoToSpeedEatingReady"]="Wettessen fertig!";
        text["de"]["goTobuyPetsParts"]="Zum Puzzleteilekauf";
        text["de"]["goToClothingDonation"]="Zur Kleiderspende";
        text["de"]["goToDonkey"]="Zum Goldesel Waltraud";
        text["de"]["goToLottery"]="Zur Lotterie";
        text["de"]["goToMarket"]="Zum Markt";
        text["de"]["goToMarketOfX"]="Zum %1%-Markt";
        text["de"]["goToMarketstall"]="Zum Marktstand";
        text["de"]["goToPage"]="Gehe zu Seite";
        text["de"]["goToRank"]="Gehe zu Platz";
        text["de"]["goToVet"]="Zum Tierarzt";
        text["de"]["goToX"]="Gehe nach %1%";
        text["de"]["hide"]="ausblenden";
        text["de"]["highlightProducts"]="Produkte am Markt markieren";
        text["de"]["highlightUser"]="User am Markt markieren";
        text["de"]["hotkeys"]="Hotkeys";
        text["de"]["idle"]="unbeschäftigt !!";
        text["de"]["importStorageString"]="Importiere Speicher-Satz";
        text["de"]["importStorageStringError"]="Entschuldige. Der Speicher-Satz konnte nicht gelesen werden.";
        text["de"]["informationIsMissing"]="Es fehlen Informationen."
        text["de"]["ingredients"]="Zutaten";
        text["de"]["inStock"]="im Lager";
        text["de"]["invalidServer"]="Ungültiger Server";
        text["de"]["inventory"]="Bestand";
        text["de"]["jobIncomplete"]="Auftrag nicht erfolgreich beendet";
        text["de"]["jobComplete"]="Auftrag erfolgreich beendet";
        text["de"]["jobCurrent"]="Aktueller Auftrag";
        text["de"]["keptLots"]="Behaltene Lose";
        text["de"]["lastPrice"]="Letzter Preis";
        text["de"]["lastQuest"]="Beendet";
        text["de"]["level"]="Level";
        text["de"]["levelTooLow"]="Dein Level ist zu niedrig";
        text["de"]["levelXneeded"]="Level&nbsp;%1%&nbsp;benötigt";
        text["de"]["load"]="Laden";
        text["de"]["loading"]="Lade";
        text["de"]["localTime"]="Lokale Zeit";
        text["de"]["lodge"]="Forsthütte";
        text["de"]["login"]="Umloggen";
        text["de"]["loginPageFound"]="Login-Seite gefunden";
        text["de"]["loginPortalSubmitted"]="Portal-Login ausgeführt";
        text["de"]["loginSubmitted"]="Login ausgeführt";
        text["de"]["logDonkey"]="Goldesel Waltraud Log";
        text["de"]["lotteryLog"]="Lotterie Log";
        text["de"]["lvl"]="Lvl";
        text["de"]["manageVariables"]="Variablen verwalten";
        text["de"]["market"]="Markt";
        text["de"]["marketplace"]="Marktplatz";
        text["de"]["marketPrice"]="Marktpreis";
        text["de"]["marketstall"]="Marktstand";
        text["de"]["megafield"]="Fahrzeughalle\/Güterhof";
        text["de"]["megafieldCurrency"]=unsafeWindow.t_megafield_currency;
        text["de"]["messages"]="Nachrichten";
        text["de"]["minRack"]="Min&nbsp;Lager";
        text["de"]["minRackamount"]="Minimaler Lagerbestand";
        text["de"]["missing"]="Fehlt";
        text["de"]["money"]="Geld";
        text["de"]["name"]="Name";
        text["de"]["newLevelReached"]="Herzlichen Glückwunsch!<br>Du bist ein Level aufgestiegen!";
        text["de"]["nextMessage"]="nächste Nachricht";
        text["de"]["no"]="Nein";
        text["de"]["nothingSelected"]="Nichts ausgewählt";
        text["de"]["NPC"]="NPC";
        text["de"]["NPCprice"]="NPC-Preis";
        text["de"]["nr"]="Nr";
        text["de"]["observed"]="beobachtet";
        text["de"]["ok"]="OK";
        text["de"]["oldOnes"]="Alte";
        text["de"]["options"]="Optionen";
        text["de"]["overNPCprice"]="über NPC-Preis";
        text["de"]["overview"]="Übersicht";
        text["de"]["overX"]="über %1%";
        text["de"]["pageXNotLoaded"]="Die Seite '%1%' ist nicht vollständig geladen.";
        text["de"]["password"]="Passwort";
        text["de"]["pleaseOpenX"]="Bitte %1% öffnen.";
        text["de"]["pleaseWait"]="Bitte warten";
        text["de"]["portalLogin"]="Portal-Login";
        text["de"]["points"]="Punkte";
        text["de"]["powerups"]="Power-Ups";
        text["de"]["previousMessage"]="vorige Nachricht";
        text["de"]["price"]="Preis";
        text["de"]["prices"]="Preise";
        text["de"]["product"]="Produkt";
        text["de"]["production"]="Produktion";
        text["de"]["productOverview"]="Produkt Übersicht";
        text["de"]["products"]="Produkte";
        text["de"]["productTimeSaving"]="%1% Minuten Zeitersparnis auf %2%";
        text["de"]["profit"]="Gewinn";
        text["de"]["profitTable"]="Profit pro Zone\/<br>Produktionsplatz pro Tag";
        text["de"]["quantity"]="Menge";
        text["de"]["quest_butterfly"]="Schmetterlings Questreihe";
        text["de"]["questbutterfly1"]="Schmetterlings Questreihe";
        text["de"]["quest_breed"]="Tieraufzuchtsanlage Questreihe";
        text["de"]["questbreed1"]="Tieraufzuchtsanlage Questreihe";
        text["de"]["questcow"]="Kuhrennen Questreihe";
        text["de"]["questcow1"]="Kuhrennen Questreihe";
        text["de"]["questfishing"]="Angel Questreihe";
        text["de"]["questfishing1"]="Angel Questreihe";
        text["de"]["quest_foodworld"]="Picknickarea Questreihe";
        text["de"]["quest_forestry"]="Forsthütte Questreihe";
        text["de"]["questinfinite1"]="Rosis täglicher Einkauf";
        text["de"]["quest_main"]="Hauptquestreihe";
        text["de"]["questscouts"]="Pfadfinder Questreihe";
        text["de"]["questscouts1"]="Pfadfinder Questreihe";
        text["de"]["quest_veterinary"]="Tierarzt Questreihe";
        text["de"]["questfoodworld1"]="Picknickarea Questreihe";
        text["de"]["questforestry1"]="Forsthütte Questreihe 1";
        text["de"]["questforestry2"]="Forsthütte Questreihe 2";
        text["de"]["questmain1"]="Hauptquestreihe 1";
        text["de"]["questmain2"]="Hauptquestreihe 2";
        text["de"]["questmain3"]="Hauptquestreihe 3";
        text["de"]["questmain4"]="Hauptquestreihe 4";
        text["de"]["questmain5"]="Hauptquestreihe 5";
        text["de"]["questveterinary1"]="Tierarzt Questreihe";
        text["de"]["quests"]="Quests";
        text["de"]["questSetXToNrY"]="Setze %1% auf Nr %2%";
        text["de"]["rackX"]="%1%. Regal";
        text["de"]["rank"]="Platz";
        text["de"]["readAll"]="Alle lesen";
        text["de"]["readyAtX"]="Fertig um %1%";
        text["de"]["readyAtX_day1"]="Morgen fertig um %1%";
        text["de"]["readyAtX_day2"]="Übermorgen fertig um %1%";
        text["de"]["readySinceX"]="Fertig seit %1%";
        text["de"]["recipes"]="Rezepte";
        text["de"]["recursive"]="Rekursiv benötigt";
        text["de"]["relative"]="Menge fehlt";
        text["de"]["reloadInXSec"]="Neu laden in %1%s.";
        text["de"]["reloadRequired"]="(Reload benötigt)";
        text["de"]["relogin"]="Session endet bald.<br>Neuer Login in %1%.";
        text["de"]["remaining"]="Verbleibend";
        text["de"]["remainFarm"]="eine Anzahl von %1% für die Anpflanzung eines Feldes verbleiben auf Farm %2%";
        text["de"]["requestingUpdateInfoOfX"]="Fordere Update-Informationen für %1% an ..."
        text["de"]["requestingUserStatistic"]="Fordere Benutzer-Statistik an ...";
        text["de"]["requirement"]="Bedarf";
        text["de"]["requirementPerProduction"]="Bedarf pro Produktion";
        text["de"]["reward"]="Belohnung";
        text["de"]["salesLog"]="Verkäufe Log";
        text["de"]["save"]="Speichern";
        text["de"]["saveAsTemplate"]="als Vorlage speichern";
        text["de"]["sawmill"]="Sägewerk";
        text["de"]["scriptHomepage"]="Scripthomepage";
        text["de"]["searchPlayer"]="Spieler suchen";
        text["de"]["seed"]="Saatgut";
        text["de"]["seedPerField"]="Saatgut pro Feld";
        text["de"]["sendContract"]="Vertrag schicken";
        text["de"]["sendingXObservedPricesToServer"]="Sende %1% beobachtete Preise an Server ...";
        text["de"]["sentContractNrX"]="Vertrag Nr %1% gesendet."
        text["de"]["server"]="Server";
        text["de"]["serverTime"]="Zeit des Servers";
        text["de"]["sessionEnd"]="Ende der Session um %1%<br>Klick für neuen Login";
        text["de"]["seedVendor"]="Saatguthändler";
        text["de"]["seedVendorShort"]="SGH"; // Short for the seller of plants
        text["de"]["shadowboxitem"]="Setzkastenitem";
        text["de"]["shortHours"]="h";
        text["de"]["shortOClock"]="Uhr";
        text["de"]["shouldReload"]="Du solltest die Seite neu laden.";
        text["de"]["showAll"]="Alle zeigen";
        text["de"]["showChangelog"]="Zeige ChangeLog";
        text["de"]["showLog"]="Zeige Log";
        text["de"]["showMissingProducts"]="Zeige fehlende Produkte";
        text["de"]["showPasswords"]="zeige Passwörter";
        text["de"]["sinceX"]="seit %1%";
        text["de"]["single"]="Einzel";
        text["de"]["start"]="Start";
        text["de"]["stat_days1"]="1 Tag";
        text["de"]["stat_days3"]="3 Tage";
        text["de"]["stat_days5"]="5 Tage";
        text["de"]["stat_days7"]="7 Tage";
        text["de"]["stat_gamefield"]="Spielfeld zeigen";
        text["de"]["stat_stats"]="Statistik zeigen";
        text["de"]["statistics"]="Statistik";
        text["de"]["stock"]="Lager";
        text["de"]["stockValue"]="Lagerwert";
        text["de"]["stockXlow"]="Lagerbestand %1% niedrig";
        text["de"]["stockXmissing"]="Lagerbestand %1% fehlt!!!";
        text["de"]["storeXinContract"]="%1% im Vertrag auslagern";
        text["de"]["summarize"]="Summiere";
        text["de"]["takeObservedPrices"]="Nimm beobachtete Preise";
        text["de"]["terrarium"]="%1%. Terrarium";
        text["de"]["time"]="Zeit";
        text["de"]["title"]="Titel";
        text["de"]["toMessage"]="zur Nachricht";
        text["de"]["toSeedVendor"]="Zum Saatguthändler";
        text["de"]["total"]="Total";
        text["de"]["turnover"]="Umsatz";
        text["de"]["unitPrice"]="Stückpreis";
        text["de"]["upgradeForX"]="ausbauen&nbsp;für&nbsp;%1%";
        text["de"]["upgradeLevel"]="Ausbaustufe";
        text["de"]["upjersAdvertising"]="Upjers-Werbung";
        text["de"]["useQuestProducts"]= "Nimm aktuelle Quest-Waren";
        text["de"]["userscriptNotStarted"]="Das Benutzerskript ist nicht vollständig gestartet.";;
        text["de"]["useWildcard"]= "Verwende * um einen oder mehrere Buchstaben zu entsprechen.";
        text["de"]["value"]="Wert";
        text["de"]["veterinary"]="Tierarzt";
        text["de"]["veterinaryLevelXNeeded"]="Tierarztlevel %1% benötigt";
        text["de"]["veterinaryRoleAutostart"]="Praxis-Autostart";
        text["de"]["version"]="Version";
        text["de"]["waterBonus"]="%1%% Gießbonus";
        text["de"]["wateringFeature"]="Gießfunktion";
        text["de"]["waterNeeded"]="Wasser benötigt";
        text["de"]["waterNeededAtX"]="Wasser benötigt um %1%";
        text["de"]["waterNeededAtX_day1"]="Morgen Wasser benötigt um %1%";
        text["de"]["windmill"]="Mühle";
        text["de"]["writeMessage"]="Nachricht schreiben";
        text["de"]["XIsUpToDate"]="%1% ist up-to-date."
        text["de"]["yes"]="Ja";
        text["de"]["yield"]="Ertrag";
        text["de"]["yield_netto"]="Nettoertrag";
        text["de"]["yieldPerProduction"]="Ertrag pro Produktion";
        text["de"]["youAreOnRankX"]="Du bist auf Platz %1%.";
        // category
        text["de"]["category_alpin"]="Bergkräuter";
        text["de"]["category_cow"]="Rennkuh-Futter";
        text["de"]["category_breed"]="Tieraufzucht";
        text["de"]["category_c"]=text["de"]["coins"];
        text["de"]["category_fish"]="Angel-Futter";
        text["de"]["category_v"]="Pflanzliche Produkte";
        text["de"]["category_ex"]="Exotische Produkte";
        text["de"]["category_e"]="Tierische Produkte";
        text["de"]["category_tea"]="Tee";
        text["de"]["category_scouts"]="Pfadfinder";
        text["de"]["category_sushi"]="Sushi";
        text["de"]["category_water"]="Wasserpflanzen"
        text["de"]["category_z"]=unsafeWindow.rack_deco;
        text["de"]["category_o"]=unsafeWindow.rack_oil;
        text["de"]["category_f1"]="Setzlinge";
        text["de"]["category_f2"]="Stämme";
        text["de"]["category_f3"]="Sägewerk Produkte";
        text["de"]["category_f4"]="Schreinerei Produkte";
        text["de"]["category_f5"]="Bauernhaus Holzprodukte";
        text["de"]["category_fw"]=unsafeWindow.rack_foodworld;
        text["de"]["category_fw1"]="Getränke";
        text["de"]["category_fw2"]="Speisen";
        text["de"]["category_fw3"]="Torten und Kuchen";
        text["de"]["category_fw4"]="Eiscreme und Sorbee";
        text["de"]["category_fl"]="Blumen";
        text["de"]["category_fla"]="Gestecke";
        text["de"]["category_hr"]="Kräuter";
        text["de"]["category_md"]="Medikamente";
        text["de"]["category_r0"]="Rezepte Produkt";
        text["de"]["category_r1"]="Rezepte Erhöhung Ertrag";
        text["de"]["category_r2"]="Rezepte Erhöhung Punkte";
        text["de"]["category_p0"]="Power-Ups Produkt";
        text["de"]["category_p1"]="Power-Ups Erhöhung Ertrag";
        text["de"]["category_p2"]="Power-Ups Erhöhung Punkte";
        // settings
        text["de"]["settings_valAutoWater"]=["Automatisch gießen","Nach dem Pflanzen wird automatisch gegossen, wenn du die Funktion 'Alles gießen' besitzt (Premium)."];
        text["de"]["settings_valAssumeWater"]=["Gießen annehmen","Dies ist wichtig für Pflanzen, die länger als 24h wachsen. Die Berechnung der Ernte-Zeit nimmt an, dass stets gegossen wird."];
        text["de"]["settings_valAutoCrop"]=["Automatisch ernten","Es wird beim Öffnen der Ackers automatisch geerntet, falls es was zu ernten gibt."];
        text["de"]["settings_valWaterNeeded"]=["Gießen nötig","Es wird angezeigt, dass der Acker gegossen werden muss."];
        text["de"]["settings_valCropMsg"]=["Erntemeldung klicken","Du magst die lästige Erntemeldung mit dem Schwein nicht? Hier wirst du sie los."];
        text["de"]["settings_valLimitEmptyFields"]=["Leere Felder","Es werden unbepflanzte Felder auf deinem Acker erkannt. Sind dies mehr als hier angegeben, wird der Acker als unbenutzt gemeldet."];
        text["de"]["settings_valLimitEmptyFields_forest"]=["Leere Felder Wald","Es werden unbepflanzte Felder im Wald erkannt. Sind dies mehr als hier angegeben, wird der Wald als unbenutzt gemeldet."];
        text["de"]["settings_valMoveAnimals"]=["Bewege Tiere",""];
        text["de"]["settings_valContractLogAmount"]=["Anzahl gemerkte Verträge","Deine letzten erhaltenen und gesendeten Verträge werden gespeichert und somit kann ein Verlauf angezeigt werden."];
        text["de"]["settings_valFarmiLimits"]=["Farmi Grenzen","Die Farmis sind in 3 Klassen eingeteilt, je nachdem wie gut ihre Bezahl-Rate ist."];
        text["de"]["settings_valFarmiMiniInfo"]=["Farmi Mini Info","Zeigt einen kleinen Kreis unter jedem Farmi mit der jeweiligen Klasse der Bezahl-Rate."];
        text["de"]["settings_valMinAlpinFarm6"]=["Bergkräuter","Korrektur der Transportmenge (Anzahl Felder)"];
        text["de"]["settings_valMinExFruitsFarms5"]=["Exotische Früchte","Korrektur der Transportmenge (Anzahl Felder)"];
        text["de"]["settings_valMinRackMan"]=["Detail Konfiguration","Du editierst die Anzahl selbst *hier*"];
        text["de"]["settings_valMinRack"]=[,"Ein Produkt wird markiert, falls der Lagerbestand unter diese Grenze fällt. Du kannst verschiedene Werte abhängig von der Kategorie einstellen."];
        text["de"]["settings_valMinRackPlantsize"]=["Pflanzengröße einrechnen","Zum Beispiel braucht Getreide nur den halben Bestand."];
        text["de"]["settings_valMinRackGrowing"]=["Ernteprodukte","Beachtet zusätzlich die Produkte in Produktion und in den fertigen Powerups."];
        text["de"]["settings_valMinRackQuest"]=["Quest-Produkte","Beachtet zusätzlich die benötigte Menge der Produkte für die Quests."];
        text["de"]["settings_valMinRackRecursive"]=["Rekursive Produkte","Beachtet zusätzlich die benötigten Ausgangsprodukte um fehlenden Produkte zu produzieren."];
        text["de"]["settings_valMinRackFarmis"]=["Farmi-Produkte","Beachtet zusätzlich die Menge der Produkte, die deine Farmis verlangen. Dabei gelten nur diejenigen, die besser als die untere Grenze bezahlen."];
        text["de"]["settings_valMinRackForestryFarmis"]=["Baumerei-Farmi-Produkte","Beachtet zusätzlich die Menge der Produkte, die deine Baumerei-Farmis verlangen."];
        text["de"]["settings_valMinRackFoodworldFarmis"]=["Picknick-Farmi-Produkte","Beachtet zusätzlich die Menge der Produkte, die deine Picknick-Farmis verlangen."];
        text["de"]["settings_valMinRackFarmersmarketFarmis"]=["Bauernmarkt-Farmi-Produkte","Beachtet zusätzlich die Menge der Produkte, die deine Bauernmarkt-Farmis verlangen."];
        text["de"]["settings_protectMinRack"]=["Marktschutz","Verhindert, dass die Warenmenge beim Marktverkauf den minimalen Lagerbestand unterschreitet."];
        text["de"]["settings_valBuyingLimitDown"]=["Untere Kaufmarkierung",""];
        text["de"]["settings_valBuyingLimit"]=["Obere Kaufgrenze","Du kannst am Markt nur Produkte kaufen die maximal der Prozentgrenze entsprechen. Dies schützt dich vor dem versehentlichen Kauf übertrieben teurer Waren."];
        text["de"]["settings_valBuyingLimitNPC"]=["Nur billiger als NPC kaufen",""];
        text["de"]["settings_valSellingLimit"]=["Verkaufgrenzen","Auch dein Verkauf wird geschützt, so dass du weder zu billig noch zu teuer verkaufst."];
        text["de"]["settings_valJoinPrices"]=["Ein Preisfeld","Verbindet die Preis-Eingabefelder beim Marktstand"];
        text["de"]["settings_valQuicklinks"]=["Quicklinks am Markt anzeigen","Quicklinks am Markt anzeigen"];
        text["de"]["settings_valUseObservedPrices"]=["Benutze beobachtete Preise","Wenn du dich durch den Markt klickst, werden die Preise beobachtet. Ein berechneter Preis ist in der Preisliste zu sehen. Soll dieser automatisch übernommen werden?"];
        text["de"]["settings_valPreiseBeobNum"]= ["Limitiere günstigste Angebote","Limitiert die Berechnung des beobachteten Marktpreises auf die angegebene Anzahl der günstigsten Angebote."];
        text["de"]["settings_valUse3TimesNpcPrices"]=["Benutze dreifache NPC-Preise","Für Produkte, die nicht am NPC zu kaufen sind, wird der (fiktive) dreifache Preis angenommen."];
        text["de"]["settings_valSendStatistics"]=["Sende Statistiken","Unterstütze den <a href='http://mff.metrax.eu/' target='_blank'>Statistik-Server</a>. Es werden keine privaten Daten gesendet!"];
        text["de"]["settings_valPrivateMessages"]=["Anzahl gemerkte Privatnachrichten","Deine letzten privaten Nachrichten werden gespeichert und somit kann ein Nachrichten-Verlauf mit einem Kontakt angezeigt werden."];
        text["de"]["settings_valMarketMessages"]=["Anzahl gemerkte Marktnachrichten","Es bleiben auch alte System-Nachrichten in diesem Speicher, selbst wenn sie älter als die maximalen 7&nbsp;Tage sind."];
        text["de"]["settings_valMessageRe"]=["Betreff kürzen","Ersetzt im Betreff \"Re:Re:\" durch \"Re:\", wenn du eine Antwort schreibst."];
        text["de"]["settings_valMessagesSystemMarkRead"]=["Systemnachrichten lesen","Systemnachrichten werden automatisch als gelesen markiert."];
        text["de"]["settings_valFoodworldFarmiPlacing"]=["Picknickarea Farmis platzieren","Angenommene Picknickarea Farmis werden automatisch auf einen freien Sitzplatz gewiesen."];
        text["de"]["settings_valAnimateStartscreen"]=["Animation abstellen","Der bewegte Hintergrund (Wolken ziehen vorbei) der Login-Seite wird entfernt."];
        text["de"]["settings_valAutoLogin"]=["Automatisch einloggen","Sobald Nutzerdaten und Passwort eingegeben sind, werden die Accounts wieder eingeloggt. Somit kann wieder gefüttert, geerntet, gegossen und gepflanzt werden. Es müssen Popups erlaubt werden bei mehreren Accounts."];
        text["de"]["settings_valUpdate"]=["Update","Es wird geprüft, ob eine neuere Version dieses Scriptes verfügbar ist."];
        text["de"]["settings_valServerTimeOffset"]=["Zeit des Servers",""];
        text["de"]["settings_valGamecursor"]=["Spiel-Cursor","Benutze die spieleigenen Cursor an Stelle deiner System-Cursor."];
        text["de"]["settings_valDrag"]=["Verschieben","Erlaube das Bewegen der Fenster (obere linke Ecke)."];
        text["de"]["settings_valClickErrorbox"]=["Verstecke Fehlerbox","Einige Spieler haben Probleme mit der Fehlerbox. Beachte, dass diese Meldung normalerweise sinnvoll ist!"];
        text["de"]["settings_valHotkeys"]=["Hotkeys","Benutze Hotkeys um schnell durch das Spiel zu navigieren. Schau in die Hilfe."];
        text["de"]["settings_hotkeymap"]={"prevPage":"vorige Nachricht, Zone, ...","nextPage":"nächste Nachricht, Zone, ...","farm1":"1. Farm","farm2":"2. Farm","farm3":"3. Farm","guild":"Club","city1":"Klein Muhstein","city2":"Teichlingen","farmiLog":"Farmi-Log","help":"Hilfe","market":"Marktplatz","marketstand":"Marktstand","messages":"Nachrichten","options":"Optionen","profit":"Profit Kalkulation","seedVendor":"Saatguthändler","overview":"Übersicht","contract":"Verträge","systemMessage":"(nächste ungelesene) Systemnachricht"};
        text["de"]["settings_valzoneAddToGlobalTime"]=["Integration","Soll die Zeit in die Global-Zeit einbezogen werden?"];
        text["de"]["settings_valGlobaltimeShowCroppedZone"]=["Beachte geerntete Zonen","Sollen geerntete Zonen in die globale Zeit einbezogen werden?"];
        text["de"]["settings_cacheReset"]=["Cache reset","Die History und alle Informationen über die Zonen werden gelöscht ..."];
        text["de"]["settings_zoneReset"]=["Zones reset","Alle Informationen über deine Zonen werden gelöscht ..."];
        text["de"]["settings_setQuestAll"]=["Korrigiere Questreihen","Werte der Questreihen werden wenn nötig übernommen und abgespeichert. Dies wirkt bei abgeschlossenen Questreihen oder Questreihen, bei denen die Sanduhr den Zugriff auf das Quest-Fenster verhindert."];
        text["de"]["settings_megafieldSmartTimer"]=["Beachte aktive Tour", "Soll beim Starten einer Tour der Güterhof-Timer auf das Ende der Tour gesetzt werden?"];
        text["de"]["settings_clothingDonation"]=["Kleiderspende", "Ein blinkender Icon zeigt an, wenn bei der Kleiderspende gespendet oder gewürfelt werden kann."];
        text["de"]["settings_vet"]=["Tierarzt (Behandlung kranker Tiere)", "Ein blinkender Icon zeigt an, wenn ein geheiltes Tier entlassen werden kann."];
        text["de"]["settings_vetAutoSet"]=["Automatisches Setzen", "Wird ein krankes Tier angeklickt, wird es direkt auf eine freie Liege gelegt."];
        text["de"]["settings_valVetNoCoinDrugs"]=["Keine Coin-Tinkturen", "Ignoriere Tinkturen, die in der Herstellung Coins kosten."];
        text["de"]["settings_vetTreatment"]=["Tier heilen", "Tierdaten werden eingelesen"];
        text["de"]["settings_valTurnOffUpjersNews"]=["Upjers News ausschalten","Die Upjers News Fenster werden geschlossen."];

        // help
        text["de"]["help_0"]=[,"This is small introduction to the functions of the Adviser-Script. Not all changes are written here, go find them yourself ... Sometimes a mouse-over helps. <br>At the bottom you see a button to visit the <a href=\""+GM_Home+"\" target=\"_blank\">homepage</a>. Next to it, there is the button for the options. You should look at them and configure as you desire.<br>Generally the script only knows what you have seen. So just visit the field if something is wrong."];
        text["de"]["help_1"]=["The Zones","The fields are observed while you see them. The script saves the plants, times and watering. So on the farm view this can be displayed. Each zone has a time counter at its top to show you when it is ready.<br>If you own the planting helper, you can access it directly from opened field. At the top of an opened zone you can navigate directly to zones of the same type."];
        text["de"]["help_2"]=["The Overview","Click the pig on the top and you will see an overview of your complete farm. Each zone, its output (product and points) and the next time of work are displayed. Also your total crop is shown. Below you see the wishes of your farmies. You can click each zone or farmie to navigate there. If you are run out of a product, it can take you directly to the market place."];
        text["de"]["help_3"]=["Blue Bar","Your points are kept daily. At the bottom you see a bar displaying the current and past level. Each white and red (sunday) line is a day. If you click it you get a detailed table and perhaps a hint if you are lack of a product."];
        text["de"]["help_4"]=["Shelf","Here informations of prices and value are added. The amount are reformatted to better style. At the bottom you have an input to seach an other player."];
        text["de"]["help_5"]=["Profit Calculation","Next to the bottom of the shelf you can click <img src=\""+GFX+"buildingupdatebutton_off.png\" style=\"width: 15px;height: 15px;\">. This shows you a table calculating times and profits of your products. Click the stars to change the upgrade levels. Click the headline to sort."];
        text["de"]["help_6"]=["Farmies","The bubbles of the farmies are expanded by a calculation if they pay enough. If your product amount runs too low, the product is marked. Click the house next to the farmies to see the ones of the last month. At the blue bar on the right you can set which farmies you send away. At the top a calculation is made, so you can decide if an advertising is profitable."];
        text["de"]["help_7"]=["Hotkeys","You can quickly move to a place by pressing <i>Alt</i>+... See the options!"];
        text["de"]["help_8"]=["Market place","On the market place you are \"protected\", means that you can't buy a product more expensive than in the retailer or by options set. If activated, you can directly switch to a product page by the incoming window on the right. At the top you can step to the next/previous product and see your current amount.<br>You find at the bottom a very important button: the prices. It gives you a table listing your product amounts, values and the prices that are everywhere used. So keep attention they are set right! An \"observed\" price is kept when you visit a market page of a single product.<br>On your market stall a few usefull values are displayed and your last offer was kept and is set now."];
        text["de"]["help_9"]=["Messages","Your sales are kept and directly displayed - no need to open a message two times! Note the \"Read all\" and \"Log\" buttons. Your private messages are kept, too. So no need to look for the last messages of the current contact."];
        text["de"]["help_10"]=["Contracts","They are kept, too. While creating a contact an input displays the value of the entered product. Enter first the price and then the amount to get inverse the amount. You can submit the same contract multiple times!"];
        text["de"]["help_11"]=["Account Managing","You can save all your accounts in the options. So you can login easily in each one by the displayed buttons on the starting page. Note that you can switch directly the accounts at the same server."];
    }
    if(undefined===text["en"]){
        text["en"]=new Object();
        text["en"]["msgContentContractsale"]="(.+) has signed a contract of yours!<br><br> The following products have been sold:<br>(.+?)<br> The amount of (.+?)&nbsp;pD has been credited to your account\\."; // The text where the general information is stated. The information has to be replaced by "(.+?)".
        text["en"]["msgContentContractsaleList"]="\\s*(\\d+)x\\s*(.+?)\\s*<br>"; // The line-pattern for the detailed selling list
        text["en"]["msgContentMarketsale"]="(.*) bought (\\d+)x (.+?) for<br> (.+?) pD from you\\."; // The text where the information is stated. The information has to be replaced by "(.+?)".
        text["en"]["msgSubjectCoins"]="xxx tbd: you got coins xxx";
        text["en"]["msgSubjectCongratulation"]="Congratulations";
        text["en"]["msgSubjectCongratulation2"]="xxx";
        text["en"]["msgSubjectContractReject"]="A contract has been withdrawn";
        text["en"]["msgSubjectContractsale"]="A contract has been accepted";
        text["en"]["msgSubjectContractCancel"]="A contract has been xxx tbd xxx";
        text["en"]["msgSubjectContractNew"]="xxx tbd xxx";
        text["en"]["msgSubjectFriend"]="^(.+) would like to add you as a friend$"; // The subject. The person has to be replaced by "(.+)"
        text["en"]["msgSubjectFriendEnd"]="xxx tbd xxx";
        text["en"]["msgSubjectLevel"]="You have reached the next level!";
        text["en"]["msgSubjectMarketsale"]="^Market&nbsp;.+ pD&nbsp;\(.+x .+\)$";
        text["en"]["msgSubjectPremium"]="Premium remind";
        text["en"]["msgSubjectPresent"]="A present for you";
        text["en"]["msgSubjectQuest"]="^.+ completed$";
        text["en"]["msgSubjectWeed1"]="Oh no!";
        text["en"]["msgSubjectWeed2"]="Au Weia!";
        text["en"]["above"]="above";
        text["en"]["absolute"]="Amount required";
        text["en"]["accountActive"]="Account active";
        text["en"]["accounts"]="Accounts";
        text["en"]["activation"]="Activation";
        text["en"]["additionalFarmi"]="%1% additional farmie daily";
        text["en"]["additionalForestFarmiSlot"]="%1% additional place in the forest farmi waiting queue";
        text["en"]["additionalLogCapacity"]="Rack capacity for logs increases of %1%";
        text["en"]["advertisingEnds"]="Advertising ends today";
        text["en"]["adviser"]="Adviser";
        text["en"]["afterFee"]="After Fee";
        text["en"]["alertSetPriceNone"]="Do you really want to set no price for %PRODUCT%?";
        text["en"]["alertSetPriceOverNPC"]="Do you really want to set the price of %PRICE% for %PRODUCT%?<br>It is higher than the NPC-value of %NPC%.";
        text["en"]["alertSetPriceOverObs"]="Do you really want to set the price of %PRICE% for %PRODUCT%?<br>It is much higher than the observed value of %OBS%.";
        text["en"]["alertSetPriceUnderObs"]="Do you really want to set the price of %PRICE% for %PRODUCT%?<br>It is much lower than the observed value of %OBS%.";
        text["en"]["alertWillLowRack"]="Attention! This will drop your stock below the minimal value!";
        text["en"]["all"]="All";
        text["en"]["autologinAllOk"]="All accounts logged in.";
        text["en"]["autologinChecking"]="Checking active sessions.  Please wait %1% seconds<br>...";
        text["en"]["blossomsForHour"]="Blossums for hour"
        text["en"]["bonus"]="Bonus";
        text["en"]["boughtTickets"]="Bought tickets";
        text["en"]["breed"]="Animal breeding";
        text["en"]["buildingNameX"]="%1% to buying";
        text["en"]["butterfly"]="Butterfly";
        text["en"]["buy"]="Buy";
        text["en"]["buyers"]="Buyers";
        //22102016
        text["en"]["buyPetsParts"]="Buy Petparts";
        text["en"]["calcTo"]="Calculate to";
        text["en"]["carpentry"]="Carpentry";
        text["en"]["city"]="City";
        text["en"]["change"]="Change";
        text["en"]["clearFilter"]="Clear filter";
        text["en"]["click"]="Click";
        text["en"]["clickAlt"]="Alt+Click";
        text["en"]["clickCtrl"]="Ctrl+Click";
        text["en"]["clickDouble"]="Double-Click";
        text["en"]["clickToChange"]="Click to change";
        text["en"]["clothingDonationLog"]="Clothing Donation Log";
        text["en"]["coins"]=unsafeWindow.t_coins;
        text["en"]["commission"]="Commission";
        text["en"]["confirmUseObservedPrices"]="The observed prices will overwrite previously saved market prices ...";
        text["en"]["confirmChangelogVersion"]="You have installed a new version of the Adviser script.<br>The version %1% contains the following changes:";
        text["en"]["contract"]="Contract";
        text["en"]["contractsReceived"]="Contracts received";
        text["en"]["contractsSent"]="Contracts sent";
        text["en"]["copyToTextFile"]="Copy this string to a text-file";
        text["en"]["couldNotGetRank"]="Your rank could not be determined.";
        text["en"]["couldNotGetUpdateInfoOfX"]="Update information for %1% could not be determined.";
        text["en"]["cow"]="Cow-Racing";
        text["en"]["cowracing"]="%1%. Cow-Racing-Stable";
        text["en"]["createStorageString"]="Create storage string";
        text["en"]["cropped"]="Cropped";
        text["en"]["currentOffers"]="Current offers";
        text["en"]["dailyRuns"]="Daily runs";
        text["en"]["dailyTicket"]="Daily ticket";
        text["en"]["dailyYield"]="Daily yield";
        text["en"]["date"]="Date";
        text["en"]["day"]="Day";
        text["en"]["day0"]="Today";
        text["en"]["day1"]="Tomorrow";
        // text["day2"]="Day after tomorrow"; // comment it if not used in the language
        text["en"]["default"]="Default";
        text["en"]["delete"]="Delete";
        text["en"]["deleteFollowingData"]="Delete following data";
        text["en"]["demand"]="Demand";
        text["en"]["detail"]="Detail";
        text["en"]["difficulty"]="Difficulty";
        text["en"]["donkey"]="Donkey";
        text["en"]["donation"]="Donation";
        text["en"]["duration"]="duration";
        text["en"]["editPrice"]="Edit price";
        text["en"]["emptyField"]="Empty field!";
        text["en"]["end"]="End";
        text["en"]["exchangedLots"]="Exchanged lots";
        text["en"]["farm"]="Farm";
        text["en"]["farmersmarket"]=unsafeWindow.t_farmers_market;
        text["en"]["farmX"]="%1%. farm";
        text["en"]["farmi"]="Farmie";
        text["en"]["farmis"]="Farmies";
        text["en"]["farmpedia"]="Forum";
        text["en"]["farmpediaUrl"]="http://forum.myfreefarm.com/";
        text["en"]["farmzone"]="Building place %1% of %2%. farm";
        text["en"]["feed"]="Feed";
        text["en"]["fields"]="Fields";
        text["en"]["filter"]="Filter";
        text["en"]["filterForX"]="Filter for %1%";
        text["en"]["finished"]="Finished";
        text["en"]["fish"]="Fishing";
        text["en"]["foodworld"]=unsafeWindow.foodworld_title;
        text["en"]["forest"]="Forest";
        text["en"]["forestry"]="Forestry";
        text["en"]["formatNumbers"]="Format numbers";
        text["en"]["formulaType"]=["Prod","+val","+pts"];
        text["en"]["fl1"]="Flower meadow";
        text["en"]["fl2"]="Flower workshop";
        text["en"]["fl3"]="Monster fruit culture";
        text["en"]["fl4"]="Animal breeding";
        text["en"]["fl5"]="Animal doctor";
        text["en"]["fl6"]="Speed eating";
        text["en"]["fl7"]="Butterfly terrarium";
        text["en"]["fl8"]="Cowracing";
        text["en"]["fl9"]="Fishing";
        text["en"]["fl11"]="Scouts";
        text["en"]["fw1"]="Soda stall";
        text["en"]["fw2"]="Snack booth";
        text["en"]["fw3"]="Pastry shop";
        text["en"]["fw4"]="Ice creme parlor";
        text["en"]["m1"]="Fruitshop I";
        text["en"]["m2"]="Fruitshop II";
        text["en"]["gain"]="Gain";
        text["en"]["gamecurrency"]=unsafeWindow.gamecurrency;
        text["en"]["general"]="General";
        text["en"]["given"]="Given";
        text["en"]["goods"]="Goods";
        text["en"]["showGoToAnimalBreedingReady"]="Animalbreeding is ready!";
        text["en"]["showGoToMonsterFruitCultureReady"]="Monster fruit culture is ready!";
        text["en"]["showGoToSpeedEatingReady"]="Speed eating is ready!";
        text["en"]["goTobuyPetsParts"]="Go to buy puzzle parts";
        text["en"]["goToClothingDonation"]="Go to clothing donation";
        text["en"]["goToDonkey"]="Go to donkey Luke";
        text["en"]["goToLottery"]="Go to lottery";
        text["en"]["goToMarket"]="Go to market";
        text["en"]["goToMarketOfX"]="Go to market of %1%";
        text["en"]["goToMarketstall"]="Go to market stall";
        text["en"]["goToPage"]="Go to page";
        text["en"]["goToRank"]="Go to rank";
        text["en"]["goToVet"]="Go to veterinary";
        text["en"]["goToX"]="Go to %1%";
        text["en"]["hide"]="hide";
        text["en"]["highlightProducts"]="Highlight products at market";
        text["en"]["highlightUser"]="Highlight user at market";
        text["en"]["hotkeys"]="Hotkeys";
        text["en"]["idle"]="idle !!";
        text["en"]["importStorageString"]="Import storage string";
        text["en"]["importStorageStringError"]="Sorry. Can't read the storage string.";
        text["en"]["informationIsMissing"]="Information is missing."
        text["en"]["ingredients"]="Ingredients";
        text["en"]["inStock"]="in stock";
        text["en"]["invalidServer"]="Invalid Server";
        text["en"]["inventory"]="Inventory";
        text["en"]["jobIncomplete"]="Job not finished successfully";
        text["en"]["jobComplete"]="Job finished successfully";
        text["en"]["jobCurrent"]="Current job";
        text["en"]["keptLots"]="Kept lots";
        text["en"]["lastPrice"]="Last price";
        text["en"]["lastQuest"]="Completed";
        text["en"]["level"]="Level";
        text["en"]["levelTooLow"]="Your level is too low";
        text["en"]["levelXneeded"]="Level&nbsp;%1%&nbsp;needed";
        text["en"]["load"]="Load";
        text["en"]["loading"]="Loading";
        text["en"]["localTime"]="Local time";
        text["en"]["lodge"]="Log cabin";
        text["en"]["login"]="Login";
        text["en"]["loginPageFound"]="Found login page";
        text["en"]["loginPortalSubmitted"]="Submitted portal login";
        text["en"]["loginSubmitted"]="Submitted login";
        text["en"]["logDonkey"]="Donkey Luke Log";
        text["en"]["lotteryLog"]="Lottery Log";
        text["en"]["lvl"]="Lvl";
        text["en"]["manageVariables"]="Manage variables";
        text["en"]["market"]="Market";
        text["en"]["marketplace"]="Market place";
        text["en"]["marketPrice"]="Market&nbsp;Price";
        text["en"]["marketstall"]="Market stall";
        text["en"]["megafield"]="Plantation\/Megafield";
        text["en"]["megafieldCurrency"]=unsafeWindow.t_megafield_currency;
        text["en"]["messages"]="Messages";
        text["en"]["minRack"]="Min&nbsp;rack";
        text["en"]["minRackamount"]="Minimal rackamount";
        text["en"]["missing"]="Need";
        text["en"]["money"]="Offered";
        text["en"]["name"]="Name";
        text["en"]["newLevelReached"]="Congratulations!<br>You have reached the next level!";
        text["en"]["nextMessage"]="next message";
        text["en"]["no"]="No";
        text["en"]["nothingSelected"]="Nothing selected";
        text["en"]["NPC"]="NPC";
        text["en"]["NPCprice"]="NPC-Price";
        text["en"]["nr"]="Nr";
        text["en"]["observed"]="Observed";
        text["en"]["ok"]="OK";
        text["en"]["oldOnes"]="Old";
        text["en"]["options"]="Options";
        text["en"]["overNPCprice"]="over NPC-price";
        text["en"]["overview"]="overview";
        text["en"]["overX"]="over %1%";
        text["en"]["pageXNotLoaded"]="Page '%1%' is not loaded completely.";
        text["en"]["password"]="Password";
        text["en"]["pleaseOpenX"]="Please open %1%.";
        text["en"]["points"]="Points";
        text["en"]["pleaseWait"]="Pleae wait";
        text["en"]["portalLogin"]="Portal-Login";
        text["en"]["powerups"]="Power-Ups";
        text["en"]["previousMessage"]="previous message";
        text["en"]["price"]="Price";
        text["en"]["prices"]="Prices";
        text["en"]["product"]="Product";
        text["en"]["production"]="Production";
        text["en"]["productOverview"]="Product overview";
        text["en"]["products"]="Products";
        text["en"]["productTimeSaving"]="%1% minutes saving for %2%";
        text["en"]["profit"]="Profit";
        text["en"]["profitTable"]="Profit per Zone per Day";
        text["en"]["quantity"]="Quantity";
        text["en"]["quest_breed"]="Animal breed quest series";
        text["en"]["questbreed1"]="Animal breed quest series";
        text["en"]["quest_butterfly"]="butterfly quest series";
        text["en"]["questbutterfly1"]="butterfly quest series";
        text["en"]["questcow"]="cow racing quest series";
        text["en"]["questcow1"]="cow racing quest series";
        text["en"]["questfishing1"]="fishing quest series";
        text["en"]["quest_foodworld"]="Picnic area quest series";
        text["en"]["quest_forestry"]="Series of quests (forestry)";
        text["en"]["questinfinite1"]="Rosy's Daily Purchase";
        text["en"]["questscouts"]="scouts quest seriese";
        text["en"]["questscouts1"]="scouts quest series";
        text["en"]["quest_main"]="Series of quests (farm)";
        text["en"]["quest_veterinary"]="Veterinary quest series";
        text["en"]["questfoodworld1"]="Picnic area quest series";
        text["en"]["questforestry1"]="1st series of quests (forestry)";
        text["en"]["questforestry2"]="2nd series of quests (forestry)";
        text["en"]["questmain1"]="1st series of quests (farm)";
        text["en"]["questmain2"]="2nd series of quests (farm)";
        text["en"]["questmain3"]="3rd series of quests (farm)";
        text["en"]["questmain4"]="4rd series of quests (farm)";
        text["en"]["questmain5"]="5rd series of quests (farm)";
        text["en"]["questveterinary1"]="Veterinary quest series";
        text["en"]["quests"]="Quests";
        text["en"]["questSetXToNrY"]="Setting %1% to No %2%";
        text["en"]["rackX"]="%1%. rack";
        text["en"]["rank"]="Rank";
        text["en"]["readAll"]="Read all";
        text["en"]["readyAtX"]="Ready at %1%"; // %1%=2:15+text["shortOClock"]
        text["en"]["readyAtX_day1"]="Tomorrow ready at %1%";
        // text["en"]["readyAtX_day2"]="Ready in 2days at %1%"; // comment it if not used in the language
        text["en"]["readySinceX"]="Ready since %1%";
        text["en"]["recipes"]="Recipes";
        text["en"]["recursive"]="Recursive Needed";
        text["en"]["relative"]="Amount missing";
        text["en"]["reloadInXSec"]="Reload in %1%s.";
        text["en"]["reloadRequired"]="(Reload required)";
        text["en"]["relogin"]="Session ends soon.<br>New login in %1%.";
        text["en"]["remaining"]="Remaining";
        text["en"]["remainFarm"]="a number of %1% for planting one field remaining on farm %2%";
        text["en"]["requestingUpdateInfoOfX"]="Requesting update information for %1% ..."
        text["en"]["requestingUserStatistic"]="Requesting user statistic ...";
        text["en"]["requirement"]="Need";
        text["en"]["requirementPerProduction"]="Requirement per production";
        text["en"]["reward"]="Reward";
        text["en"]["salesLog"]="Sales log";
        text["en"]["save"]="Save";
        text["en"]["saveAsTemplate"]="Save as template";
        text["en"]["sawmill"]="Sawmill";
        text["en"]["scriptHomepage"]="Script Homepage";
        text["en"]["searchPlayer"]="Search player";
        text["en"]["seed"]="Seed";
        text["en"]["seedPerField"]="Seed per field";
        text["en"]["sendContract"]="Send contract";
        text["en"]["sendingXObservedPricesToServer"]="Sending %1% observed prices to server ...";
        text["en"]["sentContractNrX"]="Sent contract no %1%."
        text["en"]["server"]="Server";
        text["en"]["serverTime"]="Time of server";
        text["en"]["sessionEnd"]="End of Session at %1%<br>Click for new login";
        text["en"]["seedVendor"]="Seed vendor";
        text["en"]["seedVendorShort"]="Shop"; // Short for the seller of plants
        text["en"]["shadowboxitem"]="Shadowbox item";
        text["en"]["shortHours"]="h";
        text["en"]["shortOClock"]="h";
        text["en"]["shouldReload"]="You should reload the page.";
        text["en"]["showAll"]="Show all";
        text["en"]["showChangelog"]="Show changelog";
        text["en"]["showLog"]="Show log";
        text["en"]["showMissingProducts"]="Show product shortage";
        text["en"]["showPasswords"]="show passwords";
        text["en"]["sinceX"]="since %1%";
        text["en"]["single"]="Single";
        text["en"]["start"]="Start";
        text["en"]["stat_days1"]="1 day";
        text["en"]["stat_days3"]="3 days";
        text["en"]["stat_days5"]="5 days";
        text["en"]["stat_days7"]="7 days";
        text["en"]["stat_gamefield"]="Show game";
        text["en"]["stat_stats"]="Show statistics";
        text["en"]["statistics"]="Statistics";
        text["en"]["stock"]="Stock";
        text["en"]["stockValue"]="Stock value";
        text["en"]["stockXlow"]="Stock %1% low";
        text["en"]["stockXmissing"]="Stock %1% missing!!!";
        text["en"]["storeXinContract"]="Store %1% in contract";
        text["en"]["summarize"]="Summarize";
        text["en"]["takeObservedPrices"]="Take observed prices";
        text["en"]["terrarium"]="%1%. terrarium";
        text["en"]["time"]="Time";
        text["en"]["title"]="Title";
        text["en"]["toMessage"]="to message";
        text["en"]["toSeedVendor"]="Go to seed vendor";
        text["en"]["total"]="Total";
        text["en"]["turnover"]="Turnover";
        text["en"]["unitPrice"]="Unit price";
        text["en"]["upgradeForX"]="upgrade&nbsp;for&nbsp;%1%";
        text["en"]["upgradeLevel"]="Upgrade level";
        text["en"]["upjersAdvertising"]="Upjers-Advertising";
        text["en"]["useQuestProducts"]= "Use current quest products";
        text["en"]["userscriptNotStarted"]= "The userscript is not started completely.";
        text["en"]["useWildcard"]= "Use * to match one or more letters.";
        text["en"]["value"]="Value";
        text["en"]["version"]="Version";
        text["en"]["veterinary"]="Veterinary";
        text["en"]["veterinaryLevelXNeeded"]="Veterinary level %1% needed";
        text["en"]["veterinaryRoleAutostart"]="Autostart role";
        text["en"]["waterBonus"]="%1%% water bonus";
        text["en"]["waterNeeded"]="Water needed";
        text["en"]["waterNeededAtX"]="Water needed at %1%";
        text["en"]["waterNeededAtX_day1"]="Tomorrow water needed at %1%";
        text["en"]["wateringFeature"]="Watering feature";
        text["en"]["windmill"]="Windmill";
        text["en"]["writeMessage"]="write message";
        text["en"]["XIsUpToDate"]="%1% is up-to-date."
        text["en"]["yes"]="Yes";
        text["en"]["yield"]="Yield";
        text["en"]["yield_netto"]="Yield (netto)";
        text["en"]["yieldPerProduction"]="Yield per production";
        text["en"]["youAreOnRankX"]="You are on rank %1%.";
        // category
        text["en"]["category_alpin"]="Mountain herbage";
        text["en"]["category_cow"]="cow running food";
        text["en"]["category_breed"]="Animal breeding";
        text["en"]["category_c"]=text["en"]["coins"];
        text["en"]["category_fish"]="Fishing food";
        text["en"]["category_v"]="Plants";
        text["en"]["category_ex"]="Exotic plants";
        text["en"]["category_e"]="Advanced products";
        text["en"]["category_tea"]="Tea";
        text["en"]["category_scouts"]="Scouts";
        text["en"]["category_sushi"]="Sushi";
        text["en"]["category_water"]="Water plants"
        text["en"]["category_z"]=unsafeWindow.rack_deco;
        text["en"]["category_o"]=unsafeWindow.rack_oil;
        text["en"]["category_f1"]="Saplings";
        text["en"]["category_f2"]="Logs";
        text["en"]["category_f3"]="Sawmill products";
        text["en"]["category_f4"]="Carpentry products";
        text["en"]["category_f5"]="Wooden farmhouse items";
        text["en"]["category_fw"]=unsafeWindow.rack_foodworld;
        text["en"]["category_fw1"]="Drinks";
        text["en"]["category_fw2"]="Food";
        text["en"]["category_fw3"]="Cakes";
        text["en"]["category_fw4"]="Ice crem";
        text["en"]["category_fl"]="Flowers";
        text["en"]["category_fla"]="Arrangements";
        text["en"]["category_hr"]="Medicinal herb";
        text["en"]["category_md"]="Healing tincture";
        text["en"]["category_r0"]="Recipes product";
        text["en"]["category_r1"]="Recipes increade yield";
        text["en"]["category_r2"]="Recipes increade points";
        text["en"]["category_p0"]="Power-Ups Produkt";
        text["en"]["category_p1"]="Power-Ups increade yield";
        text["en"]["category_p2"]="Power-Ups increade points";
        // settings
        text["en"]["settings_valAutoWater"]=["Automatic watering","Plants will be watered after planting, if you have 'Water everything' (Premium)."];
        text["en"]["settings_valAssumeWater"]=["Assume watering","This is important for plants growing more than 24h. The calculation of the cropping time assumes watering when needed."];
        text["en"]["settings_valAutoCrop"]=["Automatic harvesting","After opening your field, crops will be harvested if necessary."];
        text["en"]["settings_valWaterNeeded"]=["Watering needed","Shall the necessity of watering be displayed?"];
        text["en"]["settings_valCropMsg"]=["Close harvest dialog","Don't like the annoying harvest notification with the pig?  Get rid of it here."];
        text["en"]["settings_valLimitEmptyFields"]=["Empty areas","If the number of unplanted areas in your field exceeds this number, the field will be shown as empty."];
        text["en"]["settings_valLimitEmptyFields_forest"]=["Empty forest areas","If the number of unplanted areas in your field exceeds this number, the field will be shown as empty."];
        text["en"]["settings_valMoveAnimals"]=["Move animals",""];
        text["en"]["settings_valContractLogAmount"]=["Number contracts kept","Your last sent and received contracts are kept so that a history of them can be shown."];
        text["en"]["settings_valFarmiLimits"]=["Farmie Limits","The farmies are marked in 3 cases depending on their payment-rate."];
        text["en"]["settings_valFarmiMiniInfo"]=["Farmie Mini Info","Displays a small circle below each farmie showing its case of payment-rate."];
        text["en"]["settings_valMinAlpinFarm6"]=["Mountain herbs","Correction of transport amount (number of fields)"];
        text["en"]["settings_valMinExFruitsFarms5"]=["Exotic Fruits","Correction of transport amount (number of fields)"];
        text["en"]["settings_valMinRackMan"]=["Detail configuration","You edit the amount on your own *here*"];
        text["en"]["settings_valMinRack"]=[,"A product is marked if its amount in your rack is falling below this value. You can enter different values depending on the category."];
        text["en"]["settings_valMinRackPlantsize"]=["Aspect size of plant","For example grain needs only half of the value above."];
        text["en"]["settings_valMinRackGrowing"]=["Growing products","Adds the amount of products that are in production and ready by powerup."];
        text["en"]["settings_valMinRackQuest"]=["Quest products","Adds the amount of the quest products"];
        text["en"]["settings_valMinRackRecursive"]=["Recursive products","Add required products needed to manufacture missing products."];
        text["en"]["settings_valMinRackFarmis"]=["Farmie products","Adds the amount of the products wanted by the farmies which pay more than the lower limit."];
        text["en"]["settings_valMinRackForestryFarmis"]=["Lodge farmie products","Adds the amount of the products wanted by the lodge farmies."];
        text["en"]["settings_valMinRackFoodworldFarmis"]=["Foodworld farmie products","Adds the amount of the products wanted by the foodworld farmies."];
        text["en"]["settings_valMinRackFarmersmarketFarmis"]=["Farmersmarket farmie products","Adds the amount of the products wanted by the farmersmarket farmies."];
        text["en"]["settings_protectMinRack"]=["Selling protection","Prohibits to sell products at market below the minimal rackamount"];
        text["en"]["settings_valBuyingLimitDown"]=["Bottom buy highlight",""];
        text["en"]["settings_valBuyingLimit"]=["Top buy limit","You can only buy products at the market up to the limit given.  This protects you from accidentally purchasing very over-priced goods."];
        text["en"]["settings_valBuyingLimitNPC"]=["Only allow buy less than price of NPC",""];
        text["en"]["settings_valSellingLimit"]=["Sell limits","Your sales are also protected, so that you don't price your own goods too cheaply or too highly."];
        text["en"]["settings_valJoinPrices"]=["One input","Joins the price input fields at the market stand."];
        text["en"]["settings_valQuicklinks"]=["Show market quicklinks","Show quicklinks at market place"];
        text["en"]["settings_valUseObservedPrices"]=["Use observed prices","Prices are observed while clicking through the market place. A calculated price can be seen in the price list. Shall this automatically override your settings?"];
        text["en"]["settings_valPreiseBeobNum"]= ["Limit cheapest offers","Limits the calculation of observed prices to the given amount of cheapest offers."];
        text["en"]["settings_valUse3TimesNpcPrices"]=["Use three times NPC prices","For products, that can't be bought at an NPC, three times their (fictual) values are assumed."];
        text["en"]["settings_valSendStatistics"]=["Send statistics","Support the <a href='http://mff.metrax.eu/' target='_blank'>Statistik-Server</a>.  No private data is sent!"];
        text["en"]["settings_valPrivateMessages"]=["Number private messages kept","Your last private messages are kept so that a message history of one contact can be shown."];
        text["en"]["settings_valMarketMessages"]=["Number market messages kept","Old messages remain in this archive, even if they are older than the maximum 7 days."];
        text["en"]["settings_valMessageRe"]=["Short subject","Replaces \"Re:Re:\" to \"Re:\" in the subject when you reply to a message."];
        text["en"]["settings_valMessagesSystemMarkRead"]=["Read system messages","System messages are marked read automatically."];
        text["en"]["settings_valFoodworldFarmiPlacing"]=["Locate picnic area farmis","Accepted picnic area farmis are located automatically to a vacant seat."];
        text["en"]["settings_valAnimateStartscreen"]=["Stop Animation","Animated background (clouds) are removed from login-screen."];
        text["en"]["settings_valAutoLogin"]=["Automatic login","Once username and password information is given, all accounts will be logged in, so that they can be fed, harvested, watered, and planted. Popups must be allowed with multiple accounts."];
        text["en"]["settings_valUpdate"]=["Update","Checks whether an updated version of this Advisor script is available."];
        text["en"]["settings_valServerTimeOffset"]=["Time of server",""];
        text["en"]["settings_valGamecursor"]=["Game cursor","Use the game cursors instead of your system cursors."];
        text["en"]["settings_valDrag"]=["Dragging","Allow moving windows by clicking the upper left corner."];
        text["en"]["settings_valClickErrorbox"]=["Hide errorbox","Some users have problems with the error box. Keep in mind that this alert is normally useful!"];
        text["en"]["settings_valHotkeys"]=["Hotkeys","Use hotkeys to quicker navigate the game. See the help."];
        text["en"]["settings_hotkeymap"]={"prevPage":"previous Message, Zone, ...","nextPage":"next Message, Zone, ...","farm1":"1st farm","farm2":"2nd farm","farm3":"3rd farm","guild":"Club","city1":"First Village","city2":"Second Village","farmiLog":"Farmi-Log","help":"Help","market":"Market place","marketstand":"Market stand","messages":"Messages","options":"Options","profit":"Profit Calculation","seedVendor":"Seed retailer","overview":"Overview","contract":"Contracts","systemMessage":"(next unread) system message"};
        text["en"]["settings_valzoneAddToGlobalTime"]=["Integrate","Shall the time be included to the global time?"];
        text["en"]["settings_valGlobaltimeShowCroppedZone"]=["Integrate cropped zone","Shall the ready-state of the cropped zones be included in the global time?"];
        text["en"]["settings_cacheReset"]=["Cache reset","The History and all information about your farms will be deleted ..."];
        text["en"]["settings_zoneReset"]=["Zones reset","All information about your farms will be deleted ..."];
        text["en"]["settings_setQuestAll"]=["fix questseries","If neccessary values of questseries are taiken from the game. This is applicable for achieved questseries or questseries not accessible due to activated sandglass."];
        text["en"]["settings_megafieldSmartTimer"]=["Integrate active tour", "Megafield-Timer is set to end of the tour after a tour is started."];
        text["en"]["settings_clothingDonation"]=["Clothing Donation", "A blinking icon indicates, when you can donate or gamble."];
        text["en"]["settings_vet"]=["Veterinary (Treatment of sick animals)", "A blinking icon indicates, when a cured animal can be discharged."];
        text["en"]["settings_vetAutoSet"]=["Auto set", "A selected sick animal is directly benched."];
        text["en"]["settings_valVetNoCoinDrugs"]=["No coin drugs", "Ignore drugs needing coins to be produced."];
        text["en"]["settings_vetTreatment"]=["Animal sick", "Animaldata read for animal-sick"];
        text["en"]["settings_valTurnOffUpjersNews"]=["Turn off upjers news","Turn off the upjers news window."];
        //help
        text["en"]["help_0"]=[,"This is a small introduction to the functions of the Adviser-Script. Not all changes are written here, go find them yourself ... Sometimes a mouse-over helps. <br>At the bottom you see a button to visit the <a href=\""+GM_Home+"\" target=\"_blank\">homepage</a>. Next to it, there is the button for the options. You should look at them and configure as you desire.<br>Generally the script only knows what you have seen. So just visit the field if something is wrong."];
        text["en"]["help_1"]=["The Zones","The fields are observed while you see them. The script saves the plants, times and watering. So on the farm view this can be displayed. Each zone has a time counter at its top to show you when it is ready.<br>If you own the planting helper, you can access it directly from opened field. At the top of an opened zone you can navigate directly to zones of the same type."];
        text["en"]["help_2"]=["The Overview","Click the pig on the top and you will see an overview of your complete farm. Each zone, its output (product and points) and the next time of work are displayed. Also your total crop is shown. Below you see the wishes of your farmies. You can click each zone or farmie to navigate there. If you are run out of a product, it can take you directly to the market place."];
        text["en"]["help_3"]=["Blue Bar","Your points are kept daily. At the bottom you see a bar displaying the current and past level. Each white and red (sunday) line is a day. If you click it you get a detailed table and perhaps a hint if you are lack of a product."];
        text["en"]["help_4"]=["Shelf","Here informations of prices and value are added. The amount are reformatted to better style. At the bottom you have an input to seach an other player."];
        text["en"]["help_5"]=["Profit Calculation","Next to the bottom of the shelf you can click <img src=\""+GFX+"buildingupdatebutton_off.png\" style=\"width: 15px;height: 15px;\">. This shows you a table calculating times and profits of your products. Click the stars to change the upgrade levels. Click the headline to sort."];
        text["en"]["help_6"]=["Farmies","The bubbles of the farmies are expanded by a calculation if they pay enough. If your product amount runs too low, the product is marked. Click the house next to the farmies to see the ones of the last month. At the blue bar on the right you can set which farmies you send away. At the top a calculation is made, so you can decide if an advertising is profitable."];
        text["en"]["help_7"]=["Hotkeys","You can quickly move to a place by pressing <i>Alt</i>+... See the options!"];
        text["en"]["help_8"]=["Market place","On the market place you are \"protected\", means that you can't buy a product more expensive than in the retailer or by options set. If activated, you can directly switch to a product page by the incoming window on the right. At the top you can step to the next/previous product and see your current amount.<br>You find at the bottom a very important button: the prices. It gives you a table listing your product amounts, values and the prices that are everywhere used. So keep attention they are set right! An \"observed\" price is kept when you visit a market page of a single product.<br>On your market stall a few usefull values are displayed and your last offer was kept and is set now."];
        text["en"]["help_9"]=["Messages","Your sales are kept and directly displayed - no need to open a message two times! Note the \"Read all\" and \"Log\" buttons. Your private messages are kept, too. So no need to look for the last messages of the current contact."];
        text["en"]["help_10"]=["Contracts","They are kept, too. While creating a contact an input displays the value of the entered product. Enter first the price and then the amount to get inverse the amount. You can submit the same contract multiple times!"];
        text["en"]["help_11"]=["Account Managing","You can save all your accounts in the options. So you can login easily in each one by the displayed buttons on the starting page. Note that you can switch directly the accounts at the same server."];
    }
    err_trace="Regular expressions";
    regDelimThou=new RegExp(regDelimThou,"g");
    regDelimThouShift=new RegExp(regDelimThouShift,"g");
    regDelimThouDelete=new RegExp(regDelimThouDelete,"g");
    regDelimDeci=new RegExp(regDelimDeci);
    regMsgContentMarketsale=new RegExp(getText("msgContentMarketsale"));
    regMsgContentContractsale=new RegExp(getText("msgContentContractsale"));
    regMsgContentContractsaleList=new RegExp(getText("msgContentContractsaleList"));
    regMsgSubjectFriend=new RegExp(getText("msgSubjectFriend"));
    regMsgSubjectFriendEnd=new RegExp(getText("msgSubjectFriendEnd"));
    regMsgSubjectMarketsale=new RegExp(getText("msgSubjectMarketsale"));
    regMsgSubjectQuest=new RegExp(getText("msgSubjectQuest"));
    err_trace="Events";
    if(DEVMODE_EVENTS&&(self==top)){
        var allEvents=new Array();
        // list of events:
        allEvents.push("gameWindowContractNew");            // "create new contract"-frame is loaded
        allEvents.push("gameChangedProdMinRackInit");       // prodMinRackInit  is saved (rack amount detail configuration, market-frame)
        allEvents.push("gameChangedProdMinRackAddon");      // prodMinRackAddon is saved
        allEvents.push("gameChangedGut");                   // gut is saved (market-frame)
        allEvents.push("gameChangedBeobPrice");             // beobPrice is saved (market-frame)
        allEvents.push("gameChangedOwnMarketOffers");       // ownMarketOffers is saved
        allEvents.push("gameChangedLevelLog");              // levelLog is saved (message-frame)
        allEvents.push("gameOtherAccReady");                // another account needs to be worked
        allEvents.push("gameSessionEnds");                  // the session ends soon (max 120s)
        allEvents.push("gameInfoPanelOpen");                // the infoPanel is opened and filled
        allEvents.push("gameInfoPanelOptions");             // the infoPanel has the option-tab loaded
        allEvents.push("gameUpdateRack");                   // the rack has loaded
        allEvents.push("gameFieldModified");                // the plants on the opened field are loaded
        allEvents.push("gameFieldOpened");                  // a field is opened
        allEvents.push("gameFieldPlanted");                 // a field has been planted
        allEvents.push("gameFieldWatered");                 // a field has been watered
        allEvents.push("gameFieldCropped");                 // a field has been cropped
        allEvents.push("gameFieldDemolish");              //
        allEvents.push("gameFactoryKnittingStarted");       // a knitting factory has been started
        allEvents.push("gameFactoryKnittingCropped");       // a knitting factory has been cropped
        allEvents.push("gameFactoryKnittingDialogStart");   // a knitting factory has opened a production dialogue
        allEvents.push("gameFarmLoaded");                   // the farm is loaded
        allEvents.push("gameFarmOpened");                   // the farm is opened
        allEvents.push("gameFarmersmarketCropped");         // the farmersmarket is cropped
        allEvents.push("gameFarmersmarketStarted");         // the farmersmarket has been started
        allEvents.push("gameFarmersmarketWatered");         // the farmersmarket has been watered
        allEvents.push("gameFarmersmarketOpened");          // the farmersmarket is opened
        allEvents.push("gameFarmersmarketOpened1");         // the farmersmarket building 1 is opened
        allEvents.push("gameFarmersmarketOpened2");         // the farmersmarket building 2 is opened
        allEvents.push("gameFarmersmarketOpened5");         // the farmersmarket building 5 is opened
        allEvents.push("gameFarmersmarketSlotOpened");      // the farmersmarket building slot has been opened
        allEvents.push("gameFarmersmarketDialogStart");     // the farmersmarket building has opened a dialogue
        allEvents.push("gameFarmersmarketDialogCommit");    // the farmersmarket building has requested for commit of a dialogue
        allEvents.push("gameFarmiNew");                     // a new farmi is appeared
        allEvents.push("gameFarmiResponse");                // a farmi is been rejected or accepted.
        allEvents.push("gameFuelstationEntry");             // Fuelstation Product entry
        allEvents.push("gameFuelstationHarvest");           // Fuelstation Slot cropped
        allEvents.push("gameFuelstationOpenDialogProdukt"); // Fuelstation Product choose
        allEvents.push("gameFuelstationOpenDialogPID");     // Fuelstation Product amout
        allEvents.push("gamePonyCropped");                  // a pony has been cropped
        allEvents.push("gamePonyFed");                      // a pony has been fed (after confirmation)
        allEvents.push("gamePonyFarmiSet");                 // a pony farmi has been set on a pony (after confirmation)
        allEvents.push("gamePonyFarmiSelected");            // a pony farmi has been selected (not unselected)
        allEvents.push("gamePonyFeedDialogOpened");         // a pony's food box has been opened (before confirmation)
        allEvents.push("gamePonySetDialogOpened");          // a pony farmi has been set on a pony (before confirmation)
        allEvents.push("gameMegafieldDialogStarted");       // the megafield view has been moved
        allEvents.push("gameMegafieldMoved");               // a megafield vehicle has been bought
        allEvents.push("gameMegafieldTourStarted");         // a megafield tour has been started
        allEvents.push("gameMegafieldPlanted");             // a field has been planted on the megafield
        allEvents.push("gameMegafieldVehicleBought");       // a megafield vehicle has been bought
        allEvents.push("gameOpenCampaign");                 // Forestry Quest is opened
        allEvents.push("gameOpenStable");                   // a stable is opened
        allEvents.push("gameOpenFactory");                  // a factory is opened
        allEvents.push("gameOpenFactoryOil");               // an oil factory is opened
        allEvents.push("gameOpenFactoryKnitting");          // an knitting factory is opened
        allEvents.push("gameOpenFactoryOilKnittingTea");    // an knitting or oil or tea factory is opened
        allEvents.push("gameOpenFuelstation");               // an oil factory is opened
        allEvents.push("gameOpenMarket");                   // the market is opened
        allEvents.push("gameOpenMegafield");                // the megafield is opened
        allEvents.push("gameOpenWindmill");                 // the windmill is opened
        allEvents.push("gameOpenGlobalCommitBox");          // GlobalCommitBox is opened
        allEvents.push("gameOpenGlobalBox");                // GlobalBox is opened
        allEvents.push("gameOpenForestry");                 // Forestry is opened
        allEvents.push("gameFoodworldCropped");             // Foodworld building has been cropped
        allEvents.push("gameFoodworldOpened");              // Foodworld is opened
        allEvents.push("gameFoodworldOpened1");             // Foodworld building 1 is opened
        allEvents.push("gameFoodworldOpened2");             // Foodworld building 2 is opened
        allEvents.push("gameFoodworldOpened3");             // Foodworld building 3 is opened
        allEvents.push("gameFoodworldOpened4");             // Foodworld building 4 is opened
        allEvents.push("gameFoodworldSlotOpened");          // Foodworld slot has been opened
        allEvents.push("gameFoodworldStarted");             // Foodworld building has been started
        allEvents.push("gameSawmillCropped");               // Sawmill has been cropped
        allEvents.push("gameSawmillOpened");                // Sawmill is opened
        allEvents.push("gameSawmillStarted");               // Sawmill has been started
        allEvents.push("gameSawmillSlotOpened");            // Sawmill-Slot is opened
        allEvents.push("gameCarpentryCropped");             // Carpentry has been cropped
        allEvents.push("gameCarpentryOpened");              // Carpentry is opened
        allEvents.push("gameCarpentryStarted");             // Carpentry has been started
        allEvents.push("gameCarpentrySlotOpened");          // Carpentry-Slot is opened
        allEvents.push("gameCity1");                        // city 1 is opened
        allEvents.push("gameCity2");                        // city 2 is opened
        allEvents.push("gameLotteryOpen");                  // lottery frame is opened
        allEvents.push("gameLotteryGotDailyLot");           // daily lot is taken
        allEvents.push("gameLotteryGotLot");                // lot decision question is shown
        allEvents.push("gameLotteryGotPrize");              // got price
        allEvents.push("gameLotteryDailyLotAvailable");     //
        allEvents.push("gamePoweruprackUpdated");           // Power-up data updated
        allEvents.push("gameQuestNewAvailable");            // There is a new quest that can be played
        allEvents.push("gameQuestAccepted");                // Quest is accepted
        //allEvents.push("gameQuestActive");                    // There is an activated quest
        allEvents.push("gameQuestFinished");                // Quest is finished
        allEvents.push("gameQuestSolvable");
        allEvents.push("gameNewDay");                       // a new day started
        allEvents.push("gameWindmillStarted");              // the windmill has been started
        allEvents.push("gameWindmillCropped");              // the windmill has been cropped
        allEvents.push("gameWindmillDialogStart");          // the windmill has opened a recipe dialogue
        allEvents.push("gameWindmillDialogCommit");         // the windmill has requested for commit of a recipe dialogue
        allEvents.push("gameZoneReady");                    // a zone is ready. unsafeData.readyZone is set
        allEvents.push("gameUpdateFormuladealerOffers");    // the formula-dealer has filled the offers
        allEvents.push("gameUpdateFormuladealerRack");      // the formula-dealer has filled the recipes rack
        allEvents.push("gamePowerupActivated");             // a power-up has been executed
        allEvents.push("gameReallocateBuilding");           // 2 buildings are swapped. unsafeData.reallocateBuildingSet is set [1..18,1..18]
        allEvents.push("gameUserlevelUp");                  // a new level is reached
        allEvents.push("beraterDone");                      // script successfully executed

        for(var v=0;v<allEvents.length;v++){
            document.addEventListener(allEvents[v],function(event){
                GM_logInfo("EventListener","","","Event "+event.type,2);
            },false);
        }
        allEvents=null;
    }
    err_trace="MenuCommand";
    GM_registerMenuCommand(getText("adviser")+" Update", function(){
        location.href=GM_Source;
    });
    GM_registerMenuCommand(getText("adviser")+" "+getText("scriptHomepage"), function(){
        window.open(GM_Home);
    });
    err_trace="scriptStart";
    if((document.readyState=="complete")||(document.readyState=="loaded")){
        scriptStart();
    }else{
        reloader.start("pageLoad",20,getText("pageXNotLoaded").replace(/%1%/,location.href));
        window.addEventListener("load", function load(event){
            window.removeEventListener("load", load, false);
            scriptStart();
        },false);
    }
}catch(err){GM_logError("scriptWait","","err_trace="+err_trace+" location.href="+location.href,err);}
}

scriptInit();


/*
function test() {
    console.log("test");

    if($("loginbutton")){
        console.log("tes3t");
        scriptInit();
    } else if ($("farm_main")){
        console.log("tes2t");
        scriptInit();*/
        /*document.addEventListener("beraterDone",function(){
            start_script();
            document.removeEventListener("beraterDone",arguments.callee,false);
        },false);*/
/*    } else {
        window.setTimeout(test,1000);
    }
}

window.addEventListener("load", function load(event){
    window.removeEventListener("load", load, false);
    console.log("load" + implode(event));
    window.setTimeout(test,1000);
},false);
*/
